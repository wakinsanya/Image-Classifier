(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},6:function(t,e){},zUnb:function(t,e,n){"use strict";n.r(e);var r={};function i(t){return"function"==typeof t}n.r(r),n.d(r,"AdadeltaOptimizer",function(){return qA}),n.d(r,"AdagradOptimizer",function(){return $A}),n.d(r,"AdamOptimizer",function(){return GA}),n.d(r,"AdamaxOptimizer",function(){return KA}),n.d(r,"DataStorage",function(){return gC}),n.d(r,"ENV",function(){return Fv}),n.d(r,"Environment",function(){return Dv}),n.d(r,"KernelBackend",function(){return yC}),n.d(r,"MomentumOptimizer",function(){return QA}),n.d(r,"Optimizer",function(){return HA}),n.d(r,"RMSPropOptimizer",function(){return ZA}),n.d(r,"Rank",function(){return Ub}),n.d(r,"Reduction",function(){return eT}),n.d(r,"SGDOptimizer",function(){return XA}),n.d(r,"Tensor",function(){return zb}),n.d(r,"TensorBuffer",function(){return Pb}),n.d(r,"Variable",function(){return Bb}),n.d(r,"abs",function(){return uk}),n.d(r,"acos",function(){return lk}),n.d(r,"acosh",function(){return ck}),n.d(r,"add",function(){return eI}),n.d(r,"addN",function(){return nI}),n.d(r,"addStrict",function(){return rI}),n.d(r,"all",function(){return ON}),n.d(r,"any",function(){return DN}),n.d(r,"argMax",function(){return PN}),n.d(r,"argMin",function(){return FN}),n.d(r,"asin",function(){return hk}),n.d(r,"asinh",function(){return pk}),n.d(r,"atan",function(){return dk}),n.d(r,"atan2",function(){return iI}),n.d(r,"atanh",function(){return fk}),n.d(r,"avgPool",function(){return SN}),n.d(r,"backend",function(){return wx}),n.d(r,"backend_util",function(){return PC}),n.d(r,"basicLSTMCell",function(){return UI}),n.d(r,"batchNorm",function(){return Jk}),n.d(r,"batchNorm2d",function(){return tN}),n.d(r,"batchNorm3d",function(){return eN}),n.d(r,"batchNorm4d",function(){return nN}),n.d(r,"batchNormalization",function(){return Yk}),n.d(r,"batchNormalization2d",function(){return Xk}),n.d(r,"batchNormalization3d",function(){return Qk}),n.d(r,"batchNormalization4d",function(){return Zk}),n.d(r,"batchToSpaceND",function(){return __}),n.d(r,"browser",function(){return RA}),n.d(r,"buffer",function(){return w_}),n.d(r,"cast",function(){return C_}),n.d(r,"ceil",function(){return mk}),n.d(r,"clipByValue",function(){return gk}),n.d(r,"clone",function(){return S_}),n.d(r,"complex",function(){return zx}),n.d(r,"concat",function(){return r_}),n.d(r,"concat1d",function(){return i_}),n.d(r,"concat2d",function(){return o_}),n.d(r,"concat3d",function(){return s_}),n.d(r,"concat4d",function(){return a_}),n.d(r,"conv1d",function(){return sN}),n.d(r,"conv2d",function(){return aN}),n.d(r,"conv2dDerFilter",function(){return lN}),n.d(r,"conv2dTranspose",function(){return pN}),n.d(r,"conv3d",function(){return uN}),n.d(r,"cos",function(){return yk}),n.d(r,"cosh",function(){return vk}),n.d(r,"cumsum",function(){return E_}),n.d(r,"customGrad",function(){return pC}),n.d(r,"deprecationWarn",function(){return ox}),n.d(r,"depthToSpace",function(){return k_}),n.d(r,"depthwiseConv2d",function(){return cN}),n.d(r,"disableDeprecationWarnings",function(){return ix}),n.d(r,"dispose",function(){return cx}),n.d(r,"disposeVariables",function(){return sx}),n.d(r,"div",function(){return oI}),n.d(r,"divStrict",function(){return sI}),n.d(r,"dot",function(){return fN}),n.d(r,"dropout",function(){return JI}),n.d(r,"elu",function(){return II}),n.d(r,"enableDebugMode",function(){return rx}),n.d(r,"enableProdMode",function(){return nx}),n.d(r,"environment",function(){return Lv}),n.d(r,"equal",function(){return WN}),n.d(r,"equalStrict",function(){return HN}),n.d(r,"erf",function(){return bk}),n.d(r,"exp",function(){return wk}),n.d(r,"expandDims",function(){return N_}),n.d(r,"expm1",function(){return xk}),n.d(r,"eye",function(){return I_}),n.d(r,"fft",function(){return $I}),n.d(r,"fill",function(){return Yx}),n.d(r,"findBackend",function(){return yx}),n.d(r,"findBackendFactory",function(){return vx}),n.d(r,"floor",function(){return _k}),n.d(r,"floorDiv",function(){return aI}),n.d(r,"frame",function(){return iT}),n.d(r,"fused",function(){return NT}),n.d(r,"gather",function(){return zI}),n.d(r,"gatherND",function(){return YI}),n.d(r,"getBackend",function(){return mx}),n.d(r,"grad",function(){return aC}),n.d(r,"grads",function(){return uC}),n.d(r,"greater",function(){return qN}),n.d(r,"greaterEqual",function(){return $N}),n.d(r,"greaterEqualStrict",function(){return GN}),n.d(r,"greaterStrict",function(){return KN}),n.d(r,"hammingWindow",function(){return rT}),n.d(r,"hannWindow",function(){return nT}),n.d(r,"ifft",function(){return GI}),n.d(r,"imag",function(){return Ux}),n.d(r,"image",function(){return ET}),n.d(r,"io",function(){return NA}),n.d(r,"irfft",function(){return XI}),n.d(r,"isFinite",function(){return Pk}),n.d(r,"isInf",function(){return Dk}),n.d(r,"isNaN",function(){return Ok}),n.d(r,"keep",function(){return hx}),n.d(r,"leakyRelu",function(){return TI}),n.d(r,"less",function(){return XN}),n.d(r,"lessEqual",function(){return QN}),n.d(r,"lessEqualStrict",function(){return ZN}),n.d(r,"lessStrict",function(){return YN}),n.d(r,"linalg",function(){return bT}),n.d(r,"linspace",function(){return Jx}),n.d(r,"localResponseNormalization",function(){return PI}),n.d(r,"log",function(){return Ck}),n.d(r,"log1p",function(){return Sk}),n.d(r,"logSigmoid",function(){return Ek}),n.d(r,"logSoftmax",function(){return mC}),n.d(r,"logSumExp",function(){return MN}),n.d(r,"logicalAnd",function(){return _I}),n.d(r,"logicalNot",function(){return CI}),n.d(r,"logicalOr",function(){return SI}),n.d(r,"logicalXor",function(){return EI}),n.d(r,"losses",function(){return mT}),n.d(r,"matMul",function(){return dN}),n.d(r,"math",function(){return TA}),n.d(r,"max",function(){return LN}),n.d(r,"maxPool",function(){return CN}),n.d(r,"maximum",function(){return uI}),n.d(r,"maximumStrict",function(){return lI}),n.d(r,"mean",function(){return zN}),n.d(r,"memory",function(){return ax}),n.d(r,"min",function(){return BN}),n.d(r,"minimum",function(){return cI}),n.d(r,"minimumStrict",function(){return hI}),n.d(r,"mod",function(){return pI}),n.d(r,"modStrict",function(){return dI}),n.d(r,"moments",function(){return UN}),n.d(r,"movingAverage",function(){return jI}),n.d(r,"mul",function(){return fI}),n.d(r,"mulStrict",function(){return mI}),n.d(r,"multiRNNCell",function(){return VI}),n.d(r,"multinomial",function(){return T_}),n.d(r,"neg",function(){return kk}),n.d(r,"nextFrame",function(){return eR}),n.d(r,"norm",function(){return FI}),n.d(r,"notEqual",function(){return JN}),n.d(r,"notEqualStrict",function(){return tI}),n.d(r,"oneHot",function(){return A_}),n.d(r,"ones",function(){return Qx}),n.d(r,"onesLike",function(){return e_}),n.d(r,"op",function(){return Lx}),n.d(r,"outerProduct",function(){return mN}),n.d(r,"pad",function(){return R_}),n.d(r,"pad1d",function(){return O_}),n.d(r,"pad2d",function(){return D_}),n.d(r,"pad3d",function(){return P_}),n.d(r,"pad4d",function(){return F_}),n.d(r,"pool",function(){return EN}),n.d(r,"pow",function(){return gI}),n.d(r,"powStrict",function(){return yI}),n.d(r,"prelu",function(){return AI}),n.d(r,"print",function(){return x_}),n.d(r,"prod",function(){return jN}),n.d(r,"profile",function(){return ux}),n.d(r,"rand",function(){return M_}),n.d(r,"randomNormal",function(){return L_}),n.d(r,"randomUniform",function(){return z_}),n.d(r,"range",function(){return t_}),n.d(r,"ready",function(){return fx}),n.d(r,"real",function(){return Bx}),n.d(r,"reciprocal",function(){return Nk}),n.d(r,"registerBackend",function(){return bx}),n.d(r,"relu",function(){return RI}),n.d(r,"removeBackend",function(){return gx}),n.d(r,"reshape",function(){return B_}),n.d(r,"reverse",function(){return gN}),n.d(r,"reverse1d",function(){return yN}),n.d(r,"reverse2d",function(){return vN}),n.d(r,"reverse3d",function(){return bN}),n.d(r,"reverse4d",function(){return wN}),n.d(r,"rfft",function(){return KI}),n.d(r,"round",function(){return Ik}),n.d(r,"rsqrt",function(){return Tk}),n.d(r,"scalar",function(){return Wx}),n.d(r,"scatterND",function(){return qI}),n.d(r,"selu",function(){return OI}),n.d(r,"separableConv2d",function(){return hN}),n.d(r,"serialization",function(){return FA}),n.d(r,"setBackend",function(){return dx}),n.d(r,"setPlatform",function(){return xx}),n.d(r,"setdiff1dAsync",function(){return $_}),n.d(r,"sigmoid",function(){return Ak}),n.d(r,"sign",function(){return Rk}),n.d(r,"signal",function(){return oT}),n.d(r,"sin",function(){return Fk}),n.d(r,"sinh",function(){return Mk}),n.d(r,"slice",function(){return kN}),n.d(r,"slice1d",function(){return NN}),n.d(r,"slice2d",function(){return IN}),n.d(r,"slice3d",function(){return TN}),n.d(r,"slice4d",function(){return AN}),n.d(r,"softmax",function(){return fC}),n.d(r,"softplus",function(){return Lk}),n.d(r,"spaceToBatchND",function(){return U_}),n.d(r,"sparseToDense",function(){return ZI}),n.d(r,"spectral",function(){return QI}),n.d(r,"split",function(){return u_}),n.d(r,"sqrt",function(){return zk}),n.d(r,"square",function(){return Bk}),n.d(r,"squaredDifference",function(){return vI}),n.d(r,"squaredDifferenceStrict",function(){return bI}),n.d(r,"squeeze",function(){return V_}),n.d(r,"stack",function(){return j_}),n.d(r,"step",function(){return Uk}),n.d(r,"stridedSlice",function(){return WI}),n.d(r,"sub",function(){return wI}),n.d(r,"subStrict",function(){return xI}),n.d(r,"sum",function(){return VN}),n.d(r,"tan",function(){return Vk}),n.d(r,"tanh",function(){return jk}),n.d(r,"tensor",function(){return Vx}),n.d(r,"tensor1d",function(){return Hx}),n.d(r,"tensor2d",function(){return qx}),n.d(r,"tensor3d",function(){return $x}),n.d(r,"tensor4d",function(){return Gx}),n.d(r,"tensor5d",function(){return Kx}),n.d(r,"tensor6d",function(){return Xx}),n.d(r,"tensor_util",function(){return tw}),n.d(r,"test_util",function(){return VA}),n.d(r,"tidy",function(){return lx}),n.d(r,"tile",function(){return W_}),n.d(r,"time",function(){return px}),n.d(r,"topk",function(){return HI}),n.d(r,"train",function(){return JA}),n.d(r,"transpose",function(){return DI}),n.d(r,"truncatedNormal",function(){return H_}),n.d(r,"unsortedSegmentSum",function(){return BI}),n.d(r,"unstack",function(){return q_}),n.d(r,"util",function(){return Nb}),n.d(r,"valueAndGrad",function(){return lC}),n.d(r,"valueAndGrads",function(){return cC}),n.d(r,"variable",function(){return $b}),n.d(r,"variableGrads",function(){return hC}),n.d(r,"version_core",function(){return jA}),n.d(r,"webgl",function(){return WA}),n.d(r,"where",function(){return kI}),n.d(r,"whereAsync",function(){return NI}),n.d(r,"zeros",function(){return Zx}),n.d(r,"zerosLike",function(){return n_});let o=!1;const s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){o=t},get useDeprecatedSynchronousErrorHandling(){return o}};function a(t){setTimeout(()=>{throw t})}const u={closed:!0,next(t){},error(t){if(s.useDeprecatedSynchronousErrorHandling)throw t;a(t)},complete(){}},l=Array.isArray||(t=>t&&"number"==typeof t.length);function c(t){return null!==t&&"object"==typeof t}function h(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}h.prototype=Object.create(Error.prototype);const p=h;let d=(()=>{class t{constructor(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let t,e=!1;if(this.closed)return;let{_parent:n,_parents:r,_unsubscribe:o,_subscriptions:s}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let a=-1,u=r?r.length:0;for(;n;)n.remove(this),n=++a<u&&r[a]||null;if(i(o))try{o.call(this)}catch(aR){e=!0,t=aR instanceof p?f(aR.errors):[aR]}if(l(s))for(a=-1,u=s.length;++a<u;){const n=s[a];if(c(n))try{n.unsubscribe()}catch(aR){e=!0,t=t||[],aR instanceof p?t=t.concat(f(aR.errors)):t.push(aR)}}if(e)throw new p(t)}add(e){let n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;(n=new t)._subscriptions=[e]}break;default:if(!e)return t.EMPTY;throw new Error("unrecognized teardown "+e+" added to Subscription.")}if(n._addParent(this)){const t=this._subscriptions;t?t.push(n):this._subscriptions=[n]}return n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}_addParent(t){let{_parent:e,_parents:n}=this;return e!==t&&(e?n?-1===n.indexOf(t)&&(n.push(t),!0):(this._parents=[t],!0):(this._parent=t,!0))}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function f(t){return t.reduce((t,e)=>t.concat(e instanceof p?e.errors:e),[])}const m="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class g extends d{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=u;break;case 1:if(!t){this.destination=u;break}if("object"==typeof t){t instanceof g?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new y(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new y(this,t,e,n)}}[m](){return this}static create(t,e,n){const r=new g(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:t,_parents:e}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this}}class y extends g{constructor(t,e,n,r){let o;super(),this._parentSubscriber=t;let s=this;i(e)?o=e:e&&(o=e.next,n=e.error,r=e.complete,e!==u&&(i((s=Object.create(e)).unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=o,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=s;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):a(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;a(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}__tryOrSetError(t,e,n){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return s.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(a(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const v="function"==typeof Symbol&&Symbol.observable||"@@observable";function b(){}function w(...t){return x(t)}function x(t){return t?1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}:b}let _=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof g)return t;if(t[m])return t[m]()}return t||e||n?new g(t,e,n):new g(u)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||s.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),s.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){s.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof g?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=C(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[v](){return this}pipe(...t){return 0===t.length?this:x(t)(this)}toPromise(t){return new(t=C(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function C(t){if(t||(t=s.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function S(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}S.prototype=Object.create(Error.prototype);const E=S;class k extends d{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class N extends g{constructor(t){super(t),this.destination=t}}let I=(()=>{class t extends _{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[m](){return new N(this)}lift(t){const e=new T(this,this);return e.operator=t,e}next(t){if(this.closed)throw new E;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new E;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new E;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new E;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new E;return this.hasError?(t.error(this.thrownError),d.EMPTY):this.isStopped?(t.complete(),d.EMPTY):(this.observers.push(t),new k(this,t))}asObservable(){const t=new _;return t.source=this,t}}return t.create=(t,e)=>new T(t,e),t})();class T extends I{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):d.EMPTY}}function A(t){return t&&"function"==typeof t.schedule}class R extends g{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const O=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.closed||e.complete()},D=t=>e=>(t.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,a),e);function P(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const F=P(),M=t=>e=>{const n=t[F]();for(;;){const t=n.next();if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e},L=t=>e=>{const n=t[v]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)},z=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function B(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const U=t=>{if(t instanceof _)return e=>t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e);if(t&&"function"==typeof t[v])return L(t);if(z(t))return O(t);if(B(t))return D(t);if(t&&"function"==typeof t[F])return M(t);{const e=c(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}};function V(t,e,n,r,i=new R(t,n,r)){if(!i.closed)return U(e)(i)}class j extends g{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function W(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new H(t,e))}}class H{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new q(t,this.project,this.thisArg))}}class q extends g{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function $(t,e){return new _(e?n=>{const r=new d;let i=0;return r.add(e.schedule(function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()})),r}:O(t))}function G(t,e){if(!e)return t instanceof _?t:new _(U(t));if(null!=t){if(function(t){return t&&"function"==typeof t[v]}(t))return function(t,e){return new _(e?n=>{const r=new d;return r.add(e.schedule(()=>{const i=t[v]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r}:L(t))}(t,e);if(B(t))return function(t,e){return new _(e?n=>{const r=new d;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r}:D(t))}(t,e);if(z(t))return $(t,e);if(function(t){return t&&"function"==typeof t[F]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new _(e?n=>{const r=new d;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[F](),r.add(e.schedule(function(){if(n.closed)return;let t,e;try{const o=i.next();t=o.value,e=o.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())}))})),r}:M(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function K(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(K((n,r)=>G(t(n,r)).pipe(W((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new X(t,n)))}class X{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new Q(t,this.project,this.concurrent))}}class Q extends j{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new R(this,void 0,void 0);this.destination.add(r),V(this,t,e,n,r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Z(t){return t}function Y(t=Number.POSITIVE_INFINITY){return K(Z,t)}function J(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return A(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof _?t[0]:Y(e)($(t,n))}function tt(){return function(t){return t.lift(new et(t))}}class et{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new nt(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class nt extends g{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}const rt=class extends _{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new d).add(this.source.subscribe(new ot(this.getSubject(),this))),t.closed?(this._connection=null,t=d.EMPTY):this._connection=t),t}refCount(){return tt()(this)}}.prototype,it={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:rt._subscribe},_isComplete:{value:rt._isComplete,writable:!0},getSubject:{value:rt.getSubject},connect:{value:rt.connect},refCount:{value:rt.refCount}};class ot extends N{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function st(){return new I}function at(){return t=>tt()(function(t,e){return function(e){let n;n="function"==typeof t?t:function(){return t};const r=Object.create(e,it);return r.source=e,r.subjectFactory=n,r}}(st)(t))}const ut="__parameters__";function lt(t,e,n){const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty(ut)?t[ut]:Object.defineProperty(t,ut,{value:[]})[ut];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}const ct=lt("Inject",t=>({token:t})),ht=lt("Optional"),pt=lt("Self"),dt=lt("SkipSelf");var ft=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function mt(t){for(let e in t)if(t[e]===mt)return e;throw Error("Could not find renamed property on target object.")}function gt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function yt(t){const e=t[vt];return e&&e.token===t?e:null}const vt=mt({ngInjectableDef:mt});function bt(t){if("string"==typeof t)return t;if(t instanceof Array)return"["+t.map(bt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}const wt=mt({__forward_ref__:mt});function xt(t){return t.__forward_ref__=xt,t.toString=function(){return bt(this())},t}function _t(t){const e=t;return"function"==typeof e&&e.hasOwnProperty(wt)&&e.__forward_ref__===xt?e():t}const Ct="undefined"!=typeof globalThis&&globalThis,St="undefined"!=typeof window&&window,Et="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,kt="undefined"!=typeof global&&global,Nt=Ct||kt||St||Et;class It{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.ngInjectableDef=gt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Tt=new It("INJECTOR",-1),At=new Object,Rt="ngTempTokenPath",Ot="ngTokenPath",Dt=/\n/gm,Pt="\u0275",Ft="__source",Mt=mt({provide:String,useValue:mt});let Lt,zt=void 0;function Bt(t){const e=zt;return zt=t,e}function Ut(t,e=ft.Default){return(Lt||function(t,e=ft.Default){if(void 0===zt)throw new Error("inject() must be called from an injection context");return null===zt?function(t,e,n){const r=yt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ft.Optional)return null;throw new Error(`Injector: NOT_FOUND [${bt(t)}]`)}(t,0,e):zt.get(t,e&ft.Optional?null:void 0,e)})(t,e)}const Vt=Ut;class jt{get(t,e=At){if(e===At){const e=new Error(`NullInjectorError: No provider for ${bt(t)}!`);throw e.name="NullInjectorError",e}return e}}function Wt(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==Pt?t.substr(2):t;let i=bt(e);if(e instanceof Array)i=e.map(bt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):bt(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Dt,"\n  ")}`}const Ht=new It("The presence of this token marks an injector as being the root injector."),qt=function(t,e,n){return new Yt(t,e,n)};let $t=(()=>{class t{static create(t,e){return Array.isArray(t)?qt(t,e,""):qt(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=At,t.NULL=new jt,t.ngInjectableDef=gt({token:t,providedIn:"any",factory:()=>Ut(Tt)}),t.__NG_ELEMENT_ID__=-1,t})();const Gt=function(t){return t},Kt=[],Xt=Gt,Qt=function(){return Array.prototype.slice.call(arguments)},Zt="\u0275";class Yt{constructor(t,e=$t.NULL,n=null){this.parent=e,this.source=n;const r=this._records=new Map;r.set($t,{token:$t,fn:Gt,deps:Kt,value:this,useNew:!1}),r.set(Tt,{token:Tt,fn:Gt,deps:Kt,value:this,useNew:!1}),function t(e,n){if(n)if((n=_t(n))instanceof Array)for(let r=0;r<n.length;r++)t(e,n[r]);else{if("function"==typeof n)throw te("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw te("Unexpected provider",n);{let t=_t(n.provide);const r=function(t){const e=function(t){let e=Kt;const n=t.deps;if(n&&n.length){e=[];for(let t=0;t<n.length;t++){let r=6,i=_t(n[t]);if(i instanceof Array)for(let t=0,e=i;t<e.length;t++){const n=e[t];n instanceof ht||n==ht?r|=1:n instanceof dt||n==dt?r&=-3:n instanceof pt||n==pt?r&=-5:i=n instanceof ct?n.token:_t(n)}e.push({token:i,options:r})}}else if(t.useExisting)e=[{token:_t(t.useExisting),options:6}];else if(!(n||Mt in t))throw te("'deps' required",t);return e}(t);let n=Gt,r=Kt,i=!1,o=_t(t.provide);if(Mt in t)r=t.useValue;else if(t.useFactory)n=t.useFactory;else if(t.useExisting);else if(t.useClass)i=!0,n=_t(t.useClass);else{if("function"!=typeof o)throw te("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",t);i=!0,n=o}return{deps:e,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){let r=e.get(t);if(r){if(r.fn!==Qt)throw Jt(t)}else e.set(t,r={token:n.provide,deps:[],useNew:!1,fn:Qt,value:Kt});r.deps.push({token:t=n,options:6})}const i=e.get(t);if(i&&i.fn==Qt)throw Jt(t);e.set(t,r)}}}(r,t)}get(t,e,n=ft.Default){const r=this._records.get(t);try{return function t(e,n,r,i,o,s){try{return function(e,n,r,i,o,s){let a;if(!n||s&ft.SkipSelf)s&ft.Self||(a=i.get(e,o,ft.Default));else{if((a=n.value)==Xt)throw Error(Zt+"Circular dependency");if(a===Kt){n.value=Xt;let e=void 0,o=n.useNew,s=n.fn,u=n.deps,l=Kt;if(u.length){l=[];for(let e=0;e<u.length;e++){const n=u[e],o=n.options,s=2&o?r.get(n.token):void 0;l.push(t(n.token,s,r,s||4&o?i:$t.NULL,1&o?null:$t.THROW_IF_NOT_FOUND,ft.Default))}}n.value=a=o?new s(...l):s.apply(e,l)}}return a}(e,n,r,i,o,s)}catch(aR){throw aR instanceof Error||(aR=new Error(aR)),(aR[Rt]=aR[Rt]||[]).unshift(e),n&&n.value==Xt&&(n.value=Kt),aR}}(t,r,this._records,this.parent,e,n)}catch(aR){return function(t,e,n,r){const i=t[Rt];throw e[Ft]&&i.unshift(e[Ft]),t.message=Wt("\n"+t.message,i,"StaticInjectorError",r),t[Ot]=i,t[Rt]=null,t}(aR,t,0,this.source)}}toString(){const t=[];return this._records.forEach((e,n)=>t.push(bt(n))),`StaticInjector[${t.join(", ")}]`}}function Jt(t){return te("Cannot mix multi providers and regular providers",t)}function te(t,e){return new Error(Wt(t,e,"StaticInjectorError"))}const ee="ngDebugContext",ne="ngOriginalError",re="ngErrorLogger",ie=new It("AnalyzeForEntryComponents"),oe=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),se=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Nt))();let ae=!0,ue=!1;function le(){return ue=!0,ae}class ce{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t),this.inertBodyElement=this.inertDocument.createElement("body"),t.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch($S){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch($S){return null}const e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);const n=e.response.body;return n.removeChild(n.firstChild),n}getInertBodyElement_DOMParser(t){t="<body><remove></remove>"+t+"</body>";try{const e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch($S){return null}}getInertBodyElement_InertDocument(t){const e=this.inertDocument.createElement("template");return"content"in e?(e.innerHTML=t,e):(this.inertBodyElement.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const he=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))/gi,pe=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function de(t){return(t=String(t)).match(he)||t.match(pe)?t:(le()&&console.warn(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}function fe(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function me(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const ge=fe("area,br,col,hr,img,wbr"),ye=fe("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ve=fe("rp,rt"),be=me(ve,ye),we=me(ge,me(ye,fe("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),me(ve,fe("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),be),xe=fe("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),_e=fe("srcset"),Ce=me(xe,_e,fe("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),fe("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Se=fe("script,style,template");class Ee{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!we.hasOwnProperty(e))return this.sanitizedSomething=!0,!Se.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,o=e.toLowerCase();if(!Ce.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let s=t.value;xe[o]&&(s=de(s)),_e[o]&&(r=s,s=(r=String(r)).split(",").map(t=>de(t.trim())).join(", ")),this.buf.push(" ",e,'="',Ie(s),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();we.hasOwnProperty(e)&&!ge.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Ie(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const ke=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ne=/([^\#-~ |!])/g;function Ie(t){return t.replace(/&/g,"&amp;").replace(ke,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Ne,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Te;function Ae(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}const Re=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}();class Oe{}const De=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Pe=/^url\(([^)]+)\)$/;function Fe(t){return t[ee]}function Me(t){return t[ne]}function Le(t,...e){t.error(...e)}class ze{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t[re]||Le}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?Fe(t)?Fe(t):this._findContext(Me(t)):null}_findOriginalError(t){let e=Me(t);for(;e&&Me(e);)e=Me(e);return e}}const Be=/([A-Z])/g;function Ue(t){try{return null!=t?t.toString().slice(0,30):t}catch(aR){return"[ERROR] Exception while trying to serialize the value"}}let Ve=null;function je(){if(!Ve){const t=Nt.Symbol;if(t&&t.iterator)Ve=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Ve=n)}}}return Ve}function We(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function He(t,e){const n=$e(t),r=$e(e);if(n&&r)return function(t,e,n){const r=t[je()](),i=e[je()]();for(;;){const t=r.next(),e=i.next();if(t.done&&e.done)return!0;if(t.done||e.done)return!1;if(!n(t.value,e.value))return!1}}(t,e,He);{const i=t&&("object"==typeof t||"function"==typeof t),o=e&&("object"==typeof e||"function"==typeof e);return!(n||!i||r||!o)||We(t,e)}}class qe{constructor(t){this.wrapped=t}static wrap(t){return new qe(t)}static unwrap(t){return qe.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof qe}}function $e(t){return!!Ge(t)&&(Array.isArray(t)||!(t instanceof Map)&&je()in t)}function Ge(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Ke(t){return!!t&&"function"==typeof t.then}function Xe(t){return!!t&&"function"==typeof t.subscribe}class Qe{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}class Ze{}class Ye{}function Je(t){const e=Error(`No component factory found for ${bt(t)}. Did you add it to @NgModule.entryComponents?`);return e[tn]=t,e}const tn="ngComponent";class en{resolveComponentFactory(t){throw Je(t)}}let nn=(()=>{class t{}return t.NULL=new en,t})();class rn{constructor(t,e,n){this._parent=e,this._ngModule=n,this._factories=new Map;for(let r=0;r<t.length;r++){const e=t[r];this._factories.set(e.componentType,e)}}resolveComponentFactory(t){let e=this._factories.get(t);if(!e&&this._parent&&(e=this._parent.resolveComponentFactory(t)),!e)throw Je(t);return new on(e,this._ngModule)}}class on extends Ye{constructor(t,e){super(),this.factory=t,this.ngModule=e,this.selector=t.selector,this.componentType=t.componentType,this.ngContentSelectors=t.ngContentSelectors,this.inputs=t.inputs,this.outputs=t.outputs}create(t,e,n,r){return this.factory.create(t,e,n,r||this.ngModule)}}class sn{}class an{}function un(...t){}let ln=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>cn(t),t})();const cn=un;class hn{}class pn{}const dn=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}();let fn=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>mn(),t})();const mn=un;class gn{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const yn=new gn("8.1.3");class vn{constructor(){}supports(t){return $e(t)}create(t){return new wn(t)}}const bn=(t,e)=>e;class wn{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||bn}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<Sn(n,r,i)?e:n,s=Sn(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=s-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}s!==a&&t(o,s,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!$e(t))throw new Error(`Error trying to diff '${bt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)r=this._trackByFn(e,n=t[e]),null!==i&&We(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),We(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[je()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&We(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),We(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(We(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(We(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new xn(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Cn),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Cn),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class xn{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class _n{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&We(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class Cn{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new _n,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Sn(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class En{constructor(){}supports(t){return t instanceof Map||Ge(t)}create(){return new kn}}class kn{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ge(t)))throw new Error(`Error trying to diff '${bt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Nn(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){We(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Nn{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let In=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new dt,new ht]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.ngInjectableDef=gt({token:t,providedIn:"root",factory:()=>new t([new vn])}),t})(),Tn=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new dt,new ht]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.ngInjectableDef=gt({token:t,providedIn:"root",factory:()=>new t([new En])}),t})(),An=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Rn(),t})();const Rn=(...t)=>{},On=[new En],Dn=new In([new vn]),Pn=new Tn(On);let Fn=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Mn(t,ln),t})();const Mn=un;let Ln=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>zn(t,ln),t})();const zn=un;function Bn(t,e,n,r){let i=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${e}'. Current value: '${n}'.`;return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(t,e){const n=new Error(t);return Un(n,e),n}(i,t)}function Un(t,e){t[ee]=e,t[re]=e.logError.bind(e)}function Vn(t){return new Error(`ViewDestroyedError: Attempt to use a destroyed view: ${t}`)}function jn(t,e,n){const r=t.state,i=1792&r;return i===e?(t.state=-1793&r|n,t.initIndex=-1,!0):i===n}function Wn(t,e,n){return(1792&t.state)===e&&t.initIndex<=n&&(t.initIndex=n+1,!0)}function Hn(t,e){return t.nodes[e]}function qn(t,e){return t.nodes[e]}function $n(t,e){return t.nodes[e]}function Gn(t,e){return t.nodes[e]}function Kn(t,e){return t.nodes[e]}const Xn={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Qn=()=>{},Zn=new Map;function Yn(t){let e=Zn.get(t);return e||(e=bt(t)+"_"+Zn.size,Zn.set(t,e)),e}function Jn(t,e,n,r){if(qe.isWrapped(r)){r=qe.unwrap(r);const i=t.def.nodes[e].bindingIndex+n,o=qe.unwrap(t.oldValues[i]);t.oldValues[i]=new qe(o)}return r}const tr="$$undefined",er="$$empty";function nr(t){return{id:tr,styles:t.styles,encapsulation:t.encapsulation,data:t.data}}let rr=0;function ir(t,e,n,r){return!(!(2&t.state)&&We(t.oldValues[e.bindingIndex+n],r))}function or(t,e,n,r){return!!ir(t,e,n,r)&&(t.oldValues[e.bindingIndex+n]=r,!0)}function sr(t,e,n,r){const i=t.oldValues[e.bindingIndex+n];if(1&t.state||!He(i,r)){const o=e.bindings[n].name;throw Bn(Xn.createDebugContext(t,e.nodeIndex),`${o}: ${i}`,`${o}: ${r}`,0!=(1&t.state))}}function ar(t){let e=t;for(;e;)2&e.def.flags&&(e.state|=8),e=e.viewContainerParent||e.parent}function ur(t,e){let n=t;for(;n&&n!==e;)n.state|=64,n=n.viewContainerParent||n.parent}function lr(t,e,n,r){try{return ar(33554432&t.def.nodes[e].flags?qn(t,e).componentView:t),Xn.handleEvent(t,e,n,r)}catch(aR){t.root.errorHandler.handleError(aR)}}function cr(t){return t.parent?qn(t.parent,t.parentNodeDef.nodeIndex):null}function hr(t){return t.parent?t.parentNodeDef.parent:null}function pr(t,e){switch(201347067&e.flags){case 1:return qn(t,e.nodeIndex).renderElement;case 2:return Hn(t,e.nodeIndex).renderText}}function dr(t){return!!t.parent&&!!(32768&t.parentNodeDef.flags)}function fr(t){return!(!t.parent||32768&t.parentNodeDef.flags)}function mr(t){return 1<<t%32}function gr(t){const e={};let n=0;const r={};return t&&t.forEach(([t,i])=>{"number"==typeof t?(e[t]=i,n|=mr(t)):r[t]=i}),{matchedQueries:e,references:r,matchedQueryIds:n}}function yr(t,e){return t.map(t=>{let n,r;return Array.isArray(t)?[r,n]=t:(r=0,n=t),n&&("function"==typeof n||"object"==typeof n)&&e&&Object.defineProperty(n,Ft,{value:e,configurable:!0}),{flags:r,token:n,tokenKey:Yn(n)}})}function vr(t,e,n){let r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===oe.Native?qn(t,n.renderParent.nodeIndex).renderElement:void 0:e}const br=new WeakMap;function wr(t){let e=br.get(t);return e||((e=t(()=>Qn)).factory=t,br.set(t,e)),e}function xr(t,e,n,r,i){3===e&&(n=t.renderer.parentNode(pr(t,t.def.lastRenderRootNode))),_r(t,e,0,t.def.nodes.length-1,n,r,i)}function _r(t,e,n,r,i,o,s){for(let a=n;a<=r;a++){const n=t.def.nodes[a];11&n.flags&&Sr(t,n,e,i,o,s),a+=n.childCount}}function Cr(t,e,n,r,i,o){let s=t;for(;s&&!dr(s);)s=s.parent;const a=s.parent,u=hr(s),l=u.nodeIndex+u.childCount;for(let c=u.nodeIndex+1;c<=l;c++){const t=a.def.nodes[c];t.ngContentIndex===e&&Sr(a,t,n,r,i,o),c+=t.childCount}if(!a.parent){const s=t.root.projectableNodes[e];if(s)for(let e=0;e<s.length;e++)Er(t,s[e],n,r,i,o)}}function Sr(t,e,n,r,i,o){if(8&e.flags)Cr(t,e.ngContent.index,n,r,i,o);else{const s=pr(t,e);if(3===n&&33554432&e.flags&&48&e.bindingFlags?(16&e.bindingFlags&&Er(t,s,n,r,i,o),32&e.bindingFlags&&Er(qn(t,e.nodeIndex).componentView,s,n,r,i,o)):Er(t,s,n,r,i,o),16777216&e.flags){const s=qn(t,e.nodeIndex).viewContainer._embeddedViews;for(let t=0;t<s.length;t++)xr(s[t],n,r,i,o)}1&e.flags&&!e.element.name&&_r(t,n,e.nodeIndex+1,e.nodeIndex+e.childCount,r,i,o)}}function Er(t,e,n,r,i,o){const s=t.renderer;switch(n){case 1:s.appendChild(r,e);break;case 2:s.insertBefore(r,e,i);break;case 3:s.removeChild(r,e);break;case 0:o.push(e)}}const kr=/^:([^:]+):(.+)$/;function Nr(t){if(":"===t[0]){const e=t.match(kr);return[e[1],e[2]]}return["",t]}function Ir(t){let e=0;for(let n=0;n<t.length;n++)e|=t[n].flags;return e}const Tr=new Object,Ar=Yn($t),Rr=Yn(Tt),Or=Yn(sn);function Dr(t,e,n,r){return n=_t(n),{index:-1,deps:yr(r,bt(e)),flags:t,token:e,value:n}}function Pr(t,e,n=$t.THROW_IF_NOT_FOUND){const r=Bt(t);try{if(8&e.flags)return e.token;if(2&e.flags&&(n=null),1&e.flags)return t._parent.get(e.token,n);const s=e.tokenKey;switch(s){case Ar:case Rr:case Or:return t}const a=t._def.providersByKey[s];let u;if(a){let e=t._providers[a.index];return void 0===e&&(e=t._providers[a.index]=Fr(t,a)),e===Tr?void 0:e}if((u=yt(e.token))&&(i=t,null!=(o=u).providedIn&&(function(t,e){return t._def.modules.indexOf(o.providedIn)>-1}(i)||"root"===o.providedIn&&i._def.isRoot))){const n=t._providers.length;return t._def.providers[n]=t._def.providersByKey[e.tokenKey]={flags:5120,value:u.factory,deps:[],index:n,token:e.token},t._providers[n]=Tr,t._providers[n]=Fr(t,t._def.providersByKey[e.tokenKey])}return 4&e.flags?n:t._parent.get(e.token,n)}finally{Bt(r)}var i,o}function Fr(t,e){let n;switch(201347067&e.flags){case 512:n=function(t,e,n){const r=n.length;switch(r){case 0:return new e;case 1:return new e(Pr(t,n[0]));case 2:return new e(Pr(t,n[0]),Pr(t,n[1]));case 3:return new e(Pr(t,n[0]),Pr(t,n[1]),Pr(t,n[2]));default:const i=new Array(r);for(let e=0;e<r;e++)i[e]=Pr(t,n[e]);return new e(...i)}}(t,e.value,e.deps);break;case 1024:n=function(t,e,n){const r=n.length;switch(r){case 0:return e();case 1:return e(Pr(t,n[0]));case 2:return e(Pr(t,n[0]),Pr(t,n[1]));case 3:return e(Pr(t,n[0]),Pr(t,n[1]),Pr(t,n[2]));default:const i=Array(r);for(let e=0;e<r;e++)i[e]=Pr(t,n[e]);return e(...i)}}(t,e.value,e.deps);break;case 2048:n=Pr(t,e.deps[0]);break;case 256:n=e.value}return n===Tr||null===n||"object"!=typeof n||131072&e.flags||"function"!=typeof n.ngOnDestroy||(e.flags|=131072),void 0===n?Tr:n}function Mr(t,e){const n=t.viewContainer._embeddedViews;if((null==e||e>=n.length)&&(e=n.length-1),e<0)return null;const r=n[e];return r.viewContainerParent=null,Ur(n,e),Xn.dirtyParentQueries(r),zr(r),r}function Lr(t,e,n){const r=e?pr(e,e.def.lastRenderRootNode):t.renderElement,i=n.renderer.parentNode(r),o=n.renderer.nextSibling(r);xr(n,2,i,o,void 0)}function zr(t){xr(t,3,null,null,void 0)}function Br(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ur(t,e){e>=t.length-1?t.pop():t.splice(e,1)}const Vr=new Object;function jr(t,e,n,r,i,o){return new Wr(t,e,n,r,i,o)}class Wr extends Ye{constructor(t,e,n,r,i,o){super(),this.selector=t,this.componentType=e,this._inputs=r,this._outputs=i,this.ngContentSelectors=o,this.viewDefFactory=n}get inputs(){const t=[],e=this._inputs;for(let n in e)t.push({propName:n,templateName:e[n]});return t}get outputs(){const t=[];for(let e in this._outputs)t.push({propName:e,templateName:this._outputs[e]});return t}create(t,e,n,r){if(!r)throw new Error("ngModule should be provided");const i=wr(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,s=Xn.createRootView(t,e||[],n,i,r,Vr),a=$n(s,o).instance;return n&&s.renderer.setAttribute(qn(s,0).renderElement,"ng-version",yn.full),new Hr(s,new Kr(s),a)}}class Hr extends Ze{constructor(t,e,n){super(),this._view=t,this._viewRef=e,this._component=n,this._elDef=this._view.def.nodes[0],this.hostView=e,this.changeDetectorRef=e,this.instance=n}get location(){return new ln(qn(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Yr(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(t){this._viewRef.onDestroy(t)}}function qr(t,e,n){return new $r(t,e,n)}class $r{constructor(t,e,n){this._view=t,this._elDef=e,this._data=n,this._embeddedViews=[]}get element(){return new ln(this._data.renderElement)}get injector(){return new Yr(this._view,this._elDef)}get parentInjector(){let t=this._view,e=this._elDef.parent;for(;!e&&t;)e=hr(t),t=t.parent;return t?new Yr(t,e):new Yr(this._view,null)}clear(){for(let t=this._embeddedViews.length-1;t>=0;t--){const e=Mr(this._data,t);Xn.destroyView(e)}}get(t){const e=this._embeddedViews[t];if(e){const t=new Kr(e);return t.attachToViewContainerRef(this),t}return null}get length(){return this._embeddedViews.length}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;i||t instanceof on||(i=o.get(sn));const s=t.create(o,r,void 0,i);return this.insert(s.hostView,e),s}insert(t,e){if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const n=t;return function(t,e,n,r){let i=e.viewContainer._embeddedViews;null==n&&(n=i.length),r.viewContainerParent=t,Br(i,n,r),function(t,e){const n=cr(e);if(!n||n===t||16&e.state)return;e.state|=16;let r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(e),function(t,n){if(4&n.flags)return;e.parent.def.nodeFlags|=4,n.flags|=4;let r=n.parent;for(;r;)r.childFlags|=4,r=r.parent}(0,e.parentNodeDef)}(e,r),Xn.dirtyParentQueries(r),Lr(e,n>0?i[n-1]:null,r)}(this._view,this._data,e,n._view),n.attachToViewContainerRef(this),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const n=this._embeddedViews.indexOf(t._view);return function(t,e,r){const i=t.viewContainer._embeddedViews,o=i[n];Ur(i,n),null==r&&(r=i.length),Br(i,r,o),Xn.dirtyParentQueries(o),zr(o),Lr(t,r>0?i[r-1]:null,o)}(this._data,0,e),t}indexOf(t){return this._embeddedViews.indexOf(t._view)}remove(t){const e=Mr(this._data,t);e&&Xn.destroyView(e)}detach(t){const e=Mr(this._data,t);return e?new Kr(e):null}}function Gr(t){return new Kr(t)}class Kr{constructor(t){this._view=t,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(t){const e=[];return xr(t,0,void 0,void 0,e),e}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){ar(this._view)}detach(){this._view.state&=-5}detectChanges(){const t=this._view.root.rendererFactory;t.begin&&t.begin();try{Xn.checkAndUpdateView(this._view)}finally{t.end&&t.end()}}checkNoChanges(){Xn.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(t){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(t)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Xn.destroyView(this._view)}detachFromAppRef(){this._appRef=null,zr(this._view),Xn.dirtyParentQueries(this._view)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}}function Xr(t,e){return new Qr(t,e)}class Qr extends Fn{constructor(t,e){super(),this._parentView=t,this._def=e}createEmbeddedView(t){return new Kr(Xn.createEmbeddedView(this._parentView,this._def,this._def.element.template,t))}get elementRef(){return new ln(qn(this._parentView,this._def.nodeIndex).renderElement)}}function Zr(t,e){return new Yr(t,e)}class Yr{constructor(t,e){this.view=t,this.elDef=e}get(t,e=$t.THROW_IF_NOT_FOUND){return Xn.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:t,tokenKey:Yn(t)},e)}}function Jr(t,e){const n=t.def.nodes[e];if(1&n.flags){const e=qn(t,n.nodeIndex);return n.element.template?e.template:e.renderElement}if(2&n.flags)return Hn(t,n.nodeIndex).renderText;if(20240&n.flags)return $n(t,n.nodeIndex).instance;throw new Error(`Illegal state: read nodeValue for node index ${e}`)}function ti(t){return new ei(t.renderer)}class ei{constructor(t){this.delegate=t}selectRootElement(t){return this.delegate.selectRootElement(t)}createElement(t,e){const[n,r]=Nr(e),i=this.delegate.createElement(r,n);return t&&this.delegate.appendChild(t,i),i}createViewRoot(t){return t}createTemplateAnchor(t){const e=this.delegate.createComment("");return t&&this.delegate.appendChild(t,e),e}createText(t,e){const n=this.delegate.createText(e);return t&&this.delegate.appendChild(t,n),n}projectNodes(t,e){for(let n=0;n<e.length;n++)this.delegate.appendChild(t,e[n])}attachViewAfter(t,e){const n=this.delegate.parentNode(t),r=this.delegate.nextSibling(t);for(let i=0;i<e.length;i++)this.delegate.insertBefore(n,e[i],r)}detachView(t){for(let e=0;e<t.length;e++){const n=t[e],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}destroyView(t,e){for(let n=0;n<e.length;n++)this.delegate.destroyNode(e[n])}listen(t,e,n){return this.delegate.listen(t,e,n)}listenGlobal(t,e,n){return this.delegate.listen(t,e,n)}setElementProperty(t,e,n){this.delegate.setProperty(t,e,n)}setElementAttribute(t,e,n){const[r,i]=Nr(e);null!=n?this.delegate.setAttribute(t,i,n,r):this.delegate.removeAttribute(t,i,r)}setBindingDebugInfo(t,e,n){}setElementClass(t,e,n){n?this.delegate.addClass(t,e):this.delegate.removeClass(t,e)}setElementStyle(t,e,n){null!=n?this.delegate.setStyle(t,e,n):this.delegate.removeStyle(t,e)}invokeElementMethod(t,e,n){t[e].apply(t,n)}setText(t,e){this.delegate.setValue(t,e)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function ni(t,e,n,r){return new ri(t,e,n,r)}class ri{constructor(t,e,n,r){this._moduleType=t,this._parent=e,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(t){const e=t._def,n=t._providers=new Array(e.providers.length);for(let r=0;r<e.providers.length;r++){const i=e.providers[r];4096&i.flags||void 0===n[r]&&(n[r]=Fr(t,i))}}(this)}get(t,e=$t.THROW_IF_NOT_FOUND,n=ft.Default){let r=0;return n&ft.SkipSelf?r|=1:n&ft.Self&&(r|=4),Pr(this,{token:t,tokenKey:Yn(t),flags:r},e)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(nn)}destroy(){if(this._destroyed)throw new Error(`The ng module ${bt(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(t,e){const n=t._def,r=new Set;for(let i=0;i<n.providers.length;i++)if(131072&n.providers[i].flags){const e=t._providers[i];if(e&&e!==Tr){const t=e.ngOnDestroy;"function"!=typeof t||r.has(e)||(t.apply(e),r.add(e))}}}(this),this._destroyListeners.forEach(t=>t())}onDestroy(t){this._destroyListeners.push(t)}}const ii=Yn(hn),oi=Yn(fn),si=Yn(ln),ai=Yn(Ln),ui=Yn(Fn),li=Yn(An),ci=Yn($t),hi=Yn(Tt);function pi(t,e,n,r,i,o,s,a){const u=[];if(s)for(let c in s){const[t,e]=s[c];u[t]={flags:8,name:c,nonMinifiedName:e,ns:null,securityContext:null,suffix:null}}const l=[];if(a)for(let c in a)l.push({type:1,propName:c,target:null,eventName:a[c]});return fi(t,e|=16384,n,r,i,i,o,u,l)}function di(t,e,n){return fi(-1,t|=16,null,0,e,e,n)}function fi(t,e,n,r,i,o,s,a,u){const{matchedQueries:l,references:c,matchedQueryIds:h}=gr(n);u||(u=[]),a||(a=[]),o=_t(o);const p=yr(s,bt(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:l,matchedQueryIds:h,references:c,ngContentIndex:-1,childCount:r,bindings:a,bindingFlags:Ir(a),outputs:u,element:null,provider:{token:i,value:o,deps:p},text:null,query:null,ngContent:null}}function mi(t,e){return bi(t,e)}function gi(t,e){let n=t;for(;n.parent&&!dr(n);)n=n.parent;return wi(n.parent,hr(n),!0,e.provider.value,e.provider.deps)}function yi(t,e){const n=wi(t,e.parent,(32768&e.flags)>0,e.provider.value,e.provider.deps);if(e.outputs.length)for(let r=0;r<e.outputs.length;r++){const i=e.outputs[r],o=n[i.propName];if(!Xe(o))throw new Error(`@Output ${i.propName} not initialized in '${n.constructor.name}'.`);{const n=o.subscribe(vi(t,e.parent.nodeIndex,i.eventName));t.disposables[e.outputIndex+r]=n.unsubscribe.bind(n)}}return n}function vi(t,e,n){return r=>lr(t,e,n,r)}function bi(t,e){const n=(8192&e.flags)>0,r=e.provider;switch(201347067&e.flags){case 512:return wi(t,e.parent,n,r.value,r.deps);case 1024:return function(t,e,n,r,i){const o=i.length;switch(o){case 0:return r();case 1:return r(_i(t,e,n,i[0]));case 2:return r(_i(t,e,n,i[0]),_i(t,e,n,i[1]));case 3:return r(_i(t,e,n,i[0]),_i(t,e,n,i[1]),_i(t,e,n,i[2]));default:const s=Array(o);for(let r=0;r<o;r++)s[r]=_i(t,e,n,i[r]);return r(...s)}}(t,e.parent,n,r.value,r.deps);case 2048:return _i(t,e.parent,n,r.deps[0]);case 256:return r.value}}function wi(t,e,n,r,i){const o=i.length;switch(o){case 0:return new r;case 1:return new r(_i(t,e,n,i[0]));case 2:return new r(_i(t,e,n,i[0]),_i(t,e,n,i[1]));case 3:return new r(_i(t,e,n,i[0]),_i(t,e,n,i[1]),_i(t,e,n,i[2]));default:const s=new Array(o);for(let r=0;r<o;r++)s[r]=_i(t,e,n,i[r]);return new r(...s)}}const xi={};function _i(t,e,n,r,i=$t.THROW_IF_NOT_FOUND){if(8&r.flags)return r.token;const o=t;2&r.flags&&(i=null);const s=r.tokenKey;s===li&&(n=!(!e||!e.element.componentView)),e&&1&r.flags&&(n=!1,e=e.parent);let a=t;for(;a;){if(e)switch(s){case ii:return ti(Ci(a,e,n));case oi:return Ci(a,e,n).renderer;case si:return new ln(qn(a,e.nodeIndex).renderElement);case ai:return qn(a,e.nodeIndex).viewContainer;case ui:if(e.element.template)return qn(a,e.nodeIndex).template;break;case li:return Gr(Ci(a,e,n));case ci:case hi:return Zr(a,e);default:const t=(n?e.element.allProviders:e.element.publicProviders)[s];if(t){let e=$n(a,t.nodeIndex);return e||(e={instance:bi(a,t)},a.nodes[t.nodeIndex]=e),e.instance}}n=dr(a),e=hr(a),a=a.parent,4&r.flags&&(a=null)}const u=o.root.injector.get(r.token,xi);return u!==xi||i===xi?u:o.root.ngModule.injector.get(r.token,i)}function Ci(t,e,n){let r;if(n)r=qn(t,e.nodeIndex).componentView;else for(r=t;r.parent&&!dr(r);)r=r.parent;return r}function Si(t,e,n,r,i,o){if(32768&n.flags){const e=qn(t,n.parent.nodeIndex).componentView;2&e.def.flags&&(e.state|=8)}if(e.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};const e=qe.unwrap(t.oldValues[n.bindingIndex+r]);o[n.bindings[r].nonMinifiedName]=new Qe(e,i,0!=(2&t.state))}return t.oldValues[n.bindingIndex+r]=i,o}function Ei(t,e){if(!(t.def.nodeFlags&e))return;const n=t.def.nodes;let r=0;for(let i=0;i<n.length;i++){const o=n[i];let s=o.parent;for(!s&&o.flags&e&&Ni(t,i,o.flags&e,r++),0==(o.childFlags&e)&&(i+=o.childCount);s&&1&s.flags&&i===s.nodeIndex+s.childCount;)s.directChildFlags&e&&(r=ki(t,s,e,r)),s=s.parent}}function ki(t,e,n,r){for(let i=e.nodeIndex+1;i<=e.nodeIndex+e.childCount;i++){const e=t.def.nodes[i];e.flags&n&&Ni(t,i,e.flags&n,r++),i+=e.childCount}return r}function Ni(t,e,n,r){const i=$n(t,e);if(!i)return;const o=i.instance;o&&(Xn.setCurrentNode(t,e),1048576&n&&Wn(t,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&Wn(t,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}const Ii=new It("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>se}),Ti={},Ai=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}();var Ri=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Oi="en-US";class Di extends I{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,o=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const s=super.subscribe(r,i,o);return t instanceof d&&t.add(s),s}}function Pi(){return this._results[je()]()}class Fi{constructor(){this.dirty=!0,this._results=[],this.changes=new Di,this.length=0;const t=je(),e=Fi.prototype;e[t]||(e[t]=Pi)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const Mi=new It("Application Initializer");let Li=(()=>(class{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Ke(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}))();const zi=new It("AppId");function Bi(){return`${Ui()}${Ui()}${Ui()}`}function Ui(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Vi=new It("Platform Initializer"),ji=new It("Platform ID"),Wi=new It("appBootstrapListener");let Hi=(()=>(class{log(t){console.log(t)}warn(t){console.warn(t)}}))();const qi=new It("LocaleId");function $i(){throw new Error("Runtime compiler is not loaded")}const Gi=$i,Ki=$i,Xi=$i,Qi=$i;let Zi,Yi,Ji=(()=>(class{constructor(){this.compileModuleSync=Gi,this.compileModuleAsync=Ki,this.compileModuleAndAllComponentsSync=Xi,this.compileModuleAndAllComponentsAsync=Qi}clearCache(){}clearCacheFor(t){}getModuleId(t){}}))();class to{}function eo(){const t=Nt.wtf;return!(!t||!(Zi=t.trace)||(Yi=Zi.events,0))}const no=eo(),ro=no?function(t,e=null){return Yi.createScope(t,e)}:(t,e)=>(function(t,e){return null}),io=no?function(t,e){return Zi.leaveScope(t,e),e}:(t,e)=>e,oo=(()=>Promise.resolve(0))();function so(t){"undefined"==typeof Zone?oo.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class ao{constructor({enableLongStackTrace:t=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Di(!1),this.onMicrotaskEmpty=new Di(!1),this.onStable=new Di(!1),this.onError=new Di(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");var e;Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(e=this)._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,i,o,s)=>{try{return ho(e),t.invokeTask(r,i,o,s)}finally{po(e)}},onInvoke:(t,n,r,i,o,s,a)=>{try{return ho(e),t.invoke(r,i,o,s,a)}finally{po(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e.hasPendingMicrotasks=i.microTask,co(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ao.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(ao.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,lo,uo,uo);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function uo(){}const lo={};function co(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function ho(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function po(t){t._nesting--,co(t)}class fo{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Di,this.onMicrotaskEmpty=new Di,this.onStable=new Di,this.onError=new Di}run(t){return t()}runGuarded(t){return t()}runOutsideAngular(t){return t()}runTask(t){return t()}}let mo=(()=>(class{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ao.assertNotInAngularZone(),so(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())so(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}))(),go=(()=>{class t{constructor(){this._applications=new Map,bo.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return bo.findTestabilityInTree(this,t,e)}}return t.ctorParameters=()=>[],t})();class yo{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let vo,bo=new yo,wo=function(t){return t instanceof on};const xo=new It("AllowMultipleToken");class _o{constructor(t,e){this.name=t,this.token=e}}function Co(t,e,n=[]){const r=`Platform: ${e}`,i=new It(r);return(e=[])=>{let o=So();if(!o||o.injector.get(xo,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0});!function(t){if(vo&&!vo.destroyed&&!vo.injector.get(xo,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");vo=t.get(Eo);const e=t.get(Vi,null);e&&e.forEach(t=>t())}($t.create({providers:t,name:r}))}return function(t){const e=So();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function So(){return vo&&!vo.destroyed?vo:null}let Eo=(()=>(class{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n="noop"===(i=e?e.ngZone:void 0)?new fo:("zone.js"===i?void 0:i)||new ao({enableLongStackTrace:le()}),r=[{provide:ao,useValue:n}];var i;return n.run(()=>{const e=$t.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(ze,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return function(t){Oi=t.toLowerCase().replace(/_/g,"-")}(i.injector.get(qi,"en-US")),i.onDestroy(()=>Io(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{o.handleError(t)}})),function(t,e,n){try{const r=n();return Ke(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(aR){throw e.runOutsideAngular(()=>t.handleError(aR)),aR}}(o,n,()=>{const t=i.injector.get(Li);return t.runInitializers(),t.donePromise.then(()=>(this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=ko({},e);return function(t,e,n){return t.get(to).createCompiler([e]).compileModuleAsync(n)}(this.injector,n,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(No);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${bt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}))();function ko(t,e){return Array.isArray(e)?e.reduce(ko,t):Object.assign({},t,e)}let No=(()=>{class t{constructor(t,e,n,r,i,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=le(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new _(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new _(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{ao.assertNotInAngularZone(),so(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{ao.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=J(s,a.pipe(at()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof Ye?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=wo(n)?null:this._injector.get(sn),i=n.create($t.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const o=i.injector.get(mo,null);return o&&i.injector.get(go).registerApplication(i.location.nativeElement,o),this._loadComponent(i),le()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const e=t._tickScope();try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(aR){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(aR))}finally{this._runningTick=!1,io(e)}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Io(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Wi,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),Io(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t._tickScope=ro("ApplicationRef#tick()"),t})();function Io(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class To{}class Ao{}const Ro={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Oo=(()=>(class{constructor(t,e){this._compiler=t,this._config=e||Ro}load(t){return this._compiler instanceof Ji?this.loadFactory(t):this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>Do(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>Do(t,e,r))}}))();function Do(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}class Po{constructor(t,e){this.name=t,this.callback=e}}class Fo{constructor(t,e,n){this.listeners=[],this.parent=null,this._debugContext=n,this.nativeNode=t,e&&e instanceof Mo&&e.addChild(this)}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class Mo extends Fo{constructor(t,e,n){super(t,e,n),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=t}addChild(t){t&&(this.childNodes.push(t),t.parent=this)}removeChild(t){const e=this.childNodes.indexOf(t);-1!==e&&(t.parent=null,this.childNodes.splice(e,1))}insertChildrenAfter(t,e){const n=this.childNodes.indexOf(t);-1!==n&&(this.childNodes.splice(n+1,0,...e),e.forEach(e=>{e.parent&&e.parent.removeChild(e),t.parent=this}))}insertBefore(t,e){const n=this.childNodes.indexOf(t);-1===n?this.addChild(e):(e.parent&&e.parent.removeChild(e),e.parent=this,this.childNodes.splice(n,0,e))}query(t){return this.queryAll(t)[0]||null}queryAll(t){const e=[];return function t(e,n,r){e.childNodes.forEach(e=>{e instanceof Mo&&(n(e)&&r.push(e),t(e,n,r))})}(this,t,e),e}queryAllNodes(t){const e=[];return function t(e,n,r){e instanceof Mo&&e.childNodes.forEach(e=>{n(e)&&r.push(e),e instanceof Mo&&t(e,n,r)})}(this,t,e),e}get children(){return this.childNodes.filter(t=>t instanceof Mo)}triggerEventHandler(t,e){this.listeners.forEach(n=>{n.name==t&&n.callback(e)})}}const Lo=new Map,zo=function(t){return Lo.get(t)||null};function Bo(t){Lo.set(t.nativeNode,t)}const Uo=Co(null,"core",[{provide:ji,useValue:"unknown"},{provide:Eo,deps:[$t]},{provide:go,deps:[]},{provide:Hi,deps:[]}]);function Vo(){return Dn}function jo(){return Pn}function Wo(t){return t||"en-US"}function Ho(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}let qo=(()=>(class{constructor(t){}}))();function $o(t,e,n,r,i,o){t|=1;const{matchedQueries:s,references:a,matchedQueryIds:u}=gr(e);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:t,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:s,matchedQueryIds:u,references:a,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:o?wr(o):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||Qn},provider:null,text:null,query:null,ngContent:null}}function Go(t,e,n,r,i,o,s=[],a,u,l,c,h){l||(l=Qn);const{matchedQueries:p,references:d,matchedQueryIds:f}=gr(n);let m=null,g=null;o&&([m,g]=Nr(o)),a=a||[];const y=new Array(a.length);for(let w=0;w<a.length;w++){const[t,e,n]=a[w],[r,i]=Nr(e);let o=void 0,s=void 0;switch(15&t){case 4:s=n;break;case 1:case 8:o=n}y[w]={flags:t,ns:r,name:i,nonMinifiedName:i,securityContext:o,suffix:s}}u=u||[];const v=new Array(u.length);for(let w=0;w<u.length;w++){const[t,e]=u[w];v[w]={type:0,target:t,eventName:e,propName:null}}const b=(s=s||[]).map(([t,e])=>{const[n,r]=Nr(t);return[n,r,e]});return h=function(t){if(t&&t.id===tr){const e=null!=t.encapsulation&&t.encapsulation!==oe.None||t.styles.length||Object.keys(t.data).length;t.id=e?`c${rr++}`:er}return t&&t.id===er&&(t=null),t||null}(h),c&&(e|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:f,references:d,ngContentIndex:r,childCount:i,bindings:y,bindingFlags:Ir(y),outputs:v,element:{ns:m,name:g,attrs:b,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:l||Qn},provider:null,text:null,query:null,ngContent:null}}function Ko(t,e,n){const r=n.element,i=t.root.selectorOrNode,o=t.renderer;let s;if(t.parent||!i){s=r.name?o.createElement(r.name,r.ns):o.createComment("");const i=vr(t,e,n);i&&o.appendChild(i,s)}else s=o.selectRootElement(i,!!r.componentRendererType&&r.componentRendererType.encapsulation===oe.ShadowDom);if(r.attrs)for(let a=0;a<r.attrs.length;a++){const[t,e,n]=r.attrs[a];o.setAttribute(s,e,n,t)}return s}function Xo(t,e,n,r){for(let s=0;s<n.outputs.length;s++){const a=n.outputs[s],u=Qo(t,n.nodeIndex,(o=a.eventName,(i=a.target)?`${i}:${o}`:o));let l=a.target,c=t;"component"===a.target&&(l=null,c=e);const h=c.renderer.listen(l||r,a.eventName,u);t.disposables[n.outputIndex+s]=h}var i,o}function Qo(t,e,n){return r=>lr(t,e,n,r)}function Zo(t,e,n,r){if(!or(t,e,n,r))return!1;const i=e.bindings[n],o=qn(t,e.nodeIndex),s=o.renderElement,a=i.name;switch(15&i.flags){case 1:!function(t,e,n,r,i,o){const s=e.securityContext;let a=s?t.root.sanitizer.sanitize(s,o):o;a=null!=a?a.toString():null;const u=t.renderer;null!=o?u.setAttribute(n,i,a,r):u.removeAttribute(n,i,r)}(t,i,s,i.ns,a,r);break;case 2:!function(t,e,n,r){const i=t.renderer;r?i.addClass(e,n):i.removeClass(e,n)}(t,s,a,r);break;case 4:!function(t,e,n,r,i){let o=t.root.sanitizer.sanitize(Re.STYLE,i);if(null!=o){o=o.toString();const t=e.suffix;null!=t&&(o+=t)}else o=null;const s=t.renderer;null!=o?s.setStyle(n,r,o):s.removeStyle(n,r)}(t,i,s,a,r);break;case 8:!function(t,e,n,r,i){const o=e.securityContext;let s=o?t.root.sanitizer.sanitize(o,i):i;t.renderer.setProperty(n,r,s)}(33554432&e.flags&&32&i.flags?o.componentView:t,i,s,a,r)}return!0}function Yo(t,e,n){let r=[];for(let i in n)r.push({propName:i,bindingType:n[i]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:e,filterId:mr(e),bindings:r},ngContent:null}}function Jo(t){const e=t.def.nodeMatchedQueries;for(;t.parent&&fr(t);){let n=t.parentNodeDef;t=t.parent;const r=n.nodeIndex+n.childCount;for(let i=0;i<=r;i++){const r=t.def.nodes[i];67108864&r.flags&&536870912&r.flags&&(r.query.filterId&e)===r.query.filterId&&Kn(t,i).setDirty(),!(1&r.flags&&i+r.childCount<n.nodeIndex)&&67108864&r.childFlags&&536870912&r.childFlags||(i+=r.childCount)}}if(134217728&t.def.nodeFlags)for(let n=0;n<t.def.nodes.length;n++){const e=t.def.nodes[n];134217728&e.flags&&536870912&e.flags&&Kn(t,n).setDirty(),n+=e.childCount}}function ts(t,e){const n=Kn(t,e.nodeIndex);if(!n.dirty)return;let r,i=void 0;if(67108864&e.flags){const n=e.parent.parent;i=es(t,n.nodeIndex,n.nodeIndex+n.childCount,e.query,[]),r=$n(t,e.parent.nodeIndex).instance}else 134217728&e.flags&&(i=es(t,0,t.def.nodes.length-1,e.query,[]),r=t.component);n.reset(i);const o=e.query.bindings;let s=!1;for(let a=0;a<o.length;a++){const t=o[a];let e;switch(t.bindingType){case 0:e=n.first;break;case 1:e=n,s=!0}r[t.propName]=e}s&&n.notifyOnChanges()}function es(t,e,n,r,i){for(let o=e;o<=n;o++){const e=t.def.nodes[o],n=e.matchedQueries[r.id];if(null!=n&&i.push(ns(t,e,n)),1&e.flags&&e.element.template&&(e.element.template.nodeMatchedQueries&r.filterId)===r.filterId){const n=qn(t,o);if((e.childMatchedQueries&r.filterId)===r.filterId&&(es(t,o+1,o+e.childCount,r,i),o+=e.childCount),16777216&e.flags){const t=n.viewContainer._embeddedViews;for(let e=0;e<t.length;e++){const o=t[e],s=cr(o);s&&s===n&&es(o,0,o.def.nodes.length-1,r,i)}}const s=n.template._projectedViews;if(s)for(let t=0;t<s.length;t++){const e=s[t];es(e,0,e.def.nodes.length-1,r,i)}}(e.childMatchedQueries&r.filterId)!==r.filterId&&(o+=e.childCount)}return i}function ns(t,e,n){if(null!=n)switch(n){case 1:return qn(t,e.nodeIndex).renderElement;case 0:return new ln(qn(t,e.nodeIndex).renderElement);case 2:return qn(t,e.nodeIndex).template;case 3:return qn(t,e.nodeIndex).viewContainer;case 4:return $n(t,e.nodeIndex).instance}}function rs(t,e){return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:8,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:null,ngContent:{index:e}}}function is(t,e,n){const r=vr(t,e,n);r&&Cr(t,n.ngContent.index,1,r,null,void 0)}function os(t,e){return as(128,t,new Array(e+1))}function ss(t,e){return as(32,t,new Array(e))}function as(t,e,n){const r=new Array(n.length);for(let i=0;i<n.length;i++){const t=n[i];r[i]={flags:8,name:t,ns:null,nonMinifiedName:t,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:r,bindingFlags:Ir(r),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}function us(t,e,n){const r=new Array(n.length-1);for(let i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function ls(t,e,n){let r;const i=t.renderer;r=i.createText(n.text.prefix);const o=vr(t,e,n);return o&&i.appendChild(o,r),{renderText:r}}function cs(t,e){return(null!=t?t.toString():"")+e.suffix}function hs(t,e,n,r){let i=0,o=0,s=0,a=0,u=0,l=null,c=null,h=!1,p=!1,d=null;for(let f=0;f<e.length;f++){const t=e[f];if(t.nodeIndex=f,t.parent=l,t.bindingIndex=i,t.outputIndex=o,t.renderParent=c,s|=t.flags,u|=t.matchedQueryIds,t.element){const e=t.element;e.publicProviders=l?l.element.publicProviders:Object.create(null),e.allProviders=e.publicProviders,h=!1,p=!1,t.element.template&&(u|=t.element.template.nodeMatchedQueries)}if(ds(l,t,e.length),i+=t.bindings.length,o+=t.outputs.length,!c&&3&t.flags&&(d=t),20224&t.flags){h||(h=!0,l.element.publicProviders=Object.create(l.element.publicProviders),l.element.allProviders=l.element.publicProviders);const e=0!=(32768&t.flags);0==(8192&t.flags)||e?l.element.publicProviders[Yn(t.provider.token)]=t:(p||(p=!0,l.element.allProviders=Object.create(l.element.publicProviders)),l.element.allProviders[Yn(t.provider.token)]=t),e&&(l.element.componentProvider=t)}if(l?(l.childFlags|=t.flags,l.directChildFlags|=t.flags,l.childMatchedQueries|=t.matchedQueryIds,t.element&&t.element.template&&(l.childMatchedQueries|=t.element.template.nodeMatchedQueries)):a|=t.flags,t.childCount>0)l=t,ps(t)||(c=t);else for(;l&&f===l.nodeIndex+l.childCount;){const t=l.parent;t&&(t.childFlags|=l.childFlags,t.childMatchedQueries|=l.childMatchedQueries),c=(l=t)&&ps(l)?l.renderParent:l}}return{factory:null,nodeFlags:s,rootNodeFlags:a,nodeMatchedQueries:u,flags:t,nodes:e,updateDirectives:n||Qn,updateRenderer:r||Qn,handleEvent:(t,n,r,i)=>e[n].element.handleEvent(t,r,i),bindingCount:i,outputCount:o,lastRenderRootNode:d}}function ps(t){return 0!=(1&t.flags)&&null===t.element.name}function ds(t,e,n){const r=e.element&&e.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${e.nodeIndex}!`)}if(20224&e.flags&&0==(1&(t?t.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${e.nodeIndex}!`);if(e.query){if(67108864&e.flags&&(!t||0==(16384&t.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${e.nodeIndex}!`);if(134217728&e.flags&&t)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${e.nodeIndex}!`)}if(e.childCount){const r=t?t.nodeIndex+t.childCount:n-1;if(e.nodeIndex<=r&&e.nodeIndex+e.childCount>r)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${e.nodeIndex}!`)}}function fs(t,e,n,r){const i=ys(t.root,t.renderer,t,e,n);return vs(i,t.component,r),bs(i),i}function ms(t,e,n){const r=ys(t,t.renderer,null,null,e);return vs(r,n,n),bs(r),r}function gs(t,e,n,r){const i=e.element.componentRendererType;let o;return o=i?t.root.rendererFactory.createRenderer(r,i):t.root.renderer,ys(t.root,o,t,e.element.componentProvider,n)}function ys(t,e,n,r,i){const o=new Array(i.nodes.length),s=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:t,renderer:e,oldValues:new Array(i.bindingCount),disposables:s,initIndex:-1}}function vs(t,e,n){t.component=e,t.context=n}function bs(t){let e;dr(t)&&(e=qn(t.parent,t.parentNodeDef.parent.nodeIndex).renderElement);const n=t.def,r=t.nodes;for(let i=0;i<n.nodes.length;i++){const o=n.nodes[i];let s;switch(Xn.setCurrentNode(t,i),201347067&o.flags){case 1:const n=Ko(t,e,o);let a=void 0;if(33554432&o.flags){const e=wr(o.element.componentView);a=Xn.createComponentView(t,o,e,n)}Xo(t,a,o,n),s={renderElement:n,componentView:a,viewContainer:null,template:o.element.template?Xr(t,o):void 0},16777216&o.flags&&(s.viewContainer=qr(t,o,s));break;case 2:s=ls(t,e,o);break;case 512:case 1024:case 2048:case 256:(s=r[i])||4096&o.flags||(s={instance:mi(t,o)});break;case 16:s={instance:gi(t,o)};break;case 16384:(s=r[i])||(s={instance:yi(t,o)}),32768&o.flags&&vs(qn(t,o.parent.nodeIndex).componentView,s.instance,s.instance);break;case 32:case 64:case 128:s={value:void 0};break;case 67108864:case 134217728:s=new Fi;break;case 8:is(t,e,o),s=void 0}r[i]=s}Is(t,Ns.CreateViewNodes),Os(t,201326592,268435456,0)}function ws(t){Cs(t),Xn.updateDirectives(t,1),Ts(t,Ns.CheckNoChanges),Xn.updateRenderer(t,1),Is(t,Ns.CheckNoChanges),t.state&=-97}function xs(t){1&t.state?(t.state&=-2,t.state|=2):t.state&=-3,jn(t,0,256),Cs(t),Xn.updateDirectives(t,0),Ts(t,Ns.CheckAndUpdate),Os(t,67108864,536870912,0);let e=jn(t,256,512);Ei(t,2097152|(e?1048576:0)),Xn.updateRenderer(t,0),Is(t,Ns.CheckAndUpdate),Os(t,134217728,536870912,0),Ei(t,8388608|((e=jn(t,512,768))?4194304:0)),2&t.def.flags&&(t.state&=-9),t.state&=-97,jn(t,768,1024)}function _s(t,e,n,r,i,o,s,a,u,l,c,h,p){return 0===n?function(t,e,n,r,i,o,s,a,u,l,c,h){switch(201347067&e.flags){case 1:return function(t,e,n,r,i,o,s,a,u,l,c,h){const p=e.bindings.length;let d=!1;return p>0&&Zo(t,e,0,n)&&(d=!0),p>1&&Zo(t,e,1,r)&&(d=!0),p>2&&Zo(t,e,2,i)&&(d=!0),p>3&&Zo(t,e,3,o)&&(d=!0),p>4&&Zo(t,e,4,s)&&(d=!0),p>5&&Zo(t,e,5,a)&&(d=!0),p>6&&Zo(t,e,6,u)&&(d=!0),p>7&&Zo(t,e,7,l)&&(d=!0),p>8&&Zo(t,e,8,c)&&(d=!0),p>9&&Zo(t,e,9,h)&&(d=!0),d}(t,e,n,r,i,o,s,a,u,l,c,h);case 2:return function(t,e,n,r,i,o,s,a,u,l,c,h){let p=!1;const d=e.bindings,f=d.length;if(f>0&&or(t,e,0,n)&&(p=!0),f>1&&or(t,e,1,r)&&(p=!0),f>2&&or(t,e,2,i)&&(p=!0),f>3&&or(t,e,3,o)&&(p=!0),f>4&&or(t,e,4,s)&&(p=!0),f>5&&or(t,e,5,a)&&(p=!0),f>6&&or(t,e,6,u)&&(p=!0),f>7&&or(t,e,7,l)&&(p=!0),f>8&&or(t,e,8,c)&&(p=!0),f>9&&or(t,e,9,h)&&(p=!0),p){let p=e.text.prefix;f>0&&(p+=cs(n,d[0])),f>1&&(p+=cs(r,d[1])),f>2&&(p+=cs(i,d[2])),f>3&&(p+=cs(o,d[3])),f>4&&(p+=cs(s,d[4])),f>5&&(p+=cs(a,d[5])),f>6&&(p+=cs(u,d[6])),f>7&&(p+=cs(l,d[7])),f>8&&(p+=cs(c,d[8])),f>9&&(p+=cs(h,d[9]));const m=Hn(t,e.nodeIndex).renderText;t.renderer.setValue(m,p)}return p}(t,e,n,r,i,o,s,a,u,l,c,h);case 16384:return function(t,e,n,r,i,o,s,a,u,l,c,h){const p=$n(t,e.nodeIndex),d=p.instance;let f=!1,m=void 0;const g=e.bindings.length;return g>0&&ir(t,e,0,n)&&(f=!0,m=Si(t,p,e,0,n,m)),g>1&&ir(t,e,1,r)&&(f=!0,m=Si(t,p,e,1,r,m)),g>2&&ir(t,e,2,i)&&(f=!0,m=Si(t,p,e,2,i,m)),g>3&&ir(t,e,3,o)&&(f=!0,m=Si(t,p,e,3,o,m)),g>4&&ir(t,e,4,s)&&(f=!0,m=Si(t,p,e,4,s,m)),g>5&&ir(t,e,5,a)&&(f=!0,m=Si(t,p,e,5,a,m)),g>6&&ir(t,e,6,u)&&(f=!0,m=Si(t,p,e,6,u,m)),g>7&&ir(t,e,7,l)&&(f=!0,m=Si(t,p,e,7,l,m)),g>8&&ir(t,e,8,c)&&(f=!0,m=Si(t,p,e,8,c,m)),g>9&&ir(t,e,9,h)&&(f=!0,m=Si(t,p,e,9,h,m)),m&&d.ngOnChanges(m),65536&e.flags&&Wn(t,256,e.nodeIndex)&&d.ngOnInit(),262144&e.flags&&d.ngDoCheck(),f}(t,e,n,r,i,o,s,a,u,l,c,h);case 32:case 64:case 128:return function(t,e,n,r,i,o,s,a,u,l,c,h){const p=e.bindings;let d=!1;const f=p.length;if(f>0&&or(t,e,0,n)&&(d=!0),f>1&&or(t,e,1,r)&&(d=!0),f>2&&or(t,e,2,i)&&(d=!0),f>3&&or(t,e,3,o)&&(d=!0),f>4&&or(t,e,4,s)&&(d=!0),f>5&&or(t,e,5,a)&&(d=!0),f>6&&or(t,e,6,u)&&(d=!0),f>7&&or(t,e,7,l)&&(d=!0),f>8&&or(t,e,8,c)&&(d=!0),f>9&&or(t,e,9,h)&&(d=!0),d){const d=Gn(t,e.nodeIndex);let m;switch(201347067&e.flags){case 32:m=new Array(p.length),f>0&&(m[0]=n),f>1&&(m[1]=r),f>2&&(m[2]=i),f>3&&(m[3]=o),f>4&&(m[4]=s),f>5&&(m[5]=a),f>6&&(m[6]=u),f>7&&(m[7]=l),f>8&&(m[8]=c),f>9&&(m[9]=h);break;case 64:m={},f>0&&(m[p[0].name]=n),f>1&&(m[p[1].name]=r),f>2&&(m[p[2].name]=i),f>3&&(m[p[3].name]=o),f>4&&(m[p[4].name]=s),f>5&&(m[p[5].name]=a),f>6&&(m[p[6].name]=u),f>7&&(m[p[7].name]=l),f>8&&(m[p[8].name]=c),f>9&&(m[p[9].name]=h);break;case 128:const t=n;switch(f){case 1:m=t.transform(n);break;case 2:m=t.transform(r);break;case 3:m=t.transform(r,i);break;case 4:m=t.transform(r,i,o);break;case 5:m=t.transform(r,i,o,s);break;case 6:m=t.transform(r,i,o,s,a);break;case 7:m=t.transform(r,i,o,s,a,u);break;case 8:m=t.transform(r,i,o,s,a,u,l);break;case 9:m=t.transform(r,i,o,s,a,u,l,c);break;case 10:m=t.transform(r,i,o,s,a,u,l,c,h)}}d.value=m}return d}(t,e,n,r,i,o,s,a,u,l,c,h);default:throw"unreachable"}}(t,e,r,i,o,s,a,u,l,c,h,p):function(t,e,n){switch(201347067&e.flags){case 1:return function(t,e,n){let r=!1;for(let i=0;i<n.length;i++)Zo(t,e,i,n[i])&&(r=!0);return r}(t,e,n);case 2:return function(t,e,n){const r=e.bindings;let i=!1;for(let o=0;o<n.length;o++)or(t,e,o,n[o])&&(i=!0);if(i){let i="";for(let t=0;t<n.length;t++)i+=cs(n[t],r[t]);i=e.text.prefix+i;const o=Hn(t,e.nodeIndex).renderText;t.renderer.setValue(o,i)}return i}(t,e,n);case 16384:return function(t,e,n){const r=$n(t,e.nodeIndex),i=r.instance;let o=!1,s=void 0;for(let a=0;a<n.length;a++)ir(t,e,a,n[a])&&(o=!0,s=Si(t,r,e,a,n[a],s));return s&&i.ngOnChanges(s),65536&e.flags&&Wn(t,256,e.nodeIndex)&&i.ngOnInit(),262144&e.flags&&i.ngDoCheck(),o}(t,e,n);case 32:case 64:case 128:return function(t,e,n){const r=e.bindings;let i=!1;for(let o=0;o<n.length;o++)or(t,e,o,n[o])&&(i=!0);if(i){const i=Gn(t,e.nodeIndex);let o;switch(201347067&e.flags){case 32:o=n;break;case 64:o={};for(let e=0;e<n.length;e++)o[r[e].name]=n[e];break;case 128:const t=n[0],i=n.slice(1);o=t.transform(...i)}i.value=o}return i}(t,e,n);default:throw"unreachable"}}(t,e,r)}function Cs(t){const e=t.def;if(4&e.nodeFlags)for(let n=0;n<e.nodes.length;n++){const r=e.nodes[n];if(4&r.flags){const e=qn(t,n).template._projectedViews;if(e)for(let n=0;n<e.length;n++){const r=e[n];r.state|=32,ur(r,t)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function Ss(t,e,n,r,i,o,s,a,u,l,c,h,p){return 0===n?function(t,e,n,r,i,o,s,a,u,l,c,h){const p=e.bindings.length;p>0&&sr(t,e,0,n),p>1&&sr(t,e,1,r),p>2&&sr(t,e,2,i),p>3&&sr(t,e,3,o),p>4&&sr(t,e,4,s),p>5&&sr(t,e,5,a),p>6&&sr(t,e,6,u),p>7&&sr(t,e,7,l),p>8&&sr(t,e,8,c),p>9&&sr(t,e,9,h)}(t,e,r,i,o,s,a,u,l,c,h,p):function(t,e,n){for(let r=0;r<n.length;r++)sr(t,e,r,n[r])}(t,e,r),!1}function Es(t,e){if(Kn(t,e.nodeIndex).dirty)throw Bn(Xn.createDebugContext(t,e.nodeIndex),`Query ${e.query.id} not dirty`,`Query ${e.query.id} dirty`,0!=(1&t.state))}function ks(t){if(!(128&t.state)){if(Ts(t,Ns.Destroy),Is(t,Ns.Destroy),Ei(t,131072),t.disposables)for(let e=0;e<t.disposables.length;e++)t.disposables[e]();!function(t){if(!(16&t.state))return;const e=cr(t);if(e){const n=e.template._projectedViews;n&&(Ur(n,n.indexOf(t)),Xn.dirtyParentQueries(t))}}(t),t.renderer.destroyNode&&function(t){const e=t.def.nodes.length;for(let n=0;n<e;n++){const e=t.def.nodes[n];1&e.flags?t.renderer.destroyNode(qn(t,n).renderElement):2&e.flags?t.renderer.destroyNode(Hn(t,n).renderText):(67108864&e.flags||134217728&e.flags)&&Kn(t,n).destroy()}}(t),dr(t)&&t.renderer.destroy(),t.state|=128}}const Ns=function(){var t={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return t[t.CreateViewNodes]="CreateViewNodes",t[t.CheckNoChanges]="CheckNoChanges",t[t.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",t[t.CheckAndUpdate]="CheckAndUpdate",t[t.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",t[t.Destroy]="Destroy",t}();function Is(t,e){const n=t.def;if(33554432&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];33554432&i.flags?As(qn(t,r).componentView,e):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function Ts(t,e){const n=t.def;if(16777216&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];if(16777216&i.flags){const n=qn(t,r).viewContainer._embeddedViews;for(let t=0;t<n.length;t++)As(n[t],e)}else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function As(t,e){const n=t.state;switch(e){case Ns.CheckNoChanges:0==(128&n)&&(12==(12&n)?ws(t):64&n&&Rs(t,Ns.CheckNoChangesProjectedViews));break;case Ns.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?ws(t):64&n&&Rs(t,e));break;case Ns.CheckAndUpdate:0==(128&n)&&(12==(12&n)?xs(t):64&n&&Rs(t,Ns.CheckAndUpdateProjectedViews));break;case Ns.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?xs(t):64&n&&Rs(t,e));break;case Ns.Destroy:ks(t);break;case Ns.CreateViewNodes:bs(t)}}function Rs(t,e){Ts(t,e),Is(t,e)}function Os(t,e,n,r){if(!(t.def.nodeFlags&e&&t.def.nodeFlags&n))return;const i=t.def.nodes.length;for(let o=0;o<i;o++){const i=t.def.nodes[o];if(i.flags&e&&i.flags&n)switch(Xn.setCurrentNode(t,i.nodeIndex),r){case 0:ts(t,i);break;case 1:Es(t,i)}i.childFlags&e&&i.childFlags&n||(o+=i.childCount)}}let Ds=!1;function Ps(t,e,n,r,i,o){const s=i.injector.get(pn);return ms(Ms(t,i,s,e,n),r,o)}function Fs(t,e,n,r,i,o){const s=i.injector.get(pn),a=Ms(t,i,new fa(s),e,n),u=$s(r);return pa(Ys.create,ms,null,[a,u,o])}function Ms(t,e,n,r,i){const o=e.injector.get(Oe),s=e.injector.get(ze),a=n.createRenderer(null,null);return{ngModule:e,injector:t,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:a,errorHandler:s}}function Ls(t,e,n,r){const i=$s(n);return pa(Ys.create,fs,null,[t,e,i,r])}function zs(t,e,n,r){return n=js.get(e.element.componentProvider.provider.token)||$s(n),pa(Ys.create,gs,null,[t,e,n,r])}function Bs(t,e,n,r){return ni(t,e,n,function(t){const{hasOverrides:e,hasDeprecatedOverrides:n}=function(t){let e=!1,n=!1;return 0===Us.size?{hasOverrides:e,hasDeprecatedOverrides:n}:(t.providers.forEach(t=>{const r=Us.get(t.token);3840&t.flags&&r&&(e=!0,n=n||r.deprecatedBehavior)}),t.modules.forEach(t=>{Vs.forEach((r,i)=>{yt(i).providedIn===t&&(e=!0,n=n||r.deprecatedBehavior)})}),{hasOverrides:e,hasDeprecatedOverrides:n})}(t);return e?(function(t){for(let e=0;e<t.providers.length;e++){const r=t.providers[e];n&&(r.flags|=4096);const i=Us.get(r.token);i&&(r.flags=-3841&r.flags|i.flags,r.deps=yr(i.deps),r.value=i.value)}if(Vs.size>0){let e=new Set(t.modules);Vs.forEach((r,i)=>{if(e.has(yt(i).providedIn)){let e={token:i,flags:r.flags|(n?4096:0),deps:yr(r.deps),value:r.value,index:t.providers.length};t.providers.push(e),t.providersByKey[Yn(i)]=e}})}}(t=t.factory(()=>Qn)),t):t}(r))}const Us=new Map,Vs=new Map,js=new Map;function Ws(t){let e;Us.set(t.token,t),"function"==typeof t.token&&(e=yt(t.token))&&"function"==typeof e.providedIn&&Vs.set(t.token,t)}function Hs(t,e){const n=wr(e.viewDefFactory),r=wr(n.nodes[0].element.componentView);js.set(t,r)}function qs(){Us.clear(),Vs.clear(),js.clear()}function $s(t){if(0===Us.size)return t;const e=function(t){const e=[];let n=null;for(let r=0;r<t.nodes.length;r++){const i=t.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&Us.has(i.provider.token)&&(e.push(n.nodeIndex),n=null)}return e}(t);if(0===e.length)return t;t=t.factory(()=>Qn);for(let r=0;r<e.length;r++)n(t,e[r]);return t;function n(t,e){for(let n=e+1;n<t.nodes.length;n++){const e=t.nodes[n];if(1&e.flags)return;if(3840&e.flags){const t=e.provider,n=Us.get(t.token);n&&(e.flags=-3841&e.flags|n.flags,t.deps=yr(n.deps),t.value=n.value)}}}}function Gs(t,e,n,r,i,o,s,a,u,l,c,h,p){const d=t.def.nodes[e];return _s(t,d,n,r,i,o,s,a,u,l,c,h,p),224&d.flags?Gn(t,e).value:void 0}function Ks(t,e,n,r,i,o,s,a,u,l,c,h,p){const d=t.def.nodes[e];return Ss(t,d,n,r,i,o,s,a,u,l,c,h,p),224&d.flags?Gn(t,e).value:void 0}function Xs(t){return pa(Ys.detectChanges,xs,null,[t])}function Qs(t){return pa(Ys.checkNoChanges,ws,null,[t])}function Zs(t){return pa(Ys.destroy,ks,null,[t])}const Ys=function(){var t={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return t[t.create]="create",t[t.detectChanges]="detectChanges",t[t.checkNoChanges]="checkNoChanges",t[t.destroy]="destroy",t[t.handleEvent]="handleEvent",t}();let Js,ta,ea;function na(t,e){ta=t,ea=e}function ra(t,e,n,r){return na(t,e),pa(Ys.handleEvent,t.def.handleEvent,null,[t,e,n,r])}function ia(t,e){if(128&t.state)throw Vn(Ys[Js]);return na(t,ua(t,0)),t.def.updateDirectives(function(t,n,r,...i){const o=t.def.nodes[n];return 0===e?sa(t,o,r,i):aa(t,o,r,i),16384&o.flags&&na(t,ua(t,n)),224&o.flags?Gn(t,o.nodeIndex).value:void 0},t)}function oa(t,e){if(128&t.state)throw Vn(Ys[Js]);return na(t,la(t,0)),t.def.updateRenderer(function(t,n,r,...i){const o=t.def.nodes[n];return 0===e?sa(t,o,r,i):aa(t,o,r,i),3&o.flags&&na(t,la(t,n)),224&o.flags?Gn(t,o.nodeIndex).value:void 0},t)}function sa(t,e,n,r){if(_s(t,e,n,...r)){const s=1===n?r[0]:r;if(16384&e.flags){const n={};for(let t=0;t<e.bindings.length;t++){const r=e.bindings[t],a=s[t];8&r.flags&&(n[(i=r.nonMinifiedName,o=void 0,o=i.replace(/[$@]/g,"_"),`ng-reflect-${i=o.replace(Be,(...t)=>"-"+t[1].toLowerCase())}`)]=Ue(a))}const r=e.parent,a=qn(t,r.nodeIndex).renderElement;if(r.element.name)for(let e in n){const r=n[e];null!=r?t.renderer.setAttribute(a,e,r):t.renderer.removeAttribute(a,e)}else t.renderer.setValue(a,`bindings=${JSON.stringify(n,null,2)}`)}}var i,o}function aa(t,e,n,r){Ss(t,e,n,...r)}function ua(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(16384&e.flags&&e.bindings&&e.bindings.length)return n}return null}function la(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(3&e.flags&&e.bindings&&e.bindings.length)return n}return null}class ca{constructor(t,e){this.view=t,this.nodeIndex=e,null==e&&(this.nodeIndex=e=0),this.nodeDef=t.def.nodes[e];let n=this.nodeDef,r=t;for(;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=hr(r),r=r.parent;this.elDef=n,this.elView=r}get elOrCompView(){return qn(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return Zr(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const t=[];if(this.elDef)for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&t.push(n.provider.token),e+=n.childCount}return t}get references(){const t={};if(this.elDef){ha(this.elView,this.elDef,t);for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&ha(this.elView,n,t),e+=n.childCount}}return t}get componentRenderElement(){const t=function(t){for(;t&&!dr(t);)t=t.parent;return t.parent?qn(t.parent,hr(t).nodeIndex):null}(this.elOrCompView);return t?t.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?pr(this.view,this.nodeDef):pr(this.elView,this.elDef)}logError(t,...e){let n,r;2&this.nodeDef.flags?(n=this.view.def,r=this.nodeDef.nodeIndex):(n=this.elView.def,r=this.elDef.nodeIndex);const i=function(t,e){let n=-1;for(let r=0;r<=e;r++)3&t.nodes[r].flags&&n++;return n}(n,r);let o=-1;n.factory(()=>++o===i?t.error.bind(t,...e):Qn),o<i&&(t.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),t.error(...e))}}function ha(t,e,n){for(let r in e.references)n[r]=ns(t,e,e.references[r])}function pa(t,e,n,r){const i=Js,o=ta,s=ea;try{Js=t;const a=e.apply(n,r);return ta=o,ea=s,Js=i,a}catch(aR){if(Fe(aR)||!ta)throw aR;throw function(t,e){return t instanceof Error||(t=new Error(t.toString())),Un(t,e),t}(aR,da())}}function da(){return ta?new ca(ta,ea):null}class fa{constructor(t){this.delegate=t}createRenderer(t,e){return new ma(this.delegate.createRenderer(t,e))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class ma{constructor(t){this.delegate=t,this.debugContextFactory=da,this.data=this.delegate.data}createDebugContext(t){return this.debugContextFactory(t)}destroyNode(t){!function(t){Lo.delete(t.nativeNode)}(zo(t)),this.delegate.destroyNode&&this.delegate.destroyNode(t)}destroy(){this.delegate.destroy()}createElement(t,e){const n=this.delegate.createElement(t,e),r=this.createDebugContext(n);if(r){const e=new Mo(n,null,r);e.name=t,Bo(e)}return n}createComment(t){const e=this.delegate.createComment(t),n=this.createDebugContext(e);return n&&Bo(new Fo(e,null,n)),e}createText(t){const e=this.delegate.createText(t),n=this.createDebugContext(e);return n&&Bo(new Fo(e,null,n)),e}appendChild(t,e){const n=zo(t),r=zo(e);n&&r&&n instanceof Mo&&n.addChild(r),this.delegate.appendChild(t,e)}insertBefore(t,e,n){const r=zo(t),i=zo(e),o=zo(n);r&&i&&r instanceof Mo&&r.insertBefore(o,i),this.delegate.insertBefore(t,e,n)}removeChild(t,e){const n=zo(t),r=zo(e);n&&r&&n instanceof Mo&&n.removeChild(r),this.delegate.removeChild(t,e)}selectRootElement(t,e){const n=this.delegate.selectRootElement(t,e),r=da();return r&&Bo(new Mo(n,null,r)),n}setAttribute(t,e,n,r){const i=zo(t);i&&i instanceof Mo&&(i.attributes[r?r+":"+e:e]=n),this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){const r=zo(t);r&&r instanceof Mo&&(r.attributes[n?n+":"+e:e]=null),this.delegate.removeAttribute(t,e,n)}addClass(t,e){const n=zo(t);n&&n instanceof Mo&&(n.classes[e]=!0),this.delegate.addClass(t,e)}removeClass(t,e){const n=zo(t);n&&n instanceof Mo&&(n.classes[e]=!1),this.delegate.removeClass(t,e)}setStyle(t,e,n,r){const i=zo(t);i&&i instanceof Mo&&(i.styles[e]=n),this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){const r=zo(t);r&&r instanceof Mo&&(r.styles[e]=null),this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){const r=zo(t);r&&r instanceof Mo&&(r.properties[e]=n),this.delegate.setProperty(t,e,n)}listen(t,e,n){if("string"!=typeof t){const r=zo(t);r&&r.listeners.push(new Po(e,n))}return this.delegate.listen(t,e,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setValue(t,e){return this.delegate.setValue(t,e)}}function ga(t,e,n){return new ya(t,e,n)}class ya extends an{constructor(t,e,n){super(),this.moduleType=t,this._bootstrapComponents=e,this._ngModuleDefFactory=n}create(t){!function(){if(Ds)return;Ds=!0;const t=le()?{setCurrentNode:na,createRootView:Fs,createEmbeddedView:Ls,createComponentView:zs,createNgModuleRef:Bs,overrideProvider:Ws,overrideComponentView:Hs,clearOverrides:qs,checkAndUpdateView:Xs,checkNoChangesView:Qs,destroyView:Zs,createDebugContext:(t,e)=>new ca(t,e),handleEvent:ra,updateDirectives:ia,updateRenderer:oa}:{setCurrentNode:()=>{},createRootView:Ps,createEmbeddedView:fs,createComponentView:gs,createNgModuleRef:ni,overrideProvider:Qn,overrideComponentView:Qn,clearOverrides:Qn,checkAndUpdateView:xs,checkNoChangesView:ws,destroyView:ks,createDebugContext:(t,e)=>new ca(t,e),handleEvent:(t,e,n,r)=>t.def.handleEvent(t,e,n,r),updateDirectives:(t,e)=>t.def.updateDirectives(0===e?Gs:Ks,t),updateRenderer:(t,e)=>t.def.updateRenderer(0===e?Gs:Ks,t)};Xn.setCurrentNode=t.setCurrentNode,Xn.createRootView=t.createRootView,Xn.createEmbeddedView=t.createEmbeddedView,Xn.createComponentView=t.createComponentView,Xn.createNgModuleRef=t.createNgModuleRef,Xn.overrideProvider=t.overrideProvider,Xn.overrideComponentView=t.overrideComponentView,Xn.clearOverrides=t.clearOverrides,Xn.checkAndUpdateView=t.checkAndUpdateView,Xn.checkNoChangesView=t.checkNoChangesView,Xn.destroyView=t.destroyView,Xn.resolveDep=_i,Xn.createDebugContext=t.createDebugContext,Xn.handleEvent=t.handleEvent,Xn.updateDirectives=t.updateDirectives,Xn.updateRenderer=t.updateRenderer,Xn.dirtyParentQueries=Jo}();const e=function(t){const e=Array.from(t.providers),n=Array.from(t.modules),r={};for(const i in t.providersByKey)r[i]=t.providersByKey[i];return{factory:t.factory,isRoot:t.isRoot,providers:e,modules:n,providersByKey:r}}(wr(this._ngModuleDefFactory));return Xn.createNgModuleRef(this.moduleType,t||$t.NULL,this._bootstrapComponents,e)}}class va{}class ba{constructor(t,e){this.matIconRegistry=t,this.domSanitizer=e,this.title="image-classifier",this.matIconRegistry.addSvgIconSet(this.domSanitizer.bypassSecurityTrustResourceUrl("assets/icons/root.svg"))}}class wa{}const xa=new It("Location Initialized");class _a{}const Ca=new It("appBaseHref");let Sa=(()=>{class t{constructor(e,n){this._subject=new Di,this._urlChangeListeners=[],this._platformStrategy=e;const r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=t.stripTrailingSlash(Ea(r)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+t.normalizeQueryParams(n))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Ea(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(e,n="",r=null){this._platformStrategy.pushState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+t.normalizeQueryParams(n)),r)}replaceState(e,n="",r=null){this._platformStrategy.replaceState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+t.normalizeQueryParams(n)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)})}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}static normalizeQueryParams(t){return t&&"?"!==t[0]?"?"+t:t}static joinWithSlash(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}static stripTrailingSlash(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}}return t})();function Ea(t){return t.replace(/\/index.html$/,"")}let ka=(()=>(class extends _a{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Sa.joinWithSlash(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+Sa.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+Sa.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}))(),Na=(()=>(class extends _a{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Sa.joinWithSlash(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Sa.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+Sa.normalizeQueryParams(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+Sa.normalizeQueryParams(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}))();const Ia=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),Ta=new It("UseV4Plurals");class Aa{}let Ra=(()=>(class extends Aa{constructor(t,e){super(),this.locale=t,this.deprecatedPluralFn=e}getPluralCategory(t,e){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(e||this.locale,t):function(t){return function(t){const e=t.toLowerCase().replace(/_/g,"-");let n=Ti[e];if(n)return n;const r=e.split("-")[0];if(n=Ti[r])return n;if("en"===r)return Ri;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Ai.PluralCase]}(e||this.locale)(t)){case Ia.Zero:return"zero";case Ia.One:return"one";case Ia.Two:return"two";case Ia.Few:return"few";case Ia.Many:return"many";default:return"other"}}}))();function Oa(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}class Da{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Pa=(()=>(class{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){le()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. `+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch($S){throw new Error(`Cannot find a differ supporting object '${e}' of type '${t=e,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Da(null,this._ngForOf,-1,-1),r),i=new Fa(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(n);else{const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new Fa(t,i);e.push(o)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}))();class Fa{constructor(t,e){this.record=t,this.view=e}}let Ma=(()=>(class{constructor(t,e){this._viewContainer=t,this._context=new La,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){za("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){za("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}))();class La{constructor(){this.$implicit=null,this.ngIf=null}}function za(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${bt(e)}'.`)}let Ba=(()=>(class{}))();const Ua=new It("DocumentToken"),Va="browser";let ja=(()=>{class t{}return t.ngInjectableDef=gt({token:t,providedIn:"root",factory:()=>new Wa(Ut(Ua),window,Ut(ze))}),t})();class Wa{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const e=this.document.querySelector(`#${t}`);if(e)return void this.scrollToElement(e);const n=this.document.querySelector(`[name='${t}']`);if(n)return void this.scrollToElement(n)}catch(aR){this.errorHandler.handleError(aR)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch($S){return!1}}}const Ha=new _(t=>t.complete());function qa(t){return t?function(t){return new _(e=>t.schedule(()=>e.complete()))}(t):Ha}function $a(t){const e=new _(e=>{e.next(t),e.complete()});return e._isScalar=!0,e.value=t,e}function Ga(...t){let e=t[t.length-1];switch(A(e)?t.pop():e=void 0,t.length){case 0:return qa(e);case 1:return e?$(t,e):$a(t[0]);default:return $(t,e)}}class Ka extends I{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new E;return this._value}next(t){super.next(this._value=t)}}function Xa(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Xa.prototype=Object.create(Error.prototype);const Qa=Xa,Za={};function Ya(...t){let e=null,n=null;return A(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),$(t,n).lift(new Ja(e))}class Ja{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new tu(t,this.resultSelector))}}class tu extends j{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(Za),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(V(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const o=this.values,s=this.toRespond?o[n]===Za?--this.toRespond:this.toRespond:0;o[n]=e,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function eu(t){return new _(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?G(n):qa()).subscribe(e)})}function nu(){return Y(1)}function ru(t,e){return function(n){return n.lift(new iu(t,e))}}class iu{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new ou(t,this.predicate,this.thisArg))}}class ou extends g{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function su(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}su.prototype=Object.create(Error.prototype);const au=su;function uu(t){return function(e){return 0===t?qa():e.lift(new lu(t))}}class lu{constructor(t){if(this.total=t,this.total<0)throw new au}call(t,e){return e.subscribe(new cu(t,this.total))}}class cu extends g{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function hu(t,e,n){return function(r){return r.lift(new pu(t,e,n))}}class pu{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new du(t,this.nextOrObserver,this.error,this.complete))}}class du extends g{constructor(t,e,n,r){super(t),this._tapNext=b,this._tapError=b,this._tapComplete=b,this._tapError=n||b,this._tapComplete=r||b,i(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||b,this._tapError=e.error||b,this._tapComplete=e.complete||b)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}const fu=(t=function(){return new Qa})=>hu({hasValue:!1,next(){this.hasValue=!0},complete(){if(!this.hasValue)throw t()}});function mu(t=null){return e=>e.lift(new gu(t))}class gu{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new yu(t,this.defaultValue))}}class yu extends g{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function vu(t,e){const n=arguments.length>=2;return r=>r.pipe(t?ru((e,n)=>t(e,n,r)):Z,uu(1),n?mu(e):fu(()=>new Qa))}function bu(t){return function(e){const n=new wu(t),r=e.lift(n);return n.caught=r}}class wu{constructor(t){this.selector=t}call(t,e){return e.subscribe(new xu(t,this.selector,this.caught))}}class xu extends j{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new R(this,void 0,void 0);this.add(r),V(this,n,void 0,void 0,r)}}}function _u(t){return e=>0===t?qa():e.lift(new Cu(t))}class Cu{constructor(t){if(this.total=t,this.total<0)throw new au}call(t,e){return e.subscribe(new Su(t,this.total))}}class Su extends g{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function Eu(t,e){const n=arguments.length>=2;return r=>r.pipe(t?ru((e,n)=>t(e,n,r)):Z,_u(1),n?mu(e):fu(()=>new Qa))}class ku{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new Nu(t,this.predicate,this.thisArg,this.source))}}class Nu extends g{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function Iu(t,e){return"function"==typeof e?n=>n.pipe(Iu((n,r)=>G(t(n,r)).pipe(W((t,i)=>e(n,t,r,i))))):e=>e.lift(new Tu(t))}class Tu{constructor(t){this.project=t}call(t,e){return e.subscribe(new Au(t,this.project))}}class Au extends j{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new R(this,void 0,void 0);this.destination.add(i),this.innerSubscription=V(this,t,e,n,i)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function Ru(...t){return nu()(Ga(...t))}function Ou(...t){return e=>{let n=t[t.length-1];A(n)?t.pop():n=null;const r=t.length;return Ru(1!==r||n?r>0?$(t,n):qa(n):$a(t[0]),e)}}function Du(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Pu(t,e,n))}}class Pu{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Fu(t,this.accumulator,this.seed,this.hasSeed))}}class Fu extends g{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function Mu(t,e){return K(t,e,1)}function Lu(t){return e=>e.lift(new zu(t))}class zu{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Bu(t,this.callback))}}class Bu extends g{constructor(t,e){super(t),this.add(new d(e))}}let Uu=null;function Vu(){return Uu}class ju{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(t){this._attrToPropMap=t}}class Wu extends ju{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const t=this.createElement("div",document);if(null!=this.getStyle(t,"animationName"))this._animationPrefix="";else{const e=["Webkit","Moz","O","ms"];for(let n=0;n<e.length;n++)if(null!=this.getStyle(t,e[n]+"AnimationName")){this._animationPrefix="-"+e[n].toLowerCase()+"-";break}}const e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(e).forEach(n=>{null!=this.getStyle(t,n)&&(this._transitionEnd=e[n])})}catch($S){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(t){return t.getDistributedNodes()}resolveAndSetHref(t,e,n){t.href=null==n?e:e+"/../"+n}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}const Hu={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},qu=3,$u={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Gu={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ku=(()=>{if(Nt.Node)return Nt.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))}})();class Xu extends Wu{parse(t){throw new Error("parse not implemented")}static makeCurrent(){var t;t=new Xu,Uu||(Uu=t)}hasProperty(t,e){return e in t}setProperty(t,e,n){t[e]=n}getProperty(t,e){return t[e]}invoke(t,e,n){t[e](...n)}logError(t){window.console&&(console.error?console.error(t):console.log(t))}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return Hu}contains(t,e){return Ku.call(t,e)}querySelector(t,e){return t.querySelector(e)}querySelectorAll(t,e){return t.querySelectorAll(e)}on(t,e,n){t.addEventListener(e,n,!1)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}createMouseEvent(t){const e=this.getDefaultDocument().createEvent("MouseEvent");return e.initEvent(t,!0,!0),e}createEvent(t){const e=this.getDefaultDocument().createEvent("Event");return e.initEvent(t,!0,!0),e}preventDefault(t){t.preventDefault(),t.returnValue=!1}isPrevented(t){return t.defaultPrevented||null!=t.returnValue&&!t.returnValue}getInnerHTML(t){return t.innerHTML}getTemplateContent(t){return"content"in t&&this.isTemplateElement(t)?t.content:null}getOuterHTML(t){return t.outerHTML}nodeName(t){return t.nodeName}nodeValue(t){return t.nodeValue}type(t){return t.type}content(t){return this.hasProperty(t,"content")?t.content:t}firstChild(t){return t.firstChild}nextSibling(t){return t.nextSibling}parentElement(t){return t.parentNode}childNodes(t){return t.childNodes}childNodesAsList(t){const e=t.childNodes,n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r];return n}clearNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}appendChild(t,e){t.appendChild(e)}removeChild(t,e){t.removeChild(e)}replaceChild(t,e,n){t.replaceChild(e,n)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}insertBefore(t,e,n){t.insertBefore(n,e)}insertAllBefore(t,e,n){n.forEach(n=>t.insertBefore(n,e))}insertAfter(t,e,n){t.insertBefore(n,e.nextSibling)}setInnerHTML(t,e){t.innerHTML=e}getText(t){return t.textContent}setText(t,e){t.textContent=e}getValue(t){return t.value}setValue(t,e){t.value=e}getChecked(t){return t.checked}setChecked(t,e){t.checked=e}createComment(t){return this.getDefaultDocument().createComment(t)}createTemplate(t){const e=this.getDefaultDocument().createElement("template");return e.innerHTML=t,e}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createElementNS(t,e,n){return(n=n||this.getDefaultDocument()).createElementNS(t,e)}createTextNode(t,e){return(e=e||this.getDefaultDocument()).createTextNode(t)}createScriptTag(t,e,n){const r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(t,e),r}createStyleElement(t,e){const n=(e=e||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(t,e)),n}createShadowRoot(t){return t.createShadowRoot()}getShadowRoot(t){return t.shadowRoot}getHost(t){return t.host}clone(t){return t.cloneNode(!0)}getElementsByClassName(t,e){return t.getElementsByClassName(e)}getElementsByTagName(t,e){return t.getElementsByTagName(e)}classList(t){return Array.prototype.slice.call(t.classList,0)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}hasClass(t,e){return t.classList.contains(e)}setStyle(t,e,n){t.style[e]=n}removeStyle(t,e){t.style[e]=""}getStyle(t,e){return t.style[e]}hasStyle(t,e,n){const r=this.getStyle(t,e)||"";return n?r==n:r.length>0}tagName(t){return t.tagName}attributeMap(t){const e=new Map,n=t.attributes;for(let r=0;r<n.length;r++){const t=n.item(r);e.set(t.name,t.value)}return e}hasAttribute(t,e){return t.hasAttribute(e)}hasAttributeNS(t,e,n){return t.hasAttributeNS(e,n)}getAttribute(t,e){return t.getAttribute(e)}getAttributeNS(t,e,n){return t.getAttributeNS(e,n)}setAttribute(t,e,n){t.setAttribute(e,n)}setAttributeNS(t,e,n,r){t.setAttributeNS(e,n,r)}removeAttribute(t,e){t.removeAttribute(e)}removeAttributeNS(t,e,n){t.removeAttributeNS(e,n)}templateAwareRoot(t){return this.isTemplateElement(t)?this.content(t):t}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(t){try{return t.getBoundingClientRect()}catch($S){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(t){return t.title}setTitle(t,e){t.title=e||""}elementMatches(t,e){return!!this.isElementNode(t)&&(t.matches&&t.matches(e)||t.msMatchesSelector&&t.msMatchesSelector(e)||t.webkitMatchesSelector&&t.webkitMatchesSelector(e))}isTemplateElement(t){return this.isElementNode(t)&&"TEMPLATE"===t.nodeName}isTextNode(t){return t.nodeType===Node.TEXT_NODE}isCommentNode(t){return t.nodeType===Node.COMMENT_NODE}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}hasShadowRoot(t){return null!=t.shadowRoot&&t instanceof HTMLElement}isShadowRoot(t){return t instanceof DocumentFragment}importIntoDoc(t){return document.importNode(this.templateAwareRoot(t),!0)}adoptNode(t){return document.adoptNode(t)}getHref(t){return t.getAttribute("href")}getEventKey(t){let e=t.key;if(null==e){if(null==(e=t.keyIdentifier))return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),t.location===qu&&Gu.hasOwnProperty(e)&&(e=Gu[e]))}return $u[e]||e}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=Zu||(Zu=document.querySelector("base"))?Zu.getAttribute("href"):null;return null==e?null:(n=e,Qu||(Qu=document.createElement("a")),Qu.setAttribute("href",n),"/"===Qu.pathname.charAt(0)?Qu.pathname:"/"+Qu.pathname);var n}resetBaseElement(){Zu=null}getUserAgent(){return window.navigator.userAgent}setData(t,e,n){this.setAttribute(t,"data-"+e,n)}getData(t,e){return this.getAttribute(t,"data-"+e)}getComputedStyle(t){return getComputedStyle(t)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return Oa(document.cookie,t)}setCookie(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)}}let Qu,Zu=null;function Yu(){return!!window.history.pushState}let Ju=(()=>{class t extends wa{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Vu().getLocation(),this._history=Vu().getHistory()}getBaseHrefFromDOM(){return Vu().getBaseHref(this._doc)}onPopState(t){Vu().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Vu().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){Yu()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){Yu()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.ctorParameters=()=>[{type:void 0,decorators:[{type:ct,args:[Ua]}]}],t})();const tl=new It("TRANSITION_ID"),el=[{provide:Mi,useFactory:function(t,e,n){return()=>{n.get(Li).donePromise.then(()=>{const n=Vu();Array.prototype.slice.apply(n.querySelectorAll(e,"style[ng-transition]")).filter(e=>n.getAttribute(e,"ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[tl,Ua,$t],multi:!0}];class nl{static init(){var t;t=new nl,bo=t}addToWindow(t){Nt.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},Nt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Nt.getAllAngularRootElements=()=>t.getAllRootElements(),Nt.frameworkStabilizers||(Nt.frameworkStabilizers=[]),Nt.frameworkStabilizers.push(t=>{const e=Nt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,0==--n&&t(r)};e.forEach(function(t){t.whenStable(i)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?Vu().isShadowRoot(e)?this.findTestabilityInTree(t,Vu().getHost(e),!0):this.findTestabilityInTree(t,Vu().parentElement(e),!0):null}}function rl(t,e){"undefined"!=typeof COMPILED&&COMPILED||((Nt.ng=Nt.ng||{})[t]=e)}const il=(()=>({ApplicationRef:No,NgZone:ao}))();function ol(t){return zo(t)}const sl=new It("EventManagerPlugins");let al=(()=>(class{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}))();class ul{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=Vu().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let ll=(()=>(class{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}))(),cl=(()=>(class extends ll{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Vu().remove(t))}}))();const hl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},pl=/%COMP%/g,dl="_nghost-%COMP%",fl="_ngcontent-%COMP%";function ml(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?ml(t,i,n):(i=i.replace(pl,t),n.push(i))}return n}function gl(t){return e=>{!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let yl=(()=>(class{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new vl(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case oe.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new xl(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case oe.Native:case oe.ShadowDom:return new _l(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=ml(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}))();class vl{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(hl[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=hl[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=hl[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&dn.DashCase?t.style.setProperty(e,n,r&dn.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&dn.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){wl(e,"property"),t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return wl(e,"listener"),"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,gl(n)):this.eventManager.addEventListener(t,e,gl(n))}}const bl=(()=>"@".charCodeAt(0))();function wl(t,e){if(t.charCodeAt(0)===bl)throw new Error(`Found the synthetic ${e} ${t}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class xl extends vl{constructor(t,e,n,r){super(t),this.component=n;const i=ml(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr=fl.replace(pl,r+"-"+n.id),this.hostAttr=dl.replace(pl,r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class _l extends vl{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===oe.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=ml(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}const Cl=(()=>"undefined"!=typeof Zone&&Zone.__symbol__||function(t){return"__zone_symbol__"+t})(),Sl=Cl("addEventListener"),El=Cl("removeEventListener"),kl={},Nl="__zone_symbol__propagationStopped",Il=(()=>{const t="undefined"!=typeof Zone&&Zone[Cl("BLACK_LISTED_EVENTS")];if(t){const e={};return t.forEach(t=>{e[t]=t}),e}})(),Tl=function(t){return!!Il&&Il.hasOwnProperty(t)},Al=function(t){const e=kl[t.type];if(!e)return;const n=this[e];if(!n)return;const r=[t];if(1===n.length){const t=n[0];return t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}{const e=n.slice();for(let n=0;n<e.length&&!0!==t[Nl];n++){const t=e[n];t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}}};let Rl=(()=>(class extends ul{constructor(t,e,n){super(t),this.ngZone=e,n&&function(t){return"server"===t}(n)||this.patchEvent()}patchEvent(){if("undefined"==typeof Event||!Event||!Event.prototype)return;if(Event.prototype.__zone_symbol__stopImmediatePropagation)return;const t=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[Nl]=!0),t&&t.apply(this,arguments)}}supports(t){return!0}addEventListener(t,e,n){let r=n;if(!t[Sl]||ao.isInAngularZone()&&!Tl(e))t.addEventListener(e,r,!1);else{let n=kl[e];n||(n=kl[e]=Cl("ANGULAR"+e+"FALSE"));let i=t[n];const o=i&&i.length>0;i||(i=t[n]=[]);const s=Tl(e)?Zone.root:Zone.current;if(0===i.length)i.push({zone:s,handler:r});else{let t=!1;for(let e=0;e<i.length;e++)if(i[e].handler===r){t=!0;break}t||i.push({zone:s,handler:r})}o||t[Sl](e,Al,!1)}return()=>this.removeEventListener(t,e,r)}removeEventListener(t,e,n){let r=t[El];if(!r)return t.removeEventListener.apply(t,[e,n,!1]);let i=kl[e],o=i&&t[i];if(!o)return t.removeEventListener.apply(t,[e,n,!1]);let s=!1;for(let a=0;a<o.length;a++)if(o[a].handler===n){s=!0,o.splice(a,1);break}s?0===o.length&&r.apply(t,[e,Al,!1]):t.removeEventListener.apply(t,[e,n,!1])}}))();const Ol={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Dl=new It("HammerGestureConfig"),Pl=new It("HammerLoader");let Fl=(()=>(class{constructor(){this.events=[],this.overrides={}}buildHammer(t){const e=new Hammer(t,this.options);e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0});for(const n in this.overrides)e.get(n).set(this.overrides[n]);return e}}))(),Ml=(()=>(class extends ul{constructor(t,e,n,r){super(t),this._config=e,this.console=n,this.loader=r}supports(t){return!(!Ol.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t)||!window.Hammer&&!this.loader&&(this.console.warn(`The "${t}" event cannot be bound because Hammer.JS is not `+"loaded and no custom loader has been specified."),1))}addEventListener(t,e,n){const r=this.manager.getZone();if(e=e.toLowerCase(),!window.Hammer&&this.loader){let r=!1,i=()=>{r=!0};return this.loader().then(()=>{if(!window.Hammer)return this.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(i=()=>{});r||(i=this.addEventListener(t,e,n))}).catch(()=>{this.console.warn(`The "${e}" event cannot be bound because the custom `+"Hammer.JS loader failed."),i=()=>{}}),()=>{i()}}return r.runOutsideAngular(()=>{const i=this._config.buildHammer(t),o=function(t){r.runGuarded(function(){n(t)})};return i.on(e,o),()=>{i.off(e,o),"function"==typeof i.destroy&&i.destroy()}})}isCustomEvent(t){return this._config.events.indexOf(t)>-1}}))();const Ll=["alt","control","meta","shift"],zl={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Bl=(()=>{class t extends ul{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Vu().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let o="";if(Ll.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=i,0!=n.length||0===i.length)return null;const s={};return s.domEventName=r,s.fullKey=o,s}static getEventFullKey(t){let e="",n=Vu().getEventKey(t);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Ll.forEach(r=>{r!=n&&(0,zl[r])(t)&&(e+=r+".")}),e+=n}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t})();class Ul{}let Vl=(()=>(class extends Ul{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case Re.NONE:return e;case Re.HTML:return e instanceof Wl?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"HTML"),function(t,e){let n=null;try{Te=Te||new ce(t);let r=e?String(e):"";n=Te.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Te.getInertBodyElement(r)}while(r!==o);const s=new Ee,a=s.sanitizeChildren(Ae(n)||n);return le()&&s.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),a}finally{if(n){const t=Ae(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}(this._doc,String(e)));case Re.STYLE:return e instanceof Hl?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"Style"),function(t){if(!(t=String(t).trim()))return"";const e=t.match(Pe);return e&&de(e[1])===e[1]||t.match(De)&&function(t){let e=!0,n=!0;for(let r=0;r<t.length;r++){const i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(le()&&console.warn(`WARNING: sanitizing unsafe style value ${t} (see http://g.co/ng/security#xss).`),"unsafe")}(e));case Re.SCRIPT:if(e instanceof ql)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"Script"),new Error("unsafe value used in a script context");case Re.URL:return e instanceof Gl||e instanceof $l?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"URL"),de(String(e)));case Re.RESOURCE_URL:if(e instanceof Gl)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(t,e){if(t instanceof jl)throw new Error(`Required a safe ${e}, got a ${t.getTypeName()} `+"(see http://g.co/ng/security#xss)")}bypassSecurityTrustHtml(t){return new Wl(t)}bypassSecurityTrustStyle(t){return new Hl(t)}bypassSecurityTrustScript(t){return new ql(t)}bypassSecurityTrustUrl(t){return new $l(t)}bypassSecurityTrustResourceUrl(t){return new Gl(t)}}))();class jl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class Wl extends jl{getTypeName(){return"HTML"}}class Hl extends jl{getTypeName(){return"Style"}}class ql extends jl{getTypeName(){return"Script"}}class $l extends jl{getTypeName(){return"URL"}}class Gl extends jl{getTypeName(){return"ResourceURL"}}const Kl=Co(Uo,"browser",[{provide:ji,useValue:Va},{provide:Vi,useValue:function(){Xu.makeCurrent(),nl.init()},multi:!0},{provide:wa,useClass:Ju,deps:[Ua]},{provide:Ua,useFactory:function(){return document},deps:[]}]);function Xl(){return new ze}let Ql=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:zi,useValue:e.appId},{provide:tl,useExisting:zi},el]}}}return t})();"undefined"!=typeof window&&window;class Zl{constructor(t,e){this.id=t,this.url=e}}class Yl extends Zl{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Jl extends Zl{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class tc extends Zl{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ec extends Zl{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class nc extends Zl{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class rc extends Zl{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ic extends Zl{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class oc extends Zl{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sc extends Zl{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ac{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class uc{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class lc{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cc{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hc{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pc{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dc{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let fc=(()=>(class{}))();const mc="primary";class gc{constructor(t){this.params=t||{}}has(t){return this.params.hasOwnProperty(t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function yc(t){return new gc(t)}const vc="ngNavigationCancelingError";function bc(t){const e=Error("NavigationCancelingError: "+t);return e[vc]=!0,e}function wc(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const e=r[o],n=t[o];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class xc{constructor(t,e){this.routes=t,this.module=e}}function _c(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];Cc(r,Sc(e,r))}}function Cc(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&t.outlet!==mc)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&_c(t.children,e)}function Sc(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Ec(t){const e=t.children&&t.children.map(Ec),n=e?Object.assign({},t,{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==mc&&(n.component=fc),n}function kc(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(t[i=n[o]]!==e[i])return!1;return!0}function Nc(t){return Array.prototype.concat.apply([],t)}function Ic(t){return t.length>0?t[t.length-1]:null}function Tc(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Ac(t){return Xe(t)?t:Ke(t)?G(Promise.resolve(t)):Ga(t)}function Rc(t,e,n){return n?function(t,e){return kc(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!Fc(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>e[n]===t[n])}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length){return!!Fc(n.segments.slice(0,i.length),i)&&!r.hasChildren()}if(n.segments.length===i.length){if(!Fc(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),o=i.slice(n.segments.length);return!!Fc(n.segments,t)&&!!n.children[mc]&&e(n.children[mc],r,o)}}(e,n,n.segments)}(t.root,e.root)}class Oc{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=yc(this.queryParams)),this._queryParamMap}toString(){return Bc.serialize(this)}}class Dc{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Tc(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Uc(this)}}class Pc{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=yc(this.parameters)),this._parameterMap}toString(){return $c(this)}}function Fc(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function Mc(t,e){let n=[];return Tc(t.children,(t,r)=>{r===mc&&(n=n.concat(e(t,r)))}),Tc(t.children,(t,r)=>{r!==mc&&(n=n.concat(e(t,r)))}),n}class Lc{}class zc{parse(t){const e=new Zc(t);return new Oc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`${`/${function t(e,n){if(!e.hasChildren())return Uc(e);if(n){const n=e.children[mc]?t(e.children[mc],!1):"",r=[];return Tc(e.children,(e,n)=>{n!==mc&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=Mc(e,(n,r)=>r===mc?[t(e.children[mc],!1)]:[`${r}:${t(n,!1)}`]);return`${Uc(e)}/(${n.join("//")})`}}(t.root,!0)}`}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${jc(e)}=${jc(t)}`).join("&"):`${jc(e)}=${jc(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Bc=new zc;function Uc(t){return t.segments.map(t=>$c(t)).join("/")}function Vc(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function jc(t){return Vc(t).replace(/%3B/gi,";")}function Wc(t){return Vc(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Hc(t){return decodeURIComponent(t)}function qc(t){return Hc(t.replace(/\+/g,"%20"))}function $c(t){return`${Wc(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Wc(t)}=${Wc(e[t])}`).join("")}`;var e}const Gc=/^[^\/()?;=#]+/;function Kc(t){const e=t.match(Gc);return e?e[0]:""}const Xc=/^[^=?&#]+/,Qc=/^[^?&#]+/;class Zc{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Dc([],{}):new Dc([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[mc]=new Dc(t,e)),n}parseSegment(){const t=Kc(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Pc(Hc(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Kc(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=Kc(this.remaining);t&&this.capture(n=t)}t[Hc(e)]=Hc(n)}parseQueryParam(t){const e=function(t){const e=t.match(Xc);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Qc);return e?e[0]:""}(this.remaining);t&&this.capture(n=t)}const r=qc(e),i=qc(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(t[r]=e=[e]),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Kc(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=mc);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[mc]:new Dc([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Yc{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Jc(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Jc(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=th(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return th(t,this._root).map(t=>t.value)}}function Jc(t,e){if(t===e.value)return e;for(const n of e.children){const e=Jc(t,n);if(e)return e}return null}function th(t,e){if(t===e.value)return[e];for(const n of e.children){const r=th(t,n);if(r.length)return r.unshift(e),r}return[]}class eh{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function nh(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class rh extends Yc{constructor(t,e){super(t),this.snapshot=e,lh(this,t)}toString(){return this.snapshot.toString()}}function ih(t,e){const n=function(t,e){const n=new ah([],{},{},"",{},mc,e,null,t.root,-1,{});return new uh("",new eh(n,[]))}(t,e),r=new Ka([new Pc("",{})]),i=new Ka({}),o=new Ka({}),s=new Ka({}),a=new Ka(""),u=new oh(r,i,s,a,o,mc,e,n.root);return u.snapshot=n.root,new rh(new eh(u,[]),n)}class oh{constructor(t,e,n,r,i,o,s,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(W(t=>yc(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(W(t=>yc(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function sh(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign({},t.params,e.params),data:Object.assign({},t.data,e.data),resolve:Object.assign({},t.resolve,e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class ah{constructor(t,e,n,r,i,o,s,a,u,l,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this.routeConfig=a,this._urlSegment=u,this._lastPathIndex=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=yc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=yc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class uh extends Yc{constructor(t,e){super(e),this.url=t,lh(this,e)}toString(){return ch(this._root)}}function lh(t,e){e.value._routerState=t,e.children.forEach(e=>lh(t,e))}function ch(t){const e=t.children.length>0?` { ${t.children.map(ch).join(", ")} } `:"";return`${t.value}${e}`}function hh(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,kc(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),kc(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!kc(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),kc(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function ph(t,e){return kc(t.params,e.params)&&function(t,e){return Fc(t,e)&&t.every((t,n)=>kc(t.parameters,e[n].parameters))}(t.url,e.url)&&!(!t.parent!=!e.parent)&&(!t.parent||ph(t.parent,e.parent))}function dh(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function fh(t,e,n,r,i){let o={};return r&&Tc(r,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new Oc(n.root===t?e:function t(e,n,r){const i={};return Tc(e.children,(e,o)=>{i[o]=e===n?r:t(e,n,r)}),new Dc(e.segments,i)}(n.root,t,e),o,i)}class mh{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&dh(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==Ic(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class gh{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function yh(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets[mc]:`${t}`}function vh(t,e,n){if(t||(t=new Dc([],{})),0===t.segments.length&&t.hasChildren())return bh(t,e,n);const r=function(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const e=t.segments[i],s=yh(n[r]),a=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&a&&"object"==typeof a&&void 0===a.outlets){if(!Ch(s,a,e))return o;r+=2}else{if(!Ch(s,{},e))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new Dc(t.segments.slice(0,r.pathIndex),{});return e.children[mc]=new Dc(t.segments.slice(r.pathIndex),t.children),bh(e,0,i)}return r.match&&0===i.length?new Dc(t.segments,{}):r.match&&!t.hasChildren()?wh(t,e,n):r.match?bh(t,0,i):wh(t,e,n)}function bh(t,e,n){if(0===n.length)return new Dc(t.segments,{});{const r=function(t){return"object"!=typeof t[0]?{[mc]:t}:void 0===t[0].outlets?{[mc]:t}:t[0].outlets}(n),i={};return Tc(r,(n,r)=>{null!==n&&(i[r]=vh(t.children[r],e,n))}),Tc(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new Dc(t.segments,i)}}function wh(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){const t=xh(n[i].outlets);return new Dc(r,t)}if(0===i&&dh(n[0])){r.push(new Pc(t.segments[e].path,n[0])),i++;continue}const o=yh(n[i]),s=i<n.length-1?n[i+1]:null;o&&s&&dh(s)?(r.push(new Pc(o,_h(s))),i+=2):(r.push(new Pc(o,{})),i++)}return new Dc(r,{})}function xh(t){const e={};return Tc(t,(t,n)=>{null!==t&&(e[n]=wh(new Dc([],{}),0,t))}),e}function _h(t){const e={};return Tc(t,(t,n)=>e[n]=`${t}`),e}function Ch(t,e,n){return t==n.path&&kc(e,n.parameters)}const Sh=(t,e,n)=>W(r=>(new Eh(e,r.targetRouterState,r.currentRouterState,n).activate(t),r));class Eh{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),hh(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=nh(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),Tc(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=nh(t),i=t.value.component?n.children:e;Tc(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=nh(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new pc(t.value.snapshot))}),t.children.length&&this.forwardEvent(new cc(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(hh(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),kh(t.route)}else{const n=function(t){for(let e=r.snapshot.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function kh(t){hh(t.value),t.children.forEach(kh)}function Nh(t){return"function"==typeof t}function Ih(t){return t instanceof Oc}class Th{constructor(t){this.segmentGroup=t||null}}class Ah{constructor(t){this.urlTree=t}}function Rh(t){return new _(e=>e.error(new Th(t)))}function Oh(t){return new _(e=>e.error(new Ah(t)))}function Dh(t){return new _(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Ph{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(sn)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,mc).pipe(W(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(bu(t=>{if(t instanceof Ah)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof Th)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,mc).pipe(W(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(bu(t=>{if(t instanceof Th)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new Dc([],{[mc]:t}):t;return new Oc(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(W(t=>new Dc([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Ga({});const n=[],r=[],i={};return Tc(t,(t,o)=>{const s=e(o,t).pipe(W(t=>i[o]=t));o===mc?n.push(s):r.push(s)}),Ga.apply(null,n.concat(r)).pipe(nu(),vu(),W(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,o){return Ga(...n).pipe(W(s=>this.expandSegmentAgainstRoute(t,e,n,s,r,i,o).pipe(bu(t=>{if(t instanceof Th)return Ga(null);throw t}))),nu(),Eu(t=>!!t),bu((t,n)=>{if(t instanceof Qa||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return Ga(new Dc([],{}));throw new Th(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,o,s){return zh(r)!==o?Rh(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):Rh(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Oh(i):this.lineralizeSegments(n,i).pipe(K(n=>{const i=new Dc(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){const{matched:s,consumedSegments:a,lastChild:u,positionalParamSegments:l}=Fh(e,r,i);if(!s)return Rh(e);const c=this.applyRedirectCommands(a,r.redirectTo,l);return r.redirectTo.startsWith("/")?Oh(c):this.lineralizeSegments(r,c).pipe(K(r=>this.expandSegment(t,e,n,r.concat(i.slice(u)),o,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(W(t=>(n._loadedConfig=t,new Dc(r,{})))):Ga(new Dc(r,{}));const{matched:i,consumedSegments:o,lastChild:s}=Fh(e,n,r);if(!i)return Rh(e);const a=r.slice(s);return this.getChildConfig(t,n,r).pipe(K(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:s}=function(t,e,n,r){return n.length>0&&function(t,e,n){return r.some(n=>Lh(t,e,n)&&zh(n)!==mc)}(t,n)?{segmentGroup:Mh(new Dc(e,function(t,e){const n={};n[mc]=e;for(const r of t)""===r.path&&zh(r)!==mc&&(n[zh(r)]=new Dc([],{}));return n}(r,new Dc(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return r.some(n=>Lh(t,e,n))}(t,n)?{segmentGroup:Mh(new Dc(t.segments,function(t,e,n,r){const i={};for(const o of n)Lh(t,e,o)&&!r[zh(o)]&&(i[zh(o)]=new Dc([],{}));return Object.assign({},r,i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,o,a,r);return 0===s.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(W(t=>new Dc(o,t))):0===r.length&&0===s.length?Ga(new Dc(o,{})):this.expandSegment(n,i,r,s,mc,!0).pipe(W(t=>new Dc(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Ga(new xc(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Ga(e._loadedConfig):function(t,e,n){const r=e.canLoad;return r&&0!==r.length?G(r).pipe(W(r=>{const i=t.get(r);let o;if(function(t){return t&&Nh(t.canLoad)}(i))o=i.canLoad(e,n);else{if(!Nh(i))throw new Error("Invalid CanLoad guard");o=i(e,n)}return Ac(o)})).pipe(nu(),(i=t=>!0===t,t=>t.lift(new ku(i,void 0,t)))):Ga(!0);var i}(t.injector,e,n).pipe(K(n=>n?this.configLoader.load(t.injector,e).pipe(W(t=>(e._loadedConfig=t,t))):function(t){return new _(e=>e.error(bc(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Ga(new xc([],t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Ga(n);if(r.numberOfChildren>1||!r.children[mc])return Dh(t.redirectTo);r=r.children[mc]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new Oc(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Tc(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let o={};return Tc(e.children,(e,i)=>{o[i]=this.createSegmentGroup(t,e,n,r)}),new Dc(i,o)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function Fh(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||wc)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Mh(t){if(1===t.numberOfChildren&&t.children[mc]){const e=t.children[mc];return new Dc(t.segments.concat(e.segments),e.children)}return t}function Lh(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function zh(t){return t.outlet||mc}class Bh{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Uh{constructor(t,e){this.component=t,this.route=e}}function Vh(t,e,n){const r=t._root;return function t(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=nh(n);return e.children.forEach(e=>{!function(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,a=n?n.value:null,u=r?r.getContext(e.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Fc(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Fc(t.url,e.url)||!kc(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ph(t,e)||!kc(t.queryParams,e.queryParams);case"paramsChange":default:return!ph(t,e)}}(a,s,s.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new Bh(i)):(s.data=a.data,s._resolvedData=a._resolvedData),t(e,n,s.component?u?u.children:null:r,i,o),l&&o.canDeactivateChecks.push(new Uh(u&&u.outlet&&u.outlet.component||null,a))}else a&&Wh(n,u,o),o.canActivateChecks.push(new Bh(i)),t(e,null,s.component?u?u.children:null:r,i,o)}(e,s[e.value.outlet],r,i.concat([e.value]),o),delete s[e.value.outlet]}),Tc(s,(t,e)=>Wh(t,r.getContext(e),o)),o}(r,e?e._root:null,n,[r.value])}function jh(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Wh(t,e,n){const r=nh(t),i=t.value;Tc(r,(t,r)=>{Wh(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new Uh(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const Hh=Symbol("INITIAL_VALUE");function qh(){return Iu(t=>Ya(...t.map(t=>t.pipe(_u(1),Ou(Hh)))).pipe(Du((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==Hh)return t;if(r===Hh&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Ih(r))return r}return t},t)},Hh),ru(t=>t!==Hh),W(t=>Ih(t)?t:!0===t),_u(1)))}function $h(t,e){return null!==t&&e&&e(new hc(t)),Ga(!0)}function Gh(t,e){return null!==t&&e&&e(new lc(t)),Ga(!0)}function Kh(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Ga(r.map(r=>eu(()=>{const i=jh(r,e,n);let o;if(function(t){return t&&Nh(t.canActivate)}(i))o=Ac(i.canActivate(e,t));else{if(!Nh(i))throw new Error("Invalid CanActivate guard");o=Ac(i(e,t))}return o.pipe(Eu())}))).pipe(qh()):Ga(!0)}function Xh(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>(function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null})(t)).filter(t=>null!==t).map(e=>eu(()=>Ga(e.guards.map(i=>{const o=jh(i,e.node,n);let s;if(function(t){return t&&Nh(t.canActivateChild)}(o))s=Ac(o.canActivateChild(r,t));else{if(!Nh(o))throw new Error("Invalid CanActivateChild guard");s=Ac(o(r,t))}return s.pipe(Eu())})).pipe(qh())));return Ga(i).pipe(qh())}class Qh{}class Zh{constructor(t,e,n,r,i,o){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}recognize(){try{const t=tp(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,mc),n=new ah([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},mc,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new eh(n,e),i=new uh(this.url,r);return this.inheritParamsAndData(i._root),Ga(i)}catch(aR){return new _(e=>e.error(aR))}}inheritParamsAndData(t){const e=t.value,n=sh(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=Mc(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};n.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(),n.sort((t,e)=>t.value.outlet===mc?-1:e.value.outlet===mc?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const i of t)try{return this.processSegmentAgainstRoute(i,e,n,r)}catch(aR){if(!(aR instanceof Qh))throw aR}if(this.noLeftoversInUrl(e,n,r))return[];throw new Qh}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new Qh;if((t.outlet||mc)!==r)throw new Qh;let i,o=[],s=[];if("**"===t.path){const o=n.length>0?Ic(n).parameters:{};i=new ah(n,o,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,rp(t),r,t.component,t,Yh(e),Jh(e)+n.length,ip(t))}else{const a=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new Qh;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||wc)(n,t,e);if(!r)throw new Qh;const i={};Tc(r.posParams,(t,e)=>{i[e]=t.path});const o=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=a.consumedSegments,s=n.slice(a.lastChild),i=new ah(o,a.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,rp(t),r,t.component,t,Yh(e),Jh(e)+o.length,ip(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:l}=tp(e,o,s,a,this.relativeLinkResolution);if(0===l.length&&u.hasChildren()){const t=this.processChildren(a,u);return[new eh(i,t)]}if(0===a.length&&0===l.length)return[new eh(i,[])];const c=this.processSegment(a,u,l,mc);return[new eh(i,c)]}}function Yh(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Jh(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)n+=(e=e._sourceSegment)._segmentIndexShift?e._segmentIndexShift:0;return n-1}function tp(t,e,n,r,i){if(n.length>0&&function(t,e,n){return r.some(n=>ep(t,e,n)&&np(n)!==mc)}(t,n)){const i=new Dc(e,function(t,e,n,r){const i={};i[mc]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&np(o)!==mc){const n=new Dc([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[np(o)]=n}return i}(t,e,r,new Dc(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return r.some(n=>ep(t,e,n))}(t,n)){const o=new Dc(t.segments,function(t,e,n,r,i,o){const s={};for(const a of r)if(ep(t,n,a)&&!i[np(a)]){const n=new Dc([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===o?t.segments.length:e.length,s[np(a)]=n}return Object.assign({},i,s)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const o=new Dc(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function ep(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function np(t){return t.outlet||mc}function rp(t){return t.data||{}}function ip(t){return t.resolve||{}}function op(t,e,n,r){const i=jh(t,e,r);return Ac(i.resolve?i.resolve(e,n):i(e,n))}function sp(t){return function(e){return e.pipe(Iu(e=>{const n=t(e);return n?G(n).pipe(W(()=>e)):G([e])}))}}class ap{}class up{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const lp=new It("ROUTES");class cp{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(W(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new xc(Nc(r.injector.get(lp)).map(Ec),r)}))}loadModuleFactory(t){return"string"==typeof t?G(this.loader.load(t)):Ac(t()).pipe(K(t=>t instanceof an?Ga(t):G(this.compiler.compileModuleAsync(t))))}}class hp{}class pp{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function dp(t){throw t}function fp(t,e,n){return e.parse("/")}function mp(t,e){return Ga(null)}class gp{constructor(t,e,n,r,i,o,s,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new I,this.errorHandler=dp,this.malformedUriErrorHandler=fp,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:mp,afterPreactivation:mp},this.urlHandlingStrategy=new pp,this.routeReuseStrategy=new up,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(sn),this.console=i.get(Hi);const u=i.get(ao);this.isNgZoneEnabled=u instanceof ao,this.resetConfig(a),this.currentUrlTree=new Oc(new Dc([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new cp(o,s,t=>this.triggerEvent(new ac(t)),t=>this.triggerEvent(new uc(t))),this.routerState=ih(this.currentUrlTree,this.rootComponentType),this.transitions=new Ka({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(ru(t=>0!==t.id),W(t=>Object.assign({},t,{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),Iu(t=>{let n=!1,r=!1;return Ga(t).pipe(hu(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign({},this.lastSuccessfulNavigation,{previousNavigation:null}):null}}),Iu(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Ga(t).pipe(Iu(t=>{const n=this.transitions.getValue();return e.next(new Yl(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?Ha:[t]}),Iu(t=>Promise.resolve(t)),function(t,e,n,r){return function(i){return i.pipe(Iu(i=>(function(t,e,n,r,o){return new Ph(t,e,n,i.extractedUrl,o).apply()})(t,e,n,0,r).pipe(W(t=>Object.assign({},i,{urlAfterRedirects:t})))))}}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),hu(t=>{this.currentNavigation=Object.assign({},this.currentNavigation,{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(o){return o.pipe(K(o=>(function(t,e,n,r,i="emptyOnly",o="legacy"){return new Zh(t,e,n,r,i,o).recognize()})(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(W(t=>Object.assign({},o,{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),hu(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),hu(t=>{const n=new nc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:o,extras:s}=t,a=new Yl(n,this.serializeUrl(r),i,o);e.next(a);const u=ih(r,this.rootComponentType).snapshot;return Ga(Object.assign({},t,{targetSnapshot:u,urlAfterRedirects:r,extras:Object.assign({},s,{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),Ha}),sp(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),hu(t=>{const e=new rc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),W(t=>Object.assign({},t,{guards:Vh(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(K(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?Ga(Object.assign({},n,{guardsResult:!0})):function(t,e,n,r){return G(s).pipe(K(t=>(function(t,e,n,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Ga(o.map(o=>{const s=jh(o,e,i);let a;if(function(t){return t&&Nh(t.canDeactivate)}(s))a=Ac(s.canDeactivate(t,e,n,r));else{if(!Nh(s))throw new Error("Invalid CanDeactivate guard");a=Ac(s(t,e,n,r))}return a.pipe(Eu())})).pipe(qh()):Ga(!0)})(t.component,t.route,n,e,r)),Eu(t=>!0!==t,!0))}(0,r,i,t).pipe(K(n=>n&&function(t){return"boolean"==typeof n}()?function(t,e,n,r){return G(o).pipe(Mu(e=>G([Gh(e.route.parent,r),$h(e.route,r),Xh(t,e.path,n),Kh(t,e.route,n)]).pipe(nu(),Eu(t=>!0!==t,!0))),Eu(t=>!0!==t,!0))}(r,0,t,e):Ga(n)),W(t=>Object.assign({},n,{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),hu(t=>{if(Ih(t.guardsResult)){const e=bc(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),hu(t=>{const e=new ic(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),ru(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new tc(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),sp(t=>{if(t.guards.canActivateChecks.length)return Ga(t).pipe(hu(t=>{const e=new oc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),function(t,e){return function(n){return n.pipe(K(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;return i.length?G(i).pipe(Mu(n=>(function(t,e,n,i){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return Ga({});if(1===i.length){const o=i[0];return op(t[o],e,n,r).pipe(W(t=>({[o]:t})))}const o={};return G(i).pipe(K(i=>op(t[i],e,n,r).pipe(W(t=>(o[i]=t,t))))).pipe(vu(),W(()=>o))}(t._resolve,t,r,i).pipe(W(e=>(t._resolvedData=e,t.data=Object.assign({},t.data,sh(t,n).resolve),null)))})(n.route,0,t,e)),function(t,e){return arguments.length>=2?function(n){return w(Du(t,e),uu(1),mu(e))(n)}:function(e){return w(Du((e,n,r)=>t(e,n,r+1)),uu(1))(e)}}((t,e)=>t),W(t=>n)):Ga(n)}))}}(this.paramsInheritanceStrategy,this.ngModule.injector),hu(t=>{const e=new sc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),sp(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:s}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!s})}),W(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new eh(i,o)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new oh(new Ka((i=n.value).url),new Ka(i.params),new Ka(i.queryParams),new Ka(i.fragment),new Ka(i.data),i.outlet,i.component,i),o=n.children.map(n=>t(e,n));return new eh(r,o)}}var i}(t,e._root,n?n._root:void 0);return new rh(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign({},t,{targetRouterState:e})}),hu(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),Sh(this.rootContexts,this.routeReuseStrategy,t=>this.triggerEvent(t)),hu({next(){n=!0},complete(){n=!0}}),Lu(()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new tc(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null}),bu(n=>{if(r=!0,function(t){return n&&n[vc]}()){const r=Ih(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new tc(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),t.resolve(!1),r&&this.navigateByUrl(n.url)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new ec(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(Nw){t.reject(Nw)}}return Ha}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign({},this.getTransition(),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){_c(t),this.config=t.map(Ec),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:o,queryParamsHandling:s,preserveFragment:a}=e;le()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const u=n||this.routerState.root,l=a?this.currentUrlTree.fragment:i;let c=null;if(s)switch(s){case"merge":c=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=o?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return fh(e.root,e.root,e,r,i);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new mh(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return Tc(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new mh(n,e,r)}(n);if(o.toRoot())return fh(e.root,new Dc([],{}),e,r,i);const s=function(t,n,r){if(t.isAbsolute)return new gh(e.root,!0,0);if(-1===r.snapshot._lastPathIndex)return new gh(r.snapshot._urlSegment,!0,0);const i=dh(t.commands[0])?0:1;return function(e,n,o){let s=r.snapshot._urlSegment,a=r.snapshot._lastPathIndex+i,u=t.numberOfDoubleDots;for(;u>a;){if(u-=a,!(s=s.parent))throw new Error("Invalid number of '../'");a=s.segments.length}return new gh(s,!1,a-u)}()}(o,0,t),a=s.processChildren?bh(s.segmentGroup,s.index,o.commands):vh(s.segmentGroup,s.index,o.commands);return fh(s.segmentGroup,a,e,r,i)}(u,this.currentUrlTree,t,c,l)}navigateByUrl(t,e={skipLocationChange:!1}){le()&&this.isNgZoneEnabled&&!ao.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=Ih(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(aR){e=this.malformedUriErrorHandler(aR,this.urlSerializer,t)}return e}isActive(t,e){if(Ih(t))return Rc(this.currentUrlTree,t,e);const n=this.parseUrl(t);return Rc(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Jl(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r){const i=this.getTransition();if(i&&"imperative"!==e&&"imperative"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"hashchange"==e&&"popstate"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"popstate"==e&&"hashchange"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);let o=null,s=null;const a=new Promise((t,e)=>{o=t,s=e}),u=++this.navigationId;return this.setTransition({id:u,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:o,reject:s,promise:a,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),a.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign({},r,{navigationId:n})):this.location.go(i,"",Object.assign({},r,{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}let yp=(()=>(class{constructor(t,e,n,r,i){this.router=t,this.route=e,this.commands=[],null==n&&r.setAttribute(i.nativeElement,"tabindex","0")}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}set preserveQueryParams(t){le()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated!, use queryParamsHandling instead."),this.preserve=t}onClick(){const t={skipLocationChange:vp(this.skipLocationChange),replaceUrl:vp(this.replaceUrl)};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:vp(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:vp(this.preserveFragment)})}}))();function vp(t){return""===t||!!t}class bp{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new wp,this.attachRef=null}}class wp{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new bp,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}let xp=(()=>(class{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new Di,this.deactivateEvents=new Di,this.name=r||mc,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new _p(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}))();class _p{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===oh?this.route:t===wp?this.childContexts:this.parent.get(t,e)}}class Cp{}class Sp{preload(t,e){return e().pipe(bu(()=>Ga(null)))}}class Ep{preload(t,e){return Ga(null)}}let kp=(()=>(class{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new cp(e,n,e=>t.triggerEvent(new ac(e)),e=>t.triggerEvent(new uc(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(ru(t=>t instanceof Jl),Mu(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(sn);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return G(n).pipe(Y(),W(t=>void 0))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(K(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}))();class Np{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Yl?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Jl&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof dc&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new dc(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}const Ip=new It("ROUTER_CONFIGURATION"),Tp=new It("ROUTER_FORROOT_GUARD"),Ap=[Sa,{provide:Lc,useClass:zc},{provide:gp,useFactory:Lp,deps:[No,Lc,wp,Sa,$t,To,Ji,lp,Ip,[hp,new ht],[ap,new ht]]},wp,{provide:oh,useFactory:zp,deps:[gp]},{provide:To,useClass:Oo},kp,Ep,Sp,{provide:Ip,useValue:{enableTracing:!1}}];function Rp(){return new _o("Router",gp)}let Op=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Ap,Mp(e),{provide:Tp,useFactory:Fp,deps:[[gp,new ht,new dt]]},{provide:Ip,useValue:n||{}},{provide:_a,useFactory:Pp,deps:[wa,[new ct(Ca),new ht],Ip]},{provide:Np,useFactory:Dp,deps:[gp,ja,Ip]},{provide:Cp,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Ep},{provide:_o,multi:!0,useFactory:Rp},[Bp,{provide:Mi,multi:!0,useFactory:Up,deps:[Bp]},{provide:jp,useFactory:Vp,deps:[Bp]},{provide:Wi,multi:!0,useExisting:jp}]]}}static forChild(e){return{ngModule:t,providers:[Mp(e)]}}}return t})();function Dp(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Np(t,e,n)}function Pp(t,e,n={}){return n.useHash?new ka(t,e):new Na(t,e)}function Fp(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Mp(t){return[{provide:ie,multi:!0,useValue:t},{provide:lp,multi:!0,useValue:t}]}function Lp(t,e,n,r,i,o,s,a,u={},l,c){const h=new gp(null,e,n,r,i,o,s,Nc(a));if(l&&(h.urlHandlingStrategy=l),c&&(h.routeReuseStrategy=c),u.errorHandler&&(h.errorHandler=u.errorHandler),u.malformedUriErrorHandler&&(h.malformedUriErrorHandler=u.malformedUriErrorHandler),u.enableTracing){const t=Vu();h.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return u.onSameUrlNavigation&&(h.onSameUrlNavigation=u.onSameUrlNavigation),u.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=u.paramsInheritanceStrategy),u.urlUpdateStrategy&&(h.urlUpdateStrategy=u.urlUpdateStrategy),u.relativeLinkResolution&&(h.relativeLinkResolution=u.relativeLinkResolution),h}function zp(t){return t.routerState.root}let Bp=(()=>(class{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new I}appInitializer(){return this.injector.get(xa,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(gp),r=this.injector.get(Ip);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?Ga(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(Ip),n=this.injector.get(kp),r=this.injector.get(Np),i=this.injector.get(gp),o=this.injector.get(No);t===o.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}))();function Up(t){return t.appInitializer.bind(t)}function Vp(t){return t.bootstrapListener.bind(t)}const jp=new It("Router Initializer");var Wp=nr({encapsulation:2,styles:[],data:{}});function Hp(t){return hs(0,[(t()(),Go(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),pi(1,212992,null,0,xp,[wp,Ln,nn,[8,null],An],null,null)],function(t,e){t(e,1,0)},null)}function qp(t){return hs(0,[(t()(),Go(0,0,null,null,1,"ng-component",[],null,null,null,Hp,Wp)),pi(1,49152,null,0,fc,[],null,null)],null,null)}var $p=jr("ng-component",fc,qp,{},{},[]);const Gp=new gn("8.1.2");function Kp(t){return null!=t&&"false"!==`${t}`}function Xp(t){return Array.isArray(t)?t:[t]}function Qp(t){return null==t?"":"string"==typeof t?t:`${t}px`}function Zp(t){return t instanceof ln?t.nativeElement:t}let Yp;try{Yp="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch($S){Yp=!1}let Jp,td=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?this._platformId===Va:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Yp)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(ji,8))},token:t,providedIn:"root"}),t})(),ed=(()=>(class{}))();function nd(t){return function(){if(null==Jp&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Jp=!0}))}finally{Jp=Jp||!1}return Jp}()?t:!!t.capture}class rd extends d{constructor(t,e){super()}schedule(t,e=0){return this}}class id extends rd{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(aR){n=!0,r=!!aR&&aR||new Error(aR)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let od=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class sd extends od{constructor(t,e=od.now){super(t,()=>sd.delegate&&sd.delegate!==this?sd.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return sd.delegate&&sd.delegate!==this?sd.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const ad=new sd(id);class ud{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new ld(t,this.dueTime,this.scheduler))}}class ld extends g{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(cd,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function cd(t){t.debouncedNext()}const hd=new It("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),pd=new It("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let dd=(()=>{class t{constructor(t,e,n,r){this._ngZone=e,this._defaultOptions=r,this._document=n,this._liveElement=t||this._createLiveElement()}announce(t,...e){const n=this._defaultOptions;let r,i;return 1===e.length&&"number"==typeof e[0]?i=e[0]:[r,i]=e,this.clear(),clearTimeout(this._previousTimeout),r||(r=n&&n.politeness?n.politeness:"polite"),null==i&&n&&(i=n.duration),this._liveElement.setAttribute("aria-live",r),this._ngZone.runOutsideAngular(()=>new Promise(e=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,e(),"number"==typeof i&&(this._previousTimeout=setTimeout(()=>this.clear(),i))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}_createLiveElement(){const t=this._document.getElementsByClassName("cdk-live-announcer-element"),e=this._document.createElement("div");for(let n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return e.classList.add("cdk-live-announcer-element"),e.classList.add("cdk-visually-hidden"),e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),e}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(hd,8),Ut(ao),Ut(Ua),Ut(pd,8))},token:t,providedIn:"root"}),t})();const fd=650,md=nd({passive:!0,capture:!0});let gd=(()=>{class t{constructor(t,e){this._ngZone=t,this._platform=e,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=()=>{this._lastTouchTarget||this._setOriginForCurrentEventQueue("mouse")},this._documentTouchstartListener=t=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=t.target,this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,fd)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)}}monitor(t,e=!1){if(!this._platform.isBrowser)return Ga(null);const n=Zp(t);if(this._elementInfo.has(n)){let t=this._elementInfo.get(n);return t.checkChildren=e,t.subject.asObservable()}let r={unlisten:()=>{},checkChildren:e,subject:new I};this._elementInfo.set(n,r),this._incrementMonitoredElementCount();let i=t=>this._onFocus(t,n),o=t=>this._onBlur(t,n);return this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",i,!0),n.addEventListener("blur",o,!0)}),r.unlisten=()=>{n.removeEventListener("focus",i,!0),n.removeEventListener("blur",o,!0)},r.subject.asObservable()}stopMonitoring(t){const e=Zp(t),n=this._elementInfo.get(e);n&&(n.unlisten(),n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._decrementMonitoredElementCount())}focusVia(t,e,n){const r=Zp(t);this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n)}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_setClasses(t,e){this._elementInfo.get(t)&&(this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e))}_setOriginForCurrentEventQueue(t){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originTimeoutId=setTimeout(()=>this._origin=null,1)})}_wasCausedByTouch(t){let e=t.target;return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}_onFocus(t,e){const n=this._elementInfo.get(e);if(!n||!n.checkChildren&&e!==t.target)return;let r=this._origin;r||(r=this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"),this._setClasses(e,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_incrementMonitoredElementCount(){1==++this._monitoredElementCount&&this._platform.isBrowser&&this._ngZone.runOutsideAngular(()=>{document.addEventListener("keydown",this._documentKeydownListener,md),document.addEventListener("mousedown",this._documentMousedownListener,md),document.addEventListener("touchstart",this._documentTouchstartListener,md),window.addEventListener("focus",this._windowFocusListener)})}_decrementMonitoredElementCount(){--this._monitoredElementCount||(document.removeEventListener("keydown",this._documentKeydownListener,md),document.removeEventListener("mousedown",this._documentMousedownListener,md),document.removeEventListener("touchstart",this._documentTouchstartListener,md),window.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId))}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(ao),Ut(td))},token:t,providedIn:"root"}),t})();const yd=new gn("8.1.2"),vd=new It("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let bd,wd=(()=>(class{constructor(t,e){this._sanityChecksEnabled=t,this._hammerLoader=e,this._hasDoneGlobalChecks=!1,this._hasCheckedHammer=!1,this._document="object"==typeof document&&document?document:null,this._window="object"==typeof window&&window?window:null,this._areChecksEnabled()&&!this._hasDoneGlobalChecks&&(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_areChecksEnabled(){return this._sanityChecksEnabled&&le()&&!this._isTestEnv()}_isTestEnv(){const t=this._window;return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._document&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._document||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const e=getComputedStyle(t);e&&"none"!==e.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){yd.full!==Gp.full&&console.warn("The Angular Material version ("+yd.full+") does not match the Angular CDK version ("+Gp.full+").\nPlease ensure the versions of these two packages exactly match.")}_checkHammerIsAvailable(){!this._hasCheckedHammer&&this._window&&(!this._areChecksEnabled()||this._window.Hammer||this._hammerLoader||console.warn("Could not find HammerJS. Certain Angular Material components may not work correctly."),this._hasCheckedHammer=!0)}}))();function xd(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=Kp(t)}}}function _d(t,e){return class extends t{get color(){return this._color}set color(t){const n=t||e;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.color=e}}}function Cd(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Kp(t)}}}try{bd="undefined"!=typeof Intl}catch($S){bd=!1}function Sd(t,e,n){const r=t.nativeElement.classList;n?r.add(e):r.remove(e)}let Ed=(()=>(class{}))();const kd=function(){var t={FADING_IN:0,VISIBLE:1,FADING_OUT:2,HIDDEN:3};return t[t.FADING_IN]="FADING_IN",t[t.VISIBLE]="VISIBLE",t[t.FADING_OUT]="FADING_OUT",t[t.HIDDEN]="HIDDEN",t}();class Nd{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=kd.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const Id={enterDuration:450,exitDuration:400},Td=800,Ad=nd({passive:!0});class Rd{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._triggerEvents=new Map,this._activeRipples=new Set,this._onMousedown=t=>{const e=function(t){return 0===t.buttons}(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+Td;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))},this._onTouchStart=t=>{if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}},this._onPointerUp=()=>{this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(t.state===kd.VISIBLE||t.config.terminateOnPointerUp&&t.state===kd.FADING_IN)&&t.fadeOut()}))},r.isBrowser&&(this._containerElement=n.nativeElement,this._triggerEvents.set("mousedown",this._onMousedown).set("mouseup",this._onPointerUp).set("mouseleave",this._onPointerUp).set("touchstart",this._onTouchStart).set("touchend",this._onPointerUp).set("touchcancel",this._onPointerUp))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign({},Id,n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const o=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,r),s=t-r.left,a=e-r.top,u=i.enterDuration,l=document.createElement("div");l.classList.add("mat-ripple-element"),l.style.left=`${s-o}px`,l.style.top=`${a-o}px`,l.style.height=`${2*o}px`,l.style.width=`${2*o}px`,l.style.backgroundColor=n.color||null,l.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(l),window.getComputedStyle(l).getPropertyValue("opacity"),l.style.transform="scale(1)";const c=new Nd(this,l,n);return c.state=kd.FADING_IN,this._activeRipples.add(c),n.persistent||(this._mostRecentTransientRipple=c),this._runTimeoutOutsideZone(()=>{const t=c===this._mostRecentTransientRipple;c.state=kd.VISIBLE,n.persistent||t&&this._isPointerDown||c.fadeOut()},u),c}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign({},Id,t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=kd.FADING_OUT,this._runTimeoutOutsideZone(()=>{t.state=kd.HIDDEN,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}setupTriggerEvents(t){t&&t!==this._triggerElement&&(this._removeTriggerEvents(),this._ngZone.runOutsideAngular(()=>{this._triggerEvents.forEach((e,n)=>{t.addEventListener(n,e,Ad)})}),this._triggerElement=t)}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_removeTriggerEvents(){this._triggerElement&&this._triggerEvents.forEach((t,e)=>{this._triggerElement.removeEventListener(e,t,Ad)})}}const Od=new It("mat-ripple-global-options");let Dd=(()=>(class{constructor(t,e,n,r,i){this._elementRef=t,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new Rd(this,e,t,n),"NoopAnimations"===i&&(this._globalOptions.animation={enterDuration:0,exitDuration:0})}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign({},this._globalOptions.animation,this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign({},this.rippleConfig,n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign({},this.rippleConfig,t))}}))(),Pd=(()=>(class{}))(),Fd=(()=>(class{}))();class Md{constructor(t){this._elementRef=t}}const Ld=_d(Md);let zd=(()=>(class{}))(),Bd=(()=>(class extends Ld{constructor(t,e,n){super(t),this._platform=e,this._document=n}ngAfterViewInit(){le()&&this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length&&Array.from(this._elementRef.nativeElement.childNodes).filter(t=>!(t.classList&&t.classList.contains("mat-toolbar-row"))).filter(t=>t.nodeType!==(this._document?this._document.COMMENT_NODE:8)).some(t=>!(!t.textContent||!t.textContent.trim()))&&function(){throw Error("MatToolbar: Attempting to combine different toolbar modes. Either specify multiple `<mat-toolbar-row>` elements explicitly or just place content inside of a `<mat-toolbar>` for a single row.")}()}}))(),Ud=(()=>(class{}))();const Vd=new It("cdk-dir-doc",{providedIn:"root",factory:function(){return Vt(Ua)}});let jd=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new Di,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(Vd,8))},token:t,providedIn:"root"}),t})(),Wd=(()=>(class{}))();var Hd=nr({encapsulation:2,styles:["@media (-ms-high-contrast:active){.mat-toolbar{outline:solid 1px}}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media (max-width:599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}"],data:{}});function qd(t){return hs(2,[rs(null,0),rs(null,1)],null,null)}const $d=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class Gd{constructor(t){this._elementRef=t}}const Kd=_d(xd(Cd(Gd)));let Xd=(()=>(class extends Kd{constructor(t,e,n){super(t),this._focusMonitor=e,this._animationMode=n,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of $d)this._hasHostAttributes(r)&&this._getHostElement().classList.add(r);this._focusMonitor.monitor(this._elementRef,!0),this.isRoundButton&&(this.color="accent")}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(){this._getHostElement().focus()}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(t=>this._getHostElement().hasAttribute(t))}}))(),Qd=(()=>(class{}))();class Zd{}class Yd{}const Jd="*";function tf(t,e=null){return{type:2,steps:t,options:e}}function ef(t){return{type:6,styles:t,offset:null}}function nf(t){Promise.resolve(null).then(t)}class rf{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){nf(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){}getPosition(){return 0}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class of{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?nf(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){let t=0;return this.players.forEach(e=>{const n=e.getPosition();t=Math.min(n,t)}),t}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}const sf="!";function af(){return"undefined"!=typeof process}function uf(t){switch(t.length){case 0:return new rf;case 1:return t[0];default:return new of(t)}}function lf(t,e,n,r,i={},o={}){const s=[],a=[];let u=-1,l=null;if(r.forEach(t=>{const n=t.offset,r=n==u,c=r&&l||{};Object.keys(t).forEach(n=>{let r=n,a=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,s),a){case sf:a=i[n];break;case Jd:a=o[n];break;default:a=e.normalizeStyleValue(n,r,a,s)}c[r]=a}),r||a.push(c),l=c,u=n}),s.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${s.join(t)}`)}return a}function cf(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&hf(n,"start",t)));break;case"done":t.onDone(()=>r(n&&hf(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&hf(n,"destroy",t)))}}function hf(t,e,n){const r=n.totalTime,i=pf(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),o=t._data;return null!=o&&(i._data=o),i}function pf(t,e,n,r,i="",o=0,s){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!s}}function df(t,e,n){let r;return t instanceof Map?(r=t.get(e))||t.set(e,r=n):(r=t[e])||(r=t[e]=n),r}function ff(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let mf=(t,e)=>!1,gf=(t,e)=>!1,yf=(t,e,n)=>[];const vf=af();(vf||"undefined"!=typeof Element)&&(mf=(t,e)=>t.contains(e),gf=(()=>{if(vf||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):gf}})(),yf=(t,e,n)=>{let r=[];if(n)r.push(...t.querySelectorAll(e));else{const n=t.querySelector(e);n&&r.push(n)}return r});let bf=null,wf=!1;function xf(t){bf||(bf=("undefined"!=typeof document?document.body:null)||{},wf=!!bf.style&&"WebkitAppearance"in bf.style);let e=!0;return bf.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&!(e=t in bf.style)&&wf&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in bf.style),e}const _f=gf,Cf=mf,Sf=yf;function Ef(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}let kf=(()=>(class{validateStyleProperty(t){return xf(t)}matchesElement(t,e){return _f(t,e)}containsElement(t,e){return Cf(t,e)}query(t,e,n){return Sf(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,o=[],s){return new rf(n,r)}}))(),Nf=(()=>{class t{}return t.NOOP=new kf,t})();const If=1e3,Tf="{{",Af="ng-enter",Rf="ng-leave",Of="ng-trigger",Df=".ng-trigger",Pf="ng-animating",Ff=".ng-animating";function Mf(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Lf(parseFloat(e[1]),e[2])}function Lf(t,e){switch(e){case"s":return t*If;default:return t}}function zf(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,o="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=Lf(parseFloat(n[1]),n[2]);const s=n[3];null!=s&&(i=Lf(parseFloat(s),n[4]));const a=n[5];a&&(o=a)}else r=t;if(!n){let n=!1,o=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(o,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:o}}(t,e,n)}function Bf(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function Uf(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else Bf(t,n);return n}function Vf(t,e,n){return n?e+":"+n+";":""}function jf(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=Vf(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=Vf(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function Wf(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=Zf(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),af()&&jf(t))}function Hf(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=Zf(e);t.style[n]=""}),af()&&jf(t))}function qf(t){return Array.isArray(t)?1==t.length?t[0]:tf(t):t}const $f=new RegExp(`${Tf}\\s*(.+?)\\s*}}`,"g");function Gf(t){let e=[];if("string"==typeof t){const n=t.toString();let r;for(;r=$f.exec(n);)e.push(r[1]);$f.lastIndex=0}return e}function Kf(t,e,n){const r=t.toString(),i=r.replace($f,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?t:i}function Xf(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const Qf=/-+([a-z0-9])/g;function Zf(t){return t.replace(Qf,(...t)=>t[1].toUpperCase())}function Yf(t,e){return 0===t||0===e}function Jf(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let o=e[0],s=[];if(r.forEach(t=>{o.hasOwnProperty(t)||s.push(t),o[t]=n[t]}),s.length)for(var i=1;i<e.length;i++){let n=e[i];s.forEach(function(e){n[e]=em(t,e)})}}return e}function tm(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function em(t,e){return window.getComputedStyle(t)[e]}const nm="*";function rm(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>(function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],o=r[2],s=r[3];e.push(sm(i,s)),"<"!=o[0]||i==nm&&s==nm||e.push(sm(s,i))})(t,n,e)):n.push(t),n}const im=new Set(["true","1"]),om=new Set(["false","0"]);function sm(t,e){const n=im.has(t)||om.has(t),r=im.has(e)||om.has(e);return(i,o)=>{let s=t==nm||t==i,a=e==nm||e==o;return!s&&n&&"boolean"==typeof i&&(s=i?im.has(t):om.has(t)),!a&&r&&"boolean"==typeof o&&(a=o?im.has(e):om.has(e)),s&&a}}const am=":self",um=new RegExp(`s*${am}s*,?`,"g");function lm(t,e,n){return new hm(t).build(e,n)}const cm="";class hm{constructor(t){this._driver=t}build(t,e){const n=new pm(e);return this._resetContextStyleTimingState(n),tm(this,qf(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector=cm,t.collectedStyles={},t.collectedStyles[cm]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,o.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:o,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,o=r||{};if(n.styles.forEach(t=>{if(dm(t)){const e=t;Object.keys(e).forEach(t=>{Gf(e[t]).forEach(t=>{o.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=Xf(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=tm(this,qf(t.animation),e);return{type:1,matchers:rm(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:fm(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>tm(this,t,e)),options:fm(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=tm(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:fm(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return mm(zf(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=mm(0,0,"");return t.dynamic=!0,t.strValue=r,t}return mm((n=n||zf(r,e)).duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:ef({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,o=!1;if(!i){o=!0;const t={};n.easing&&(t.easing=n.easing),i=ef(t)}e.currentTime+=n.duration+n.delay;const s=this.visitStyle(i,e);s.isEmptyStep=o,r=s}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?t==Jd?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(dm(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf(Tf)>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const o=e.collectedStyles[e.currentQuerySelector],s=o[n];let a=!0;s&&(i!=r&&i>=s.startTime&&r<=s.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${s.startTime}ms" and "${s.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=s.startTime),a&&(o[n]={startTime:i,endTime:r}),e.options&&function(r,i,o){const s=e.options.params||{},a=Gf(t[n]);a.length&&a.forEach(t=>{s.hasOwnProperty(t)||o.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(0,0,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let o=!1,s=!1,a=0;const u=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let u=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(dm(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(dm(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),l=0;return null!=u&&(r++,l=n.offset=u),s=s||l<0||l>1,o=o||l<a,a=l,i.push(l),n});s&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&e.errors.push("Please ensure that all keyframe offsets are in order");const l=t.steps.length;let c=0;r>0&&r<l?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(c=1/(l-1));const h=l-1,p=e.currentTime,d=e.currentAnimateTimings,f=d.duration;return u.forEach((t,r)=>{const o=c>0?r==h?1:c*r:i[r],s=o*f;e.currentTime=p+d.delay+s,d.duration=s,this._validateStyleAst(t,e),t.offset=o,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:tm(this,qf(t.animation),e),options:fm(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:fm(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:fm(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>t==am);return e&&(t=t.replace(um,"")),[t=t.replace(/@\*/g,Df).replace(/@\w+/g,t=>Df+"-"+t.substr(1)).replace(/:animating/g,Ff),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,df(e.collectedStyles,e.currentQuerySelector,{});const s=tm(this,qf(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:t.selector,options:fm(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:zf(t.timings,e.errors,!0);return{type:12,animation:tm(this,qf(t.animation),e),timings:n,options:null}}}class pm{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function dm(t){return!Array.isArray(t)&&"object"==typeof t}function fm(t){var e;return t?(t=Bf(t)).params&&(t.params=(e=t.params)?Bf(e):null):t={},t}function mm(t,e,n){return{duration:t,delay:e,easing:n}}function gm(t,e,n,r,i,o,s=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class ym{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const vm=1,bm=new RegExp(":enter","g"),wm=new RegExp(":leave","g");function xm(t,e,n,r,i,o={},s={},a,u,l=[]){return(new _m).buildKeyframes(t,e,n,r,i,o,s,a,u,l)}class _m{buildKeyframes(t,e,n,r,i,o,s,a,u,l=[]){u=u||new ym;const c=new Sm(t,e,u,r,i,l,[]);c.options=a,c.currentTimeline.setStyles([o],null,c.errors,a),tm(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(s).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([s],null,c.errors,a)}return h.length?h.map(t=>t.buildKeyframes()):[gm(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?Mf(n.duration):null,o=null!=n.delay?Mf(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,o);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),tm(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&((r=e.createSubContext(i)).transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Cm);const t=Mf(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>tm(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Mf(t.options.delay):0;t.steps.forEach(o=>{const s=e.createSubContext(t.options);i&&s.delayNextStep(i),tm(this,o,s),r=Math.max(r,s.currentTimeline.currentTime),n.push(s.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return zf(e.params?Kf(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,o=e.createSubContext().currentTimeline;o.easing=n.easing,t.styles.forEach(t=>{o.forwardTime((t.offset||0)*i),o.setStyles(t.styles,t.easing,e.errors,e.options),o.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(o),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?Mf(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Cm);let o=n;const s=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=s.length;let a=null;s.forEach((n,r)=>{e.currentQueryIndex=r;const s=e.createSubContext(t.options,n);i&&s.delayNextStep(i),n===e.element&&(a=s.currentTimeline),tm(this,t.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),a&&(e.currentTimeline.mergeTimelineCollectedStyles(a),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),s=o*(e.currentQueryTotal-1);let a=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=s-a;break;case"full":a=n.currentStaggerTime}const u=e.currentTimeline;a&&u.delayNextStep(a);const l=u.currentTime;tm(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-l+(r.startTime-n.currentTimeline.startTime)}}const Cm={};class Sm{constructor(t,e,n,r,i,o,s,a){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Cm,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new Em(this._driver,e,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=Mf(n.duration)),null!=n.delay&&(r.delay=Mf(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=Kf(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new Sm(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=Cm,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new km(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,o){let s=[];if(r&&s.push(this.element),t.length>0){t=(t=t.replace(bm,"."+this._enterClassName)).replace(wm,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),s.push(...e)}return i||0!=s.length||o.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),s}}class Em{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Em(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=vm,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||Jd,this._currentKeyframe[t]=Jd}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},o=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e)).forEach(t=>{n[t]=Jd}):Uf(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(t=>{const e=Kf(o[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:Jd),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,o)=>{const s=Uf(i,!0);Object.keys(s).forEach(n=>{const r=s[n];r==sf?t.add(n):r==Jd&&e.add(n)}),n||(s.offset=o/this.duration),r.push(s)});const i=t.size?Xf(t.values()):[],o=e.size?Xf(e.values()):[];if(n){const t=r[0],e=Bf(t);t.offset=0,e.offset=1,r=[t,e]}return gm(this.element,r,i,o,this.duration,this.startTime,this.easing,!1)}}class km extends Em{constructor(t,e,n,r,i,o,s=!1){super(t,e,o.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=s,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=n+e,s=e/o,a=Uf(t[0],!1);a.offset=0,i.push(a);const u=Uf(t[0],!1);u.offset=Nm(s),i.push(u);const l=t.length-1;for(let r=1;r<=l;r++){let s=Uf(t[r],!1);s.offset=Nm((e+s.offset*n)/o),i.push(s)}n=o,e=0,r="",t=i}return gm(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function Nm(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class Im{}class Tm extends Im{normalizePropertyName(t,e){return Zf(t)}normalizeStyleValue(t,e,n,r){let i="";const o=n.toString().trim();if(Am[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return o+i}}const Am=(()=>(function(t){const e={};return t.forEach(t=>e[t]=!0),e})("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Rm(t,e,n,r,i,o,s,a,u,l,c,h,p){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:s,timelines:a,queriedElements:u,preStyleProps:l,postStyleProps:c,totalTime:h,errors:p}}const Om={};class Dm{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],o=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):o}build(t,e,n,r,i,o,s,a,u,l){const c=[],h=this.ast.options&&this.ast.options.params||Om,p=this.buildStyles(n,s&&s.params||Om,c),d=a&&a.params||Om,f=this.buildStyles(r,d,c),m=new Set,g=new Map,y=new Map,v="void"===r,b={params:Object.assign({},h,d)},w=l?[]:xm(t,e,this.ast.animation,i,o,p,f,b,u,c);let x=0;if(w.forEach(t=>{x=Math.max(t.duration+t.delay,x)}),c.length)return Rm(e,this._triggerName,n,r,v,p,f,[],[],g,y,x,c);w.forEach(t=>{const n=t.element,r=df(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=df(y,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const _=Xf(m.values());return Rm(e,this._triggerName,n,r,v,p,f,w,_,g,y,x)}}class Pm{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=Bf(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let o=i[t];o.length>1&&(o=Kf(o,r,e)),n[t]=o})}}),n}}class Fm{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new Pm(t.style,t.options&&t.options.params||{})}),Mm(this.states,"true","1"),Mm(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new Dm(t,e,this.states))}),this.fallbackTransition=new Dm(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function Mm(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const Lm=new ym;class zm{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=lm(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=lf(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let o;const s=new Map;if(i?(o=xm(this._driver,e,i,Af,Rf,{},{},n,Lm,r)).forEach(t=>{const e=df(s,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)}):(r.push("The requested animation doesn't exist or has already been destroyed"),o=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);s.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,Jd)})});const a=uf(o.map(t=>{const e=s.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=a,a.onDestroy(()=>this.destroy(t)),this.players.push(a),a}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,r){const i=pf(e,"","","");return cf(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const Bm="ng-animate-queued",Um=".ng-animate-queued",Vm="ng-animate-disabled",jm=".ng-animate-disabled",Wm="ng-star-inserted",Hm=".ng-star-inserted",qm=[],$m={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Gm={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Km="__ng_removed";class Xm{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function(t){return null!=t?t:null}(n?t.value:t),n){const e=Bf(t);delete e.value,this.options=e}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const Qm="void",Zm=new Xm(Qm);class Ym{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,sg(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const o=df(this._elementListeners,t,[]),s={name:e,phase:n,callback:r};o.push(s);const a=df(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(sg(t,Of),sg(t,Of+"-"+e),a[e]=Zm),()=>{this._engine.afterFlush(()=>{const t=o.indexOf(s);t>=0&&o.splice(t,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),o=new tg(this.id,e,t);let s=this._engine.statesByElement.get(t);s||(sg(t,Of),sg(t,Of+"-"+e),this._engine.statesByElement.set(t,s={}));let a=s[e];const u=new Xm(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&u.absorbOptions(a.options),s[e]=u,a||(a=Zm),u.value!==Qm&&a.value===u.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(a.params,u.params)){const e=[],n=i.matchStyles(a.value,a.params,e),r=i.matchStyles(u.value,u.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{Hf(t,n),Wf(t,r)})}return}const l=df(this._engine.playersByElement,t,[]);l.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=i.matchTransition(a.value,u.value,t,u.params),h=!1;if(!c){if(!r)return;c=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:a,toState:u,player:o,isFallbackTransition:h}),h||(sg(t,Bm),o.onStart(()=>{ag(t,Bm)})),o.onDone(()=>{let e=this.players.indexOf(o);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(o);t>=0&&n.splice(t,1)}}),this.players.push(o),l.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e,n=!1){this._engine.driver.query(t,Df,!0).forEach(t=>{if(t[Km])return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)})}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const o=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,Qm,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&uf(o).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const i=this._triggers[r].fallbackTransition,o=this._engine.statesByElement.get(t)[r]||Zm,s=new Xm(Qm),a=new tg(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:i,fromState:o,toState:s,player:a,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e,!0),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}this.prepareLeaveAnimationListeners(t),r?n.markElementAsRemoved(this.id,t,!1,e):(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}insertNode(t,e){sg(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,o=this._elementListeners.get(i);o&&o.forEach(e=>{if(e.name==n.triggerName){const r=pf(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,cf(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),!!this._queue.find(e=>e.element===t)||e}}class Jm{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new Ym(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(eg(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!eg(e))return;const i=e[Km];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),sg(t,Vm)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),ag(t,Vm))}removeNode(t,e,n,r){if(eg(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e[Km]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return eg(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,Df,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,Ff,!0)).forEach(t=>this.finishActiveQueriedAnimationOnElement(t))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return uf(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Km];if(e&&e.setForRemoval){if(t[Km]=$m,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,jm)&&this.markElementAsDisabled(t,!1),this.driver.query(t,jm,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)sg(this.collectedEnterElements[n],Wm);if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?uf(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new ym,r=[],i=new Map,o=[],s=new Map,a=new Map,u=new Map,l=new Set;this.disabledNodes.forEach(t=>{l.add(t);const e=this.driver.query(t,Um,!0);for(let n=0;n<e.length;n++)l.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),p=ig(h,this.collectedEnterElements),d=new Map;let f=0;p.forEach((t,e)=>{const n=Af+f++;d.set(e,n),t.forEach(t=>sg(t,n))});const m=[],g=new Set,y=new Set;for(let A=0;A<this.collectedLeaveElements.length;A++){const t=this.collectedLeaveElements[A],e=t[Km];e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,Hm,!0).forEach(t=>g.add(t)):y.add(t))}const v=new Map,b=ig(h,Array.from(g));b.forEach((t,e)=>{const n=Rf+f++;v.set(e,n),t.forEach(t=>sg(t,n))}),t.push(()=>{p.forEach((t,e)=>{const n=d.get(e);t.forEach(t=>ag(t,n))}),b.forEach((t,e)=>{const n=v.get(e);t.forEach(t=>ag(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const w=[],x=[];for(let A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(w.push(e),this.collectedEnterElements.length){const t=i[Km];if(t&&t.setForMove)return void e.destroy()}const l=!c||!this.driver.containsElement(c,i),h=v.get(i),p=d.get(i),f=this._buildInstruction(t,n,p,h,l);if(!f.errors||!f.errors.length)return l?(e.onStart(()=>Hf(i,f.fromStyles)),e.onDestroy(()=>Wf(i,f.toStyles)),void r.push(e)):t.isFallbackTransition?(e.onStart(()=>Hf(i,f.fromStyles)),e.onDestroy(()=>Wf(i,f.toStyles)),void r.push(e)):(f.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,f.timelines),o.push({instruction:f,player:e,element:i}),f.queriedElements.forEach(t=>df(s,t,[]).push(e)),f.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=a.get(e);t||a.set(e,t=new Set),n.forEach(e=>t.add(e))}}),void f.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=u.get(e);r||u.set(e,r=new Set),n.forEach(t=>r.add(t))}));x.push(f)});if(x.length){const t=[];x.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),w.forEach(t=>t.destroy()),this.reportError(t)}const _=new Map,C=new Map;o.forEach(t=>{const e=t.element;n.has(e)&&(C.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,_))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{df(_,e,[]).push(t),t.destroy()})});const S=m.filter(t=>lg(t,a,u)),E=new Map;rg(E,this.driver,y,u,Jd).forEach(t=>{lg(t,a,u)&&S.push(t)});const k=new Map;p.forEach((t,e)=>{rg(k,this.driver,new Set(t),a,sf)}),S.forEach(t=>{const e=E.get(t),n=k.get(t);E.set(t,Object.assign({},e,n))});const N=[],I=[],T={};o.forEach(t=>{const{element:e,player:o,instruction:s}=t;if(n.has(e)){if(l.has(e))return o.onDestroy(()=>Wf(e,s.toStyles)),o.disabled=!0,o.overrideTotalTime(s.totalTime),void r.push(o);let t=T;if(C.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=C.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>C.set(e,t))}const n=this._buildAnimation(o.namespaceId,s,_,i,k,E);if(o.setRealPlayer(n),t===T)N.push(o);else{const e=this.playersByElement.get(t);e&&e.length&&(o.parentPlayer=uf(e)),r.push(o)}}else Hf(e,s.fromStyles),o.onDestroy(()=>Wf(e,s.toStyles)),I.push(o),l.has(e)&&r.push(o)}),I.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=uf(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let A=0;A<m.length;A++){const t=m[A],e=t[Km];if(ag(t,Rf),e&&e.hasAnimation)continue;let n=[];if(s.size){let e=s.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,Ff,!0);for(let t=0;t<r.length;t++){let e=s.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?ug(this,t,r):this.processLeaveNode(t)}return m.length=0,N.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),N}elementContainsData(t,e){let n=!1;const r=e[Km];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let o=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(o=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||i==Qm;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&o.push(e)})}}return(n||r)&&(o=o.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),o}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,o=e.isRemovalTransition?void 0:e.triggerName;for(const s of e.timelines){const t=s.element,a=t!==r,u=df(n,t,[]);this._getPreviousPlayers(t,a,i,o,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),u.push(t)})}Hf(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,o){const s=e.triggerName,a=e.element,u=[],l=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;l.add(h);const p=h[Km];if(p&&p.removedBeforeQueried)return new rf(e.duration,e.delay);const d=h!==a,f=function(t){const e=[];return function t(e,n){for(let r=0;r<e.length;r++){const i=e[r];i instanceof of?t(i.players,n):n.push(i)}}((n.get(h)||qm).map(t=>t.getRealPlayer()),e),e}().filter(t=>!!t.element&&t.element===h),m=i.get(h),g=o.get(h),y=lf(0,this._normalizer,0,e.keyframes,m,g),v=this._buildPlayer(e,y,f);if(e.subTimeline&&r&&c.add(h),d){const e=new tg(t,s,h);e.setRealPlayer(v),u.push(e)}return v});u.forEach(t=>{df(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>(function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e)){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e]){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r})(this.playersByQueriedElement,t.element,t))}),l.forEach(t=>sg(t,Pf));const p=uf(h);return p.onDestroy(()=>{l.forEach(t=>ag(t,Pf)),Wf(a,e.toStyles)}),c.forEach(t=>{df(r,t,[]).push(p)}),p}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new rf(t.duration,t.delay)}}class tg{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new rf,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>cf(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){df(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function eg(t){return t&&1===t.nodeType}function ng(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function rg(t,e,n,r,i){const o=[];n.forEach(t=>o.push(ng(t)));const s=[];r.forEach((n,r)=>{const o={};n.forEach(t=>{const n=o[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r[Km]=Gm,s.push(r))}),t.set(r,o)});let a=0;return n.forEach(t=>ng(t,o[a++])),s}function ig(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;return e.forEach(t=>{const e=function t(e){if(!e)return 1;let o=i.get(e);if(o)return o;const s=e.parentNode;return o=n.has(s)?s:r.has(s)?1:t(s),i.set(e,o),o}(t);1!==e&&n.get(e).push(t)}),n}const og="$$classes";function sg(t,e){if(t.classList)t.classList.add(e);else{let n=t[og];n||(n=t[og]={}),n[e]=!0}}function ag(t,e){if(t.classList)t.classList.remove(e);else{let n=t[og];n&&delete n[e]}}function ug(t,e,n){uf(n).onDone(()=>t.processLeaveNode(e))}function lg(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class cg{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new Jm(t,e,n),this._timelineEngine=new zm(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const o=t+"-"+r;let s=this._triggerCache[o];if(!s){const t=[],e=lm(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);s=function(t,e){return new Fm(t,e)}(r,e),this._triggerCache[o]=s}this._transitionEngine.registerTrigger(e,r,s)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=ff(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=ff(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function hg(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=dg(e[0]),e.length>1&&(r=dg(e[e.length-1]))):e&&(n=dg(e)),n||r?new pg(t,n,r):null}let pg=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&Wf(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Wf(this._element,this._initialStyles),this._endStyles&&(Wf(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Hf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Hf(this._element,this._endStyles),this._endStyles=null),Wf(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function dg(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];fg(i)&&((e=e||{})[i]=t[i])}return e}function fg(t){return"display"===t||"position"===t}const mg=3,gg="animation",yg="animationend",vg=1e3;class bg{constructor(t,e,n,r,i,o,s){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=Eg(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),Sg(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),Cg(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){wg(this._element,this._name,"paused")}resume(){wg(this._element,this._name,"running")}setPosition(t){const e=xg(this._element,this._name);this._position=t*this._duration,Sg(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=parseFloat(t.elapsedTime.toFixed(mg))*vg;t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),Cg(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=Eg(t,"").split(","),r=_g(n,e);r>=0&&(n.splice(r,1),Sg(t,"",n.join(",")))}(this._element,this._name))}}function wg(t,e,n){Sg(t,"PlayState",n,xg(t,e))}function xg(t,e){const n=Eg(t,"");return n.indexOf(",")>0?_g(n.split(","),e):_g([n],e)}function _g(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function Cg(t,e,n){n?t.removeEventListener(yg,e):t.addEventListener(yg,e)}function Sg(t,e,n,r){const i=gg+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function Eg(t,e){return t.style[gg+e]}const kg="forwards",Ng="linear";class Ig{constructor(t,e,n,r,i,o,s,a){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=s,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||Ng,this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new bg(this.element,this.animationName,this._duration,this._delay,this.easing,kg,()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:em(this.element,n))})}this.currentSnapshot=t}}class Tg extends rf{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=Ef(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}const Ag="gen_css_kf_",Rg=" ";class Og{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(t){return xf(t)}matchesElement(t,e){return _f(t,e)}containsElement(t,e){return Cf(t,e)}query(t,e,n){return Sf(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>Ef(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=Rg;const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=Rg,Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const o=document.createElement("style");return o.innerHTML=r,o}animate(t,e,n,r,i,o=[],s){s&&this._notifyFaultyScrubber();const a=o.filter(t=>t instanceof Ig),u={};Yf(n,r)&&a.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>u[t]=e[t])});const l=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=Jf(t,e,u));if(0==n)return new Tg(t,l);const c=`${Ag}${this._count++}`,h=this.buildKeyframeElement(t,c,e);document.querySelector("head").appendChild(h);const p=hg(t,e),d=new Ig(t,e,c,n,r,i,l,p);return d.onDestroy(()=>(function(t){h.parentNode.removeChild(h)})()),d}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class Dg{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:em(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class Pg{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(Fg().toString()),this._cssKeyframesDriver=new Og}validateStyleProperty(t){return xf(t)}matchesElement(t,e){return _f(t,e)}containsElement(t,e){return Cf(t,e)}query(t,e,n){return Sf(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,o=[],s){if(!s&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,o);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const u={},l=o.filter(t=>t instanceof Dg);Yf(n,r)&&l.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>u[t]=e[t])});const c=hg(t,e=Jf(t,e=e.map(t=>Uf(t,!1)),u));return new Dg(t,e,a,c)}}function Fg(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let Mg=(()=>(class extends Zd{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:oe.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?tf(t):t;return Bg(this._renderer,null,e,"register",[n]),new Lg(e,this._renderer)}}))();class Lg extends Yd{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new zg(this._id,t,e||{},this._renderer)}}class zg{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return Bg(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){return 0}}function Bg(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}const Ug="@",Vg="@.disabled";let jg=(()=>(class{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new Wg("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;return this._currentId++,this.engine.register(i,t),e.data.animation.forEach(e=>this.engine.registerTrigger(r,i,t,e.name,e)),new Hg(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}))();class Wg{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==Ug&&e==Vg?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class Hg extends Wg{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==Ug?"."==e.charAt(1)&&e==Vg?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if(e.charAt(0)==Ug){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),o="";return i.charAt(0)!=Ug&&([i,o]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,o,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let qg=(()=>(class extends cg{constructor(t,e,n){super(t.body,e,n)}}))();function $g(){return"function"==typeof Fg()?new Pg:new Og}function Gg(){return new Tm}function Kg(t,e,n){return new jg(t,e,n)}const Xg=new It("AnimationModuleType");let Qg=(()=>(class{}))();var Zg=nr({encapsulation:2,styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media (hover:none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-flat-button,.mat-icon-button,.mat-stroked-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-flat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-focus-overlay,.mat-stroked-button .mat-button-ripple.mat-ripple{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button .mat-icon,.mat-icon-button i{line-height:24px}.mat-button-focus-overlay,.mat-button-ripple.mat-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}@media (-ms-high-contrast:active){.mat-button-focus-overlay{background-color:#fff}}@media (-ms-high-contrast:black-on-white){.mat-button-focus-overlay{background-color:#000}}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}@media (-ms-high-contrast:active){.mat-button,.mat-fab,.mat-flat-button,.mat-icon-button,.mat-mini-fab,.mat-raised-button{outline:solid 1px}}"],data:{}});function Yg(t){return hs(2,[Yo(671088640,1,{ripple:0}),(t()(),Go(1,0,null,null,1,"span",[["class","mat-button-wrapper"]],null,null,null,null,null)),rs(null,0),(t()(),Go(3,0,null,null,1,"div",[["class","mat-button-ripple mat-ripple"],["matRipple",""]],[[2,"mat-button-ripple-round",null],[2,"mat-ripple-unbounded",null]],null,null,null,null)),pi(4,212992,[[1,4]],0,Dd,[ln,ao,td,[2,Od],[2,Xg]],{centered:[0,"centered"],disabled:[1,"disabled"],trigger:[2,"trigger"]},null),(t()(),Go(5,0,null,null,0,"div",[["class","mat-button-focus-overlay"]],null,null,null,null,null))],function(t,e){var n=e.component;t(e,4,0,n.isIconButton,n._isRippleDisabled(),n._getHostElement())},function(t,e){var n=e.component;t(e,3,0,n.isRoundButton||n.isIconButton,Jr(e,4).unbounded)})}class Jg{constructor(t){this.router=t}ngOnInit(){}navigateToHome(){this.router.navigateByUrl("/")}}var ty=nr({encapsulation:0,styles:[[".header-text[_ngcontent-%COMP%]:hover{cursor:pointer}.header-text[_ngcontent-%COMP%]:focus{outline:0}"]],data:{}});function ey(t){return hs(0,[(t()(),Go(0,0,null,null,8,"mat-toolbar",[["class","mat-toolbar"]],[[2,"mat-toolbar-multiple-rows",null],[2,"mat-toolbar-single-row",null]],null,null,qd,Hd)),pi(1,4243456,null,1,Bd,[ln,td,Ua],null,null),Yo(603979776,1,{_toolbarRows:1}),(t()(),Go(3,0,null,1,5,"mat-toolbar-row",[["class","mat-toolbar-row"]],null,null,null,null,null)),pi(4,16384,[[1,4]],0,zd,[],null,null),(t()(),Go(5,0,null,null,3,"button",[["mat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.navigateToHome()&&r),r},Yg,Zg)),pi(6,180224,null,0,Xd,[ln,gd,[2,Xg]],null,null),(t()(),Go(7,0,null,0,1,"h1",[],null,null,null,null,null)),(t()(),us(-1,null,["A Simple Image Classifier"]))],null,function(t,e){t(e,0,0,Jr(e,1)._toolbarRows.length>0,0===Jr(e,1)._toolbarRows.length),t(e,5,0,Jr(e,6).disabled||null,"NoopAnimations"===Jr(e,6)._animationMode)})}let ny=(()=>(class{}))(),ry=(()=>(class{}))(),iy=(()=>(class{constructor(){this.align="start"}}))(),oy=(()=>(class{}))(),sy=(()=>(class{constructor(t){this._animationMode=t}}))(),ay=(()=>(class{}))();var uy=nr({encapsulation:2,styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(.4,0,.2,1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}@media (-ms-high-contrast:active){.mat-card{outline:solid 1px}}.mat-card-actions,.mat-card-content,.mat-card-subtitle{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media (max-width:599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card-content>:first-child,.mat-card>:first-child{margin-top:0}.mat-card-content>:last-child:not(.mat-card-footer),.mat-card>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child{margin-left:0;margin-right:0}.mat-card-subtitle:not(:first-child),.mat-card-title:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],data:{}});function ly(t){return hs(2,[rs(null,0),rs(null,1)],null,null)}class cy{}class hy{}class py{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),r=n.toLowerCase(),i=t.slice(e+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof py?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new py;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof py?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const i=t.value;if(i){let t=this.headers.get(e);if(!t)return;0===(t=t.filter(t=>-1===i.indexOf(t))).length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class dy{encodeKey(t){return fy(t)}encodeValue(t){return fy(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function fy(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class my{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new dy,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.split("&").forEach(t=>{const r=t.indexOf("="),[i,o]=-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],s=n.get(i)||[];s.push(o),n.set(i,s)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).join("&")}clone(t){const e=new my({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function gy(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function yy(t){return"undefined"!=typeof Blob&&t instanceof Blob}function vy(t){return"undefined"!=typeof FormData&&t instanceof FormData}class by{constructor(t,e,n,r){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new py),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new my,this.urlWithParams=e}serializeBody(){return null===this.body?null:gy(this.body)||yy(this.body)||vy(this.body)||"string"==typeof this.body?this.body:this.body instanceof my?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body?null:vy(this.body)?null:yy(this.body)?this.body.type||null:gy(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof my?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let a=t.headers||this.headers,u=t.params||this.params;return void 0!==t.setHeaders&&(a=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),a)),t.setParams&&(u=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),u)),new by(e,n,i,{params:u,headers:a,reportProgress:s,responseType:r,withCredentials:o})}}const wy=function(){var t={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return t[t.Sent]="Sent",t[t.UploadProgress]="UploadProgress",t[t.ResponseHeader]="ResponseHeader",t[t.DownloadProgress]="DownloadProgress",t[t.Response]="Response",t[t.User]="User",t}();class xy{constructor(t,e=200,n="OK"){this.headers=t.headers||new py,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class _y extends xy{constructor(t={}){super(t),this.type=wy.ResponseHeader}clone(t={}){return new _y({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Cy extends xy{constructor(t={}){super(t),this.type=wy.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Cy({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Sy extends xy{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function Ey(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let ky=(()=>(class{constructor(t){this.handler=t}request(t,e,n={}){let r;if(t instanceof by)r=t;else{let i=void 0;i=n.headers instanceof py?n.headers:new py(n.headers);let o=void 0;n.params&&(o=n.params instanceof my?n.params:new my({fromObject:n.params})),r=new by(t,e,void 0!==n.body?n.body:null,{headers:i,params:o,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Ga(r).pipe(Mu(t=>this.handler.handle(t)));if(t instanceof by||"events"===n.observe)return i;const o=i.pipe(ru(t=>t instanceof Cy));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return o.pipe(W(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return o.pipe(W(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return o.pipe(W(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return o.pipe(W(t=>t.body))}case"response":return o;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new my).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,Ey(n,e))}post(t,e,n={}){return this.request("POST",t,Ey(n,e))}put(t,e,n={}){return this.request("PUT",t,Ey(n,e))}}))();class Ny{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const Iy=new It("HTTP_INTERCEPTORS");let Ty=(()=>(class{intercept(t,e){return e.handle(t)}}))();const Ay=/^\)\]\}',?\n/;class Ry{}let Oy=(()=>(class{constructor(){}build(){return new XMLHttpRequest}}))(),Dy=(()=>(class{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new _(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const r=t.serializeBody();let i=null;const o=()=>{if(null!==i)return i;const e=1223===n.status?204:n.status,r=n.statusText||"OK",o=new py(n.getAllResponseHeaders()),s=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return i=new _y({headers:o,status:e,statusText:r,url:s})},s=()=>{let{headers:r,status:i,statusText:s,url:a}=o(),u=null;204!==i&&(u=void 0===n.response?n.responseText:n.response),0===i&&(i=u?200:0);let l=i>=200&&i<300;if("json"===t.responseType&&"string"==typeof u){const t=u;u=u.replace(Ay,"");try{u=""!==u?JSON.parse(u):null}catch(c){u=t,l&&(l=!1,u={error:c,text:u})}}l?(e.next(new Cy({body:u,headers:r,status:i,statusText:s,url:a||void 0})),e.complete()):e.error(new Sy({error:u,headers:r,status:i,statusText:s,url:a||void 0}))},a=t=>{const{url:r}=o(),i=new Sy({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});e.error(i)};let u=!1;const l=r=>{u||(e.next(o()),u=!0);let i={type:wy.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===t.responseType&&n.responseText&&(i.partialText=n.responseText),e.next(i)},c=t=>{let n={type:wy.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",s),n.addEventListener("error",a),t.reportProgress&&(n.addEventListener("progress",l),null!==r&&n.upload&&n.upload.addEventListener("progress",c)),n.send(r),e.next({type:wy.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("load",s),t.reportProgress&&(n.removeEventListener("progress",l),null!==r&&n.upload&&n.upload.removeEventListener("progress",c)),n.abort()}})}}))();const Py=new It("XSRF_COOKIE_NAME"),Fy=new It("XSRF_HEADER_NAME");class My{}let Ly=(()=>(class{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Oa(t,this.cookieName),this.lastCookieString=t),this.lastToken}}))(),zy=(()=>(class{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}))(),By=(()=>(class{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(Iy,[]);this.chain=t.reduceRight((t,e)=>new Ny(t,e),this.backend)}return this.chain.handle(t)}}))(),Uy=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:zy,useClass:Ty}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:Py,useValue:e.cookieName}:[],e.headerName?{provide:Fy,useValue:e.headerName}:[]]}}}return t})(),Vy=(()=>(class{}))();class jy extends j{constructor(t,e){super(t),this.sources=e,this.completed=0,this.haveValues=0;const n=e.length;this.values=new Array(n);for(let r=0;r<n;r++){const t=V(this,e[r],null,r);t&&this.add(t)}}notifyNext(t,e,n,r,i){this.values[n]=e,i._hasValue||(i._hasValue=!0,this.haveValues++)}notifyComplete(t){const{destination:e,haveValues:n,values:r}=this,i=r.length;t._hasValue?(this.completed++,this.completed===i&&(n===i&&e.next(r),e.complete())):e.complete()}}function Wy(t){return Error(`Unable to find icon with the name "${t}"`)}function Hy(t){return Error("The URL provided to MatIconRegistry was not trusted as a resource URL "+`via Angular's DomSanitizer. Attempted URL was "${t}".`)}function qy(t){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by "+`Angular's DomSanitizer. Attempted literal was "${t}".`)}class $y{constructor(t){t.nodeName?this.svgElement=t:this.url=t}}let Gy=(()=>{class t{constructor(t,e,n){this._httpClient=t,this._sanitizer=e,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=n}addSvgIcon(t,e){return this.addSvgIconInNamespace("",t,e)}addSvgIconLiteral(t,e){return this.addSvgIconLiteralInNamespace("",t,e)}addSvgIconInNamespace(t,e,n){return this._addSvgIconConfig(t,e,new $y(n))}addSvgIconLiteralInNamespace(t,e,n){const r=this._sanitizer.sanitize(Re.HTML,n);if(!r)throw qy(n);const i=this._createSvgElementForSingleIcon(r);return this._addSvgIconConfig(t,e,new $y(i))}addSvgIconSet(t){return this.addSvgIconSetInNamespace("",t)}addSvgIconSetLiteral(t){return this.addSvgIconSetLiteralInNamespace("",t)}addSvgIconSetInNamespace(t,e){return this._addSvgIconSetConfig(t,new $y(e))}addSvgIconSetLiteralInNamespace(t,e){const n=this._sanitizer.sanitize(Re.HTML,e);if(!n)throw qy(e);const r=this._svgElementFromString(n);return this._addSvgIconSetConfig(t,new $y(r))}registerFontClassAlias(t,e=t){return this._fontCssClassesByAlias.set(t,e),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const e=this._sanitizer.sanitize(Re.RESOURCE_URL,t);if(!e)throw Hy(t);const n=this._cachedIconsByUrl.get(e);return n?Ga(Ky(n)):this._loadSvgIconFromConfig(new $y(t)).pipe(hu(t=>this._cachedIconsByUrl.set(e,t)),W(t=>Ky(t)))}getNamedSvgIcon(t,e=""){const n=Xy(e,t),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);const i=this._iconSetConfigs.get(e);return i?this._getSvgFromIconSetConfigs(t,i):(o=Wy(n),new _(t=>t.error(o)));var o}ngOnDestroy(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgElement?Ga(Ky(t.svgElement)):this._loadSvgIconFromConfig(t).pipe(hu(e=>t.svgElement=e),W(t=>Ky(t)))}_getSvgFromIconSetConfigs(t,e){const n=this._extractIconWithNameFromAnySet(t,e);return n?Ga(n):function t(...e){let n;return"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&l(e[0])&&(e=e[0]),0===e.length?Ha:n?t(e).pipe(W(t=>n(...t))):new _(t=>new jy(t,e))}(e.filter(t=>!t.svgElement).map(t=>this._loadSvgIconSetFromConfig(t).pipe(bu(e=>{const n=this._sanitizer.sanitize(Re.RESOURCE_URL,t.url);return console.error(`Loading icon set URL: ${n} failed: ${e.message}`),Ga(null)})))).pipe(W(()=>{const n=this._extractIconWithNameFromAnySet(t,e);if(!n)throw Wy(t);return n}))}_extractIconWithNameFromAnySet(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.svgElement){const e=this._extractSvgIconFromSet(r.svgElement,t);if(e)return e}}return null}_loadSvgIconFromConfig(t){return this._fetchUrl(t.url).pipe(W(t=>this._createSvgElementForSingleIcon(t)))}_loadSvgIconSetFromConfig(t){return t.svgElement?Ga(t.svgElement):this._fetchUrl(t.url).pipe(W(e=>(t.svgElement||(t.svgElement=this._svgElementFromString(e)),t.svgElement)))}_createSvgElementForSingleIcon(t){const e=this._svgElementFromString(t);return this._setSvgAttributes(e),e}_extractSvgIconFromSet(t,e){const n=t.querySelector(`[id="${e}"]`);if(!n)return null;const r=n.cloneNode(!0);if(r.removeAttribute("id"),"svg"===r.nodeName.toLowerCase())return this._setSvgAttributes(r);if("symbol"===r.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(r));const i=this._svgElementFromString("<svg></svg>");return i.appendChild(r),this._setSvgAttributes(i)}_svgElementFromString(t){const e=this._document.createElement("DIV");e.innerHTML=t;const n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(t){let e=this._svgElementFromString("<svg></svg>");for(let n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[n].cloneNode(!0));return e}_setSvgAttributes(t){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),t}_fetchUrl(t){if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==t)throw Error(`Cannot fetch icon from URL "${t}".`);const e=this._sanitizer.sanitize(Re.RESOURCE_URL,t);if(!e)throw Hy(t);const n=this._inProgressUrlFetches.get(e);if(n)return n;const r=this._httpClient.get(e,{responseType:"text"}).pipe(Lu(()=>this._inProgressUrlFetches.delete(e)),at());return this._inProgressUrlFetches.set(e,r),r}_addSvgIconConfig(t,e,n){return this._svgIconConfigs.set(Xy(t,e),n),this}_addSvgIconSetConfig(t,e){const n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(ky,8),Ut(Ul),Ut(Ua,8))},token:t,providedIn:"root"}),t})();function Ky(t){return t.cloneNode(!0)}function Xy(t,e){return t+":"+e}class Qy{constructor(t){this._elementRef=t}}const Zy=_d(Qy),Yy=new It("mat-icon-location",{providedIn:"root",factory:function(){const t=Vt(Ua),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),Jy=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],tv=Jy.map(t=>`[${t}]`).join(", "),ev=/^url\(['"]?#(.*?)['"]?\)$/;let nv=(()=>(class extends Zy{constructor(t,e,n,r){super(t),this._iconRegistry=e,this._location=r,this._inline=!1,n||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=Kp(t)}get fontSet(){return this._fontSet}set fontSet(t){this._fontSet=this._cleanupFontValue(t)}get fontIcon(){return this._fontIcon}set fontIcon(t){this._fontIcon=this._cleanupFontValue(t)}_splitIconName(t){if(!t)return["",""];const e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnChanges(t){const e=t.svgIcon;if(e)if(this.svgIcon){const[t,e]=this._splitIconName(this.svgIcon);this._iconRegistry.getNamedSvgIcon(e,t).pipe(_u(1)).subscribe(t=>this._setSvgElement(t),t=>console.log(`Error retrieving icon: ${t.message}`))}else e.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}ngOnInit(){this._usingFontIcon()&&this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&this._location&&t.size){const t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const e=t.querySelectorAll("style");for(let n=0;n<e.length;n++)e[n].textContent+=" ";if(this._location){const e=this._location.getPathname();this._previousPath=e,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(e)}this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){const n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,e=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();e!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),e&&t.classList.add(e),this._previousFontSetClass=e),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const e=this._elementsWithExternalReferences;e&&e.forEach((e,n)=>{e.forEach(e=>{n.setAttribute(e.name,`url('${t}#${e.value}')`)})})}_cacheChildrenWithExternalReferences(t){const e=t.querySelectorAll(tv),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<e.length;r++)Jy.forEach(t=>{const i=e[r],o=i.getAttribute(t),s=o?o.match(ev):null;if(s){let e=n.get(i);e||n.set(i,e=[]),e.push({name:t,value:s[1]})}})}}))(),rv=(()=>(class{}))();var iv=nr({encapsulation:2,styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1,1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],data:{}});function ov(t){return hs(2,[rs(null,0)],null,null)}class sv{constructor(){}ngOnInit(){}}var av=nr({encapsulation:0,styles:[[".home__options-wrap[_ngcontent-%COMP%]{display:-webkit-box;display:flex;flex-wrap:wrap;-webkit-box-flex:1;flex-grow:1;-webkit-box-pack:center;justify-content:center}.home__options-card-wrap[_ngcontent-%COMP%]{color:#fff;margin:20px}.home__options-card-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:128px;height:128px}.home__options-card-wrap[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]:hover{cursor:pointer;color:#fff;background-color:rgba(0,0,0,.87)}.home__options-card-wrap[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{fill:#fff}.home__options-card-wrap[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{text-align:center}.home__options-btn-wrap[_ngcontent-%COMP%]{margin-top:20px}"]],data:{}});function uv(t){return hs(0,[(t()(),Go(0,0,null,null,1,"app-header",[],null,null,null,ey,ty)),pi(1,114688,null,0,Jg,[gp],null,null),(t()(),Go(2,0,null,null,23,"div",[["class","home-container"]],null,null,null,null,null)),(t()(),Go(3,0,null,null,22,"div",[["class","home__options-wrap"]],null,null,null,null,null)),(t()(),Go(4,0,null,null,10,"div",[["class","home__options-card-wrap"]],null,null,null,null,null)),(t()(),Go(5,0,null,null,9,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Jr(t,6).onClick()&&r),r},ly,uy)),pi(6,16384,null,0,yp,[gp,oh,[8,null],fn,ln],{routerLink:[0,"routerLink"]},null),ss(7,1),pi(8,49152,null,0,sy,[[2,Xg]],null,null),(t()(),Go(9,0,null,0,5,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),pi(10,16384,null,0,ny,[],null,null),(t()(),Go(11,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),Go(12,0,null,null,1,"mat-icon",[["class","mat-icon notranslate"],["role","img"],["svgIcon","image"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],null,null,ov,iv)),pi(13,9158656,null,0,nv,[ln,Gy,[8,null],[2,Yy]],{svgIcon:[0,"svgIcon"]},null),(t()(),us(-1,null,[" Upload Image "])),(t()(),Go(15,0,null,null,10,"div",[["class","home__options-card-wrap"]],null,null,null,null,null)),(t()(),Go(16,0,null,null,9,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Jr(t,17).onClick()&&r),r},ly,uy)),pi(17,16384,null,0,yp,[gp,oh,[8,null],fn,ln],{routerLink:[0,"routerLink"]},null),ss(18,1),pi(19,49152,null,0,sy,[[2,Xg]],null,null),(t()(),Go(20,0,null,0,5,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),pi(21,16384,null,0,ny,[],null,null),(t()(),Go(22,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),Go(23,0,null,null,1,"mat-icon",[["class","mat-icon notranslate"],["role","img"],["svgIcon","videocam"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],null,null,ov,iv)),pi(24,9158656,null,0,nv,[ln,Gy,[8,null],[2,Yy]],{svgIcon:[0,"svgIcon"]},null),(t()(),us(-1,null,[" Use Webcam "]))],function(t,e){t(e,1,0);var n=t(e,7,0,"classifier/image");t(e,6,0,n),t(e,13,0,"image");var r=t(e,18,0,"classifier/video");t(e,17,0,r),t(e,24,0,"videocam")},function(t,e){t(e,5,0,"NoopAnimations"===Jr(e,8)._animationMode),t(e,12,0,Jr(e,13).inline,"primary"!==Jr(e,13).color&&"accent"!==Jr(e,13).color&&"warn"!==Jr(e,13).color),t(e,16,0,"NoopAnimations"===Jr(e,19)._animationMode),t(e,23,0,Jr(e,24).inline,"primary"!==Jr(e,24).color&&"accent"!==Jr(e,24).color&&"warn"!==Jr(e,24).color)})}function lv(t){return hs(0,[(t()(),Go(0,0,null,null,1,"app-home",[],null,null,null,uv,av)),pi(1,114688,null,0,sv,[],null,null)],function(t,e){t(e,1,0)},null)}var cv=jr("app-home",sv,lv,{},{},[]);function hv(t){return e=>e.lift(new pv(t))}class pv{constructor(t){this.notifier=t}call(t,e){const n=new dv(t),r=V(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class dv extends j{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,n,r,i){this.seenValue=!0,this.complete()}notifyComplete(){}}class fv{}const mv=Cd(fv);class gv{}const yv=Cd(gv);let vv=(()=>(class extends mv{constructor(){super(...arguments),this._stateChanges=new I}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}))(),bv=(()=>(class extends mv{constructor(t){super(),this._elementRef=t,this._stateChanges=new I,"action-list"===this._getListType()&&t.nativeElement.classList.add("mat-action-list")}_getListType(){const t=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===t?"list":"mat-action-list"===t?"action-list":null}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}))(),wv=(()=>(class extends yv{constructor(t,e,n,r){super(),this._element=t,this._isInteractiveList=!1,this._destroyed=new I,this._isInteractiveList=!!(n||r&&"action-list"===r._getListType()),this._list=n||r;const i=this._getHostElement();"button"!==i.nodeName.toLowerCase()||i.hasAttribute("type")||i.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(hv(this._destroyed)).subscribe(()=>{e.markForCheck()})}ngAfterContentInit(){var t,e;e=this._element,(t=this._lines).changes.pipe(Ou(t)).subscribe(({length:t})=>{Sd(e,"mat-2-line",!1),Sd(e,"mat-3-line",!1),Sd(e,"mat-multi-line",!1),2===t||3===t?Sd(e,`mat-${t}-line`,!0):t>3&&Sd(e,"mat-multi-line",!0)})}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}))(),xv=(()=>(class{}))(),_v=(()=>(class{}))();var Cv=nr({encapsulation:2,styles:[".mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:400;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:400;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:0}mat-action-list button{background:0 0;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:0}@media (-ms-high-contrast:active){.mat-selection-list:focus{outline-style:dotted}.mat-list-option:focus,.mat-list-option:hover,.mat-nav-list .mat-list-item:focus,.mat-nav-list .mat-list-item:hover,mat-action-list .mat-list-item:focus,mat-action-list .mat-list-item:hover{outline:dotted 1px}}@media (hover:none){.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover{background:0 0}}"],data:{}});function Sv(t){return hs(2,[rs(null,0)],null,null)}var Ev=nr({encapsulation:2,styles:[],data:{}});function kv(t){return hs(2,[(t()(),Go(0,0,null,null,6,"div",[["class","mat-list-item-content"]],null,null,null,null,null)),(t()(),Go(1,0,null,null,1,"div",[["class","mat-list-item-ripple mat-ripple"],["mat-ripple",""]],[[2,"mat-ripple-unbounded",null]],null,null,null,null)),pi(2,212992,null,0,Dd,[ln,ao,td,[2,Od],[2,Xg]],{disabled:[0,"disabled"],trigger:[1,"trigger"]},null),rs(null,0),(t()(),Go(4,0,null,null,1,"div",[["class","mat-list-text"]],null,null,null,null,null)),rs(null,1),rs(null,2)],function(t,e){var n=e.component;t(e,2,0,n._isRippleDisabled(),n._getHostElement())},function(t,e){t(e,1,0,Jr(e,2).unbounded)})}class Nv{transform(t,...e){return t.toFixed(2).concat("%")}}var Iv=function(t,e){return(Iv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Tv(t,e){function n(){this.constructor=t}Iv(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Av=function(){return(Av=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Rv(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})}function Ov(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var Dv=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e=Pv(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach(function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])})}},t}();function Pv(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")}),e}var Fv=null;function Mv(t){Fv=t}var Lv=Object.freeze({Environment:Dv,getQueryParams:Pv,get ENV(){return Fv},setEnvironmentGlobal:Mv});function zv(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function Bv(t,e,n){return Math.max(t,Math.min(e,n))}function Uv(t){return t%2==0?t:t+1}function Vv(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function jv(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function Wv(t,e,n){void 0===n&&(n=""),jv(Gv(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})}function Hv(t){jv(null!=t,function(){return"The input to the tensor constructor must be a non-null value."})}function qv(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||ub(t)&&!n)for(var r=0;r<t.length;++r)qv(t[r],e,n);else e.push(t);return e}function $v(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function Gv(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Kv(t){return t%1==0}function Xv(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function Qv(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Zv(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Yv(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise(function(r,i){var o=0,s=function(){if(t())r();else{var a=e(++o);null!=n&&o>=n?i():setTimeout(s,a)}};s()})}function Jv(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function tb(t,e){var n=e.length;return jv((t=null==t?e.map(function(t,e){return e}):[].concat(t)).every(function(t){return t>=-n&&t<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t}),jv(t.every(function(t){return Kv(t)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(t){return t<0?n+t:t})}function eb(t,e){for(var n=[],r=[],i=null==e?null:tb(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function nb(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function rb(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function ib(t,e,n){if("float32"===e)for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))throw Error("The result of the '"+n+"' is "+i+".")}}function ob(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function sb(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function ab(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function ub(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function lb(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function cb(t){if(null==t)return 0;var e=0;return t.forEach(function(t){return e+=t.length}),e}function hb(t){return"string"==typeof t||t instanceof String}function pb(t){return"boolean"==typeof t}function db(t){return"number"==typeof t}function fb(t){return Array.isArray(t)?fb(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":db(t)?"float32":hb(t)?"string":pb(t)?"bool":"float32"}function mb(t){return!!(t&&t.constructor&&t.call&&t.apply)}function gb(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function yb(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function vb(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=qv(t)),n&&ob(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function bb(t,e){if(0===t.length)return e[0];var n=t.reduce(function(t,e){return t*e});if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],s=0;s<o;s++)i[s]=r[e+s];else{o=n[0];var a=n.slice(1),u=a.reduce(function(t,e){return t*e});for(s=0;s<o;s++)i[s]=t(e+s*u,a,r)}return i}(0,t,e)}function wb(t,e){for(var n=xb(t,e),r=0;r<n.length;r++)n[r]=1;return n}function xb(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function _b(){return Fv.platform.now()}function Cb(t){t.forEach(function(e){jv(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function Sb(t,e){return Fv.platform.fetch(t,e)}function Eb(t,e){return void 0===e&&(e="utf-8"),Fv.platform.encode(t,e=e||"utf-8")}function kb(t,e){return void 0===e&&(e="utf-8"),Fv.platform.decode(t,e=e||"utf-8")}var Nb=Object.freeze({shuffle:zv,clamp:Bv,nearestLargerEven:Uv,sum:Vv,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:jv,assertShapesMatch:Wv,assertNonNull:Hv,flatten:qv,sizeFromShape:$v,isScalarShape:function(t){return 0===t.length},arraysEqual:Gv,isInt:Kv,tanh:Xv,sizeToSquarishShape:Qv,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return zv(e),e},rightPad:Zv,repeatedTry:Yv,inferFromImplicitShape:Jv,parseAxisParam:tb,squeezeShape:eb,getTypedArrayFromDType:nb,getArrayFromDType:rb,checkComputationForErrors:ib,checkConversionForErrors:ob,isValidDtype:sb,hasEncodingLoss:ab,isTypedArray:ub,bytesPerElement:lb,bytesFromStringArray:cb,isString:hb,isBoolean:pb,isNumber:db,inferDtype:fb,isFunction:mb,nearestDivisor:gb,computeStrides:yb,toTypedArray:vb,toNestedArray:bb,makeOnesTypedArray:wb,makeZerosTypedArray:xb,now:_b,assertNonNegativeIntegerDimensions:Cb,fetch:Sb,encodeString:Eb,decodeString:kb}),Ib=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Tb)}return t.prototype.profileKernel=function(t,e){var n,r=this,i=this.backendTimer.time(function(){n=e()});return(Array.isArray(n)?n:[n]).forEach(function(e){var n=e.dataSync();ib(n,e.dtype,t),i.then(function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),r.logger.logKernelProfile(t,e,n,i.kernelMs,o)})}),n},t}(),Tb=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i){var o=Zv(r+"ms",9),s=Zv(t,25),a=e.rank,u=e.size,l=Zv(e.shape.toString(),14);console.log("%c"+s+"\t%c"+o+"\t%c"+a+"D "+l+"\t%c"+u+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green")},t}(),Ab=7;function Rb(t,e,n){return Zv(Array.isArray(t)?parseFloat(t[0].toFixed(Ab))+" + "+parseFloat(t[1].toFixed(Ab))+"j":hb(t)?"'"+t+"'":"bool"===n?Ob(t):parseFloat(t.toFixed(Ab)).toString(),e)}function Ob(t){return 0===t?"false":"true"}function Db(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var Pb=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=$v(t),null!=n){var i=n.length;jv(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."})}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||rb(e,this.size),this.strides=yb(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),jv(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}n++}for(var a=t[t.length-1],u=0;u<t.length-1;++u)a+=this.strides[u]*t[u];return this.values[a]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return zb.make(this.shape,{values:this.values},this.dtype)},t}(),Fb=null,Mb=null,Lb=null,zb=function(){function t(t,e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=$v(t),this.strides=yb(t),this.dataId=null!=r?r:{},this.id=Fb().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",Fb().registerTensor(this,i),null!=n&&Fb().write(i,this.dataId,n)}return t.make=function(e,n,r,i){var o=n.values;return null!=n.values&&"string"===r&&hb(n.values[0])&&(o=n.values.map(function(t){return Eb(t)})),new t(e,r,o,n.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),jv(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),Mb.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Mb.buffer(this.shape,this.dtype,t)]}})})},t.prototype.bufferSync=function(){return Mb.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,bb(this.shape,t)]}})})},t.prototype.arraySync=function(){return bb(this.shape,this.dataSync())},t.prototype.data=function(){return Rv(this,void 0,void 0,function(){var t,e;return Ov(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=Fb().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map(function(t){return kb(t)})]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var t=Fb().readSync(this.dataId);if("string"===this.dtype)try{return t.map(function(t){return kb(t)})}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Fb().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(Fb().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),Mb.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),Mb.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),Mb.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),Mb.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),Mb.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),Mb.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),Mb.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=yb(e),o=function(t,e,n,r){var i=$v(e),o=r[r.length-1],s=new Array(o).fill(0),a=e.length,u="complex64"===n?Db(t):t;if(a>1)for(var l=0;l<i/o;l++)for(var c=l*o,h=0;h<o;h++)s[h]=Math.max(s[h],Rb(u[c+h],0,n).length);return s}(t,e,n,i),s=e.length,a=function t(e,n,r,i,o,s){void 0===s&&(s=!0);var a="complex64"===r?2:1,u=n[0],l=n.length;if(0===l)return"complex64"===r?[Rb(Db(e)[0],0,r)]:"bool"===r?[Ob(e[0])]:[e[0].toString()];if(1===l){if(u>20){var c=Array.from(e.slice(0,3*a)),h=Array.from(e.slice(u-3*a,u));return"complex64"===r&&(c=Db(c),h=Db(h)),["["+c.map(function(t,e){return Rb(t,o[e],r)}).join(", ")+", ..., "+h.map(function(t,e){return Rb(t,o[u-3+e],r)}).join(", ")+"]"]}return["["+("complex64"===r?Db(e):Array.from(e)).map(function(t,e){return Rb(t,o[e],r)}).join(", ")+"]"]}var p=n.slice(1),d=i.slice(1),f=i[0]*a,m=[];if(u>20){for(var g=0;g<3;g++)m.push.apply(m,t(e.slice(y=g*f,y+f),p,r,d,o,!1));for(m.push("..."),g=u-3;g<u;g++)m.push.apply(m,t(e.slice(y=g*f,y+f),p,r,d,o,g===u-1))}else for(g=0;g<u;g++){var y;m.push.apply(m,t(e.slice(y=g*f,y+f),p,r,d,o,g===u-1))}var v=2===l?",":"";for(m[0]="["+m[0]+v,g=1;g<m.length-1;g++)m[g]=" "+m[g]+v;var b=",\n";for(g=2;g<l;g++)b+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(s?"":b),m}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+s),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(a.map(function(t){return"    "+t}).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),Mb.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),Mb.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),Mb.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),Mb.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),Mb.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),Mb.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),Mb.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),Mb.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),Mb.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),Mb.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),Mb.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),Mb.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),Lb("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),Mb.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Mb.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),Mb.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),Mb.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),Mb.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),Mb.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),Mb.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),Mb.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),Mb.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),Mb.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),Mb.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),Mb.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),Mb.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),Mb.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),Mb.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),Mb.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),Mb.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),Mb.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Mb.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),Mb.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Mb.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),Mb.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),Mb.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),Mb.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Mb.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),Mb.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),Mb.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Mb.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),Mb.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),Mb.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),Mb.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),Mb.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),Mb.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Mb.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),Mb.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Mb.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Mb.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Mb.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Mb.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),Mb.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),Mb.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),Mb.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),Mb.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),Mb.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),Mb.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),Mb.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),Mb.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),Mb.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),Mb.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),Mb.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),Mb.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),Mb.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),Mb.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),Mb.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),Mb.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),Mb.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),Mb.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),Mb.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),Mb.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Mb.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),Mb.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),Mb.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),Mb.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),Mb.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),Mb.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),Mb.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),Mb.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),Mb.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),Mb.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),Mb.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),Mb.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),Mb.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),Mb.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),Mb.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),Mb.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),Mb.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),Mb.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),Mb.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),Mb.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),Mb.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),Mb.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),Mb.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),Mb.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),Mb.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),Mb.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),Mb.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),Mb.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),Mb.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),Mb.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),Mb.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),Mb.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),Mb.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),Mb.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),Mb.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Mb.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),Mb.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),Mb.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),Mb.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),Bb.variable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Mb.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Mb.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Mb.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),Mb.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),this.throwIfDisposed(),Mb.stridedSlice(this,t,e,n,r,i,o,s,a)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Mb.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),Mb.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),Mb.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),Mb.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),Mb.spectral.irfft(this)},t}();Object.defineProperty(zb,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var Bb=function(t){function e(e,n,r){void 0===n&&(n=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=Fb().nextVariableId().toString());try{Fb().registerVariable(i)}catch(t){throw Fb().disposeTensor(i),t}return i}return Tv(e,t),e.variable=function(t,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,n,r)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!Gv(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");Fb().disposeTensor(this),this.dataId=t.dataId,Fb().registerTensor(this)},e.prototype.dispose=function(){Fb().disposeVariable(this),this.isDisposedInternal=!0},e}(zb);Object.defineProperty(Bb,Symbol.hasInstance,{value:function(t){return t instanceof zb&&null!=t.assign&&t.assign instanceof Function}});var Ub,Vb,jb,Wb,Hb,qb,$b=Bb.variable;(qb=Ub||(Ub={})).R0="R0",qb.R1="R1",qb.R2="R2",qb.R3="R3",qb.R4="R4",qb.R5="R5",qb.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Vb||(Vb={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(jb||(jb={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Wb||(Wb={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Hb||(Hb={}));var Gb={float32:Wb,int32:Vb,bool:jb,complex64:Hb};function Kb(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return Gb[t][e]}function Xb(t){return Kb(t,"int32")}function Qb(t,e){if(t.dtype===e.dtype)return[t,e];var n=Kb(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Zb(t,e){jv(t.dtype===e.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"})}function Yb(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof zb)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var s in o){var a=o[s];r.has(a)||(r.add(a),t(a,n,r))}}}(t,e,new Set),e}var Jb,tw=Object.freeze({makeTypesMatch:Qb,assertTypesMatch:Zb,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:Yb}),ew=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),nw=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ew}return t.prototype.ready=function(){return Rv(this,void 0,void 0,function(){var t,e,n;return Ov(this,function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return Rv(this,void 0,void 0,function(){var e,n,r;return Ov(this,function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.profiler=new Ib(this.backendInstance),[2,!0]}})})},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then(function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))}).catch(function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){this.write(t,e,this.readSync(e))},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return r.startScope(i)},function(){return r.endScope(n)},function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=zb.make(t.shape,{dataId:t.dataId},t.dtype);return this.addTapeNode([t],e,function(t){return[t.toFloat()]}),e},t.prototype.runKernel=function(t,e,n){var r,i=this,o=[],s=this.isTapeOn(),a=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(t){s&&(o=t.map(function(t){return i.keep(i.clone(t))}))},l=this.state.numBytes,c=this.state.numTensors;if(this.scopedRun(function(){return i.state.kernelDepth++},function(){return i.state.kernelDepth--},function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(a,function(){return t(i.backend,u)}):t(i.backend,u)}),s){var h={id:this.state.nextTapeNodeId++,name:a,inputs:e,outputs:Array.isArray(r)?r:[r],saved:o};null!=n&&(h.gradient=function(t){return n(t,o)}),this.state.activeTape.push(h)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-l,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-c,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(t){return e[t].shape}),outputShape:Array.isArray(r)?r.map(function(t){return t.shape}):r.shape}),r},t.prototype.registerTensor=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*lb(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:null!=e?e:this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=e?e.register(t.dataId,t.shape,t.dtype):this.backend.register(t.dataId,t.shape,t.dtype)}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Bb||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.state.registeredVariables[t.name])throw new Error("Variable with name "+t.name+" was already registered");this.state.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return Rv(this,void 0,void 0,function(){var e,n;return Ov(this,function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(t){return t.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n){var r={};t.forEach(function(t,e){r[e]=t});var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[e],gradient:function(t){var e=n(t),r={};return e.forEach(function(t,e){r[e]=function(){return t}}),r}};this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=Yb(t),r=new Set(n.map(function(t){return t.id})),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(t){t.kept||t.scopeId!==s.id||e.track(t)})},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),jv(e.length>0,function(){return"gradients() received an empty list of xs."}),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});jv(o instanceof zb,function(){return"The result y returned by f() must be a tensor."});var s=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var s=(f=t[o]).inputs;for(var a in s){for(var u=s[a],l=!1,c=0;c<e.length;c++)if(r[u.id]){f.outputs.forEach(function(t){return r[t.id]=!0}),l=!0,i[f.id]=!0;break}if(l)break}}var h={};h[n.id]=!0;var p={};for(o=t.length-1;o>=0;o--)for(s=(f=t[o]).inputs,c=0;c<f.outputs.length;c++)if(h[f.outputs[c].id]){for(var a in s)h[s[a].id]=!0,p[f.id]=!0;break}var d=[];for(o=0;o<t.length;o++){var f;if(i[(f=t[o]).id]&&p[f.id]){var m={};for(var a in f.inputs){var g=f.inputs[a];r[g.id]&&(m[a]=g)}var y=Object.assign({},f);y.inputs=m,y.outputs=f.outputs,d.push(y)}}return d}(this.state.activeTape,e,o);if(!r&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var t,r,a={};a[o.id]=null==n?(r=wb($v(t=o.shape),"float32"),zb.make(t,{values:r})):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach(function(e){var n=t[e.id];if(null!=n)o.push(n);else{var r=zb.make(e.shape,{values:xb(e.size,e.dtype)},e.dtype);o.push(r)}}),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var s=i.gradient(1===i.outputs.length?o[0]:o),a=function(e){if(!(e in s))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(s)+".");var r=n(function(){return s[e]()});if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!Gv(r.shape,o.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var a=t[o.id];t[o.id]=a.add(r),a.dispose()}};for(var u in i.inputs)a(u)},i=e.length-1;i>=0;i--)r(i)}(a,s,function(t){return i.tidy(t)});var u=e.map(function(t){return a[t.id]});return 0===i.state.gradientDepth&&(i.state.activeTape.forEach(function(t){for(var e in t.saved)t.saved[e].dispose()}),i.state.activeTape=null),{value:o,grads:u}})},t.prototype.customGrad=function(t){var e=this;return jv(mb(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];jv(r.every(function(t){return t instanceof zb}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return r.forEach(function(t,e){o[e]=t}),e.runKernel(function(e,i){return jv((n=t.apply(void 0,r.concat([i]))).value instanceof zb,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),jv(mb(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},o,function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];jv(o.length===r.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),jv(o.every(function(t){return t instanceof zb}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var s={};return o.forEach(function(t,e){s[e]=function(){return t}}),s})}},t.prototype.write=function(t,e,n){var r=this.state.tensorInfo.get(e),i=r.backend;if(t=t||this.backend,"string"===r.dtype){var o=cb(n);this.state.numBytes+=o-r.bytes,r.bytes=o}t!==i&&(i.disposeData(e),r.backend=t,t.register(e,r.shape,r.dtype)),t.write(e,n)},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return Rv(this,void 0,void 0,function(){var e,n;return Ov(this,function(r){switch(r.label){case 0:return e=_b(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=_b()-e,[2,n]}})})},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ew,this.registry)this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),rw=function(){var t=function(){if(null==Jb){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}Jb=t}return Jb}();if(null==t._tfengine){var e=new Dv(t);t._tfengine=new nw(e)}return Mv(t._tfengine.ENV),Fb=function(){return t._tfengine},t._tfengine}();function iw(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}Fv.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Fv.registerFlag("IS_BROWSER",function(){return iw()}),Fv.registerFlag("IS_NODE",function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}),Fv.registerFlag("IS_CHROME",function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Fv.registerFlag("PROD",function(){return!1}),Fv.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Fv.getBool("DEBUG")}),Fv.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Fv.registerFlag("IS_TEST",function(){return!1});var ow={},sw={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function aw(t,e){ow[t]=e}function uw(t){t in ow||(ow[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=lw(t);return e.addEventListener("webglcontextlost",function(e){e.preventDefault(),delete ow[t]},!1),1===t?e.getContext("webgl",sw)||e.getContext("experimental-webgl",sw):e.getContext("webgl2",sw)}(t));var e=ow[t];return e.isContextLost()?(delete ow[t],uw(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),ow[t])}function lw(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function cw(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+fw(t,e))}(t),r}var hw=5.96e-8,pw=65504;function dw(t){return!!(Fv.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||hw<Math.abs(t)&&Math.abs(t)<pw)}function fw(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function mw(t,e,n){return zw(t,e,function(){return t.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function gw(t,e,n){var r=zw(t,e,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(cw(t,e,function(){return t.shaderSource(r,n)}),cw(t,e,function(){return t.compileShader(r)}),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function yw(t,e,n){var r=zw(t,e,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(cw(t,e,function(){return t.shaderSource(r,n)}),cw(t,e,function(){return t.compileShader(r)}),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=ww.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,s=i.map(function(t,e){return Zv((e+1).toString(),o)+t}),a=0,u=0;u<s.length;u++)a=Math.max(s[u].length,a);var l=s.slice(0,r-1),c=s.slice(r-1,r),h=s.slice(r);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+Zv(c[0],a),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var vw,bw,ww=/ERROR: [0-9]+:([0-9]+):/g;function xw(t,e){return zw(t,e,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function _w(t,e,n){if(cw(t,e,function(){return t.linkProgram(n)}),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Cw(t,e,n){if(cw(t,e,function(){return t.validateProgram(n)}),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function Sw(t,e,n){var r=zw(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return cw(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),cw(t,e,function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function Ew(t,e,n){var r=zw(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return cw(t,e,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),cw(t,e,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function kw(t,e){return zw(t,e,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function Nw(t,e){var n=Fv.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function Iw(t,e){return zw(t,e,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Tw(t,e,n,r,i,o,s,a){var u=t.getAttribLocation(n,r);return-1!==u&&(cw(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,i)}),cw(t,e,function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,s,a)}),cw(t,e,function(){return t.enableVertexAttribArray(u)}),!0)}function Aw(t,e,n,r){Bw(t,r),cw(t,e,function(){return t.activeTexture(t.TEXTURE0+r)}),cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)})}function Rw(t,e,n,r){return zw(t,e,function(){return t.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function Ow(t,e,n){return t.getUniformLocation(e,n)}function Dw(t,e,n,r,i,o){cw(t,e,function(){return Aw(t,e,r,o)}),cw(t,e,function(){return t.uniform1i(i,o)})}function Pw(t,e,n,r){cw(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),cw(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)})}function Fw(t,e,n){cw(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)}),cw(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function Mw(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Lw(t,e))}function Lw(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function zw(t,e,n,r){var i=cw(t,e,function(){return n()});if(null==i)throw new Error(r);return i}function Bw(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Uw(t,e){return void 0===e&&(e=2),$v(t.slice(0,t.length-e))}function Vw(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function jw(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[Uw(t)].concat(Vw(t))),e}function Ww(t,e){var n;void 0===e&&(e=!1);var r=Fv.getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map(function(e,n){return n>=t.length-2?Uv(t[n]):t[n]})).length&&(t=[2,t[0]])),2!==t.length){var i=eb(t);t=i.newShape}var o=$v(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var s=Uw(t),a=2,u=2;return t.length&&(a=(n=Vw(t))[0],u=n[1]),Qv(o=s*(a/2)*(u/2)).map(function(t){return 2*t})}return Qv(o)}function Hw(t){return t%2==0}function qw(t,e){if(Gv(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Hw(n)&&Hw(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Hw(t[0])&&Hw(e[0])}function $w(t){if(null==vw){var e=uw(t);vw=e.getParameter(e.MAX_TEXTURE_SIZE)}return vw}function Gw(t){if(null==bw){var e=uw(t);bw=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,bw)}function Kw(t){if(0===t)return 0;var e=uw(t);return Xw(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:Xw(e,"EXT_disjoint_timer_query")?1:0}function Xw(t,e){return null!=t.getExtension(e)}function Qw(t){try{if(null!=uw(t))return!0}catch(t){return!1}return!1}function Zw(t){if(0===t)return!1;var e=uw(t);if(1===t){if(!Xw(e,"OES_texture_float"))return!1}else if(!Xw(e,"EXT_color_buffer_float"))return!1;return Jw(e,t)}function Yw(t){if(0===t)return!1;var e=uw(t);if(1===t){if(!Xw(e,"OES_texture_float"))return!1;if(!Xw(e,"WEBGL_color_buffer_float"))return!1}else if(!Xw(e,"EXT_color_buffer_float"))return!1;return Jw(e,t)}function Jw(t,e){var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,2===e?t.RGBA32F:t.RGBA,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(n),i}function tx(t){return 2===t&&null!=uw(t).fenceSync}var ex=Object.freeze({callAndCheck:cw,canBeRepresented:dw,getWebGLErrorMessage:fw,getExtensionOrThrow:mw,createVertexShader:gw,createFragmentShader:yw,createProgram:xw,linkProgram:_w,validateProgram:Cw,createStaticVertexBuffer:Sw,createStaticIndexBuffer:Ew,getNumChannels:function(){return 2===Fv.getNumber("WEBGL_VERSION")?1:4},createTexture:kw,validateTextureSize:Nw,createFramebuffer:Iw,bindVertexBufferToProgramAttribute:Tw,bindTextureUnit:Aw,unbindTextureUnit:function(t,e,n){Bw(t,n),cw(t,e,function(){return t.activeTexture(t.TEXTURE0+n)}),cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:Rw,getProgramUniformLocation:Ow,bindTextureToProgramUniformSampler:Dw,bindCanvasToFramebuffer:function(t,e){cw(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),cw(t,e,function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)}),cw(t,e,function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)})},bindColorTextureToFramebuffer:Pw,unbindColorTextureFromFramebuffer:Fw,validateFramebuffer:Mw,getFramebufferErrorMessage:Lw,getBatchDim:Uw,getRowsCols:Vw,getShapeAs3D:jw,getTextureShapeFromLogicalShape:Ww,isReshapeFree:qw,get MAX_TEXTURE_SIZE(){return vw},get MAX_TEXTURES_IN_SHADER(){return bw},getWebGLMaxTextureSize:$w,getMaxTexturesInShader:Gw,getWebGLDisjointQueryTimerVersion:Kw,isWebGLVersionEnabled:Qw,isRenderToFloatTextureEnabled:Zw,isDownloadFloatTextureEnabled:Yw,isWebGLFenceEnabled:tx});function nx(){Fv.set("PROD",!0)}function rx(){Fv.set("DEBUG",!0)}function ix(){Fv.set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function ox(t){Fv.getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function sx(){rw.disposeVariables()}function ax(){return rw.memory()}function ux(t){return rw.profile(t)}function lx(t,e){return rw.tidy(t,e)}function cx(t){Yb(t).forEach(function(t){return t.dispose()})}function hx(t){return rw.keep(t)}function px(t){return rw.time(t)}function dx(t){return rw.setBackend(t)}function fx(){return rw.ready()}function mx(){return rw.backendName}function gx(t){rw.removeBackend(t)}function yx(t){return rw.findBackend(t)}function vx(t){return rw.findBackendFactory(t)}function bx(t,e,n){return void 0===n&&(n=1),rw.registerBackend(t,e,n)}function wx(){return rw.backend}function xx(t,e){Fv.setPlatform(t,e)}function _x(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Fv.getBool("IS_TEST")||console.warn.apply(console,t)}function Cx(t,e){var n=t;if(ub(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||ub(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&Fv.getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||ub(e)){jv(n.length>0,function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"}),jv(e.length===n[0],function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"});for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else jv(0===n.length,function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"})}(t,r,[]),r}function Sx(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function Ex(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof zb)return Sx(r,t.dtype,e,n),t;var i=fb(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Sx(r,i,e,n),null==t||!ub(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var o=Cx(t,i);ub(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?vb(t,i,Fv.getBool("DEBUG")):qv(t,[],!0);return zb.make(o,{values:s},i)}function kx(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(t,r){return Ex(t,e+"["+r+"]",n)},r)}function Nx(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Ix(t,e,n){for(var r=t.length+e.length,i=[],o=0,s=0,a=0;a<r;a++)-1===n.indexOf(a)?i.push(t[o++]):i.push(e[s++]);return i}function Tx(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map(function(e){return t[e]})]}function Ax(t,e){return Ix(t,e.map(function(t){return 1}),e)}function Rx(t,e,n){jv(Nx(e,n),function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."})}function Ox(t,e){if(Nx(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(function(t){return n.push(t)}),n}function Dx(t){return t.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function Px(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function Fx(t,e){var n=t[0].length;t.forEach(function(t,e){jv(t.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"})}),jv(e>=0&&e<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=t[0];t.forEach(function(t,i){for(var o=0;o<n;o++)jv(o===e||t[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Mx(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function Lx(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];rw.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),rw.endScope(i),i}catch(t){throw rw.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Fv.registerFlag("HAS_WEBGL",function(){return Fv.getNumber("WEBGL_VERSION")>0}),Fv.registerFlag("WEBGL_VERSION",function(){return Qw(2)?2:Qw(1)?1:0}),Fv.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Fv.get("WEBGL_VERSION")}),Fv.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Fv.registerFlag("WEBGL_PACK",function(){return Fv.getBool("HAS_WEBGL")}),Fv.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_PACK_CLIP",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Fv.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_PACK_REDUCE",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_CONV_IM2COL",function(){return Fv.getBool("WEBGL_PACK")}),Fv.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return $w(Fv.getNumber("WEBGL_VERSION"))}),Fv.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return Gw(Fv.getNumber("WEBGL_VERSION"))}),Fv.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=Fv.getNumber("WEBGL_VERSION");return 0===t?0:Kw(t)}),Fv.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),Fv.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return Zw(Fv.getNumber("WEBGL_VERSION"))}),Fv.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Yw(Fv.getNumber("WEBGL_VERSION"))}),Fv.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return tx(Fv.getNumber("WEBGL_VERSION"))}),Fv.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Fv.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),Lb=ox;var zx=Lx({complex_:function(t,e){var n=Ex(t,"real","complex"),r=Ex(e,"imag","complex");return Wv(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),rw.runKernel(function(t){return t.complex(n,r)},{$real:n,$imag:r})}}),Bx=Lx({real_:function(t){var e=Ex(t,"input","real");return rw.runKernel(function(t){return t.real(e)},{$input:e})}}),Ux=Lx({imag_:function(t){var e=Ex(t,"input","imag");return rw.runKernel(function(t){return t.imag(e)},{$input:e})}});function Vx(t,e,n){return jx(t,e,Cx(t,n),n)}function jx(t,e,n,r){if(null==r&&(r=fb(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ub(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Cb(e);var i=$v(e),o=$v(n);jv(i===o,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o});for(var s=0;s<n.length;++s){var a=s!==n.length-1||n[s]!==$v(e.slice(s));jv(n[s]===e[s]||!a,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "})}}return ub(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?vb(t,r,Fv.getBool("DEBUG")):qv(t,[],!0),zb.make(e,{values:t},r)}function Wx(t,e){if((ub(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&ub(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return jx(t,[],[],e)}function Hx(t,e){Hv(t);var n=Cx(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return jx(t,null,n,e)}function qx(t,e,n){if(Hv(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Cx(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return jx(t,e,r,n)}function $x(t,e,n){if(Hv(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Cx(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return jx(t,e,r,n)}function Gx(t,e,n){if(Hv(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Cx(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return jx(t,e,r,n)}function Kx(t,e,n){if(Hv(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Cx(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return jx(t,e,r,n)}function Xx(t,e,n){if(Hv(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Cx(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return jx(t,e=e||r,r,n)}function Qx(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=Qx(t,"float32"),r=Zx(t,"float32");return zx(n,r)}var i=wb($v(t),e);return zb.make(t,{values:i},e)}function Zx(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=Zx(t,"float32"),r=Zx(t,"float32");return zx(n,r)}var i=xb($v(t),e);return zb.make(t,{values:i},e)}function Yx(t,e,n){return rw.runKernel(function(r){return r.fill(t,e,n)},{})}function Jx(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return rw.runKernel(function(r){return r.linspace(t,e,n)},{})}function t_(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Zx([0],r);var i=xb(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return Hx(i,r)}var e_=Lx({onesLike_:function(t){var e=Ex(t,"x","onesLike");if("complex64"===e.dtype){var n=e_(Bx(e)),r=n_(Ux(e));return zx(n,r)}return rw.runKernel(function(t){return t.onesLike(e)},{$x:e},function(t,e){return{$x:function(){return n_(t)}}})}}),n_=Lx({zerosLike_:function(t){var e=Ex(t,"x","zerosLike");return rw.runKernel(function(t){return t.zerosLike(e)},{$x:e},function(t,e){return{$x:function(){return n_(t)}}})}}),r_=Lx({concat_:function(t,e){void 0===e&&(e=0),jv(t.length>=1,function(){return"Pass at least one tensor to concat"});var n=kx(t,"tensors","concat");e=tb(e,n[0].shape)[0];var r=Mx(n.map(function(t){return t.shape}),e);if(0===$v(r))return Vx([],r);if(1===(n=n.filter(function(t){return t.size>0})).length)return n[0];var i=n.map(function(t){return t.shape});return Fx(i,e),rw.runKernel(function(t){return t.concat(n,e)},n,function(t){var n=i.map(function(t){return t[e]});return u_(t,n,e).map(function(t){return function(){return t}})})}}),i_=Lx({concat1d_:function(t){return r_(t,0)}}),o_=Lx({concat2d_:function(t,e){return r_(t,e)}}),s_=Lx({concat3d_:function(t,e){return r_(t,e)}}),a_=Lx({concat4d_:function(t,e){return r_(t,e)}}),u_=Lx({split_:function(t,e,n){void 0===n&&(n=0);var r,i=Ex(t,"x","split");return n=tb(n,i.shape)[0],"number"==typeof e?(jv(i.shape[n]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(i.shape[n]/e)):(jv(i.shape[n]===e.reduce(function(t,e){return t+e}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),rw.runKernel(function(t){return t.split(i,r,n)},{$x:i},function(t){return{$x:function(){return r_(t,n)}}})}});function l_(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var c_=l_(function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.alea=o}(0,t)}),h_=l_(function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xor128=o}(0,t)}),p_=l_(function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)}),d_=l_(function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)}),f_=l_(function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=a[127&o]^=r+(s=s+1640531527|0))?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,a[i]=(r^=r>>>15)^(n^=n>>>12);t.w=s,t.X=a,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)}),m_=l_(function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:this.tychei=o}(0,t)}),g_=l_(function(t){!function(e,r){var i,o=this,s=256,a=6,u="random",l=r.pow(s,a),c=r.pow(2,52),h=2*c,p=s-1;function d(t,n,p){var d=[],v=g(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,y(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(o.crypto||o.msCrypto).getRandomValues(t)),y(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,y(e)]}}():t,3),d),b=new f(d),w=function(){for(var t=b.g(a),e=l,n=0;t<c;)t=(t+n)*s,e*=s,n=b.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return w.int32=function(){return 0|b.g(4)},w.quick=function(){return b.g(4)/4294967296},w.double=w,g(y(b.S),e),(n.pass||p||function(t,e,n,i){return i&&(i.S&&m(i,b),t.state=function(){return m(b,{})}),n?(r[u]=t,e):t})(w,v,"global"in n?n.global:this==r,n.state)}function f(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=p&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=p&i+1],n=n*s+a[p&(a[i]=a[o=p&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(s)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){for(var n,r=t+"",i=0;i<r.length;)e[p&i]=p&(n^=19*e[p&i])+r.charCodeAt(i++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(r["seed"+u]=d,g(r.random(),e),t.exports){t.exports=d;try{i=n(1)}catch(t){}}}([],Math)});g_.alea=c_,g_.xor128=h_,g_.xorwow=p_,g_.xorshift7=d_,g_.xor4096=f_,g_.tychei=m_;var y_=g_.alea,v_=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=y_(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,s=void 0;do{s=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(s>=1||0===s);var a=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*i*a,n=this.mean+this.stdDev*o*a,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),b_=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=1);var i=this;if(this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=y_(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function w_(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",Cb(t),new Pb(t,e,n)}function x_(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}var __=Lx({batchToSpaceND_:function(t,e,n){var r=Ex(t,"x","batchToSpaceND"),i=e.reduce(function(t,e){return t*e});return jv(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),jv(n.length===e.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length}),jv(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i}),rw.runKernel(function(t){return t.batchToSpaceND(r,e,n)},{$x:r},function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}})}}),C_=Lx({cast_:function(t,e){var n=Ex(t,"x","cast");if(!sb(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return rw.runKernel(function(t){return t.cast(n,e)},{$x:n},function(t){return{$x:function(){return t.clone()}}})}}),S_=Lx({clone_:function(t){var e=Ex(t,"x","clone",null);return rw.runKernel(function(t){return zb.make(e.shape,{dataId:e.dataId},e.dtype)},{$x:e},function(t){return{$x:function(){return t.toFloat()}}})}}),E_=Lx({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Ex(t,"x","cumsum"),o=Ox([e|=0],i.rank),s=i;null!=o&&(s=i.transpose(o));var a=Px(1,i.rank)[0],u=rw.runKernel(function(t){return t.cumsum(s,a,n,r)},{permutedX:s},function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}});return null!=o&&(u=u.transpose(o)),u}}),k_=Lx({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=Ex(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];return jv(i*e>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape}),jv(o*e>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape}),jv(s%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+s+" for depthToSpace with input shape "+r.shape}),rw.runKernel(function(t){return t.depthToSpace(r,e,n)},{$x:r})}}),N_=Lx({expandDims_:function(t,e){void 0===e&&(e=0);var n=Ex(t,"x","expandDims",null);jv(e<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return e<0&&(jv(-(n.rank+1)<=e,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),e=n.rank+e+1),r.splice(e,0,1),B_(n,r)}}),I_=Lx({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=w_([t,e],r),o=t<=e?t:e,s=0;s<o;++s)i.set(1,s,s);var a=i.toTensor().as2D(t,e);if(null==n)return a;if(1===n.length)return W_(N_(a,0),[n[0],1,1]);if(2===n.length)return W_(N_(N_(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return W_(N_(N_(N_(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),T_=Lx({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=Ex(t,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);n=n||Math.random();var a=1===s?i.as2D(1,-1):i,u=rw.runKernel(function(t){return t.multinomial(a,r,e,n)},{logits2D:a});return 1===s?u.as1D():u}}),A_=Lx({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=Ex(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),rw.runKernel(function(t){return t.oneHot(i,e,n,r)},{$indices:i},function(t){return{$indices:function(){return Zx(i.shape,"float32")}}}).reshape(o)}}),R_=Lx({pad_:function(t,e,n){void 0===n&&(n=0);var r=Ex(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map(function(t){return t[0]});return rw.runKernel(function(t){return t.pad(r,e,n)},{$x:r},function(t){return{$x:function(){return t.slice(i,r.shape)}}})}}),O_=Lx({pad1d_:function(t,e,n){return void 0===n&&(n=0),jv(2===e.length,function(){return"Invalid number of paddings. Must be length of 2."}),R_(t,[e],n)}}),D_=Lx({pad2d_:function(t,e,n){return void 0===n&&(n=0),jv(2===e.length&&2===e[0].length&&2===e[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),R_(t,e,n)}}),P_=Lx({pad3d_:function(t,e,n){return void 0===n&&(n=0),jv(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),R_(t,e,n)}}),F_=Lx({pad4d_:function(t,e,n){return void 0===n&&(n=0),jv(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),R_(t,e,n)}}),M_=Lx({rand_:function(t,e,n){var r=$v(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return zb.make(t,{values:i},n)}}),L_=Lx({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new v_(e,n,r,!1,i),s=w_(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),z_=Lx({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=w_(t,r),s=new b_(e,n,null,i),a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),B_=Lx({reshape_:function(t,e){var n=Ex(t,"x","reshape",null);return e=Jv(e,n.size),jv(n.size===$v(e),function(){return"new shape and old shape must have the same number of elements."}),rw.runKernel(function(t){return t.reshape(n,e)},{$x:n},function(t){return{$x:function(){return t.reshape(n.shape)}}})}}),U_=Lx({spaceToBatchND_:function(t,e,n){var r=Ex(t,"x","spaceToBatchND");return jv(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),jv(n.length===e.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length}),jv(r.shape.reduce(function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()}),rw.runKernel(function(t){return t.spaceToBatchND(r,e,n)},{$x:r},function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}})}}),V_=Lx({squeeze_:function(t,e){var n=Ex(t,"x","squeeze");return B_(n,eb(n.shape,e).newShape)}}),j_=Lx({stack_:function(t,e){void 0===e&&(e=0);var n=kx(t,"tensors","stack");if(jv(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;jv(e<=n[0].rank,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(t){Wv(r,t.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(t){jv(i===t.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(t){return t.expandDims(e)});return r_(o,e)}}),W_=Lx({tile_:function(t,e){var n=Ex(t,"x","tile",null);return jv(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."}),rw.runKernel(function(t,r){var i=t.tile(n,e);return r([n]),i},{$x:n},function(t,n){var r=n[0];return{$x:function(){var n=n_(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var s=0;s<e[2];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(s=0;s<e[2];++s)for(var a=0;a<e[3];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],s*r.shape[2],a*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}})}}),H_=Lx({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new v_(e,n,r,!0,i),s=w_(t,r),a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}}),q_=Lx({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=Ex(t,"x","unstack");return jv(e>=-n.shape.length&&e<n.shape.length,function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),e<0&&(e+=n.shape.length),rw.runKernel(function(t){return t.unstack(n,e)},{$x:n},function(t){return{$x:function(){return j_(t,e)}}})}}),$_=function(t,e){return Rv(this,void 0,void 0,function(){var n,r,i,o,s,a,u,l,c,h;return Ov(this,function(p){switch(p.label){case 0:return n=Ex(t,"x","setdiff1d"),r=Ex(e,"y","setdiff1d"),jv(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),jv(1===n.rank,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),jv(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=p.sent(),[4,r.data()];case 2:for(o=p.sent(),s=new Set(o),a=0,c=0;c<i.length;c++)s.has(i[c])||a++;for(u=new Pb([a],n.dtype),l=new Pb([a],"int32"),c=0,h=0;c<i.length;c++)s.has(i[c])||(u.values[h]=i[c],l.values[h]=c,h++);return[2,[u.toTensor(),l.toTensor()]]}})})};function G_(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,s=0;s<o;++s)i=i.concat([t[s+1]/e[s],e[s]]);i=i.concat(t.slice(o+1))}return i}function K_(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],s=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?s.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,s)}return r}function X_(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var o=1;o<t.length;++o)i.push(o<=e.length?r?e[o-1]*t[o]:t[o]/e[o-1]:t[o]);return i}function Q_(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Z_(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function Y_(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var s=t.shape,a=n.slice();a.pop();var u=1;for(o=r;o<t.rank;++o)u*=s[o],a.push(s[o]);var l=yb(t.shape).map(function(t){return t/u}).concat([1]).slice(0,r);return[a,i,u,l]}var J_=30;function tC(t){return t<=J_?t:gb(t,Math.floor(Math.sqrt(t)))}function eC(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=n.length,o=1,s=r;s<i;++s)o*=n[s];return{sliceRank:r,numUpdates:e.size/(r<1?1:r),sliceSize:o,strides:yb(n.slice(0,r)).concat([1]),outputSize:$v(n)}}function nC(t,e,n,r,i,o,s,a,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),0!==s)throw new Error("ellipsis mask is not yet supported");if(0!==a)throw new Error("new axis mask is not yet supported");for(var l=[],c=[],h=[],p=0;p<t.length;p++)l[p]=rC(i,e,r,t,p),c[p]=iC(o,n,r,t,p),u&1<<p&&(c[p]=l[p]+1,h.push(p));var d=new Array(t.length).fill(0);return d=d.map(function(t,e){for(var n=0,i=r[e]||1,o=l[e];!(i>0?o>=c[e]:o<=c[e]);o+=i)n+=1;return n}),[l,d,h]}function rC(t,e,n,r,i){var o=e[i];(t&1<<i||null==o)&&(o=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),Bv(0,o,s-1)}function iC(t,e,n,r,i){var o=e[i],s=n[i]||1;(t&1<<i||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),s>0?Bv(0,o,a):Bv(-1,o,a-1)}function oC(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function sC(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function aC(t){return jv(mb(t),function(){return"The f passed in grad(f) must be a function"}),function(e,n){var r=Ex(e,"x","tf.grad",null),i=null!=n?Ex(n,"dy","tf.grad"):null;return rw.tidy(function(){var e=rw.gradients(function(){return t(r)},[r],i),n=e.grads;return null!=i&&Wv(e.value.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),dC(n),n[0]})}}function uC(t){return jv(mb(t),function(){return"The f passed in grads(f) must be a function"}),function(e,n){jv(Array.isArray(e),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=kx(e,"args","tf.grads",null),i=null!=n?Ex(n,"dy","tf.grads"):null;return rw.tidy(function(){var e=rw.gradients(function(){return t.apply(void 0,r)},r,i),n=e.grads;return null!=i&&Wv(e.value.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),dC(n),n})}}function lC(t){return jv(mb(t),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(e,n){jv(e instanceof zb,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),jv(null==n||n instanceof zb,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=rw.gradients(function(){return t(e)},[e],n),i=r.grads,o=r.value;return dC(i),{grad:i[0],value:o}}}function cC(t){return jv(mb(t),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(e,n){jv(Array.isArray(e)&&e.every(function(t){return t instanceof zb}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),jv(null==n||n instanceof zb,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=rw.gradients(function(){return t.apply(void 0,e)},e,n);return null!=n&&Wv(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),dC(r.grads),r}}function hC(t,e){jv(mb(t),function(){return"The f passed in variableGrads(f) must be a function"}),jv(null==e||Array.isArray(e)&&e.every(function(t){return t instanceof Bb}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=null!=e;if(!n)for(var r in e=[],rw.registeredVariables)e.push(rw.registeredVariables[r]);var i=n?e.filter(function(t){return!t.trainable}):null,o=e.length;jv((e=e.filter(function(t){return t.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var s=rw.gradients(t,e,null,!0),a=s.value,u=s.grads;jv(u.some(function(t){return null!=t}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),jv(0===a.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"});var l={};return e.forEach(function(t,e){null!=u[e]&&(l[t.name]=u[e])}),null!=i&&i.forEach(function(t){return l[t.name]=null}),{value:a,grads:l}}function pC(t){return rw.customGrad(t)}function dC(t){if(t.filter(function(t){return null==t}).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var fC=Lx({softmax_:function(t,e){void 0===e&&(e=-1);var n=Ex(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return pC(function(t,n){var r=t.logSumExp([e],!0),i=t.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(t,n){var r=n[0],i=t.mul(r);return i.sub(i.sum([e],!0).mul(r))}}})(n)}}),mC=Lx({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=Ex(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return pC(function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}})(n)}}),gC=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.data.delete(t)},t}(),yC=function(){function t(){}return t.prototype.time=function(t){throw new Error("Not yet implemented.")},t.prototype.read=function(t){throw new Error("Not yet implemented.")},t.prototype.readSync=function(t){throw new Error("Not yet implemented.")},t.prototype.disposeData=function(t){throw new Error("Not yet implemented.")},t.prototype.write=function(t,e){throw new Error("Not yet implemented.")},t.prototype.fromPixels=function(t,e){throw new Error("Not yet implemented.")},t.prototype.register=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.memory=function(){throw new Error("Not yet implemented.")},t.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.slice=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a,u){throw new Error("Not yet implemented")},t.prototype.unstack=function(t,e){throw new Error("Not yet implemented")},t.prototype.reverse=function(t,e){throw new Error("Not yet implemented")},t.prototype.concat=function(t,e){throw new Error("Not yet implemented")},t.prototype.neg=function(t){throw new Error("Not yet implemented")},t.prototype.add=function(t,e){throw new Error("Not yet implemented")},t.prototype.addN=function(t){throw new Error("Not yet implemented")},t.prototype.subtract=function(t,e){throw new Error("Not yet implemented")},t.prototype.multiply=function(t,e){throw new Error("Not yet implemented")},t.prototype.realDivide=function(t,e){throw new Error("Not yet implemented")},t.prototype.floorDiv=function(t,e){throw new Error("Not yet implemented")},t.prototype.sum=function(t,e){throw new Error("Not yet implemented")},t.prototype.prod=function(t,e){throw new Error("Not yet implemented")},t.prototype.unsortedSegmentSum=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.argMin=function(t,e){throw new Error("Not yet implemented")},t.prototype.argMax=function(t,e){throw new Error("Not yet implemented")},t.prototype.equal=function(t,e){throw new Error("Not yet implemented")},t.prototype.notEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.less=function(t,e){throw new Error("Not yet implemented")},t.prototype.lessEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.greater=function(t,e){throw new Error("Not yet implemented")},t.prototype.greaterEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalNot=function(t){throw new Error("Not yet implemented")},t.prototype.logicalAnd=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalOr=function(t,e){throw new Error("Not yet implemented")},t.prototype.where=function(t){throw new Error("Not yet implemented")},t.prototype.select=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.topk=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.min=function(t,e){throw new Error("Not yet implemented")},t.prototype.minimum=function(t,e){throw new Error("Not yet implemented")},t.prototype.mod=function(t,e){throw new Error("Not yet implemented")},t.prototype.max=function(t,e){throw new Error("Not yet implemented")},t.prototype.maximum=function(t,e){throw new Error("Not yet implemented")},t.prototype.all=function(t,e){throw new Error("Not yet implemented")},t.prototype.any=function(t,e){throw new Error("Not yet implemented")},t.prototype.squaredDifference=function(t,e){throw new Error("Not yet implemented")},t.prototype.ceil=function(t){throw new Error("Not yet implemented")},t.prototype.floor=function(t){throw new Error("Not yet implemented")},t.prototype.round=function(t){throw new Error("Not yet implemented")},t.prototype.sign=function(t){throw new Error("Not yet implemented")},t.prototype.isNaN=function(t){throw new Error("Not yet implemented")},t.prototype.isInf=function(t){throw new Error("Not yet implemented")},t.prototype.isFinite=function(t){throw new Error("Not yet implemented")},t.prototype.pow=function(t,e){throw new Error("Not yet implemented")},t.prototype.exp=function(t){throw new Error("Not yet implemented")},t.prototype.expm1=function(t){throw new Error("Not yet implemented")},t.prototype.log=function(t){throw new Error("Not yet implemented")},t.prototype.log1p=function(t){throw new Error("Not yet implemented")},t.prototype.sqrt=function(t){throw new Error("Not yet implemented")},t.prototype.rsqrt=function(t){throw new Error("Not yet implemented")},t.prototype.square=function(t){throw new Error("Not yet implemented")},t.prototype.reciprocal=function(t){throw new Error("Not yet implemented")},t.prototype.relu=function(t){throw new Error("Not yet implemented")},t.prototype.prelu=function(t,e){throw new Error("Not yet implemented")},t.prototype.elu=function(t){throw new Error("Not yet implemented")},t.prototype.eluDer=function(t,e){throw new Error("Not yet implemented")},t.prototype.selu=function(t){throw new Error("Not yet implemented")},t.prototype.int=function(t){throw new Error("Not yet implemented")},t.prototype.clip=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.abs=function(t){throw new Error("Not yet implemented")},t.prototype.complexAbs=function(t){throw new Error("Not yet implemented")},t.prototype.sigmoid=function(t){throw new Error("Not yet implemented")},t.prototype.softplus=function(t){throw new Error("Not yet implemented")},t.prototype.sin=function(t){throw new Error("Not yet implemented")},t.prototype.cos=function(t){throw new Error("Not yet implemented")},t.prototype.tan=function(t){throw new Error("Not yet implemented")},t.prototype.asin=function(t){throw new Error("Not yet implemented")},t.prototype.acos=function(t){throw new Error("Not yet implemented")},t.prototype.atan=function(t){throw new Error("Not yet implemented")},t.prototype.atan2=function(t,e){throw new Error("Not yet implemented")},t.prototype.sinh=function(t){throw new Error("Not yet implemented")},t.prototype.cosh=function(t){throw new Error("Not yet implemented")},t.prototype.tanh=function(t){throw new Error("Not yet implemented")},t.prototype.asinh=function(t){throw new Error("Not yet implemented")},t.prototype.acosh=function(t){throw new Error("Not yet implemented")},t.prototype.atanh=function(t){throw new Error("Not yet implemented")},t.prototype.erf=function(t){throw new Error("Not yet implemented")},t.prototype.step=function(t,e){throw new Error("Not yet implemented")},t.prototype.conv2d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2D=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPoolBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.avgPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPoolBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.reshape=function(t,e){throw new Error("Not yet implemented")},t.prototype.cast=function(t,e){throw new Error("Not yet implemented")},t.prototype.tile=function(t,e){throw new Error("Not yet implemented")},t.prototype.pad=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.transpose=function(t,e){throw new Error("Not yet implemented")},t.prototype.gather=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.gatherND=function(t,e){throw new Error("Not yet implemented")},t.prototype.scatterND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchToSpaceND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.spaceToBatchND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeBilinear=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeBilinearBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchNormalization=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){throw new Error("Not yet implemented")},t.prototype.multinomial=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.oneHot=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.cumsum=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.fft=function(t){throw new Error("Not yet implemented")},t.prototype.ifft=function(t){throw new Error("Not yet implemented")},t.prototype.complex=function(t,e){throw new Error("Not yet implemented")},t.prototype.real=function(t){throw new Error("Not yet implemented")},t.prototype.imag=function(t){throw new Error("Not yet implemented")},t.prototype.cropAndResize=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.depthToSpace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.split=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.sparseToDense=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){throw new Error("Not yet implemented")},t.prototype.zerosLike=function(t){throw new Error("Not yet implemented")},t.prototype.linspace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.dispose=function(){throw new Error("Not yet implemented")},t}();function vC(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[o]||1)&&r.unshift(o)}return r}function bC(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1;(null==i||1===i&&e[o]>1)&&n.unshift(o)}return n}function wC(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var s=e[e.length-i-1];if(null==s&&(s=1),1===o)n.unshift(s);else if(1===s)n.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function xC(t,e,n,r,i,o,s){void 0===s&&(s="channelsLast");var a,u=EC(e),l=u[0],c=u[1];if("channelsLast"===s)a=[l,c,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);a=[l,c,t[1],t[1]]}return _C(t,a,n,r,i,o,!1,s)}function _C(t,e,n,r,i,o,s,a){void 0===s&&(s=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],p=u[3];if("channelsLast"===a)l=t[0],c=t[1],h=t[2],p=t[3];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);l=t[0],p=t[1],c=t[2],h=t[3]}var d,f=e[0],m=e[1],g=e[3],y=EC(n),v=y[0],b=y[1],w=EC(r),x=w[0],_=w[1],C=NC(f,x),S=NC(m,_),E=function(t,e,n,r,i,o,s,a){var u,l,c;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=SC(t,e,n));var o=t[1],s=IC((t[0]-e+2*r)/n+1,i);jv(Kv(s),function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"});var a=IC((o-e+2*r)/n+1,i);return jv(Kv(a),function(){return"The output # of columns ("+a+") must be an integer. Change the stride and/or zero pad parameters"}),[s,a]}([e,n],o,r,t,a);l=h[0],c=h[1]}else if("same"===t){l=Math.ceil(e/r),c=Math.ceil(n/i);var p=Math.max(0,(l-1)*r+o-e),d=Math.max(0,(c-1)*i+s-n),f=Math.floor(p/2),m=p-f,g=Math.floor(d/2);u={top:f,bottom:m,left:g,right:d-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-o+1)/r),c=Math.ceil((n-s+1)/i)}return{padInfo:u,outHeight:l,outWidth:c}}(i,c,h,v,b,C,S,o),k=E.outHeight,N=E.outWidth,I=s?g*p:g;return"channelsFirst"===a?d=[l,I,k,N]:"channelsLast"===a&&(d=[l,k,N,I]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:h,inChannels:p,outHeight:k,outWidth:N,outChannels:I,padInfo:E.padInfo,strideHeight:v,strideWidth:b,filterHeight:f,filterWidth:m,effectiveFilterHeight:C,effectiveFilterWidth:S,dilationHeight:x,dilationWidth:_,inShape:t,outShape:d,filterShape:e}}function CC(t,e,n,r,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var a=[-1,-1,-1,-1,-1],u=a[0],l=a[1],c=a[2],h=a[3],p=a[4];if("channelsLast"===s)u=t[0],l=t[1],c=t[2],h=t[3],p=t[4];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);u=t[0],p=t[1],l=t[2],c=t[3],h=t[4]}var d,f=e[0],m=e[1],g=e[2],y=e[4],v=kC(n),b=v[0],w=v[1],x=v[2],_=kC(r),C=_[0],S=_[1],E=_[2],k=function(t,e,n,r,i,o,s,a,u,l){var c,h,p,d;if("same"===t){var f=((h=Math.ceil(e/i))-1)*i+a-e,m=((p=Math.ceil(n/o))-1)*o+u-n,g=((d=Math.ceil(r/s))-1)*s+l-r,y=Math.floor(f/2),v=f-y,b=Math.floor(m/2),w=m-b,x=Math.floor(g/2);c={top:b,bottom:w,left:x,right:g-x,front:y,back:v,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);c={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-a+1)/i),p=Math.ceil((n-u+1)/o),d=Math.ceil((r-l+1)/s)}return{padInfo:c,outDepth:h,outHeight:p,outWidth:d}}(i,l,c,h,b,w,x,NC(f,C),NC(m,S),NC(g,E)),N=k.outDepth,I=k.outHeight,T=k.outWidth,A=o?y*p:y;return"channelsFirst"===s?d=[u,A,N,I,T]:"channelsLast"===s&&(d=[u,N,I,T,A]),{batchSize:u,dataFormat:s,inDepth:l,inHeight:c,inWidth:h,inChannels:p,outDepth:N,outHeight:I,outWidth:T,outChannels:A,padInfo:k.padInfo,strideDepth:b,strideHeight:w,strideWidth:x,filterDepth:f,filterHeight:m,filterWidth:g,dilationDepth:C,dilationHeight:S,dilationWidth:E,inShape:t,outShape:d,filterShape:e}}function SC(t,e,n,r){void 0===r&&(r=1);var i=NC(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function EC(t){return"number"==typeof t?[t,t]:t}function kC(t){return"number"==typeof t?[t,t,t]:t}function NC(t,e){return e<=1?t:t+(t-1)*(e-1)}function IC(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function TC(t){var e=EC(t);return 1===e[0]&&1===e[1]}function AC(t,e){return TC(t)||TC(e)}function RC(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=Zx(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!ab(t.dtype,e))return zb.make(t.shape,{dataId:t.dataId},e);if("complex64"===t.dtype){var s=n.real(t);return o=s.cast(e),s.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var a=Wx(0,t.dtype);return o=n.notEqual(t,a),a.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function OC(t,e){return zb.make(e,{dataId:t.dataId},t.dtype)}function DC(t,e,n){var r=(e-t)/(n-1),i=xb(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return Hx(i,"float32")}var PC=Object.freeze({castTensor:RC,reshapeTensor:OC,linspaceImpl:DC,upcastType:Kb,axesAreInnerMostDims:Nx,combineLocations:Ix,computeOutAndReduceShapes:Tx,expandShapeToKeepDim:Ax,assertAxesAreInnerMostDims:Rx,getAxesPermutation:Ox,getUndoAxesPermutation:Dx,getInnerMostAxes:Px,getBroadcastDims:vC,getReductionAxes:bC,assertAndGetBroadcastShape:wC,assertParamsConsistent:Fx,computeOutShape:Mx,computePool2DInfo:xC,computeConv2DInfo:_C,computeConv3DInfo:CC,computeDefaultPad:SC,tupleValuesAreOne:TC,eitherStridesOrDilationsAreOne:AC});function FC(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function MC(t,e){return{real:t[2*e],imag:t[2*e+1]}}function LC(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function zC(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function BC(t,e,n,r,i){for(var o=Array.from(e).map(function(t,e){return{score:t,boxIndex:e}}).filter(function(t){return t.score>i}).sort(function(t,e){return e.score-t.score}),s=[],a=0;a<o.length;a++){var u=o[a],l=u.boxIndex;if(u.score<i)break;for(var c=!1,h=s.length-1;h>=0;--h)if(UC(t,l,s[h])>=r){c=!0;break}if(!c&&(s.push(l),s.length>=n))break}return Hx(s,"int32")}function UC(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),d=(a-o)*(u-s),f=(h-l)*(p-c);if(d<=0||f<=0)return 0;var m=Math.max(o,l),g=Math.max(s,c),y=Math.min(a,h),v=Math.min(u,p),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(d+f-b)}function VC(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map(function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o})}function jC(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=w_(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),s=new Array(t.rank),a=0;a<s.length;a++)s[a]=o[a]%t.shape[a];var u=t.locToIndex(s);i.values[r]=t.values[u]}return i.toTensor()}function WC(t,e,n,r,i){for(var o=e[e.length-1],s=[t.length/o,o],a=s[0],u=s[1],l=nb(n,a*r),c=nb("int32",a*r),h=0;h<a;h++){for(var p=h*u,d=t.subarray(p,p+u),f=[],m=0;m<d.length;m++)f.push({value:d[m],index:m});f.sort(function(t,e){return e.value-t.value});var g=h*r,y=l.subarray(g,g+r),v=c.subarray(g,g+r);for(m=0;m<r;m++)y[m]=f[m].value,v[m]=f[m].index}var b=e.slice();return b[b.length-1]=r,[Vx(l,b,n),Vx(c,b,"int32")]}function HC(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=w_(t,"int32"),o=w_([n.length,t.length],"int32");for(r=0;r<n.length;r++){var s=i.indexToLoc(n[r]);o.values.set(s,r*t.length)}return o.toTensor()}var qC=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(function(t,e){return"T"+e});var n=[];this.variableNames.forEach(function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")});var r=this.variableNames.map(function(t){return"v"+t}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},$C=function(t,e){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=t,this.variableNames=e.map(function(t,e){return"T"+e});var n=[];this.variableNames.forEach(function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")});var r=this.variableNames.map(function(t){return"v"+t}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},GC=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function KC(t,e){return["x","y","z","w","u","v"].slice(0,e).map(function(e){return t+"."+e})}function XC(t,e){return 1===e?[t]:KC(t,e)}function QC(){var t,e,n,r,i,o,s,a,u,l;return 2===Fv.getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 0. || val == 0.) ? false : true;\n      }\n    ",u="\n      const float INFINITY = uintBitsToFloat(uint(0x7f800000));\n    ",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a="\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}function ZC(t,e,n){void 0===n&&(n="index");var r=yb(e);return r.map(function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"}).join("")}function YC(t){var e=yb(t).map(function(t){return t.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var JC="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function tS(t){return"offset"+t}function eS(t){var e=t.name,n=$v(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function nS(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function rS(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function iS(t,e){return e.map(function(e){return t[e]}).join(", ")}var oS=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,jv(t.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,a=this.outputShape,u=a.length,l=nS(u),c=XC("coords",u);if(1===i){var h=nS(s=u+1);o="\n        "+h+" sourceLocR = "+h+"("+c.join()+", 0);\n        ++"+c[u-1]+";\n        "+h+" sourceLocG = "+h+"("+c.join()+", 0);\n        ++"+c[u-2]+";\n        "+h+" sourceLocA = "+h+"("+c.join()+", 0);\n        --"+c[u-1]+";\n        "+h+" sourceLocB = "+h+"("+c.join()+", 0);\n        --"+c[u-2]+";"}else s=u,o="\n        "+l+" sourceLocR = coords;\n        ++"+c[u-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+c[u-2]+";\n        "+l+" sourceLocA = coords;\n        --"+c[u-1]+";\n        "+l+" sourceLocB = coords;\n        --"+c[u-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),d="."+p[s-1],f=p.map(function(t){return"int "+t}),m=XC("sourceLocR",s-1).concat("inIdx.r"),g=XC("sourceLocG",s-1).concat("inIdx.g"),y=XC("sourceLocB",s-1).concat("inIdx.b"),v=XC("sourceLocA",s-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+v.join()+")));",x="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+v.join()+") : 0.)",_=r?"":"\n      float getBestIndicesAChannel("+f.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+f.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+_+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+c[u-1]+" < "+(a[u-1]-1)+";\n        bool hasNextRow = "+c[u-2]+" < "+(a[u-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+x+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+x+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},sS=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},aS=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],wC(t,e),wC(t,n);var s="0.0";null!=r&&(wC(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";null!=i&&(wC(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+s+";\n        float scale = "+a+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},uS=function(t,e,n,r,i,o){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],wC(t,e),wC(t,n);var s="vec4(0.0)";null!=r&&(wC(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";null!=i&&(wC(t,i),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+s+";\n        vec4 scale = "+a+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},lS=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=wC(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},cS="return a + b;",hS="return a - b;",pS="return a * b;",dS=function(t,e,n){this.variableNames=["A","B"],this.outputShape=wC(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},fS=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=wC(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===$v(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+nS(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var s=XC("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+s[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+s[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},mS=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float min;\n      uniform float max;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, min, max));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"min"),n.maxLoc=r.getUniformLocationNoThrow(i,"max")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),gS=function(){function t(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      uniform float min;\n      uniform float max;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(min), vec4(max)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"min"),n.maxLoc=r.getUniformLocationNoThrow(i,"max")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),yS=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},vS=function(t){this.outputShape=[],this.outputShape=Mx(t,1),this.variableNames=t.map(function(t,e){return"T"+e});var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},bS=function(t,e){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=Mx(t,e);var n=this.outputShape,r=n.length,i=nS(r),o=XC("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(t,e){return"T"+e});var a=new Array(t.length-1);a[0]=t[0][e];for(var u=1;u<a.length;u++)a[u]=a[u-1]+t[u][e];var l=s[e],c="vec2("+s.slice(-2).join()+")",h=s.join(),p="if ("+l+" < "+a[0]+")\n          return getChannel(getT0("+h+"), "+c+");";for(u=1;u<a.length;u++)p+="\n        else if ("+l+" < "+a[u]+") {\n          "+l+" -= "+a[u-1]+";\n          return getChannel(getT"+u+"("+h+"), "+c+");\n        }";p+="\n        else {\n          "+l+" -= "+a[a.length-1]+";\n          return getChannel(getT"+a.length+"("+h+"), "+c+");\n        }",this.userCode="\n      float getValue("+s.map(function(t){return"int "+t})+") {\n        "+p+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n        if (++"+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n        if (++"+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            --"+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "},wS=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},xS=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},_S=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},CS=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},SS=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TODO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ES=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TODO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},kS=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.top,n=t.padInfo.left,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,a=t.filterHeight,u=t.filterWidth,l=4*Math.floor(t.inChannels/4),c=t.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+r+", "+i+");\n      const ivec2 pads = ivec2("+e+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+"; wR++) {\n          int xR = xRCorner + wR * "+o+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+u+"; wC++) {\n            int xC = xCCorner + wC * "+s+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+l+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===c)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+l+") *\n                getW(wR, wC, "+l+", d2);\n            } else if ("+(2===c)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+l+"),\n                getX(batch, xR, xC, "+l+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+l+", d2),\n                getW(wR, wC, "+l+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===c)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+l+"),\n                getX(batch, xR, xC, "+l+" + 1),\n                getX(batch, xR, xC, "+l+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+l+", d2),\n                getW(wR, wC, "+l+" + 1, d2),\n                getW(wR, wC, "+l+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},NS=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,a=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,p=t.filterWidth,d=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+s+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+c+"; wF++) {\n          int xF = xFCorner + wF * "+a+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+p+"; wC++) {\n              int xC = xCCorner + wC * "+l+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===f)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+d+") *\n                  getW(wF, wR, wC, "+d+", d2);\n              } else if ("+(2===f)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===f)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1),\n                  getX(batch, xF, xR, xC, "+d+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2),\n                  getW(wF, wR, wC, "+d+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},IS=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+t.strideHeight+", "+t.strideWidth+");\n      const ivec2 pads = ivec2("+t.padInfo.top+", "+t.padInfo.left+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+e+";\n        int q = d2 - d1 * "+e+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+t.filterHeight+"; wR++) {\n          int xR = xRCorner + wR * "+t.dilationHeight+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+t.filterWidth+"; wC++) {\n            int xC = xCCorner + wC * "+t.dilationWidth+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},TS=function(t){this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=t.outShape;for(var e=t.inHeight,n=t.inWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,a=t.dilationHeight,u=t.dilationWidth,l=t.filterHeight,c=t.filterWidth,h=c,p="int xR; int xC; int xCOffset;",d=0;d<l;d++)for(var f=0;f<c;f++)p+="\n          vec4 xTexelR"+d+"C"+2*f+" = vec4(0.);\n          vec4 wR"+d+"C"+f+" = vec4(0.);\n          vec4 xR"+d+"C"+f+" = vec4(0.);";for(d=0;d<l;d++)for(var m=0;m<h;m++){if(p+="\n          xR = xRCorner + "+d*a+";\n          xC = xCCorner + "+(f=2*m)*u+";\n        ",1===s){if(f<c&&(p+=i%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+f+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+f+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+e+" && xCOffset >= 0 && xCOffset < "+n+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+d+"C"+f+" = vec4(previous.zw, xTexelR"+d+"C"+f+".xy);\n                } else {\n                  xR"+d+"C"+f+" = vec4(0, 0, xTexelR"+d+"C"+f+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+e+" && xC >= 0 && xC < "+n+") {\n                  xTexelR"+d+"C"+f+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+d+"C"+f+" = vec4(0.);\n                }\n\n                xR"+d+"C"+f+" = xTexelR"+d+"C"+f+";\n              ",f+1<c)){var g=i%2==0?Uv(u):u;u%2==0&&i%2==1||u%2!=0&&i%2!=1?(p+="\n                  xCOffset = xC + "+i%2+" + "+g+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+d+"C"+(f+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",u>1&&(p+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+e+" &&\n                      xCOffset >= 0 && xCOffset < "+n+") {\n                      xTexelR"+d+"C"+f+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+d+"C"+f+" = vec4(0.);\n                    }\n                  "),p+="\n                  xR"+d+"C"+(f+1)+" = vec4(\n                    xTexelR"+d+"C"+f+".zw, xTexelR"+d+"C"+(f+2)+".xy);\n                "):p+="\n                  xCOffset = xC + "+g+";\n\n                  if(xR >= 0 && xR < "+e+" &&\n                    xCOffset >= 0 && xCOffset < "+n+") {\n                    xTexelR"+d+"C"+(f+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+d+"C"+(f+1)+" = xTexelR"+d+"C"+(f+2)+";\n                "}}else f<c&&(p+="\n              if(xR >= 0 && xR < "+e+") {\n            ",i%2==1?(p+="\n                xCOffset = xC + 1 - "+s+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+f+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+f+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+n+") {\n                  xTexelR"+d+"C"+(f+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+d+"C"+(f+2)+" = vec4(0.);\n                }\n\n                xR"+d+"C"+f+" = vec4(\n                  xTexelR"+d+"C"+f+".zw, xTexelR"+d+"C"+(f+2)+".zw);\n              ",f+1<c&&(p+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+s+";\n                  if(xCOffset >= 0 && xCOffset < "+n+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+d+"C"+(f+1)+" = vec4(xTexelR"+d+"C"+(f+2)+".xy, final.xy);\n                ")):(p+="\n                if(xC >= 0 && xC < "+n+") {\n                  xTexelR"+d+"C"+f+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+d+"C"+f+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+s+";\n                if(xCOffset >= 0 && xCOffset < "+n+") {\n                  xTexelR"+d+"C"+(f+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+d+"C"+(f+2)+" = vec4(0.);\n                }\n\n                xR"+d+"C"+f+" = vec4(\n                  xTexelR"+d+"C"+f+".xy, xTexelR"+d+"C"+(f+2)+".xy);\n              ",f+1<c&&(p+="\n                  xR"+d+"C"+(f+1)+" = vec4(\n                    xTexelR"+d+"C"+f+".zw, xTexelR"+d+"C"+(f+2)+".zw);\n                ")),p+="}");f<c&&(p+="\n            vec4 wTexelR"+d+"C"+f+" = getW("+d+", "+f+", d1, q);\n            wR"+d+"C"+f+" = vec4(wTexelR"+d+"C"+f+".xz, wTexelR"+d+"C"+f+".xz);\n          ",f+1<c&&(p+="\n              vec4 wTexelR"+d+"C"+(f+1)+" = getW("+d+", "+(f+1)+", d1, q);\n              wR"+d+"C"+(f+1)+" =\n                vec4(wTexelR"+d+"C"+(f+1)+".xz, wTexelR"+d+"C"+(f+1)+".xz);"))}for(d=0;d<l;d++)for(f=0;f<c;f++)p+="result += xR"+d+"C"+f+" * wR"+d+"C"+f+";";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+r+", "+i+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 result = vec4(0.);\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},AS=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],s=t[1],a=t[2],u=n[0],l=n[1];this.outputShape=[e[0],u,l,t[3]];var c=[s-1+".0",a-1+".0"],h=c[0],p=c[1],d=u>1?[""+(s-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],f=l>1?[""+(a-1)/(l-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p];this.userCode="\n      const float height_ratio = float("+d[0]+");\n      const float width_ratio = float("+f[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+d[1]+";\n        float width_scale = "+f[1]+";\n\n        float in_y = "+d[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+f[2]+";\n        if( in_x < 0.0 || in_x > "+p+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},RS=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+nS(r)+" coords = getOutputCoords();\n        int end = "+OS(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+OS(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===r)return""+e;if(2===r)return e+".x, "+e+".y";if(3===r)return e+".x, "+e+".y, "+e+".z";if(4===r)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}(0,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function OS(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var DS,PS,FS=function(t,e){this.variableNames=["A"];var n=QC();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ZC(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},MS=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;var n=QC();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ZC(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},LS=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),zS=function(t){this.variableNames=["A"];var e=QC();this.outputShape=t,this.userCode="\n      "+JC+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},BS=function(t){this.variableNames=["A"],this.usesPackedTextures=!0;var e=QC();this.outputShape=t,this.userCode="\n      "+JC+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},US=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=QC(),i=e[0],o=e[1];this.outputShape=t;var s="result";n&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      "+YC(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+s+", 0., 0., 0.);\n      }\n    "},VS=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=QC(),i=e[0],o=e[1];this.outputShape=t;var s="",a="result";n&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;s+="\n          localCoords = coords;\n          if(localCoords[2] + "+l+" < "+t[2]+") {\n            localCoords[2] += "+l+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+c+"] = values[0];\n              } else if(offset == 1) {\n                result["+c+"] = values[1];\n              } else if(offset == 2) {\n                result["+c+"] = values[2];\n              } else {\n                result["+c+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+YC(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+s+"\n\n        "+r.output+" = "+a+";\n      }\n    "},jS=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},WS=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),HS=function(t){this.variableNames=["A"];var e=QC(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},qS=function(t){this.variableNames=["A"];var e=QC(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},$S=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=nS(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)i.push(o===e?"int(getIndices("+r[o]+"))":""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},GS=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=nS(e.length),i=nS(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function KS(t,e){return[e,t]}function XS(t){var e=$v(t);return Qv(Math.ceil(e/4))}function QS(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function ZS(t,e){var n=QC();return gw(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function YS(t,e){return Sw(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function JS(t,e){return Ew(t,e,new Uint16Array([0,1,2,2,1,3]))}function tE(t,e){var n,r,i,o,s,a,u,l,c=t;return 2===Fv.getNumber("WEBGL_VERSION")?(n=c.R32F,r=c.R16F,i=c.RGBA16F,o=c.RGBA32F,s=c.RED,a=4,u=1,l=c.HALF_FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=c.RGBA,s=t.RGBA,a=4,u=4,l=null!=e?e.HALF_FLOAT_OES:null),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:l}}function eE(t,e,n,r,i,o,s){Nw(n,r);var a=kw(t,e),u=t.TEXTURE_2D;return cw(t,e,function(){return t.bindTexture(u,a)}),cw(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),cw(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),cw(t,e,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),cw(t,e,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),cw(t,e,function(){return t.texImage2D(u,0,i,n,r,0,o,s,null)}),cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)}),a}function nE(t,e,n,r,i){var o=KS(n,r);return eE(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function rE(t,e,n,r,i){var o=KS(n,r);return eE(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function iE(t,e,n,r,i){var o=KS(n,r);return eE(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function oE(t,e,n,r,i){var o=QS(n,r);return eE(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function sE(t,e,n,r,i){var o=QS(n,r);return eE(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function aE(t,e,n,r){return cw(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),Tw(t,e,n,"clipSpacePos",r,3,20,0)&&Tw(t,e,n,"uv",r,2,20,12)}function uE(t,e,n,r,i,o,s){var a,u,l;cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),o instanceof Uint8Array?(a=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(a=new Float32Array(r*i*4),u=t.FLOAT,l=s.internalFormatPackedFloat),a.set(o),cw(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,l,r,i,0,t.RGBA,u,a)}),cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function lE(t,e,n,r){cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),r.data instanceof Uint8Array?cw(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):cw(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),cw(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function cE(t,e,n,r,i){var o=t.createBuffer();cw(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)});var s=16*n*r;return cw(t,e,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ)}),cw(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)}),cw(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),o}function hE(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function pE(t,e,n,r,i){var o=KS(n,r),s=o[0],a=o[1],u=new Uint8Array(n*r*4);return cw(t,e,function(){return t.readPixels(0,0,s,a,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function dE(t,e,n,r,i,o,s,a){var u=t,l=new Float32Array(function(t,e){var n=QS(o,s);return n[0]*n[1]*4}());return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function fE(t,e,n,r){var i=new Float32Array(n*r*4);return cw(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)}),i}!function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(DS||(DS={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(PS||(PS={}));var mE=Object.freeze({createVertexShader:ZS,createVertexBuffer:YS,createIndexBuffer:JS,getTextureConfig:tE,createFloat32MatrixTexture:nE,createFloat16MatrixTexture:rE,createUnsignedBytesMatrixTexture:iE,createPackedMatrixTexture:oE,createFloat16PackedMatrixTexture:sE,bindVertexProgramAttributeStreams:aE,uploadDenseMatrixToTexture:uE,uploadPixelDataToTexture:lE,createBufferFromOutputTexture:cE,downloadFloat32MatrixFromBuffer:hE,downloadByteEncodedFloatMatrixFromOutputTexture:pE,downloadPackedMatrixFromBuffer:dE,downloadMatrixFromPackedOutputTexture:fE}),gE=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=Fv.getNumber("WEBGL_VERSION");null!=t?(this.gl=t,aw(e,t)):this.gl=uw(e),1===Fv.getNumber("WEBGL_VERSION")?(this.textureFloatExtension=mw(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),Fv.getBool("WEBGL_RENDER_FLOAT32_ENABLED")||(this.textureHalfFloatExtension=mw(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float"))):this.colorBufferFloatExtension=mw(this.gl,this.debug,"EXT_color_buffer_float"),this.vertexBuffer=YS(this.gl,this.debug),this.indexBuffer=JS(this.gl,this.debug),this.framebuffer=Iw(this.gl,this.debug),this.textureConfig=tE(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return Fv.getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;cw(e,this.debug,function(){return e.finish()}),cw(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),cw(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),cw(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),cw(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),cw(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),nE(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),rE(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),iE(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),lE(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),uE(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),sE(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),oE(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(Fw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),cw(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,function(){return pE(r.gl,r.debug,e,n,r.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return dE(this.gl,t,0,0,0,i,o)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return hE(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=cE(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(Fv.getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,function(){return fE(r.gl,r.debug,e,n)})},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=yw(e,this.debug,t),r=ZS(e,this.debug),i=xw(e,this.debug);return cw(e,this.debug,function(){return e.attachShader(i,r)}),cw(e,this.debug,function(){return e.attachShader(i,n)}),_w(e,this.debug,i),this.debug&&Cw(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=aE(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&cw(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&Cw(this.gl,this.debug,this.program),cw(this.gl,this.debug,function(){return e.gl.useProgram(t)})},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?Rw(this.gl,this.debug,t,e):Ow(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),cw(this.gl,this.debug,function(){return n.gl.getAttribLocation(t,e)})},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),Dw(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=QS(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&Cw(this.gl,this.debug,this.program),Mw(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),cw(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),cw(this.gl,this.debug,function(){return t.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=mw(this.gl,this.debug,2===Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return Rv(this,void 0,void 0,function(){var e=this;return Ov(this,function(n){switch(n.label){case 0:return[4,Yv(function(){return e.disposed||e.isQueryAvailable(t,Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(t,Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise(function(n){e.addItemToPoll(function(){return t.isFencePassed()},function(){return n()})})},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map(function(t){return t.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||Yv(function(){return n.pollItems(),0===n.itemsToPoll.length})},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Pw(this.gl,this.debug,t,this.framebuffer),this.debug&&Mw(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Pw(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Mw(this.gl)):Fw(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;Pw(r,this.debug,t,this.framebuffer),this.debug&&Mw(r),this.outputTexture=t,cw(r,this.debug,function(){return r.viewport(0,0,e,n)}),cw(r,this.debug,function(){return r.scissor(0,0,e,n)})},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),cw(this.gl,this.debug,function(){return i.gl.scissor(t,e,n,r)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function yE(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach(function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!Gv(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var s=t.texShape,a=i.isUniform?null:i.texData.texShape;if(!Gv(s,a))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+a+" must match")}})}var vE=function(t,e,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var r=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,a=n.outWidth,u=n.dilationWidth,l=n.dilationHeight,c=s.left,h=s.top,p=r*n.filterWidth,d=QC(),f="",m=0;m<=1;m++)for(var g=0;g<=1;g++)f+="\n          blockIndex = rc.y + "+g+";\n          pos = rc.x + "+m+";\n          \n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+a+")) * "+o+" - "+h+";\n            d0 = offsetY + "+l+" * (pos / "+p+");\n  \n            if(d0 < "+e[0]+" && d0 >= 0) {\n              offsetX = int(mod(float(blockIndex), "+a+".) * "+i+". - "+c+".);\n              d1 = offsetX + "+u+" * (int(mod(float(pos), "+p+".) / "+r+".));\n    \n              if(d1 < "+e[1]+" && d1 >= 0) {\n                innerDims = vec2(d1, int(mod(float(pos), "+r+".)));\n                result["+(2*m+g)+"] = getChannel(getA(d0, int(innerDims.x),\n                                                  int(innerDims.y)), innerDims);\n              }\n            }\n  \n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1;\n        vec2 innerDims;\n\n        "+f+"\n\n        "+d.output+" = result;\n      }\n    "},bE=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o=e,s=t[3]-1;this.outputShape=t;var a="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+a+")":1===i?"1.0/("+a+")":"exp(log("+a+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},wE=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},xE=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var o=e,s=t[3]-1;this.outputShape=t;var a="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+a+")":1===i?"1.0/("+a+")":"exp(log("+a+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},_E=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},CE=function(t,e,n,r,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=e;var s=Math.ceil((n?t[1]:t[2])/2),a=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",l=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],c=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";o&&(h="vec4 activation(vec4 x) {\n        "+o+"\n      }",p="result = activation(result);");var d=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+s+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+s+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+a+");\n          vec4 b = getMatrixB(rc.x, "+u+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+l[0]+" * "+c[0]+");\n          result += ("+l[1]+" * "+c[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+d+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},SE=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),EE=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},kE=function(t){this.variableNames=["A"],this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=XC("rc",e),r=nS(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),s=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),s=2;s<t;s++)o=e[e.length-1-s]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+s+"));\n          }\n        }\n      "}},NE=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map(function(e,n){return e[0]+t[n]+e[1]});var r=t.length,i=nS(r),o=e.map(function(t){return t[0]}).join(","),s=e.map(function(e,n){return e[0]+t[n]}).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+s+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+a+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+s+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},IE=function(t,e,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=e.map(function(e,n){return e[0]+t[n]+e[1]});for(var r=t.length,i=nS(r),o=e.map(function(t){return t[0]}).join(","),s=e.map(function(e,n){return e[0]+t[n]}).join(","),a=XC("rc",r),u=XC("source",r),l=a[r-1]+" < "+this.outputShape[r-1],c=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",a[r-1]+" += 1;\n       if("+l+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+a[r-2]+" += 1;\n       if("+a[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+a[r-1]+" += 1;\n         if("+l+") {"],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",f=0,m=1===r?2:4;f<m;f++)d+="\n        "+h[f]+"\n        if ("+p+") {\n          result["+f+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+f+"] = getChannel(getX("+u.join()+"), "+c+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+s+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(d+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},TE=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,s=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var p="avg"===e,d="0.0";if(p||(d="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+c+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+s+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+a+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+l+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var f=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(f="avgValue / count");var m=4*Math.floor(r/4),g=r%4,y="\n      if ("+p+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+c+", "+h+");\n      const float initializationValue = "+d+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+d+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+s+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+a+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              getValue(batch, xR, xC + 3 * "+a+", d)\n            );\n\n            "+y+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              initializationValue\n            );\n\n            "+y+"\n          }\n        }\n        setOutput("+f+");\n      }\n    "}},AE=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var s="0.0",a="";"prod"===e?s="1.0":"min"===e?(s="1.0 / 1e-20",a="min"):"max"===e&&(s="-1.0 / 1e-20",a="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+a+"(values, minMaxValue);\n      }\n    ",p="vec4";"all"===e?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===e&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var d="";i%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+s+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+s+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},RE=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+ZC(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+YC(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},OE=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=t.shape,a=s[1],u=s[2],l=[n&&a>1?i-1:i,n&&u>1?o-1:o],c=[n&&a>1?a-1:a,n&&u>1?u-1:u],h=l[0]/c[0],p=l[1]/c[1],d=1/h,f=1/p,m=2*Math.ceil(d)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},DE=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],a=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},PE=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=t[1],o=t[2],s=t[3];this.outputShape=[t[0],e,n,s];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+a[0]/u[0]+",\n          "+a[1]/u[1]+",\n          "+a[1]/u[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},FE=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],s=t.shape,a=s[1],u=s[2],l=[n&&a>1?i-1:i,n&&u>1?o-1:o],c=[n&&a>1?a-1:a,n&&u>1?u-1:u],h=l[0]/c[0],p=l[1]/c[1],d=1/h,f=1/p,m=2*Math.ceil(d)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+l[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+l[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},ME=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],a=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/a[0]+",\n          "+s[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},LE=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map(function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)}).join(","),i=nS(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},zE=function(t,e){this.variableNames=["x"],this.usesPackedTextures=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=XC("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],s=nS(n);function a(n){var r=t.map(function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)});return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+s+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+a(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",a(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",a(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",a(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},BE=function(t,e,n,r,i,o,s){void 0===s&&(s=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var a=nS(i.length),u=nS(o.length),l="";1===n?l="i":2===n&&(l="i, j");var c="";1===r?c="i":2===r&&(c="i, coords[1]"),this.userCode="\n        "+a+" strides = "+a+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+l+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+c+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},UE=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/n);this.outputShape=[r,s];var a=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, segFilter);\n    ",c="";i%n>0&&(c="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+a+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+l+"\n        }\n\n        int inIdx = inOffset + "+a+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+l+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+l+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+l+"\n        }\n        setOutput(sumValue);\n      }\n    "},VE=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<e.length;u++)a.push(""+o[u]),u<t&&s.push(""+o[u]);r=s.join(),i=a.join()}var l=nS(n);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},jE=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=nS(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return WE.slice(0,t).map(function(t){return"sourceLoc."+t}).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map(function(t,e){return"sourceLoc."+WE[e]+" = start["+e+"] + coords."+WE[e]+";"}).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),WE=["x","y","z","w","u","v"],HE=function(){function t(t){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=t,this.rank=t.length;var e=nS(this.rank),n=XC("coords",this.rank),r=XC("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",s="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",a=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map(function(t,e){return"start["+e+"]"}).join()+");":t.map(function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+s+"\n        "+a+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),qE=function(t,e,n,r){this.variableNames=["x"];var i=n.filter(function(t,e){return-1===r.indexOf(e)});this.outputShape=i;var o=n.length,s=nS(n.length),a=nS(i.length),u="";if(1===o)u="coords * strides + begin";else{var l=0;u=n.map(function(t,e){return-1===r.indexOf(e)?(l++,1===i.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(l-1)+"] * strides["+e+"] + begin["+e+"]"):"begin["+e+"]"}).join(",")}this.userCode="\n      "+s+" begin = "+s+"("+t+");\n      "+s+" strides = "+s+"("+e+");\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+u+"));\n      }\n    "},$E=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=GE(e,n),o=KE(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),i===PS.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===PS.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===PS.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===PS.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===PS.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=KE(e,GE(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(e){t.gpgpu.deleteMatrixTexture(e)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(e){t.gpgpu.deleteMatrixTexture(e)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function GE(t,e){if(t===DS.UPLOAD)return PS.PACKED_2X2_FLOAT32;if(t===DS.RENDER||null==t)return e?Fv.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?PS.PACKED_2X2_FLOAT32:PS.PACKED_2X2_FLOAT16:Fv.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?PS.UNPACKED_FLOAT32:PS.UNPACKED_FLOAT16;if(t===DS.DOWNLOAD||t===DS.PIXELS)return PS.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function KE(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var XE=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=nS(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},QE=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=nS(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},ZE=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=nS(this.rank),o=KC("rc",this.rank),s=new Array(this.rank);for(r=0;r<e.length;r++)s[e[r]]=o[r];var a="vec2("+s.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+s.join()+"), "+a+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+l+";\n      if("+u+") {\n        result[1] = "+l+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+l+";\n        if("+u+") {\n          result[3] = "+l+";\n        }\n      }  \n      setOutput(result);\n    }\n    "},YE=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},JE="if (isnan(x)) return x;",tk=JE+"\n  return (x < 0.0) ? 0.0 : x;\n",ek="return exp(x);",nk="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",rk=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},ik=function(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var e=t.length,n=XC("rc",e),r=nS(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),s=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+s+"));\n      }\n    "},ok={},sk=600,ak=function(){function t(t){if(this.gpgpu=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!Fv.getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var e=uw(Fv.getNumber("WEBGL_VERSION"));this.binaryCache=(n=Fv.getNumber("WEBGL_VERSION"))in ok?ok[n]:(ok[n]={},ok[n]),this.gpgpu=new gE(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var n;this.textureManager=new $E(this.gpgpu),this.numMBBeforeWarning=null==Fv.global.screen?1024:Fv.global.screen.height*Fv.global.screen.width*window.devicePixelRatio*sk/1024/1024,this.texData=new gC(this,rw)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw new Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n})},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=[t.height,t.width],r=[t.height,t.width,e],i="undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement,o=t.data instanceof Uint8Array,s="undefined"!=typeof ImageData&&t instanceof ImageData,a="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,u="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement;if(!(i||o||s||a||u))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(u||a){if(null==this.fromPixels2DContext){if("complete"!==document.readyState)throw new Error("The DOM is not ready yet. Please call tf.browser.fromPixels() once the DOM is ready. One way to do that is to add an event listener for `DOMContentLoaded` on the document object");this.fromPixels2DContext=lw(Fv.getNumber("WEBGL_VERSION")).getContext("2d")}this.fromPixels2DContext.canvas.width=t.width,this.fromPixels2DContext.canvas.height=t.height,this.fromPixels2DContext.drawImage(t,0,0,t.width,t.height),t=this.fromPixels2DContext.canvas}var l,c,h=this.makeTensorHandle(n,"int32");if(this.texData.get(h.dataId).usage=DS.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(h.dataId),t),Fv.getBool("WEBGL_PACK")){l=new qS(r);var p=this.makePackedTensor(l.outputShape,h.dtype);c=this.compileAndRun(l,[h],p)}else l=new HS(r),c=this.compileAndRun(l,[h]);return this.disposeData(h.dataId),c},t.prototype.makeTensorHandle=function(t,e){var n={};return this.register(n,t,e),{dataId:n,shape:t,dtype:e}},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");if(Fv.getBool("DEBUG"))for(var n=0;n<e.length;n++){var r=e[n];if(!dw(r))throw Error("The value "+r+" cannot be represented on this device.")}var i=this.texData.get(t);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(t),i.usage=DS.UPLOAD,i.values=e},t.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.shape;if(null!=e.slice){var s=new YE(o,"return x;"),a=this.compileAndRun(s,[{dataId:t,shape:o,dtype:r}]),u=this.readSync(a.dataId);return a.dispose(),u}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var l,c,h=null!=this.activeTimers;return h&&(l=_b()),c="complex64"===r?FC(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=_b()-l),this.convertAndCacheOnCPU(t,c)},t.prototype.read=function(t){return Rv(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,l,c,h,p,d,f,m,g,y,v;return Ov(this,function(b){switch(b.label){case 0:if(this.pendingRead.has(t))return n=this.pendingRead.get(t),[2,new Promise(function(t){return n.push(t)})];if(r=this.texData.get(t),i=r.values,o=r.shape,s=r.dtype,a=r.complexTensors,null!=r.slice)return u=new YE(o,"return x;"),l=this.compileAndRun(u,[{dataId:t,shape:o,dtype:s}]),c=this.read(l.dataId),l.dispose(),[2,c];if(null!=i)return[2,this.convertAndCacheOnCPU(t)];if(!Fv.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Fv.getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==s&&Fv.get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),t=p.dataId,d=this.texData.get(p.dataId),h=(e=this.gpgpu).createBufferFromTexture.apply(e,[d.texture].concat(XS(o)))),this.pendingRead.set(t,[]),"complex64"===s?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:b.sent(),b.label=2;case 2:return"complex64"!==s?[3,4]:[4,Promise.all([a.real.data(),a.imag.data()])];case 3:return m=b.sent(),f=FC(m[0],m[1]),[3,5];case 4:null==h?f=this.getValuesFromTexture(t):(g=$v(o),f=this.gpgpu.downloadFloat32MatrixFromBuffer(h,g),this.disposeData(t)),b.label=5;case 5:return y=this.convertAndCacheOnCPU(t,f),v=this.pendingRead.get(t),this.pendingRead.delete(t),v.forEach(function(t){return t(y)}),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,y]}})})},t.prototype.getValuesFromTexture=function(t){var e,n=this,r=this.texData.get(t),i=r.shape,o=r.dtype,s=r.isPacked,a=$v(i);if(Fv.getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(t),l=this.texData.get(u.dataId),c=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[l.texture].concat(XS(i))).subarray(0,a);return this.disposeData(u.dataId),c}var h=Fv.getBool("WEBGL_PACK")&&!0===s,p=h?jw(i):i,d=this.makeTensorHandle(p,"float32");d.size=$v(i),this.texData.get(d.dataId).usage=DS.DOWNLOAD;var f=lx(function(){var e=h?new BS(p):new zS(p);return n.compileAndRun(e,[{shape:p,dtype:o,dataId:t}],d,null)}),m=this.texData.get(f.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,a);return this.disposeData(d.dataId),g},t.prototype.time=function(t){return Rv(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return Ov(this,function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=qv(this.activeTimers.map(function(t){return t.query})).filter(function(t){return null!=t}),o=qv(this.activeTimers.map(function(t){return t.name})).filter(function(t){return null!=t}),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return s=u.sent(),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:Vv(s),getExtraProfileInfo:function(){return s.map(function(t,e){return{name:o[e],ms:t}}).map(function(t){return t.name+": "+t.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:_b(),endMs:null}},t.prototype.endTimer=function(t){return Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=_b(),t)},t.prototype.getQueryTime=function(t){return Rv(this,void 0,void 0,function(){var e;return Ov(this,function(n){return Fv.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]})})},t.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t))if(this.pendingRead.has(t))this.pendingDisposal.add(t);else if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}},t.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,s=e.isPacked,a=e.slice,u=a&&a.origDataId||t,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,s)));var c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getCPUBackend=function(){return Fv.getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=rw.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every(function(t){return null==n.texData.get(t.dataId).texture&&t.size<e})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(t,e){var n=this.makeOutputArray(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:rw.keep(t.clone()),imag:rw.keep(e.clone())},n},t.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},t.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===$v(n))return Vx([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=oC(t.shape,e,n);if(r||!i){var o=Fv.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HE(n):new jE(n),s=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,s)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},t.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=zb.make(n,{},t.dtype,this),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var s=sC(e,t.strides);r.slice&&(s+=r.slice.flatOffset),o.slice={flatOffset:s,origDataId:r.slice&&r.slice.origDataId||t.dataId};var a=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,a+1),i},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a,u){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r,i,o,s,a,u);var l=nC(t.shape,e,n,r,i,o,s,a,u),c=l[0],h=l[1],p=l[2],d=h.filter(function(t,e){return-1===p.indexOf(e)});if(d.some(function(t){return 0===t}))return Vx([],d);var f=new qE(c,r,h,p);return this.compileAndRun(f,[t])},t.prototype.reverse=function(t,e){var n=Fv.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zE(t.shape,e):new LE(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>Fv.getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(t.length/2),r=this.concat(t.slice(0,n),e),i=this.concat(t.slice(n),e);return this.concat([r,i],e)}if(Fv.getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var o=new bS(t.map(function(t){return t.shape}),e);return this.compileAndRun(o,t)}var s=Mx(t.map(function(t){return t.shape}),e),a=t.map(function(t){return t.as2D(-1,$v(t.shape.slice(e)))}),u=new vS(a.map(function(t){return t.shape}));return this.compileAndRun(u,a).reshape(s)},t.prototype.neg=function(t){var e=new YE(t.shape,"return -x;");return this.compileAndRun(e,[t])},t.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=n?t.shape[1]:t.shape[2],a=t.shape[0];if((1===i||1===o)&&s>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(a,s,1),l=1===o?2:1,c=1===o?e.as3D(a,1,s):e;return this.multiply(u,c).sum(l,!0)}var h=Kb(t.dtype,e.dtype),p=new CE(t.shape,[a,i,o],n,r),d=this.makePackedTensor(p.outputShape,h);return this.compileAndRun(p,[t,e],d)},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){var s=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],u=t.shape[0],l=Kb(t.dtype,e.dtype),c=new CE(t.shape,[u,s,a],n,r,!!i,o?function(t,e){if(void 0===e&&(e=!1),"linear"===o)return"return x;";if("relu"===o)return e?nk:tk;throw new Error("Activation "+o+" has not been implemented for the WebGL backend.")}(0,!0):null),h=this.makePackedTensor(c.outputShape,l),p=[t,e];return i&&p.push(i),this.compileAndRun(c,p,h)},t.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new lS("return areal * breal - aimag * bimag;",t.shape,e.shape),o=new lS("return areal * bimag + aimag * breal;",t.shape,e.shape),s=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag),this.makeComplexComponentTensorHandle(e,r.complexTensors.real),this.makeComplexComponentTensorHandle(e,r.complexTensors.imag)],a=this.compileAndRun(i,s),u=this.compileAndRun(o,s),l=this.complex(a,u);return a.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,pS,t.dtype);var c=new dS(pS,t.shape,e.shape),h=this.makeOutputArray(c.outputShape,t.dtype);return this.compileAndRun(c,[t,e],h)},t.prototype.batchNormalization=function(t,e,n,r,i,o){var s=[t,e,n],a=null;null!=o&&(a=o.shape,s.push(o));var u=null;if(null!=i&&(u=i.shape,s.push(i)),Fv.getBool("WEBGL_PACK_NORMALIZATION")){var l=new uS(t.shape,e.shape,n.shape,a,u,r);return this.compileAndRun(l,s)}var c=new aS(t.shape,e.shape,n.shape,a,u,r);return this.compileAndRun(c,s)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=Fv.getBool("WEBGL_PACK_NORMALIZATION")?new xE(t.shape,e,n,r,i):new bE(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){var a=new wE(e.shape,r,i,o,s);return this.compileAndRun(a,[e,n,t])},t.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map(function(t){return kb(t)});return jC(w_(t.shape,t.dtype,n),e)}var r=new XE(t.shape,e);return this.compileAndRun(r,[t])},t.prototype.pad=function(t,e,n){var r=Fv.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IE(t.shape,e,n):new NE(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=Fv.getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZE(t.shape,e):new QE(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new $S(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.batchToSpaceND=function(t,e,n){jv(t.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var r=e.reduce(function(t,e){return t*e}),i=G_(t.shape,e,r),o=K_(i.length,e.length),s=X_(t.shape,e,r),a=Q_(n,e.length),u=Z_(s,n,e.length);return t.reshape(i).transpose(o).reshape(s).slice(a,u)},t.prototype.spaceToBatchND=function(t,e,n){jv(t.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var r=e.reduce(function(t,e){return t*e}),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var s=t.pad(i),a=G_(s.shape,e,r,!1),u=K_(a.length,e.length,!1),l=X_(s.shape,e,r,!1);return s.reshape(a).transpose(u).reshape(l)},t.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=tC(i),s=new AE({windowSize:o,inSize:i,batchSize:r},e),a=s.outputShape,u=this.makeOutputArray([a[0],a[1]],n);return this.compileAndRun(s,[t],u),1===u.shape[1]?u:this.reduce(u,e,n)},t.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=tC(i),s=new GC({windowSize:o,inSize:i,batchSize:r},e,null==n),a=s.outputShape,u=this.makeOutputArray([a[0],a[1]],"int32"),l=[t];return null!=n&&l.push(n),this.compileAndRun(s,l,u),1===u.shape[1]?u:this.argReduce(t,e,u)},t.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=tC(r[r.length-1]),o=new oS(r,i,e,null==n),s=this.makePackedTensor(o.outputShape,"int32");return this.compileAndRun(o,null==n?[t]:[t,n],s),s.rank===t.rank?this.argReducePacked(t,e,s):s},t.prototype.sum=function(t,e){Rx("sum",e,t.rank);var n=Tx(t.shape,e),r=n[0],i=$v(n[1]),o=t.as2D(-1,i),s=Xb(t.dtype);return this.reduce(o,"sum",s).reshape(r)},t.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=Tx(t.shape,e),r=n[0],i=$v(n[1]),o=t.as2D(-1,i),s=Xb(t.dtype);return this.reduce(o,"prod",s).reshape(r)},t.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=Ox([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=Px(1,t.rank)[0]);var s=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)r.push(o!==e?t[o]:n);return r}(o.shape,r,n),a=$v([o.shape[r]]),u=o.as2D(-1,a),l=Xb(t.dtype),c=this.segOpCompute(u,"unsortedSegmentSum",e,l,n).reshape(s);return null!=i&&(c=c.transpose(Dx(i))),c},t.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],s=t.shape[1],a=function(t,e){var n,r=!1;for(t<=J_?(n=t,r=!0):n=gb(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=gb(t,n+1);return n}(s,i),u=new UE({windowSize:a,inSize:s,batchSize:o,numSegments:i},e),l=u.outputShape,c=this.makeOutputArray([l[0],l[1]],r);return this.compileAndRun(u,[t,n],c),c.shape[1]===i?c:(n=t_(0,i).tile([s/a]),this.segOpCompute(c,e,n,r,i))},t.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(Rx("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!Fv.getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=Tx(t.shape,r),o=i[0],s=$v(i[1]),a=t.as2D(-1,s);return this.argReduce(a,n).reshape(o)}return this.argReducePacked(t,n)},t.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},t.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},t.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new RS(t.shape,n,r);return this.compileAndRun(i,[t])},t.prototype.equal=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new dS("return float(a == b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new dS("return float(a != b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new dS("return float(a < b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new dS("return float(a <= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new dS("return float(a > b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new dS("return float(a >= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new YE(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new dS("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new dS("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.select=function(t,e,n){var r=new VE(t.rank,e.shape,e.rank),i=this.makeOutputArray(r.outputShape,Kb(e.dtype,n.dtype));return this.compileAndRun(r,[t,e,n],i)},t.prototype.where=function(t){_x("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return HC(t.shape,e)},t.prototype.topk=function(t,e,n){return WC(t.dataSync(),t.shape,t.dtype,e)},t.prototype.min=function(t,e){Rx("min",e,t.rank);var n=Tx(t.shape,e),r=n[0],i=$v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dS("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dS("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);Rx("max",e,t.rank);var n=Tx(t.shape,e),r=n[0],i=$v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dS("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.all=function(t,e){Rx("all",e,t.rank);var n=Tx(t.shape,e),r=n[0],i=$v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(t,e){Rx("any",e,t.rank);var n=Tx(t.shape,e),r=n[0],i=$v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.squaredDifference=function(t,e){var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("return (a - b) * (a - b);",t.shape,e.shape):new dS("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.realDivide=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(b.x == 0.0) {\n    result.x = NAN;\n  } else if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(b.y == 0.0) {\n    result.y = NAN;\n  } else if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(b.z == 0.0) {\n    result.z = NAN;\n  } else if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(b.w == 0.0) {\n    result.w = NAN;\n  } else if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new dS("\nif (b == 0.0) {\n  return NAN;\n}\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t,e],r)},t.prototype.floorDiv=function(t,e){if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new dS("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[t,e],r)},t.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,cS);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=Kb(t.dtype,e.dtype);if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,cS,n);var r=new dS(cS,t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new fS(n,t.shape,e.shape,i),s=this.makePackedTensor(o.outputShape,r);return this.compileAndRun(o,[t,e],s)},t.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),s=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map(function(i){var o=i[0],s=i[1],a=r.makeComplexComponentTensorHandle(t,o),u=r.makeComplexComponentTensorHandle(e,s),l=new dS(n,t.shape,e.shape),c=r.makeOutputArray(l.outputShape,Kb(o.dtype,s.dtype));return r.compileAndRun(l,[a,u],c)}),a=s[0],u=s[1],l=this.complex(a,u);return a.dispose(),u.dispose(),l},t.prototype.makeComplexComponentTensorHandle=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},t.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>Fv.get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map(function(t){return t.dtype}).reduce(function(t,e){return Kb(t,e)}),o=t.map(function(t){return t.shape}),s=Fv.getBool("WEBGL_PACK"),a=s?new $C(t[0].shape,o):new qC(t[0].shape,o),u=s?this.makePackedTensor(a.outputShape,i):this.makeOutputArray(a.outputShape,i);return this.compileAndRun(a,t,u)},t.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,hS);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=Kb(t.dtype,e.dtype);if(Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,hS,t.dtype);var r=new dS(hS,t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.pow=function(t,e){var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new fS("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dS("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=Kb(t.dtype,e.dtype),o=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[t,e],o)},t.prototype.ceil=function(t){var e=new YE(t.shape,"return ceil(x);");return this.compileAndRun(e,[t])},t.prototype.floor=function(t){var e=new YE(t.shape,"return floor(x);");return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new YE(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},t.prototype.isNaN=function(t){var e=new YE(t.shape,"return float(isnan(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isInf=function(t){var e=new YE(t.shape,"return float(isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isFinite=function(t){var e=new YE(t.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.round=function(t){var e=new YE(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},t.prototype.exp=function(t){var e;return e=Fv.getBool("WEBGL_PACK")?new rk(t.shape,ek):new YE(t.shape,ek),this.compileAndRun(e,[t])},t.prototype.expm1=function(t){var e=new YE(t.shape,"return exp(x) - 1.0;");return this.compileAndRun(e,[t])},t.prototype.log=function(t){var e;return e=Fv.getBool("WEBGL_PACK")?new rk(t.shape,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n"):new YE(t.shape,"if (x < 0.0) return NAN;\n  return log(x);"),this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new YE(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new YE(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new YE(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new YE(t.shape,"return x * x;");return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new YE(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e;return e=Fv.getBool("WEBGL_PACK")?new rk(t.shape,nk):new YE(t.shape,tk),this.compileAndRun(e,[t])},t.prototype.prelu=function(t,e){var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",t.shape,e.shape):new dS("return (a < 0.) ? b * a : a;",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.elu=function(t){var e=new YE(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new dS("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new YE(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new YE(t.shape,"return float(int(x));"),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r,i=(r=Fv.getBool("WEBGL_PACK_CLIP")?new gS(t.shape):new mS(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},t.prototype.abs=function(t){var e=new YE(t.shape,"return abs(x);");return this.compileAndRun(e,[t])},t.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new yS(t.shape),r=[this.makeComplexComponentTensorHandle(t,e.complexTensors.real),this.makeComplexComponentTensorHandle(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(t){var e=new YE(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new YE(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new YE(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new YE(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new YE(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new YE(t.shape,"return asin(x);");return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new YE(t.shape,"return acos(x);");return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new YE(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fS("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dS("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new YE(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new YE(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new YE(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new YE(t.shape,"return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new YE(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new YE(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new YE(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n');return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new YE(t.shape,function(t){return void 0===t&&(t=0),JE+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},t.prototype.conv2dByMatMul=function(t,e,n){var r=t.shape,i=this.texData.get(t.dataId),o=r[2]%2!=0&&!!i.isPacked;if((1==r[0]*r[1]*r[2]||1===n.outChannels)&&n.inChannels>1e3||!Fv.getBool("WEBGL_LAZILY_UNPACK")||!Fv.getBool("WEBGL_PACK_BINARY_OPERATIONS")||!o){var s=this.reshape(t,[1,r[0]*r[1]*r[2],n.inChannels]),a=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.batchMatMul(s,a,!1,!1),n.outShape)}var u=zb.make([1,r[0]*r[1]*(r[2]+1),n.inChannels],{dataId:t.dataId},t.dtype,this),l=i.shape;i.shape=i.shape.slice(),i.shape[i.shape.length-2]++,jv(qw(i.shape,u.shape),function(){return"packed reshape "+i.shape+" to "+u.shape+" isn't free"});var c=this.reshape(e,[1,n.inChannels,n.outChannels]),h=this.batchMatMul(u,c,!1,!1),p=this.texData.get(h.dataId);return jv(p.isPacked,function(){return"batchMatMul result is expected to be packed"}),i.shape=l,p.shape=n.outShape,zb.make(n.outShape,{dataId:h.dataId},h.dtype,this)},t.prototype.conv2dWithIm2Row=function(t,e,n){var r=n.outWidth,i=n.outHeight,o=n.filterWidth*n.filterHeight*n.inChannels,s=i*r,a=[o,s],u=t.squeeze([0]),l=e.reshape([1,o,-1]),c=new vE(a,u.shape,n),h=this.compileAndRun(c,[u]).reshape([1,a[0],a[1]]),p=new CE(h.shape,[1,s,n.outChannels],!0,!1);return this.compileAndRun(p,[h,l]).reshape([1,i,r,n.outChannels])},t.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(Fv.getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new kS(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new xS(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new wS(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2D=function(t,e,n){var r;return Fv.getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new TS(n),this.compileAndRun(r,[t,e],this.makePackedTensor(n.outShape,t.dtype))):(r=new IS(n),this.compileAndRun(r,[t,e]))},t.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new ES(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new SS(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3d=function(t,e,n){var r=new NS(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerInput=function(t,e,n){var r=new CS(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerFilter=function(t,e,n){var r=new _S(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new TE(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new TE(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var i=new TE(r,"max",!0),o=this.compileAndRun(i,[e]),s=new _E(r),a=this.makeOutputArray(s.outputShape,e.dtype),u=this.compileAndRun(s,[t,o],a);return o.dispose(),u},t.prototype.avgPoolBackprop=function(t,e,n){var r=new sS(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.cast=function(t,e){return RC(t,e,this)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var s=new Array(t.rank).fill(0),a=t.shape.slice();a[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)s[e]=o,u[o]=this.slice(t,s,a).reshape(r);return u},t.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);return!n.isPacked||qw(t.shape,e)||null!==n.texture&&qw(n.shape,e)?OC(t,e):this.packedReshape(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var i=Fv.getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new PE(t.shape,e,n,r):new DE(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeBilinearBackprop=function(t,e,n){var r=new OE(t,e,n);return this.compileAndRun(r,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new ME(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new FE(t,e,n);return this.compileAndRun(r,[t])},t.prototype.multinomial=function(t,e,n,r){var i=e?t:fC(t),o=new SE(i.shape[0],i.shape[1],n),s=this.makeOutputArray(o.outputShape,"int32"),a=o.getCustomSetupFunc(r);return this.compileAndRun(o,[i],s,a)},t.prototype.oneHot=function(t,e,n,r){var i=new EE(t.size,e,n,r);return this.compileAndRun(i,[t])},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return _x("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),BC(t.dataSync(),e.dataSync(),n,r,i)},t.prototype.cropAndResize=function(t,e,n,r,i,o){var s=new AS(t.shape,e.shape,r,i,o);return this.compileAndRun(s,[t,e,n])},t.prototype.depthToSpace=function(t,e,n){jv(e>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+e});var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,s=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),a=new LS("NHWC"===n?[r,i,o,s]:[r,s,i,o],e,n);return this.compileAndRun(a,[t])},t.prototype.split=function(t,e,n){return VC(t,e,n)},t.prototype.scatterND=function(t,e,n){var r=eC(0,t,n),i=r.sliceRank,o=r.numUpdates,s=r.sliceSize,a=r.strides,u=r.outputSize,l=[u/s,s],c=t.reshape([o,i]),h=e.reshape([o,s]);if(0===u)return OC(Vx([]),n);var p=Wx(0),d=new BE(o,i,c.rank,h.rank,a,l);return this.compileAndRun(d,[h,c,p]).reshape(n)},t.prototype.sparseToDense=function(t,e,n,r){var i=eC(0,t,n),o=new BE(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(o,[e,t,r]).reshape(n)},t.prototype.fft=function(t){return this.fftImpl(t,!1)},t.prototype.ifft=function(t){return this.fftImpl(t,!0)},t.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new jS("return real * expR - imag * expI;",t.shape,e),i=new jS("return real * expI + imag * expR;",t.shape,e),o=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag)],s=this.compileAndRun(r,o),a=this.compileAndRun(i,o),u=this.complex(s,a).as2D(t.shape[0],t.shape[1]);return s.dispose(),a.dispose(),u},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=Y_(t,e),o=i[0],s=i[1],a=i[2],u=i[3],l=e.reshape([s,r]),c=t.reshape([t.size/a,a]),h=new GS(r,u,[s,a]);return this.compileAndRun(h,[c,l]).reshape(o)},t.prototype.fill=function(t,e,n){if("string"===(n=n||fb(e))){var r=rb(n,$v(t));return r.fill(e),zb.make(t,{values:r},n)}var i=new WS(t,e),o=i.getCustomSetupFunc(e),s=this.makeOutputArray(t,n);return this.compileAndRun(i,[],s,o)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},t.prototype.linspace=function(t,e,n){return DC(t,e,n)},t.prototype.makeOutputArray=function(t,e){return zb.make(t,{},e,this)},t.prototype.makePackedTensor=function(t,e){var n=zb.make(t,{},e,this);return this.texData.get(n.dataId).isPacked=!0,n},t.prototype.unpackTensor=function(t){var e=new ik(t.shape);return this.compileAndRun(e,[t],zb.make(e.outputShape,{},t.dtype,this))},t.prototype.packTensor=function(t){var e=new kE(t.shape);return this.compileAndRun(e,[t],this.makePackedTensor(t.shape,t.dtype),null,!0)},t.prototype.packedReshape=function(t,e){var n=t.reshape([Uw(t.shape)].concat(Vw(t.shape))),r=[Uw(e)].concat(Vw(e)),i=new RE(r,n.shape);return this.compileAndRun(i,[n]).reshape(e)},t.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,s=jw(i),a=XS(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=o,this.texData.get(u.dataId).texShape=a.map(function(t){return 2*t}),e=r?new MS(s,a):new FS(s,a),this.compileAndRun(e,[{shape:s,dtype:o,dataId:t}],u,null,!0),u},t.prototype.compileAndRun=function(t,e,n,r,i){var o=this;if(void 0===i&&(i=!1),null==n&&(n=t.usesPackedTextures?this.makePackedTensor(t.outputShape,e[0].dtype):this.makeOutputArray(t.outputShape,e[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=nb(n.dtype,0),n;var s=e.map(function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.usesPackedTextures&&$v(e.shape)<=Fv.getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.usesPackedTextures&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.usesPackedTextures)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!qw(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(n.dataId);var a,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},l=function(t,e,n){var r="";return s.concat(u).forEach(function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)}),t.constructor.name+"_"+r+"_"+t.userCode}(t),c=this.getAndSaveBinary(l,function(){return function(t,e,n,r){var i=e.userCode,o=n.map(function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}}),s=o.map(function(t){return t.shapeInfo}),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=function(t,e,n,r){var i=[];t.forEach(function(t){var e=$v(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))});var o,s,a=i.join("\n"),u=t.map(function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+QC().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=QC();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],s=i[1],a=QC();if(null!=i&&Gv(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+s+".0, "+o+".0);\n\n        return "+a.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+a.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var a=rS(e,n.slice(1));return"\n        "+t(a)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+iS(["b","row","col"],[1,2])+");\n        }\n      "}var u=s[0],l=s[1],c=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+l+", "+c*Math.ceil(n[1]/2)+", "+c+", b, row, col);\n      return "+QC().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],a=s[0],u=s[1],l=Math.ceil(e[n-1]/2),c=l*Math.ceil(e[n-2]/2),h="int b, int row, int col",p="b * "+c+" + (row / 2) * "+l+" + (col / 2)",d=2;d<n-1;d++)h="int b"+d+", "+h,p="b"+d+" * "+(c*=e[n-d-1])+" + "+p;return"\n    vec4 "+i+"("+h+") {\n      int index = "+p+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+a+");\n      return "+QC().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+tS(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+eS(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var s=tS(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+s+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+s+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+s+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&Gv(n,o))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+o[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var s=eb(n),a=s.newShape,u=s.keptDims;if(a.length<n.length){var l=rS(e,a);return"\n      "+t(l)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+iS(["row","col"],u)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+eS(e)+"\n      }\n    ";var c=o[0],h=o[1],p=tS(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+p+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+c+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===c?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+p+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+p+";\n    vec2 uv = uvFromFlat("+c+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],a=eb(n),u=a.newShape,l=a.keptDims;if(u.length<n.length){var c=rS(e,u);return"\n        "+t(c)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+iS(["row","col","depth"],l)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+s+", 1)));\n        "+eS(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,p=h[0],d=h[1],f=e.shapeInfo.flatOffset;return d===o&&null==f?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+s+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+p+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":d===s&&null==f?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+p+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+s+" + depth + "+tS(r)+";\n        vec2 uv = uvFromFlat("+p+", "+d+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,a=n[1]*s,u=eb(n),l=u.newShape,c=u.keptDims;if(l.length<n.length){var h=rS(e,l);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+iS(["row","col","depth","depth2"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+s+", "+o+", 1)));\n        "+eS(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],m=d[1];return m===a&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+s+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+f+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===o&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+f+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+s+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+f+", "+m+", index + "+tS(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[4],s=n[3]*o,a=n[2]*s,u=n[1]*a,l=eb(n),c=l.newShape,h=l.keptDims;if(c.length<n.length){var p=rS(e,c);return"\n      "+t(p)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+iS(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+a+", "+s+", "+o+")) +\n          depth3;\n        "+eS(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,m=f[0],g=f[1];return g===u&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+s+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===o&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+a+" + depth * "+s+" +\n          depth2 * "+o+" + depth3 + "+tS(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=eb(n),s=o.newShape,a=o.keptDims;if(s.length<n.length){var u=rS(e,s);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+iS(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    "}var l=n[5],c=n[4]*l,h=n[3]*c,p=n[2]*h,d=n[1]*p;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+d+", "+p+", "+h+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+l+", 1)));\n        "+eS(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,g=m[0],y=m[1];return y===d&&null==f?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+p+", "+h+", "+c+", "+l+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+y+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":y===l&&null==f?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+y+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+d+" + col * "+p+" + depth * "+h+" +\n          depth2 * "+c+" + depth3 * "+l+" + depth4 + "+tS(r)+";\n      vec2 uv = uvFromFlat("+g+", "+y+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,o=i.charAt(0).toUpperCase()+i.slice(1),s="get"+o+"AtOutCoords",a=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,l=vC(t.shapeInfo.logicalShape,e.logicalShape),c=nS(u),h=u-a,p=["x","y","z","w","u","v"];n=0===a?"":u<2&&l.length>=1?"coords = 0;":l.map(function(t){return"coords."+p[t+h]+" = 0;"}).join("\n"),r=u<2&&a>0?"coords":t.shapeInfo.logicalShape.map(function(t,e){return"coords."+p[e+h]}).join(", ");var d="return outputValue;",f=1===$v(t.shapeInfo.logicalShape),m=1===$v(e.logicalShape);if(1!==a||f||m){if(f&&!m)d=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){var g=a-2,y=a-1;l.indexOf(g)>-1&&l.indexOf(y)>-1?d="return vec4(outputValue.x);":l.indexOf(g)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(y)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+s+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+r+");\n      "+d+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===s&&null==t.shapeInfo.flatOffset&&Gv(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var a=nS(s),u=vC(t.shapeInfo.logicalShape,e.logicalShape),l=s-o,c=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+a+" coords = getOutputCoords();\n      "+(0===o?"":s<2&&u.length>=1?"coords = 0;":u.map(function(t){return"coords."+c[t+l]+" = 0;"}).join("\n"))+"\n      return get"+r+"("+(s<2&&o>0?"coords":t.shapeInfo.logicalShape.map(function(t,e){return"coords."+c[e+l]}).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)}).join("\n"),l=e.texShape,c=QC(),h="\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+c.texture2D+"(textureSampler, uv).r;\n    }\n  ",p=c.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+c.varyingFs+" vec2 resultUV;\n    "+c.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    #define isnan(value) isnan_custom(value)\n    "+c.defineSpecialNaN+"\n    bvec4 isnan_custom(vec4 val) {\n      return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n    }\n\n    "+c.defineSpecialInf+"\n    "+c.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  ";return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Gv(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],s=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+s+";\n      index -= b * "+s+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,s="",a="b, r, c",u=2;u<t.length-1;u++)s="\n      int b"+u+" = index / "+(o*=t[t.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+s,a="b"+u+", "+a;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+s+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+a+");\n    }\n  "}(t,e)}var n,r,i,o,s}(e.logicalShape,l),s="\n    void setOutput(vec4 val) {\n      "+c.output+" = val;\n    }\n  "):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return Gv(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=ZC(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=ZC(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=ZC(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=ZC(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,l),s="\n    void setOutput(float val) {\n      "+c.output+" = vec4(val, 0, 0, 0);\n    }\n  "),r&&(p+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[p,h,s,a,o,u,n].join("\n")}(o,a,i,e.usesPackedTextures),l=t.createProgram(u),c=null,h=t.getUniformLocation(l,"NAN",!1);1===Fv.getNumber("WEBGL_VERSION")&&(c=t.getUniformLocation(l,"INFINITY",!1));for(var p={},d=0;d<e.variableNames.length;d++){var f=e.variableNames[d];p[f]=t.getUniformLocation(l,f,!1),p["offset"+f]=t.getUniformLocation(l,"offset"+f,!1)}return{program:e,source:u,webGLProgram:l,uniformLocations:p,inShapeInfos:s,outShapeInfo:a,infLoc:c,nanLoc:h}}(o.gpgpu,t,s,u)}),h=null!=this.activeTimers;return h&&(a=this.startTimer()),function(t,e,n,r,i){yE(e.inShapeInfos,n),yE([e.outShapeInfo],[r]);var o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,s[0],s[1]):t.setOutputMatrixTexture(o,s[0],s[1]),t.setProgram(e.webGLProgram),1===Fv.getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach(function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],s=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if($v(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var a=n.uniformValues;a instanceof Float32Array||(a=new Float32Array(a)),t.gl.uniform1fv(o,a)}else null!=n.texData.slice&&null!=s&&t.gl.uniform1i(s,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)}),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,c,s,u,r),h&&(a=this.endTimer(a),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(a)})),!Fv.getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=lx(function(){var e=Fv.getBool("DEBUG");Fv.set("DEBUG",!1);var n=t.abs(Wx(1e-8)).dataSync()[0];return Fv.set("DEBUG",e),n>0?32:16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,s=n.usage,a=n.isPacked;if(null==n.texture){var u,l=null!=this.activeTimers;l&&(u=_b());var c=n.texShape;if(null==c&&(c=Ww(r,a),n.texShape=c),null!=o){var h=jw(r),p=void 0,d=c[1],f=c[0],m=o instanceof Uint8Array;a?(d=(e=QS(c[0],c[1]))[0],p=new VS(h,[f=e[1],d],m)):p=new US(h,[f,d],m);var g=this.makeTensorHandle([f,d],i);this.texData.get(g.dataId).usage=m?DS.PIXELS:DS.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,f,o);var y=this.makeTensorHandle(p.outputShape,g.dtype);y.size=$v(p.outputShape),this.texData.get(y.dataId).isPacked=a,this.compileAndRun(p,[g],y);var v=this.texData.get(y.dataId);n.texture=v.texture,n.texShape=v.texShape,n.isPacked=v.isPacked,n.usage=v.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=_b()-u)}else{var b=this.acquireTexture(c,s,i,a);n.texture=b}}},t.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},t.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},t.prototype.computeBytes=function(t,e){return t[0]*t[1]*lb(e)},t}();iw()&&rw.registerBackend("webgl",function(){return new ak},2);var uk=Lx({abs_:function(t){var e=Ex(t,"x","abs");return"complex64"===e.dtype?rw.runKernel(function(t){return t.complexAbs(e)},{$x:e}):rw.runKernel(function(t,n){var r=t.abs(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().step(-1))}}})}}),lk=Lx({acos_:function(t){var e=Ex(t,"x","acos");return rw.runKernel(function(t,n){var r=t.acos(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Wx(1).sub(n.toFloat().square()).sqrt()).neg()}}})}}),ck=Lx({acosh_:function(t){var e=Ex(t,"x","acosh");return rw.runKernel(function(t,n){var r=t.acosh(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}})}}),hk=Lx({asin_:function(t){var e=Ex(t,"x","asin");return rw.runKernel(function(t,n){var r=t.asin(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Wx(1).sub(n.toFloat().square()).sqrt())}}})}}),pk=Lx({asinh_:function(t){var e=Ex(t,"x","asinh");return rw.runKernel(function(t,n){var r=t.asinh(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Wx(1).add(n.toFloat().square()).sqrt())}}})}}),dk=Lx({atan_:function(t){var e=Ex(t,"x","atan");return rw.runKernel(function(t,n){var r=t.atan(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}})}}),fk=Lx({atanh_:function(t){var e=Ex(t,"x","atanh");return rw.runKernel(function(t,n){var r=t.atanh(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(Wx(1).sub(n.toFloat().square()))}}})}}),mk=Lx({ceil_:function(t){var e=Ex(t,"x","ceil");return rw.runKernel(function(t){return t.ceil(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),gk=Lx({clipByValue_:function(t,e,n){var r=Ex(t,"x","clipByValue");return jv(e<=n,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."}),rw.runKernel(function(t,i){var o=t.clip(r,e,n);return i([r]),o},{$x:r},function(t,r){var i=r[0];return{$x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),n_(t))}}})}}),yk=Lx({cos_:function(t){var e=Ex(t,"x","cos");return rw.runKernel(function(t,n){var r=t.cos(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}})}}),vk=Lx({cosh_:function(t){var e=Ex(t,"x","cosh");return rw.runKernel(function(t,n){var r=t.cosh(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}})}}),bk=Lx({erf_:function(t){var e=Ex(t,"x","erf");return jv("int32"===e.dtype||"float32"===e.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===e.dtype&&(e=e.toFloat()),rw.runKernel(function(t,n){var r=t.erf(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),wk=Lx({exp_:function(t){var e=Ex(t,"x","exp");return rw.runKernel(function(t,n){var r=t.exp(e);return n([r]),r},{$x:e},function(t,e){return{$x:function(){return t.mulStrict(e[0])}}})}}),xk=Lx({expm1_:function(t){var e=Ex(t,"x","expm1");return rw.runKernel(function(t,n){var r=t.expm1(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}})}}),_k=Lx({floor_:function(t){var e=Ex(t,"x","floor");return rw.runKernel(function(t){return t.floor(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),Ck=Lx({log_:function(t){var e=Ex(t,"x","log");return rw.runKernel(function(t,n){var r=t.log(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}})}}),Sk=Lx({log1p_:function(t){var e=Ex(t,"x","log1p");return rw.runKernel(function(t,n){var r=t.log1p(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}})}}),Ek=Lx({logSigmoid_:function(t){var e=Ex(t,"x","logSigmoid");return rw.runKernel(function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}})}}),kk=Lx({neg_:function(t){var e=Ex(t,"x","neg");return rw.runKernel(function(t){return t.neg(e)},{$x:e},function(t){return{$x:function(){return t.neg()}}})}}),Nk=Lx({reciprocal_:function(t){var e=Ex(t,"x","reciprocal");return rw.runKernel(function(t,n){var r=t.reciprocal(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}})}}),Ik=Lx({round_:function(t){var e=Ex(t,"x","round");return rw.runKernel(function(t){return t.round(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),Tk=Lx({rsqrt_:function(t){var e=Ex(t,"x","rsqrt");return rw.runKernel(function(t,n){var r=t.rsqrt(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}})}}),Ak=Lx({sigmoid_:function(t){var e=Ex(t,"x","sigmoid");return rw.runKernel(function(t,n){var r=t.sigmoid(e);return n([r]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.mul(Wx(1).sub(n)))}}})}}),Rk=Lx({sign_:function(t){var e=Ex(t,"x","sign");return rw.runKernel(function(t){return t.sign(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),Ok=Lx({isNaN_:function(t){var e=Ex(t,"x","isNaN");return rw.runKernel(function(t){return t.isNaN(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),Dk=Lx({isInf_:function(t){var e=Ex(t,"x","isInf");return rw.runKernel(function(t){return t.isInf(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),Pk=Lx({isFinite_:function(t){var e=Ex(t,"x","isFinite");return rw.runKernel(function(t){return t.isFinite(e)},{$x:e},function(t){return{$x:function(){return n_(t)}}})}}),Fk=Lx({sin_:function(t){var e=Ex(t,"x","sin");return rw.runKernel(function(t,n){var r=t.sin(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}})}}),Mk=Lx({sinh_:function(t){var e=Ex(t,"x","sinh");return rw.runKernel(function(t,n){var r=t.sinh(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}})}}),Lk=Lx({softplus_:function(t){var e=Ex(t,"x","softplus");return rw.runKernel(function(t,n){var r=t.softplus(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}})}}),zk=Lx({sqrt_:function(t){var e=Ex(t,"x","sqrt");return rw.runKernel(function(t,n){var r=t.sqrt(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}})}}),Bk=Lx({square_:function(t){var e=Ex(t,"x","square");return rw.runKernel(function(t,n){return n([e]),t.square(e)},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().mul(2))}}})}}),Uk=Lx({step_:function(t,e){void 0===e&&(e=0);var n=Ex(t,"x","step");return rw.runKernel(function(t){return t.step(n,e)},{$x:n},function(t){return{$x:function(){return n_(t)}}})}}),Vk=Lx({tan_:function(t){var e=Ex(t,"x","tan");return rw.runKernel(function(t,n){var r=t.tan(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}})}}),jk=Lx({tanh_:function(t){var e=Ex(t,"x","tanh");return rw.runKernel(function(t,n){var r=t.tanh(e);return n([r]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return Wx(1).sub(n.square()).mulStrict(t)}}})}});function Wk(t,e,n,r,i,o){var s,a,u=Ex(t,"x","batchNorm"),l=Ex(e,"mean","batchNorm"),c=Ex(n,"variance","batchNorm");return null!=i&&(s=Ex(i,"scale","batchNorm")),null!=r&&(a=Ex(r,"offset","batchNorm")),jv(2===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),jv(2===l.rank||1===l.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),jv(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),null!=s&&jv(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),null!=a&&jv(2===a.rank||1===a.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."}),$k(u,l,c,a,s,o)}function Hk(t,e,n,r,i,o){var s,a,u=Ex(t,"x","batchNorm"),l=Ex(e,"mean","batchNorm"),c=Ex(n,"variance","batchNorm");return null!=i&&(s=Ex(i,"scale","batchNorm")),null!=r&&(a=Ex(r,"offset","batchNorm")),jv(3===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),jv(3===l.rank||1===l.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),jv(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),null!=s&&jv(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),null!=a&&jv(3===a.rank||1===a.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."}),$k(u,l,c,a,s,o)}function qk(t,e,n,r,i,o){var s,a,u=Ex(t,"x","batchNorm"),l=Ex(e,"mean","batchNorm"),c=Ex(n,"variance","batchNorm");return null!=i&&(s=Ex(i,"scale","batchNorm")),null!=r&&(a=Ex(r,"offset","batchNorm")),jv(4===u.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),jv(4===l.rank||1===l.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),jv(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),null!=s&&jv(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),null!=a&&jv(4===a.rank||1===a.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."}),$k(u,l,c,a,s,o)}function $k(t,e,n,r,i,o){null==o&&(o=.001);var s,a,u,l=Ex(t,"x","batchNorm"),c=Ex(e,"mean","batchNorm"),h=Ex(n,"variance","batchNorm");return null!=i&&(s=Ex(i,"scale","batchNorm")),null!=r&&(a=Ex(r,"offset","batchNorm")),jv(c.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),jv(null==a||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),jv(null==s||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=0===l.rank||1===l.rank?l.as4D(1,1,1,l.size):2===l.rank?l.as4D(1,1,l.shape[0],l.shape[1]):3===l.rank?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l,rw.runKernel(function(t,e){var n=t.batchNormalization(u,Gk(c),Gk(h),o,Gk(s),Gk(a));return e([l,c,h,s]),n},{$x:l,$mean:c,$variance:h,$scale:s,$offset:a},function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],a=null==s?Wx(1):s,l=bC(r.shape,u.shape),c=[];if(1===r.rank){for(var h=0;h<u.shape.length-1;++h)c.push(u.shape[h]);c.push(1)}var p=n.sub(r),d=t.mul(a),f=Tk(i.add(Wx(o))),m=f.mul(f).mul(f).mul(Wx(-.5));return{$x:function(){return 1===r.rank?t.mul(W_(f.as4D(1,1,1,r.shape[0]),c)).mul(a).reshape(n.shape):t.mul(f).mul(a).reshape(n.shape)},$mean:function(){var t=f.mul(Wx(-1)).mul(d);return 1===r.rank&&(t=t.sum(l)),t.reshape(r.shape)},$variance:function(){var t=m.mul(p).mul(d);return 1===r.rank&&(t=t.sum(l)),t.reshape(r.shape)},$scale:function(){var e=p.mul(f),n=t.mul(e);return 1===r.rank&&(n=n.sum(l)),n.reshape(r.shape)},$offset:function(){var e=t;return 1===r.rank&&(e=e.sum(l)),e.reshape(r.shape)}}}).reshape(l.shape)}function Gk(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Kk(){ox("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Xk=Lx({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Kk(),Wk(t,e,n,o,i,r)}}),Qk=Lx({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Kk(),Hk(t,e,n,o,i,r)}}),Zk=Lx({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Kk(),qk(t,e,n,o,i,r)}}),Yk=Lx({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),Kk(),$k(t,e,n,o,i,r)}}),Jk=Lx({batchNorm_:$k}),tN=Lx({batchNorm2d_:Wk}),eN=Lx({batchNorm3d_:Hk}),nN=Lx({batchNorm4d_:qk});function rN(t,e,n,r,i,o){jv(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var s=t,a=e,u=!1;3===e.rank&&(u=!0,a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]);var l=s[3],c=a.shape[3];jv(4===s.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),jv(4===a.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+a.rank}),jv(4===n.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}),jv(l===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."}),jv(c===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[3]+"."}),null!=o&&jv(Kv(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var h=_C(s,n.shape,r,1,i,o),p=rw.runKernel(function(t,e){var r=t.conv2dDerInput(a,n,h);return e([n,a]),r},{dy4D:a,filter:n},function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return aN(t,n,r,i,"NHWC",1,o)},filter:function(){return lN(t,s,n.shape,r,i,o)}}});return u?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function iN(t,e,n,r,i,o){var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=e;3===a.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),jv(4===s.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),jv(4===a.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+a.shape+"."}),jv(4===n.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}),jv(s.shape[3]===n[2],function(){return"Error in conv2dDerFilter: depth of input "+s.shape[3]+") must match input depth in filter ("+n[2]+"."}),jv(a.shape[3]===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+a.shape[3]+") must match output depth for filter ("+n[3]+")."}),null!=o&&jv(Kv(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var u=_C(s.shape,n,r,1,i,o);return rw.runKernel(function(t){return t.conv2dDerFilter(s,a,u)},{x4D:s,dy4D:a})}function oN(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}var sN=Lx({conv1d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NWC"),void 0===o&&(o=1);var a=Ex(t,"x","conv1d"),u=Ex(e,"filter","conv1d"),l=a,c=!1;2===a.rank&&(c=!0,l=a.as3D(1,a.shape[0],a.shape[1])),jv(3===l.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),jv(3===u.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),null!=s&&jv(Kv(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}),jv(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),jv(AC(n,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"}),jv("NWC"===i,function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),d=aN(p,h,[1,n],r,"NHWC",[1,o],s);return c?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),aN=Lx({conv2d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var a=Ex(t,"x","conv2d"),u=Ex(e,"filter","conv2d"),l=a,c=!1;3===a.rank&&(c=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),jv(4===l.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),jv(4===u.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),null!=s&&jv(Kv(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}),jv(l.shape[3]===u.shape[2],function(){return"Error in conv2d: depth of input ("+l.shape[3]+") must match input depth for filter "+u.shape[2]+"."}),jv(AC(n,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),jv("NHWC"===i,function(){return"Error in conv2d: got dataFormat of "+i+" but only NHWC is currently supported."});var h=_C(l.shape,u.shape,n,o,r,s),p=rw.runKernel(function(t,e){var n=t.conv2d(l,u,h);return e([u,l]),n},{x:l,$filter:u},function(t,e){var i=e[0],s=e[1];return jv(TC(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return rN(s.shape,t,i,n,r)},$filter:function(){return iN(s,t,i.shape,n,r)}}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),uN=Lx({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var s=Ex(t,"x","conv3d"),a=Ex(e,"filter","conv3d"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),jv(5===u.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),jv(5===a.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."}),jv(u.shape[4]===a.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."}),jv(function(t,e){return oN(n)||oN(e)}(0,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),jv("NDHWC"===i,function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=CC(u.shape,a.shape,n,o,r),h=rw.runKernel(function(t,e){var n=t.conv3d(u,a,c);return e([u,a]),n},{x:u,$filter:a},function(t,e){jv(oN(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var i=e[0],s=e[1];return{x:function(){return function(t,e,n,r,i){jv(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var o=t,s=e,a=!1;4===e.rank&&(a=!0,s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],l=s.shape[4];jv(5===o.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),jv(5===s.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),jv(5===n.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),jv(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),jv(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=CC(o,n.shape,r,1,i),h=rw.runKernel(function(t){return t.conv3dDerInput(s,n,c)},{dy5D:s});return a?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}(i.shape,t,s,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var s=e;4===s.rank&&(s=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),jv(5===o.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."}),jv(5===s.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+s.shape+"."}),jv(5===n.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."}),jv(o.shape[4]===n[3],function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."}),jv(s.shape[4]===n[4],function(){return"Error in conv3dDerFilter: depth of dy ("+s.shape[4]+") must match output depth for filter ("+n[4]+")."});var a=CC(o.shape,n,r,1,i);return rw.runKernel(function(t){return t.conv3dDerFilter(o,s,a)},{x5D:o,dy5D:s})}(i,t,s.shape,n,r)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),lN=Lx({conv2dDerFilter_:iN}),cN=Lx({depthwiseConv2d_:function(t,e,n,r,i,o,s){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var a=Ex(t,"x","depthwiseConv2d"),u=Ex(e,"filter","depthwiseConv2d"),l=a,c=!1;3===a.rank&&(c=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),jv(4===l.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),jv(4===u.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),jv(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),null==o&&(o=[1,1]),jv(AC(n,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),null!=s&&jv(Kv(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var h=_C(l.shape,u.shape,n,o,r,s,!0),p=rw.runKernel(function(t,e){var n=t.depthwiseConv2D(l,u,h);return e([l,u]),n},{x:l,$filter:u},function(t,e){jv(TC(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var n=e[0],r=e[1];return{x:function(){return function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=rw.runKernel(function(t){return t.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}(0,t,r,h)},$filter:function(){return function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),rw.runKernel(function(t){return t.depthwiseConv2DDerFilter(i,o,r)},{x4D:i,dy4D:o})}(n,t,0,h)}}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),hN=Lx({separableConv2d_:function(t,e,n,r,i,o,s){void 0===o&&(o=[1,1]),void 0===s&&(s="NHWC");var a=Ex(t,"x","separableConv2d"),u=Ex(e,"depthwiseFilter","separableConv2d"),l=Ex(n,"pointwiseFilter","separableConv2d"),c=a,h=!1;if(3===a.rank&&(h=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");jv(4===c.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),jv(4===u.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),jv(4===l.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),jv(1===l.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),jv(1===l.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var p=u.shape[2],d=u.shape[3];jv(l.shape[2]===p*d,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*d+", but got "+l.shape[2]+"."});var f=cN(c,u,r,i,s,o),m=aN(f,l,1,"valid",s);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),pN=Lx({conv2dTranspose_:function(t,e,n,r,i,o){return rN(n,Ex(t,"x","conv2dTranspose"),Ex(e,"filter","conv2dTranspose"),r,i,o)}}),dN=Lx({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=Ex(t,"a","matMul"),s=Ex(e,"b","matMul");i=Qb(o,s),o=i[0],s=i[1];var a=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],l=n?o.shape[o.rank-1]:o.shape[o.rank-2],c=r?s.shape[s.rank-2]:s.shape[s.rank-1],h=o.shape.slice(0,-2),p=s.shape.slice(0,-2),d=$v(h),f=$v(p);jv(o.rank>=2&&s.rank>=2&&o.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."}),jv(Gv(h,p),function(){return"Error in matMul: outer dimensions ("+h+") and ("+p+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."}),jv(a===u,function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=o.shape.slice(0,-2).concat([l,c]),g=n?o.as3D(d,a,l):o.as3D(d,l,a),y=r?s.as3D(f,c,u):s.as3D(f,u,c);return rw.runKernel(function(t,e){var i=t.batchMatMul(g,y,n,r);return e([g,y]),i},{$a:g,$b:y},function(t,e){var i=e[0],o=e[1];return n||r?!n&&r?{$a:function(){return t.matMul(o,!1,!1)},$b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(t,!1,!0)},$b:function(){return i.matMul(t,!1,!1)}}:{$a:function(){return o.matMul(t,!0,!0)},$b:function(){return t.matMul(i,!0,!0)}}:{$a:function(){return t.matMul(o,!1,!0)},$b:function(){return i.matMul(t,!0,!1)}}}).reshape(m)}}),fN=Lx({dot_:function(t,e){var n=Ex(t,"t1","dot"),r=Ex(e,"t2","dot");jv(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return jv(i===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."}),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),mN=Lx({outerProduct_:function(t,e){var n=Ex(t,"v1","outerProduct"),r=Ex(e,"v2","outerProduct");return jv(1===n.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),gN=Lx({reverse_:function(t,e){var n=Ex(t,"x","reverse");if(0===n.rank)return n.clone();var r=tb(e,n.shape);return rw.runKernel(function(t){return t.reverse(n,r)},{$x:n},function(t){return{$x:function(){return t.reverse(r)}}}).reshapeAs(n)}}),yN=Lx({reverse1d_:function(t){var e=Ex(t,"x","reverse");return jv(1===e.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),gN(e,0)}}),vN=Lx({reverse2d_:function(t,e){var n=Ex(t,"x","reverse");return jv(2===n.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),gN(n,e)}}),bN=Lx({reverse3d_:function(t,e){var n=Ex(t,"x","reverse");return jv(3===n.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),gN(n,e)}}),wN=Lx({reverse4d_:function(t,e){var n=Ex(t,"x","reverse");return jv(4===n.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),gN(n,e)}});function xN(t,e,n,r,i,o){var s=Ex(t,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),null==r&&(r=[1,1]),jv(4===a.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."}),jv(AC(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),null!=o&&jv(Kv(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=xC(a.shape,e,n,r,i,o),c=rw.runKernel(function(t,e){var n=t.maxPool(a,l);return e([a,n]),n},{x:a},function(t,o){var s=o[0],a=o[1];return{x:function(){return function(t,e,n,r,i,o,s,a){var u=Ex(t,"dy","maxPoolBackprop"),l=Ex(e,"input","maxPoolBackprop"),c=Ex(n,"output","maxPoolBackprop");jv(l.rank===u.rank,function(){return"Rank of input ("+l.rank+") does not match rank of dy ("+u.rank+")"}),null==o&&(o=[1,1]),jv(AC(i,o),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"}),jv(4===u.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."}),jv(4===l.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+l.rank+"."});var h=xC(l.shape,r,i,o,s,void 0);return rw.runKernel(function(t){return t.maxPoolBackprop(u,l,c,h)},{$dy:u,$input:l})}(t,s,a,e,n,r,i)}}});return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function _N(t,e,n,r,i,o){var s=Ex(t,"x","avgPool","float32");null==r&&(r=[1,1]),jv(AC(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),jv(4===a.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."}),null!=o&&jv(Kv(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=xC(a.shape,e,n,r,i,o),c=rw.runKernel(function(t){return t.avgPool(a,l)},{x:a},function(t){return{x:function(){return function(t,e,n,r,i,o){var s=Ex(t,"dy","avgPoolBackprop"),a=Ex(e,"input","avgPoolBackprop");jv(a.rank===s.rank,function(){return"Rank of input ("+a.rank+") does not match rank of dy ("+s.rank+")"}),null==i&&(i=[1,1]),jv(AC(r,i),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"});var u=a,l=s,c=!1;3===a.rank&&(c=!0,u=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]),l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),jv(4===l.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."}),jv(4===u.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."});var h=xC(u.shape,n,r,i,o),p=rw.runKernel(function(t){return t.avgPoolBackprop(l,u,h)},{dy4D:l,input4D:u});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}(t,a,e,n,r,i)}}});return c=c.cast(s.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var CN=Lx({maxPool_:function(t,e,n,r,i){return xN(t,e,n,1,r,i)}}),SN=Lx({avgPool_:function(t,e,n,r,i){return _N(t,e,n,1,r,i)}}),EN=Lx({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var s=Ex(t,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),jv(AC(o,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"});var l,c=xC(a.shape,e,o,i,r),h=[c.dilationHeight,c.dilationWidth];l="same"===r?function(t,e){var n=[c.filterHeight,c.filterWidth].map(function(t,n){return t+(t-1)*(e[n]-1)}).map(function(t){return t-1}),r=n.map(function(t){return Math.floor(t/2)}),i=n.map(function(t,e){return t-r[e]});return n.map(function(t,e){return[r[e],i[e]]})}(0,h):[[0,0],[0,0]];var p=1===h[0]&&1===h[1],d=function(t,e,n){var r=n.map(function(t){return t[0]}),i=n.map(function(t){return t[1]}),o=t.concat(r,i),s=e.map(function(t,e){return(t-o[e]%t)%t}),a=i.map(function(t,e){return t+s[e]});return[e.map(function(t,e){return[r[e],a[e]]}),e.map(function(t,e){return[0,s[e]]})]}([c.inHeight,c.inWidth],h,l),f=d[1],m=p?r:"valid",g=p?a:U_(a,h,d[0]),y=("avg"===n?function(){return _N(g,e,o,1,m)}:function(){return xN(g,e,o,1,m)})(),v=p?y:__(y,h,f);return u?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),kN=Lx({slice_:function(t,e,n){var r,i,o=Ex(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice(),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map(function(t,e){return t>=0?t:(jv(-1===t,function(){return"Bad value in size"}),o.shape[e]-r[e])}),function(t,e,n){jv(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."}),jv(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."});for(var r=function(r){jv(e[r]+n[r]<=t.shape[r],function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"})},i=0;i<t.rank;++i)r(i)}(o,r,i);var s=o.shape;return rw.runKernel(function(t){return t.slice(o,r,i)},{$x:o},function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],s[n]-r[n]-i[n]]);return{$x:function(){return t.pad(e)}}})}}),NN=Lx({slice1d_:function(t,e,n){var r=Ex(t,"x","slice1d");return jv(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),kN(r,[e],[n])}}),IN=Lx({slice2d_:function(t,e,n){var r=Ex(t,"x","slice2d");return jv(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),kN(r,e,n)}}),TN=Lx({slice3d_:function(t,e,n){var r=Ex(t,"x","slice3d");return jv(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),kN(r,e,n)}}),AN=Lx({slice4d_:function(t,e,n){var r=Ex(t,"x","slice4d");return jv(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),kN(r,e,n)}});function RN(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(Ax(e.shape,r))),t.rank<n.rank&&(t=t.reshape(Ax(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var ON=Lx({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","all","bool"),i=tb(e,r.shape),o=i,s=Ox(o,r.rank);null!=s&&(r=r.transpose(s),o=Px(o.length,r.rank));var a=rw.runKernel(function(t){return t.all(r,o)},{$x:r});if(n){var u=Ax(a.shape,i);return a.reshape(u)}return a}}),DN=Lx({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","any","bool"),i=tb(e,r.shape),o=i,s=Ox(o,r.rank);null!=s&&(r=r.transpose(s),o=Px(o.length,r.rank));var a=rw.runKernel(function(t){return t.any(r,o)},{$x:r});if(n){var u=Ax(a.shape,i);return a.reshape(u)}return a}}),PN=Lx({argMax_:function(t,e){void 0===e&&(e=0);var n=Ex(t,"x","argMax");null==e&&(e=0);var r=tb(e,n.shape),i=Ox(r,n.rank);return null!=i&&(n=n.transpose(i),r=Px(r.length,n.rank)),rw.runKernel(function(t,e){var i=t.argMax(n,r[0]);return e([n]),i},{$x:n},function(t,e){var n=e[0];return{$x:function(){return n_(n)}}})}}),FN=Lx({argMin_:function(t,e){void 0===e&&(e=0);var n=Ex(t,"x","argMin");null==e&&(e=0);var r=tb(e,n.shape),i=Ox(r,n.rank);return null!=i&&(n=n.transpose(i),r=Px(r.length,n.rank)),rw.runKernel(function(t,e){var i=t.argMin(n,r[0]);return e([n]),i},{$x:n},function(t,e){var n=e[0];return{$x:function(){return n_(n)}}})}}),MN=Lx({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","logSumExp"),i=tb(e,r.shape),o=r.max(i,!0),s=r.sub(o).exp().sum(i).log(),a=o.reshape(s.shape).add(s);if(n){var u=Ax(a.shape,i);return a.reshape(u)}return a}}),LN=Lx({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","max"),i=r,o=tb(e,r.shape),s=o,a=Ox(s,r.rank);null!=a&&(r=r.transpose(a),s=Px(s.length,r.rank));var u=rw.runKernel(function(t,e){var n=t.max(r,s);return e([i,n]),n},{$x:r},function(t,e){return RN(t,e[1],e[0],o,a)});if(n){var l=Ax(u.shape,o);u=u.reshape(l)}return u}}),zN=Lx({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","mean"),i=tb(e,r.shape),o=$v(Tx(r.shape,i)[1]);return pC(function(t){var r=Wx(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach(function(t){n[t]=1}),e.reshape(n).mul(Qx(t.shape,"float32")).div(o)}}})(r)}}),BN=Lx({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","min"),i=r,o=tb(e,r.shape),s=o,a=Ox(s,r.rank);null!=a&&(r=r.transpose(a),s=Px(s.length,r.rank));var u=rw.runKernel(function(t,e){var n=t.min(r,s);return e([i,n]),n},{$x:r},function(t,e){return RN(t,e[1],e[0],o,a)});if(n){var l=Ax(u.shape,o);u=u.reshape(l)}return u}}),UN=Lx({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tb(e,(t=Ex(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=Ax(i.shape,r));var s=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:s.mean(r,n)}}}),VN=Lx({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=tb(e,r.shape);return pC(function(t){var e=Ox(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=Px(r.length,t.rank));var s=rw.runKernel(function(t){return t.sum(o,r)},{permutedX:o});if(n){var a=Ax(s.shape,i);s=s.reshape(a)}return{value:s,gradFunc:function(e){var n=t.shape.slice();return i.forEach(function(t){n[t]=1}),e.reshape(n).mul(Qx(t.shape,"float32"))}}})(r)}}),jN=Lx({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ex(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=tb(e,r.shape),o=Ox(i,r.rank),s=i,a=r;null!=o&&(a=r.transpose(o),s=Px(s.length,r.rank));var u=rw.runKernel(function(t){return t.prod(a,s)},{permutedX:a});if(n){var l=Ax(u.shape,i);u=u.reshape(l)}return u}}),WN=Lx({equal_:function(t,e){var n,r=Ex(t,"a","equal"),i=Ex(e,"b","equal");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t){return t.equal(r,i)},{$a:r,$b:i})}}),HN=Lx({equalStrict_:function(t,e){var n=Ex(t,"a","equalStrict"),r=Ex(e,"b","equalStrict");return Wv(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),qN=Lx({greater_:function(t,e){var n,r=Ex(t,"a","greater"),i=Ex(e,"b","greater");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t){return t.greater(r,i)},{$a:r,$b:i})}}),$N=Lx({greaterEqual_:function(t,e){var n,r=Ex(t,"a","greaterEqual"),i=Ex(e,"b","greaterEqual");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){return n_(n)},$b:function(){return n_(r)}}})}}),GN=Lx({greaterEqualStrict_:function(t,e){var n=Ex(t,"a","greaterEqualStrict"),r=Ex(e,"b","greaterEqualStrict");return Wv(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),KN=Lx({greaterStrict_:function(t,e){var n=Ex(t,"a","greaterStrict"),r=Ex(e,"b","greaterStrict");return Wv(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),XN=Lx({less_:function(t,e){var n,r=Ex(t,"a","less"),i=Ex(e,"b","less");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t){return t.less(r,i)},{$a:r,$b:i})}}),QN=Lx({lessEqual_:function(t,e){var n,r=Ex(t,"a","lessEqual"),i=Ex(e,"b","lessEqual");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t){return t.lessEqual(r,i)},{$a:r,$b:i})}}),ZN=Lx({lessEqualStrict_:function(t,e){var n=Ex(t,"a","lessEqualStrict"),r=Ex(e,"b","lessEqualStrict");return Wv(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),YN=Lx({lessStrict_:function(t,e){var n=Ex(t,"a","lessStrict"),r=Ex(e,"b","lessStrict");return Wv(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),JN=Lx({notEqual_:function(t,e){var n,r=Ex(t,"a","notEqual"),i=Ex(e,"b","notEqual");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t){return t.notEqual(r,i)},{$a:r,$b:i})}}),tI=Lx({notEqualStrict_:function(t,e){var n=Ex(t,"a","notEqualStrict"),r=Ex(e,"b","notEqualStrict");return Wv(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),eI=Lx({add_:function(t,e){var n,r=Ex(t,"a","add"),i=Ex(e,"b","add");n=Qb(r,i);var o=wC((r=n[0]).shape,(i=n[1]).shape);return rw.runKernel(function(t){return t.add(r,i)},{$a:r,$b:i},function(t){return{$a:function(){var e=t,n=bC(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=bC(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}})}}),nI=Lx({addN_:function(t){jv(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),jv(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var e=t.map(function(t,e){return Ex(t,"tensors"+e,"addN")}),n=e[0];return e.forEach(function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(t){if(!Gv(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),rw.runKernel(function(t){return t.addN(e)},e,function(t){var n={};return e.forEach(function(e,r){n[r]=function(){return t.clone()}}),n})}}),rI=Lx({addStrict_:function(t,e){var n=Ex(t,"a","addStrict"),r=Ex(e,"b","addStrict");return Wv(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),iI=Lx({atan2_:function(t,e){var n,r=Ex(t,"a","atan2"),i=Ex(e,"b","atan2");n=Qb(r,i);var o=wC((r=n[0]).shape,(i=n[1]).shape);return rw.runKernel(function(t,e){var n=t.atan2(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=eI(n.square(),r.square()),i=t.mul(r.div(e)),s=bC(n.shape,o);return s.length>0&&(i=i.sum(s)),i.reshape(n.shape)},$b:function(){var e=eI(n.square(),r.square()),i=kk(t.mul(n.div(e))),s=bC(r.shape,o);return s.length>0&&(i=i.sum(s)),i.reshape(r.shape)}}})}}),oI=Lx({div_:function(t,e){var n,r=Ex(t,"a","div"),i=Ex(e,"b","div");if(n=Qb(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype)return aI(r,i);var o=wC(r.shape,i.shape);return rw.runKernel(function(t,e){var n=t.realDivide(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=bC(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=bC(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var s=r.square();return e.div(s.toFloat()).neg()}}})}}),sI=Lx({divStrict_:function(t,e){var n=Ex(t,"a","div"),r=Ex(e,"b","div");return Wv(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),aI=Lx({floorDiv_:function(t,e){var n,r=Ex(t,"a","floorDiv"),i=Ex(e,"b","floorDiv");n=Qb(r,i);var o=wC((r=n[0]).shape,(i=n[1]).shape);return rw.runKernel(function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=bC(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=bC(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var s=r.square();return e.div(s.toFloat()).neg()}}})}}),uI=Lx({maximum_:function(t,e){var n,r=Ex(t,"a","maximum"),i=Ex(e,"b","maximum");return n=Qb(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),wC(r.shape,i.shape),rw.runKernel(function(t,e){var n=t.maximum(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}})}}),lI=Lx({maximumStrict_:function(t,e){var n=Ex(t,"a","maximumStrict"),r=Ex(e,"b","maximumStrict");return Wv(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),cI=Lx({minimum_:function(t,e){var n,r=Ex(t,"a","minimum"),i=Ex(e,"b","minimum");return n=Qb(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),wC(r.shape,i.shape),rw.runKernel(function(t,e){var n=t.minimum(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}})}}),hI=Lx({minimumStrict_:function(t,e){var n=Ex(t,"a","minimumStrict"),r=Ex(e,"b","minimumStrict");return Wv(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),pI=Lx({mod_:function(t,e){var n,r=Ex(t,"a","mod"),i=Ex(e,"b","mod");n=Qb(r,i);var o=wC((r=n[0]).shape,(i=n[1]).shape);return rw.runKernel(function(t,e){var n=t.mod(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=bC(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=bC(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}})}}),dI=Lx({modStrict_:function(t,e){var n=Ex(t,"a","modStrict"),r=Ex(e,"b","modStrict");return Wv(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),fI=Lx({mul_:function(t,e){var n,r=Ex(t,"a","mul"),i=Ex(e,"b","mul");n=Qb(r,i);var o=wC((r=n[0]).shape,(i=n[1]).shape);return rw.runKernel(function(t,e){var n=t.multiply(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.mul(r.toFloat()),i=bC(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=bC(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}})}}),mI=Lx({mulStrict_:function(t,e){var n=Ex(t,"a","mul"),r=Ex(e,"b","mul");return Wv(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),gI=Lx({pow_:function(t,e){var n=Ex(t,"base","pow"),r=Ex(e,"exp","pow"),i=wC(n.shape,r.shape);return t=n.cast(Kb(n.dtype,r.dtype)),e=r.cast(Kb(n.dtype,r.dtype)),rw.runKernel(function(t,e){var i=t.pow(n,r);return e([n,r,i]),i},{$base:n,$exp:r},function(t,e){var n=e[0],r=e[1],o=e[2];return{$base:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(Wx(1))))),s=bC(n.shape,i);return s.length>0&&(o=o.sum(s)),o.reshape(n.shape)},$exp:function(){var e=n.greater(0),s=n.log().where(e,n_(n)),a=t.mul(o.mul(s)),u=bC(r.shape,i);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)}}})}}),yI=Lx({powStrict_:function(t,e){return Wv(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),vI=Lx({squaredDifference_:function(t,e){var n,r=Ex(t,"a","squaredDifference"),i=Ex(e,"b","squaredDifference");return n=Qb(r,i),wC((r=n[0]).shape,(i=n[1]).shape),rw.runKernel(function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n},{$a:r,$b:i},function(t,e){var n=e[0],r=e[1],i=Wx(2);return{$a:function(){return t.mul(n.sub(r).mul(i))},$b:function(){return t.mul(r.sub(n).mul(i))}}})}}),bI=Lx({squaredDifferenceStrict_:function(t,e){var n=Ex(t,"a","squaredDifferenceStrict"),r=Ex(e,"b","squaredDifferenceStrict");return Wv(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),wI=Lx({sub_:function(t,e){var n,r=Ex(t,"a","sub"),i=Ex(e,"b","sub");n=Qb(r,i);var o=wC((r=n[0]).shape,(i=n[1]).shape);return rw.runKernel(function(t){return t.subtract(r,i)},{$a:r,$b:i},function(t){return{$a:function(){var e=t,n=bC(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=bC(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}})}}),xI=Lx({subStrict_:function(t,e){var n=Ex(t,"a","subStrict"),r=Ex(e,"b","subStrict");return Wv(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),_I=Lx({logicalAnd_:function(t,e){var n=Ex(t,"a","logicalAnd","bool"),r=Ex(e,"b","logicalAnd","bool");return wC(n.shape,r.shape),rw.runKernel(function(t){return t.logicalAnd(n,r)},{$a:n,$b:r})}}),CI=Lx({logicalNot_:function(t){var e=Ex(t,"x","logicalNot","bool");return rw.runKernel(function(t){return t.logicalNot(e)},{$x:e})}}),SI=Lx({logicalOr_:function(t,e){var n=Ex(t,"a","logicalOr","bool"),r=Ex(e,"b","logicalOr","bool");return wC(n.shape,r.shape),rw.runKernel(function(t){return t.logicalOr(n,r)},{$a:n,$b:r})}}),EI=Lx({logicalXor_:function(t,e){var n=Ex(t,"a","logicalXor","bool"),r=Ex(e,"b","logicalXor","bool");return wC(n.shape,r.shape),SI(t,e).logicalAnd(_I(t,e).logicalNot())}}),kI=Lx({where_:function(t,e,n){var r=Ex(e,"a","where"),i=Ex(n,"b","where"),o=Ex(t,"condition","where","bool");return Wv(r.shape,i.shape,"Error in where: "),1===o.rank?jv(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Wv(o.shape,i.shape,"Error in where: "),rw.runKernel(function(t,e){var n=t.select(o,r,i);return e([o]),n},{$condition:o,$a:r,$b:i},function(t,e){var n=e[0];return{$condition:function(){return n_(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}})}}),NI=function(t){return Rv(this,void 0,void 0,function(){var e,n,r;return Ov(this,function(i){switch(i.label){case 0:return[4,(e=Ex(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=HC(e.shape,n),t!==e&&e.dispose(),[2,r]}})})},II=Lx({elu_:function(t){var e=Ex(t,"x","elu");return rw.runKernel(function(t,n){var r=t.elu(e);return n([r]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return rw.runKernel(function(e){return e.eluDer(t,n)},{dy:t,y:n})}}})}}),TI=Lx({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=Ex(t,"x","leakyRelu");return uI(Wx(e).mul(n),n)}}),AI=Lx({prelu_:function(t,e){var n=Ex(t,"x","prelu"),r=Ex(e,"alpha","prelu");return rw.runKernel(function(t,e){var i=t.prelu(n,r);return e([n,r]),i},{$x:n,$alpha:r},function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{$x:function(){return kI(i,t,t.mul(r))},$alpha:function(){var e=kI(i,n_(t),t.mul(n)),o=bC(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}})}}),RI=Lx({relu_:function(t){var e=Ex(t,"x","relu");return"bool"===e.dtype?e.toInt():rw.runKernel(function(t,n){var r=t.relu(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}})}}),OI=Lx({selu_:function(t){var e=Ex(t,"x","selu");return rw.runKernel(function(t,n){var r=t.selu(e);return n([e]),r},{$x:e},function(t,e){var n=e[0];return{$x:function(){var e=n.greater(Wx(0)),r=Wx(1.7580993408473768),i=Wx(1.0507009873554805),o=t.mul(i),s=t.mul(r).mul(n.toFloat().exp());return kI(e,o,s)}}})}}),DI=Lx({transpose_:function(t,e){var n=Ex(t,"x","transpose");return null==e&&(e=n.shape.map(function(t,e){return e}).reverse()),jv(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."}),e.forEach(function(t){jv(t>=0&&t<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e})}),n.rank<=1?n.clone():rw.runKernel(function(t){return t.transpose(n,e)},{$x:n},function(t){var n=Dx(e);return{$x:function(){return t.transpose(n)}}})}}),PI=Lx({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=Ex(t,"x","localResponseNormalization");jv(4===o.rank||3===o.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."}),jv(Kv(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var s=o,a=!1;3===o.rank&&(a=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=rw.runKernel(function(t,o){var a=t.localResponseNormalization4D(s,e,n,r,i);return o([s,a]),a},{x4D:s},function(t,o){var s=o[0],a=o[1];return{x4D:function(){return rw.runKernel(function(o){return o.LRNGrad(t,s,a,e,n,r,i)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),FI=Lx({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(Wx(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=Ex(t,"x","norm"),e,n),o=i.shape;if(r){var s=tb(n,t.shape);o=Ax(i.shape,s)}return i.reshape(o)}});function MI(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function LI(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var zI=Lx({gather_:function(t,e,n){void 0===n&&(n=0);var r=Ex(t,"x","gather"),i=Ex(e,"indices","gather","int32");n=tb(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,s=1,a=0;a<n;a++)i.push(t.shape[a]),o*=t.shape[a];for(a=0;a<e.rank;a++)i.push(e.shape[a]);for(a=n+1;a<t.rank;a++)i.push(t.shape[a]),s*=t.shape[a];return{batchSize:o,sliceSize:s,dimSize:r,outputShape:i}}(r,i,n);return rw.runKernel(function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o},{$x:r},function(t,e){var i=e[0];return{$x:function(){var e=r.shape,o=i.size,s=e.slice(0,n),a=s.length,u=e.slice(n,e.length).slice(1),l=u.length,c=MI(0,a),h=MI(a+1,a+1+l),p=LI([s,[o],u]),d=t.reshape(p),f=i.reshape([o]),m=LI([[a],c,h]),g=d.transpose(m),y=BI(g,f,r.shape[n]),v=Dx(m);return y.transpose(v)}}}).reshape(o.outputShape)}}),BI=Lx({unsortedSegmentSum_:function(t,e,n){var r=Ex(t,"x","unsortedSegmentSum"),i=Ex(e,"segmentIds","unsortedSegmentSum","int32");return jv(Kv(n),function(){return"numSegments must be of dtype int"}),rw.runKernel(function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o},{$x:r},function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=uI(e,n_(e)),r=zI(t,n),i=$N(e,Wx(0,"int32")),o=r.rank-i.rank,s=0;s<o;++s)i=N_(i,s+1);i=_I(i,Qx(r.shape,"bool"));var a=n_(r);return kI(i,r,a)}(t,n)}}})}}),UI=Lx({basicLSTMCell_:function(t,e,n,r,i,o){var s=Ex(t,"forgetBias","basicLSTMCell"),a=Ex(e,"lstmKernel","basicLSTMCell"),u=Ex(n,"lstmBias","basicLSTMCell"),l=Ex(r,"data","basicLSTMCell"),c=Ex(i,"c","basicLSTMCell"),h=Ex(o,"h","basicLSTMCell"),p=l.concat(h,1).matMul(a).add(u),d=p.shape[1]/4,f=[p.shape[0],d],m=p.slice([0,0],f),g=p.slice([0,d],f),y=p.slice([0,2*d],f),v=p.slice([0,3*d],f),b=m.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(s.add(y).sigmoid())),w=b.tanh().mulStrict(v.sigmoid());return[b,w]}}),VI=Lx({multiRNNCell_:function(t,e,n,r){for(var i=Ex(e,"data","multiRNNCell"),o=kx(n,"c","multiRNNCell"),s=kx(r,"h","multiRNNCell"),a=i,u=[],l=0;l<t.length;l++){var c=t[l](a,o[l],s[l]);u.push(c[0]),u.push(c[1]),a=c[1]}var h=[],p=[];for(l=0;l<u.length;l+=2)h.push(u[l]),p.push(u[l+1]);return[h,p]}}),jI=Lx({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=Ex(t,"v","movingAverage"),s=Ex(e,"x","movingAverage"),a=Ex(n,"decay","movingAverage");Zb(o,s),jv(Gv(o.shape,s.shape),function(){return"Shape mismatch in v and x"});var u=Wx(1),l=u.sub(a),c=s.sub(o).mul(l);if(i){jv(null!=r,function(){return"When using zeroDebias: true, step is required."});var h=Ex(r,"step","movingAverage");c=c.div(u.sub(gI(a,h)))}return o.add(c)}}),WI=Lx({stridedSlice_:function(t,e,n,r,i,o,s,a,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),0!==s)throw new Error("ellipsis mask is not yet supported");if(0!==a)throw new Error("new axis mask is not yet supported");var l=Ex(t,"x","stridedSlice");if(r.every(function(t){return 1===t})){var c=nC(l.shape,e,n,r,i,o,s,a,u),h=c[0],p=c[1],d=c[2],f=p.filter(function(t,e){return-1===d.indexOf(e)});return kN(l,h,p).reshape(f)}return rw.runKernel(function(t){return t.stridedSlice(l,e,n,r,i,o,s,a,u)},{$x:l})}}),HI=Lx({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=Ex(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=rw.runKernel(function(t){return t.topk(r,e,n)},{$x:r});return{values:o[0],indices:o[1]}}}),qI=Lx({scatterND_:function(t,e,n){var r=Ex(t,"indices","scatterND","int32"),i=Ex(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var s=0;s<i;++s)if(n.shape[s]!==e.shape[s])throw new Error(o+" updates.shape["+s+"] ("+n.shape[s]+") != indices.shape["+s+"] ("+e.shape[s]+").");for(s=0;s<n.rank-i;++s)if(n.shape[s+i]!==t[s+r])throw new Error(o+" updates.shape["+(s+i)+"] ("+n.shape[s+i]+") != shape["+(s+i)+"] ("+t[s+i]+")")}(n,e,t)}(i,r,n),rw.runKernel(function(t){return t.scatterND(r,i,n)},{$indices:r,$updates:i})}}),$I=Lx({fft_:function(t){jv("complex64"===t.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return rw.runKernel(function(t){return t.fft(n)},{input:t}).reshape(t.shape)}}),GI=Lx({ifft_:function(t){jv("complex64"===t.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return rw.runKernel(function(t){return t.ifft(n)},{input:t}).reshape(t.shape)}}),KI=Lx({rfft_:function(t,e){jv("float32"===t.dtype,function(){return"The dtype for rfft() must be real value but got "+t.dtype});var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map(function(t){return 0}),s=t.shape.map(function(t){return t});s[t.shape.length-1]=e,n=t.slice(o,s),r=e}else if(null!=e&&e>r){var a=t.shape.map(function(t){return t});a[t.shape.length-1]=e-r,n=t.concat(Zx(a),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),l=zx(n,u).as2D(i,r),c=$I(l),h=Math.floor(r/2)+1,p=Bx(c),d=Ux(c),f=p.split([h,r-h],p.shape.length-1),m=d.split([h,r-h],d.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,zx(f[0],m[0]).reshape(g)}}),XI=Lx({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=GI(r);return Bx(i)}var o=[n,2*(e-1)],s=Bx(t).as2D(n,e),a=Ux(t).as2D(n,e),u=s.slice([0,1],[n,e-2]).reverse(1),l=a.slice([0,1],[n,e-2]).reverse(1).mul(Wx(-1)),c=s.concat(u,1),h=a.concat(l,1);return r=zx(c,h).as2D(o[0],o[1]),i=GI(r),Bx(i)}}),QI=Object.freeze({fft:$I,ifft:GI,rfft:KI,irfft:XI}),ZI=Lx({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=Ex(t,"sparseIndices","sparseToDense","int32"),o=Ex(e,"sparseValues","sparseToDense"),s=Ex(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,s),rw.runKernel(function(t){return t.sparseToDense(i,o,n,s)},{$sparseIndices:i,$sparseValues:o,$defaultValue:s})}}),YI=Lx({gatherND_:function(t,e){var n=Ex(e,"indices","gatherND","int32"),r=Ex(t,"x","gatherND");return rw.runKernel(function(t){return t.gatherND(r,n)},{$x:r,$indices:n})}}),JI=Lx({dropout_:function(t,e,n,r){if(null!=n&&!Gv(t.shape,n))throw new Error("Non-default noise shape is not implemented yet: "+JSON.stringify(n));var i=z_(t.shape,0,1,"float32",r).greater(e);return i=i.div(wI(1,e)),t.mul(i)}});function tT(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var s=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(s)}return Hx(i,"float32")}var eT,nT=Lx({hannWindow_:function(t){return tT(t,.5,.5)}}),rT=Lx({hammingWindow_:function(t){return tT(t,.54,.46)}}),iT=Lx({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,s=[];o+e<=t.size;)s.push(kN(t,o,e)),o+=n;if(r){var a=o+e-t.size,u=r_([kN(t,o,e-a),Yx([a],i)]);s.push(u)}return 0===s.length?qx([],[0,e]):r_(s).as2D(s.length,e)}}),oT=Object.freeze({hannWindow:nT,hammingWindow:rT,frame:iT});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(eT||(eT={}));var sT=Lx({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=eT.SUM_BY_NONZERO_WEIGHTS);var i=Ex(t,"labels","absoluteDifference"),o=Ex(e,"predictions","absoluteDifference"),s=null;null!=n&&(s=Ex(n,"weights","absoluteDifference")),Wv(i.shape,o.shape,"Error in absoluteDifference: ");var a=i.sub(o).abs();return aT(a,s,r)}}),aT=Lx({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=eT.SUM_BY_NONZERO_WEIGHTS);var r=Ex(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=Ex(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===eT.NONE)return o;if(n===eT.SUM)return o.sum();if(n===eT.MEAN){if(null==i)return o.mean();var s=r.size/i.size,a=o.sum().div(i.sum());return s>1?a.div(Wx(s)):a}if(n===eT.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(Wx(r.size));var u=i.mul(Qx(r.shape)).notEqual(Wx(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),uT=Lx({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=eT.SUM_BY_NONZERO_WEIGHTS);var o=Ex(t,"labels","cosineDistance"),s=Ex(e,"predictions","cosineDistance"),a=null;null!=r&&(a=Ex(r,"weights","cosineDistance")),Wv(o.shape,s.shape,"Error in cosineDistance: ");var u=Wx(1).sub(o.mul(s).sum(n,!0));return aT(u,a,i)}}),lT=Lx({hingeLoss_:function(t,e,n,r){void 0===r&&(r=eT.SUM_BY_NONZERO_WEIGHTS);var i=Ex(t,"labels","hingeLoss"),o=Ex(e,"predictions","hingeLoss"),s=null;null!=n&&(s=Ex(n,"weights","hingeLoss")),Wv(i.shape,o.shape,"Error in hingeLoss: ");var a=Wx(1);i=Wx(2).mul(i).sub(a);var u=a.sub(i.mul(o)).relu();return aT(u,s,r)}}),cT=Lx({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=eT.SUM_BY_NONZERO_WEIGHTS);var o=Ex(t,"labels","huberLoss"),s=Ex(e,"predictions","huberLoss"),a=null;null!=n&&(a=Ex(n,"weights","huberLoss")),Wv(o.shape,s.shape,"Error in huberLoss: ");var u=Wx(r),l=s.sub(o).abs(),c=cI(l,u),h=l.sub(c),p=Wx(.5).mul(c.square()).add(u.mul(h));return aT(p,a,i)}}),hT=Lx({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=eT.SUM_BY_NONZERO_WEIGHTS);var o=Ex(t,"labels","logLoss"),s=Ex(e,"predictions","logLoss"),a=null;null!=n&&(a=Ex(n,"weights","logLoss")),Wv(o.shape,s.shape,"Error in logLoss: ");var u=Wx(1),l=Wx(r),c=o.mul(s.add(l).log()).neg().sub(u.sub(o).mul(u.sub(s).add(l).log()));return aT(c,a,i)}}),pT=Lx({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=eT.SUM_BY_NONZERO_WEIGHTS);var i=Ex(t,"labels","meanSquaredError"),o=Ex(e,"predictions","meanSquaredError"),s=null;null!=n&&(s=Ex(n,"weights","meanSquaredError")),Wv(i.shape,o.shape,"Error in meanSquaredError: ");var a=i.squaredDifference(o);return aT(a,s,r)}}),dT=Lx({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=eT.SUM_BY_NONZERO_WEIGHTS);var o=Ex(t,"multiClassLabels","sigmoidCrossEntropy"),s=Ex(e,"logits","sigmoidCrossEntropy"),a=null;if(null!=n&&(a=Ex(n,"weights","sigmoidCrossEntropy")),Wv(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Wx(r),l=Wx(1),c=Wx(.5);o=o.mul(l.sub(u)).add(c.mul(u))}var h=function(t,e){var n=Ex(t,"labels","sigmoidCrossEntropyWithLogits"),r=Ex(e,"logits","sigmoidCrossEntropyWithLogits");Wv(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),s=r.abs().neg().exp().log1p();return i.sub(o).add(s)}(o,s);return aT(h,a,i)}}),fT=Lx({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=eT.SUM_BY_NONZERO_WEIGHTS);var o=Ex(t,"onehotLabels","softmaxCrossEntropy"),s=Ex(e,"logits","softmaxCrossEntropy"),a=null;if(null!=n&&(a=Ex(n,"weights","softmaxCrossEntropy")),Wv(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Wx(r),l=Wx(1),c=Wx(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(c))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return pC(function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=Ax(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}})(t,e)}(o,s);return aT(h,a,i)}}),mT=Object.freeze({get Reduction(){return eT},absoluteDifference:sT,computeWeightedLoss:aT,cosineDistance:uT,hingeLoss:lT,huberLoss:cT,logLoss:hT,meanSquaredError:pT,sigmoidCrossEntropy:dT,softmaxCrossEntropy:fT});function gT(t,e){return void 0===e&&(e=!1),rw.tidy(function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=I_(n),o=t.clone(),s=qx([[1]],[1,1]),a=s.clone(),u=n>=r?r:n,l=function(t){var e,u=o,l=a,c=i;e=rw.tidy(function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),l=o.slice([t,t],[1,1]),c=l.sign().neg(),h=l.sub(c.mul(u)),p=e.div(h);a=1===p.shape[0]?s.clone():s.concat(p.slice([1,0],[p.shape[0]-1,p.shape[1]]),0);var d=c.matMul(h).div(u).neg(),f=o.slice([t,0],[n-t,r]),m=d.mul(a);o=0===t?f.sub(m.matMul(a.transpose().matMul(f))):o.slice([0,0],[t,r]).concat(f.sub(m.matMul(a.transpose().matMul(f))),0);var g=i.slice([0,t],[n,i.shape[1]-t]);return i=0===t?g.sub(g.matMul(a).matMul(m.transpose())):i.slice([0,0],[n,t]).concat(g.sub(g.matMul(a).matMul(m.transpose())),1),[a,o,i]}),a=e[0],o=e[1],i=e[2],cx([u,l,c])},c=0;c<u;++c)l(c);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]})}var yT=Lx({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,jv(null!=t&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=t[0].shape[0],r=function(e){jv(t[e].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"})},i=1;i<t.length;++i)r(i)}else e=!0,t=u_(t,t.shape[0],0).map(function(t){return V_(t,[0])});jv(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var o=[],s=t,a=function(t){o.push(rw.tidy(function(){var e=s[t];if(t>0)for(var n=0;n<t;++n){var r=VN(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(FI(e,"euclidean"))}))};for(i=0;i<t.length;++i)a(i);return e?j_(o,0):o}}),vT=Lx({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return gT(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce(function(t,e){return t*e}),r=q_(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach(function(t){var n=gT(t,e),r=n[1];i.push(n[0]),o.push(r)}),[j_(i,0).reshape(t.shape),j_(o,0).reshape(t.shape)]}}),bT=Object.freeze({gramSchmidt:yT,qr:vT});function wT(t,e,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return n=Math.min(n,o),jv(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),jv(2===t.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),jv(4===t.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),jv(1===e.rank,function(){return"scores must be a 1D tensor"}),jv(e.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var xT=Lx({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=Ex(t,"images","resizeBilinear");jv(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),jv(2===e.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=rw.runKernel(function(t,e){return e([i]),t.resizeBilinear(i,s,a,n)},{batchImages:i},function(t,e){return{batchImages:function(){return rw.runKernel(function(r){return r.resizeBilinearBackprop(t,e[0],n)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),_T=Lx({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=Ex(t,"images","resizeNearestNeighbor");jv(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),jv(2===e.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),jv("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=e[0],a=e[1],u=rw.runKernel(function(t,e){return e([i]),t.resizeNearestNeighbor(i,s,a,n)},{batchImages:i},function(t,e){return{batchImages:function(){return rw.runKernel(function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),CT=Lx({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=Ex(t,"boxes","nonMaxSuppression"),s=Ex(e,"scores","nonMaxSuppression"),a=wT(o,s,n,r,i);return n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,rw.runKernel(function(t){return t.nonMaxSuppression(o,s,n,r,i)},{$boxes:o})}}),ST=Lx({cropAndResize_:function(t,e,n,r,i,o){var s=Ex(t,"image","cropAndResize","float32"),a=Ex(e,"boxes","cropAndResize","float32"),u=Ex(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=a.shape[0];return jv(4===s.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),jv(2===a.rank&&4===a.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+a.shape+"."}),jv(1===u.rank&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+a.shape+"."}),jv(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),jv(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),jv("bilinear"===i||"nearest"===i,function(){return"method must be bilinear or nearest, but was "+i}),rw.runKernel(function(t,e){return t.cropAndResize(s,a,u,r,i,o)},{$image:s,$boxes:a})}}),ET=Object.freeze({resizeBilinear:xT,resizeNearestNeighbor:_T,nonMaxSuppression:CT,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),Rv(this,void 0,void 0,function(){var o,s,a,u,l,c;return Ov(this,function(h){switch(h.label){case 0:return o=Ex(t,"boxes","nonMaxSuppressionAsync"),s=Ex(e,"scores","nonMaxSuppressionAsync"),a=wT(o,s,n,r,i),n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold,[4,o.data()];case 1:return u=h.sent(),[4,s.data()];case 2:return l=h.sent(),c=BC(u,l,n,r,i),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,c]}})})},cropAndResize:ST}),kT=Lx({matMul_:function(t,e,n,r,i,o){var s;void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o="linear");var a=Ex(t,"a","fused matMul"),u=Ex(e,"b","fused matMul");s=Qb(a,u),a=s[0],u=s[1];var l=n?a.shape[a.rank-2]:a.shape[a.rank-1],c=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?a.shape[a.rank-1]:a.shape[a.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],d=a.shape.slice(0,-2),f=u.shape.slice(0,-2),m=$v(d),g=$v(f);jv(a.rank>=2&&u.rank>=2&&a.rank===u.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+u.rank+"."}),jv(Gv(d,f),function(){return"Error in fused matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+a.shape+" and "+u.shape+" must match."}),jv(l===c,function(){return"Error in fused matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+a.shape+" and "+u.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var y,v=a.shape.slice(0,-2).concat([h,p]),b=n?a.as3D(m,l,h):a.as3D(m,h,l),w=r?u.as3D(g,p,c):u.as3D(g,c,p);null!=i&&wC(v,(y=Qb(y=Ex(i,"bias","fused matMul"),a)[0]).shape);var x={$a:b,$b:w};return null!=i&&(x.$bias=y),rw.runKernel(function(t,e){var i=t.fusedBatchMatMul(b,w,n,r,y,o);return e([b,w,i]),i},x,function(t,e){var s,a=e[0],u=e[1],l=e[2];if(null==o||"linear"===o)s=t;else{if("relu"!==o)throw new Error("Gradient for activation "+o+" has not been implemented yet.");s=t.mul(l.step())}var c={};return null!=i&&(c={$bias:function(){var t=s,e=bC(y.shape,s.shape);return e.length>0&&(t=t.sum(e)),t.reshape(y.shape)}}),n||r?!n&&r?Object.assign({$a:function(){return s.matMul(u,!1,!1)},$b:function(){return s.matMul(a,!0,!1)}},c):n&&!r?Object.assign({$a:function(){return u.matMul(s,!1,!0)},$b:function(){return a.matMul(s,!1,!1)}},c):Object.assign({$a:function(){return u.matMul(s,!0,!0)},$b:function(){return s.matMul(a,!0,!0)}},c):Object.assign({$a:function(){return s.matMul(u,!1,!0)},$b:function(){return a.matMul(s,!0,!1)}},c)}).reshape(v)}}),NT=Object.freeze({matMul:kT}),IT=Object.freeze({image:ET,linalg:bT,losses:mT,spectral:QI,fused:NT,signal:oT,op:Lx,batchNormalization2d:Xk,batchNormalization3d:Qk,batchNormalization4d:Zk,batchNormalization:Yk,batchNorm:Jk,batchNorm2d:tN,batchNorm3d:eN,batchNorm4d:nN,complex:zx,real:Bx,imag:Ux,concat:r_,concat1d:i_,concat2d:o_,concat3d:s_,concat4d:a_,split:u_,conv1d:sN,conv2d:aN,conv3d:uN,conv2dDerFilter:lN,depthwiseConv2d:cN,separableConv2d:hN,conv2dTranspose:pN,matMul:dN,dot:fN,outerProduct:mN,reverse:gN,reverse1d:yN,reverse2d:vN,reverse3d:bN,reverse4d:wN,maxPool:CN,avgPool:SN,pool:EN,slice:kN,slice1d:NN,slice2d:IN,slice3d:TN,slice4d:AN,abs:uk,acos:lk,acosh:ck,asin:hk,asinh:pk,atan:dk,atanh:fk,ceil:mk,clipByValue:gk,cos:yk,cosh:vk,erf:bk,exp:wk,expm1:xk,floor:_k,log:Ck,log1p:Sk,logSigmoid:Ek,neg:kk,reciprocal:Nk,round:Ik,rsqrt:Tk,sigmoid:Ak,sign:Rk,isNaN:Ok,isInf:Dk,isFinite:Pk,sin:Fk,sinh:Mk,softplus:Lk,sqrt:zk,square:Bk,step:Uk,tan:Vk,tanh:jk,all:ON,any:DN,argMax:PN,argMin:FN,logSumExp:MN,max:LN,mean:zN,min:BN,moments:UN,sum:VN,prod:jN,equal:WN,equalStrict:HN,greater:qN,greaterEqual:$N,greaterEqualStrict:GN,greaterStrict:KN,less:XN,lessEqual:QN,lessEqualStrict:ZN,lessStrict:YN,notEqual:JN,notEqualStrict:tI,add:eI,addN:nI,addStrict:rI,atan2:iI,div:oI,divStrict:sI,floorDiv:aI,maximum:uI,maximumStrict:lI,minimum:cI,minimumStrict:hI,mod:pI,modStrict:dI,mul:fI,mulStrict:mI,pow:gI,powStrict:yI,squaredDifference:vI,squaredDifferenceStrict:bI,sub:wI,subStrict:xI,elu:II,leakyRelu:TI,prelu:AI,relu:RI,selu:OI,logicalAnd:_I,logicalNot:CI,logicalOr:SI,logicalXor:EI,where:kI,whereAsync:NI,buffer:w_,print:x_,batchToSpaceND:__,cast:C_,clone:S_,cumsum:E_,depthToSpace:k_,expandDims:N_,eye:I_,multinomial:T_,oneHot:A_,pad:R_,pad1d:O_,pad2d:D_,pad3d:P_,pad4d:F_,rand:M_,randomNormal:L_,randomUniform:z_,reshape:B_,spaceToBatchND:U_,squeeze:V_,stack:j_,tile:W_,truncatedNormal:H_,unstack:q_,setdiff1dAsync:$_,fill:Yx,linspace:Jx,ones:Qx,range:t_,scalar:Wx,tensor:Vx,tensor1d:Hx,tensor2d:qx,tensor3d:$x,tensor4d:Gx,tensor5d:Kx,tensor6d:Xx,zeros:Zx,onesLike:e_,zerosLike:n_,transpose:DI,softmax:fC,logSoftmax:mC,localResponseNormalization:PI,norm:FI,gather:zI,unsortedSegmentSum:BI,basicLSTMCell:UI,multiRNNCell:VI,movingAverage:jI,stridedSlice:WI,topk:HI,scatterND:qI,fft:$I,ifft:GI,rfft:KI,irfft:XI,sparseToDense:ZI,gatherND:YI,dropout:JI,hannWindow:nT,hammingWindow:rT,frame:iT}),TT=function(){function t(){if(this.blockSize=48,this.firstUse=!0,Fv.get("IS_BROWSER")){var t="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(300,150):"undefined"!=typeof document?document.createElement("canvas"):null;null!==t&&(this.fromPixels2DContext=t.getContext("2d"))}this.data=new gC(this,rw)}return t.prototype.register=function(t,e,n){if(this.firstUse&&(this.firstUse=!1,Fv.get("IS_NODE")&&_x("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,{dtype:n})},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(t).values=e},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r,i=t.data instanceof Uint8Array,o="undefined"!=typeof ImageData&&t instanceof ImageData,s="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement;if(Fv.get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,t.width,t.height).data;else if(o||i)n=t.data;else{if(!a&&!s)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=t.width,this.fromPixels2DContext.canvas.height=t.height,this.fromPixels2DContext.drawImage(t,0,0,t.width,t.height),n=this.fromPixels2DContext.getImageData(0,0,t.width,t.height).data}if(4===e)r=new Int32Array(n);else{var u=t.width*t.height;r=new Int32Array(u*e);for(var l=0;l<u;l++)for(var c=0;c<e;++c)r[l*e+c]=n[4*l+c]}return $x(r,[t.height,t.width,e],"int32")},t.prototype.read=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(e){return[2,this.readSync(t)]})})},t.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?FC(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},t.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map(function(t){return kb(t)})}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return w_(t.shape,t.dtype,n)},t.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},t.prototype.time=function(t){return Rv(this,void 0,void 0,function(){var e;return Ov(this,function(n){return e=_b(),t(),[2,{kernelMs:_b()-e}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(t,e){var n=zb.make(t.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:rw.keep(t.clone()),imag:rw.keep(e.clone())},n},t.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},t.prototype.assertNotComplex=function(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(t){null!=t&&jv("complex64"!==t.dtype,function(){return e+" does not support complex64 tensors."})})},t.prototype.slice=function(t,e,n){if(this.assertNotComplex(t,"slice"),oC(t.shape,e,n)){var r=sC(e,t.strides),i=$v(n);return Vx(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=w_(n,t.dtype),s=this.bufferSync(t),a=0;a<o.size;++a){var u=o.indexToLoc(a).map(function(t,n){return t+e[n]});o.values[a]=s.get.apply(s,u)}return o.toTensor()},t.prototype.stridedSlice=function(t,e,n,r,i,o,s,a,u){this.assertNotComplex(t,"stridedSlice");var l=nC(t.shape,e,n,r,i,o,s,a,u),c=l[0],h=l[1],p=l[2],d=h.filter(function(t,e){return-1===p.indexOf(e)});if(d.some(function(t){return 0===t}))return Vx([],d);for(var f=w_(h,t.dtype),m=this.bufferSync(t),g=0;g<f.size;g++){for(var y=f.indexToLoc(g),v=new Array(y.length),b=0;b<v.length;b++)v[b]=y[b]*r[b]+c[b];f.set.apply(f,[m.get.apply(m,v)].concat(y))}return f.toTensor().reshape(d)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var s=new Array(t.rank).fill(0),a=t.shape.slice();a[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)s[e]=o,u[o]=this.slice(t,s,a).reshape(r);return u},t.prototype.reverse=function(t,e){this.assertNotComplex(t,"reverse");for(var n=w_(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),s=o.slice();e.forEach(function(e){return s[e]=t.shape[e]-1-s[e]}),n.set.apply(n,[r.get.apply(r,s)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(t,e){var n=this;this.assertNotComplex(t,"concat");var r=t.map(function(t){var n=$v(t.shape.slice(e));return t.as2D(-1,n)}),i=Mx(r.map(function(t){return t.shape}),1),o=w_(i,t[0].dtype).values;if(1===r[0].shape[0]){var s=0;r.forEach(function(t){o.set(n.readSync(t.dataId),s),s+=t.size})}else{var a=0;r.forEach(function(t){for(var e=n.readSync(t.dataId),r=0,s=0;s<t.shape[0];++s)for(var u=s*i[1]+a,l=0;l<t.shape[1];++l)o[u+l]=e[r++];a+=t.shape[1]})}var u=Mx(t.map(function(t){return t.shape}),e);return Vx(o,u,t[0].dtype)},t.prototype.neg=function(t){return this.assertNotComplex(t,"neg"),this.multiply(Wx(-1),t)},t.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),function(t,e,n,r){return{real:t+n,imag:e+r}}):this.broadcastedBinaryOp(t,e,Kb(t.dtype,e.dtype),function(t,e){return t+e})},t.prototype.addN=function(t){var e=this;this.assertNotComplex(t,"addN");for(var n=t.map(function(t){return e.readSync(t.dataId)}),r=w_(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var s=n[o],a=0;a<i.length;a++)i[a]+=s[a];return r.toTensor()},t.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),function(t,e,n,r){return{real:t-n,imag:e-r}}):this.broadcastedBinaryOp(t,e,Kb(t.dtype,e.dtype),function(t,e){return t-e})},t.prototype.pow=function(t,e){return this.assertNotComplex([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.pow(t,e)})},t.prototype.batchMatMul=function(t,e,n,r){this.assertNotComplex([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],s=r?e.shape[1]:e.shape[2],a=t.shape[0],u=this.readSync(t.dataId),l=this.readSync(e.dataId),c=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=c[0],p=c[1],d=c[2],f=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=f[0],g=f[1],y=f[2],v=o*s,b=w_([a,o,s],t.dtype),w=b.values,x=this.blockSize,_=0;_<a;_++)for(var C=0;C<o;C+=x)for(var S=0;S<s;S+=x)for(var E=0;E<i;E+=x)for(var k=Math.min(C+x,o),N=Math.min(S+x,s),I=Math.min(E+x,i),T=C;T<k;T++)for(var A=S;A<N;A++){for(var R=0,O=E;O<I;O++)R+=u[_*h+T*p+O*d]*l[O*m+A*g+_*y];w[_*v+(T*s+A)]+=R}return b.toTensor()},t.prototype.fusedBatchMatMul=function(t,e,n,r,i,o){var s=this.batchMatMul(t,e,n,r);return i&&(s=this.add(s,i)),o&&(s=function(t,e,n){if("linear"===e)return t.linear(n);if("relu"===e)return t.relu(n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}(this,o,s)),s},t.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}}):this.broadcastedBinaryOp(t,e,Kb(t.dtype,e.dtype),function(t,e){return t*e})},t.prototype.realDivide=function(t,e){return this.assertNotComplex([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",function(t,e){return t/e})},t.prototype.floorDiv=function(t,e){return this.assertNotComplex([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",function(t,e){return Math.floor(t/e)})},t.prototype.sum=function(t,e){this.assertNotComplex(t,"sum"),Rx("sum",e,t.rank);for(var n=Tx(t.shape,e),r=n[1],i=Zx(n[0],Kb(t.dtype,"int32")),o=$v(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var l=u*o,c=0,h=0;h<o;++h)c+=a[l+h];s[u]=c}return i},t.prototype.prod=function(t,e){this.assertNotComplex(t,"sum");for(var n=Tx(t.shape,e),r=n[1],i=Zx(n[0],Kb(t.dtype,"int32")),o=$v(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var l=u*o,c=1,h=0;h<o;++h)c*=a[l+h];s[u]=c}return i},t.prototype.unsortedSegmentSum=function(t,e,n){this.assertNotComplex(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var s=Wx(o,"int32"),a=WN(s,e).asType("float32").mul(t).sum(0);r.push(a)}return j_(r)},t.prototype.argMin=function(t,e){this.assertNotComplex(t,"argMin");var n=[e];Rx("argMin",n,t.rank);for(var r=Tx(t.shape,n),i=r[1],o=Zx(r[0],"int32"),s=$v(i),a=this.readSync(o.dataId),u=this.readSync(t.dataId),l=0;l<a.length;++l){for(var c=l*s,h=u[c],p=0,d=0;d<s;++d){var f=u[c+d];f<h&&(h=f,p=d)}a[l]=p}return o},t.prototype.argMax=function(t,e){this.assertNotComplex(t,"argMax");var n=[e];Rx("argMax",n,t.rank);for(var r=Tx(t.shape,n),i=r[1],o=Zx(r[0],"int32"),s=$v(i),a=this.readSync(o.dataId),u=this.readSync(t.dataId),l=0;l<a.length;++l){for(var c=l*s,h=u[c],p=0,d=0;d<s;++d){var f=u[c+d];f>h&&(h=f,p=d)}a[l]=p}return o},t.prototype.cumsum=function(t,e,n,r){if(this.assertNotComplex(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=Kb(t.dtype,"int32"),o=Zx(t.shape,i),s=this.readSync(o.dataId),a=this.readSync(t.dataId),u=t.shape[t.rank-1],l=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},c=0;c<a.length;c+=u)for(var h=0;h<u;h++){var p=l(c,h);if(0===h)s[p]=n?0:a[p];else{var d=l(c,h-1);s[p]=n?a[d]+s[d]:a[p]+s[d]}}return o},t.prototype.equal=function(t,e){return this.assertNotComplex([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t===e?1:0})},t.prototype.notEqual=function(t,e){return this.assertNotComplex([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t!==e?1:0})},t.prototype.less=function(t,e){return this.assertNotComplex([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t<e?1:0})},t.prototype.lessEqual=function(t,e){return this.assertNotComplex([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t<=e?1:0})},t.prototype.greater=function(t,e){return this.assertNotComplex([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t>e?1:0})},t.prototype.greaterEqual=function(t,e){return this.assertNotComplex([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t>=e?1:0})},t.prototype.logicalNot=function(t){this.assertNotComplex(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return zb.make(t.shape,{values:n},"bool")},t.prototype.logicalAnd=function(t,e){return this.assertNotComplex([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t&&e})},t.prototype.logicalOr=function(t,e){return this.assertNotComplex([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",function(t,e){return t||e})},t.prototype.select=function(t,e,n){this.assertNotComplex([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),s=Zx(e.shape,Kb(e.dtype,n.dtype)),a=this.readSync(s.dataId),u=0,l=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1],c=0;c<r.length;c++)for(var h=0;h<l;h++)a[u++]=1===r[c]?i[c]:o[c];return s},t.prototype.where=function(t){this.assertNotComplex([t],"where");var e=this.readSync(t.dataId);return HC(t.shape,e)},t.prototype.topk=function(t,e,n){return this.assertNotComplex(t,"topk"),WC(this.readSync(t.dataId),t.shape,t.dtype,e)},t.prototype.min=function(t,e){this.assertNotComplex(t,"min"),Rx("min",e,t.rank);for(var n=Tx(t.shape,e),r=n[1],i=Zx(n[0],t.dtype),o=$v(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var l=u*o,c=a[l],h=0;h<o;++h){var p=a[l+h];p<c&&(c=p)}s[u]=c}return i},t.prototype.minimum=function(t,e){return this.assertNotComplex([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.min(t,e)})},t.prototype.mod=function(t,e){return this.assertNotComplex([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})},t.prototype.max=function(t,e){this.assertNotComplex(t,"max"),Rx("max",e,t.rank);for(var n=Tx(t.shape,e),r=n[1],i=Zx(n[0],t.dtype),o=$v(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var l=u*o,c=a[l],h=0;h<o;++h){var p=a[l+h];p>c&&(c=p)}s[u]=c}return i},t.prototype.maximum=function(t,e){return this.assertNotComplex([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.max(t,e)})},t.prototype.all=function(t,e){this.assertNotComplex(t,"all"),Rx("all",e,t.rank);for(var n=Tx(t.shape,e),r=n[1],i=Zx(n[0],t.dtype),o=$v(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var l=u*o,c=a[l],h=0;h<o;++h)c=c&&a[l+h];s[u]=c}return i},t.prototype.any=function(t,e){this.assertNotComplex(t,"any"),Rx("any",e,t.rank);for(var n=Tx(t.shape,e),r=n[1],i=Zx(n[0],t.dtype),o=$v(r),s=this.readSync(i.dataId),a=this.readSync(t.dataId),u=0;u<s.length;++u){for(var l=u*o,c=a[l],h=0;h<o;++h)c=c||a[l+h];s[u]=c}return i},t.prototype.squaredDifference=function(t,e){return this.assertNotComplex([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){var n=t-e;return n*n})},t.prototype.ceil=function(t){this.assertNotComplex(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return zb.make(t.shape,{values:n})},t.prototype.floor=function(t){this.assertNotComplex(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return zb.make(t.shape,{values:n})},t.prototype.sign=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return zb.make(t.shape,{values:n})},t.prototype.isNaN=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return zb.make(t.shape,{values:n},"bool")},t.prototype.isInf=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return zb.make(t.shape,{values:n},"bool")},t.prototype.isFinite=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return zb.make(t.shape,{values:n},"bool")},t.prototype.round=function(t){this.assertNotComplex(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return zb.make(t.shape,{values:n})},t.prototype.exp=function(t){this.assertNotComplex(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return zb.make(t.shape,{values:n})},t.prototype.expm1=function(t){this.assertNotComplex(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return zb.make(t.shape,{values:n})},t.prototype.log=function(t){this.assertNotComplex(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return zb.make(t.shape,{values:n})},t.prototype.log1p=function(t){this.assertNotComplex(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return zb.make(t.shape,{values:n})},t.prototype.sqrt=function(t){this.assertNotComplex(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return zb.make(t.shape,{values:n})},t.prototype.rsqrt=function(t){this.assertNotComplex(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return zb.make(t.shape,{values:n})},t.prototype.square=function(t){this.assertNotComplex(t,"square");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=i*i}return zb.make(t.shape,{values:n})},t.prototype.reciprocal=function(t){this.assertNotComplex(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return zb.make(t.shape,{values:n})},t.prototype.linear=function(t){return t},t.prototype.relu=function(t){this.assertNotComplex(t,"relu");for(var e=Zx(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},t.prototype.prelu=function(t,e){return this.assertNotComplex([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return t<0?e*t:t})},t.prototype.elu=function(t){this.assertNotComplex(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return zb.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){this.assertNotComplex([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var s=r[o];n[o]=s>=1?i[o]:i[o]*(s+1)}return zb.make(e.shape,{values:n})},t.prototype.selu=function(t){this.assertNotComplex(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return zb.make(t.shape,{values:e})},t.prototype.clip=function(t,e,n){this.assertNotComplex(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var s=i[o];r[o]=s>n?n:s<e?e:s}return zb.make(t.shape,{values:r})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return zb.make(t.shape,{values:e})},t.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return zb.make(t.shape,{values:e})},t.prototype.int=function(t){this.assertNotComplex(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return zb.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){this.assertNotComplex(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return zb.make(t.shape,{values:e})},t.prototype.softplus=function(t){this.assertNotComplex(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o,s=r[i]>-e,a=r[i]<e,u=Math.exp(r[i]);o=a?u:s?r[i]:Math.log(1+u),n[i]=o}return zb.make(t.shape,{values:n})},t.prototype.sin=function(t){this.assertNotComplex(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return zb.make(t.shape,{values:e})},t.prototype.cos=function(t){this.assertNotComplex(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return zb.make(t.shape,{values:e})},t.prototype.tan=function(t){this.assertNotComplex(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return zb.make(t.shape,{values:e})},t.prototype.asin=function(t){this.assertNotComplex(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return zb.make(t.shape,{values:e})},t.prototype.acos=function(t){this.assertNotComplex(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return zb.make(t.shape,{values:e})},t.prototype.atan=function(t){this.assertNotComplex(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return zb.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.assertNotComplex([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.atan2(t,e)})},t.prototype.sinh=function(t){this.assertNotComplex(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return zb.make(t.shape,{values:e})},t.prototype.cosh=function(t){this.assertNotComplex(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return zb.make(t.shape,{values:e})},t.prototype.tanh=function(t){this.assertNotComplex(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Xv(n[r]);return zb.make(t.shape,{values:e})},t.prototype.asinh=function(t){this.assertNotComplex(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return zb.make(t.shape,{values:e})},t.prototype.acosh=function(t){this.assertNotComplex(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return zb.make(t.shape,{values:e})},t.prototype.atanh=function(t){this.assertNotComplex(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return zb.make(t.shape,{values:e})},t.prototype.erf=function(t){this.assertNotComplex(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r],o=1/(1+.3275911*i);e[r]=1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i)}return zb.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0),this.assertNotComplex(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=isNaN(o)?NaN:o>0?1:e}return zb.make(t.shape,{values:n})},t.prototype.conv2d=function(t,e,n){this.assertNotComplex([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.padInfo.left,u=n.padInfo.top,l=w_(n.outShape,t.dtype),c=this.readSync(t.dataId),h=this.readSync(e.dataId),p=l.values,d=0;d<n.batchSize;++d)for(var f=d*t.strides[0],m=d*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],v=g*n.strideHeight-u,b=0;b<r;b++){var w=v+b*o;if(!(w<0||w>=n.inHeight))for(var x=b*e.strides[0],_=f+w*t.strides[1],C=0;C<n.outWidth;++C)for(var S=y+C*n.outChannels,E=C*n.strideWidth-a,k=0;k<i;k++){var N=E+k*s;if(!(N<0||N>=n.inWidth))for(var I=_+N*n.inChannels,T=x+k*e.strides[1],A=0;A<n.inChannels;++A){for(var R=c[I+A],O=0;O<n.outChannels;++O)p[S+O]+=R*h[T+O];T+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,s=n.dilationDepth,a=n.dilationHeight,u=n.dilationWidth,l=n.padInfo.front,c=n.padInfo.left,h=n.padInfo.top,p=w_(n.outShape,t.dtype),d=this.readSync(t.dataId),f=this.readSync(e.dataId),m=p.values,g=0;g<n.batchSize;++g)for(var y=g*t.strides[0],v=g*p.strides[0],b=0;b<n.outDepth;++b)for(var w=v+b*p.strides[1],x=b*n.strideDepth-l,_=0;_<r;_++){var C=x+_*s;if(!(C<0||C>=n.inDepth))for(var S=_*e.strides[0],E=y+C*t.strides[1],k=0;k<n.outHeight;++k)for(var N=w+k*p.strides[2],I=k*n.strideHeight-h,T=0;T<i;T++){var A=I+T*a;if(!(A<0||A>=n.inHeight))for(var R=S+T*e.strides[1],O=E+A*t.strides[2],D=0;D<n.outWidth;++D)for(var P=N+D*n.outChannels,F=D*n.strideWidth-c,M=0;M<o;M++){var L=F+M*u;if(!(L<0||L>=n.inWidth))for(var z=O+L*n.inChannels,B=R+M*e.strides[2],U=0;U<n.inChannels;++U){for(var V=d[z+U],j=0;j<n.outChannels;++j)m[P+j]+=V*f[B+j];B+=n.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerInput");for(var r=w_(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],l=this.readSync(t.dataId),c=t.strides,h=c[0],p=c[1],d=c[2],f=this.readSync(e.dataId),m=e.strides,g=m[0],y=m[1],v=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,_=n.inChannels,C=n.inHeight,S=n.inWidth,E=n.outChannels,k=n.outHeight,N=n.outWidth,I=n.strideHeight,T=n.strideWidth,A=w-1-n.padInfo.top,R=x-1-n.padInfo.left,O=0;O<b;++O)for(var D=0;D<_;++D)for(var P=0;P<C;++P)for(var F=P-A,M=Math.max(0,Math.ceil(F/I)),L=Math.min(k,(w+F)/I),z=0;z<S;++z){for(var B=z-R,U=Math.max(0,Math.ceil(B/T)),V=Math.min(N,(x+B)/T),j=0,W=M;W<L;++W)for(var H=W*I-F,q=U;q<V;++q)for(var $=h*O+p*W+d*q,G=g*(w-1-H)+y*(x-1-(q*T-B))+v*D,K=0;K<E;++K)j+=l[$+K]*f[G+K];i[s*O+a*P+u*z+D]=j}return r.toTensor()},t.prototype.conv3dDerInput=function(t,e,n){for(var r=w_(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],l=o[3],c=this.readSync(t.dataId),h=t.strides,p=h[0],d=h[1],f=h[2],m=h[3],g=this.readSync(e.dataId),y=e.strides,v=y[0],b=y[1],w=y[2],x=y[3],_=n.batchSize,C=n.filterDepth,S=n.filterHeight,E=n.filterWidth,k=n.inChannels,N=n.inDepth,I=n.inHeight,T=n.inWidth,A=n.outChannels,R=n.outDepth,O=n.outHeight,D=n.outWidth,P=n.strideDepth,F=n.strideHeight,M=n.strideWidth,L=C-1-n.padInfo.front,z=S-1-n.padInfo.top,B=E-1-n.padInfo.left,U=0;U<_;++U)for(var V=0;V<k;++V)for(var j=0;j<N;++j)for(var W=j-L,H=Math.max(0,Math.ceil(W/P)),q=Math.min(R,(C+W)/P),$=0;$<I;++$)for(var G=$-z,K=Math.max(0,Math.ceil(G/F)),X=Math.min(O,(S+G)/F),Q=0;Q<T;++Q){for(var Z=Q-B,Y=Math.max(0,Math.ceil(Z/M)),J=Math.min(D,(E+Z)/M),tt=0,et=H;et<q;++et)for(var nt=et*P-W,rt=K;rt<X;++rt)for(var it=rt*F-G,ot=Y;ot<J;++ot)for(var st=p*U+d*et+f*rt+m*ot,at=v*(C-1-nt)+b*(S-1-it)+w*(E-1-(ot*M-Z))+x*V,ut=0;ut<A;++ut)tt+=c[st+ut]*g[at+ut];i[s*U+a*j+u*$+l*Q+V]=tt}return r.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=w_(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=this.bufferSync(t),h=this.bufferSync(e),p=0;p<o;++p)for(var d=Math.max(0,Math.ceil((l-p)/r)),f=Math.min(n.outHeight,(n.inHeight+l-p)/r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((u-m)/i)),y=Math.min(n.outWidth,(n.inWidth+u-m)/i),v=0;v<n.inChannels;++v)for(var b=0;b<n.outChannels;++b){for(var w=0,x=0;x<n.batchSize;++x)for(var _=d;_<f;++_)for(var C=p+_*r-l,S=g;S<y;++S)w+=c.get(x,C,m+S*i-u,v)*h.get(x,_,S,b);a.set(w,p,m,v,b)}return a.toTensor()},t.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,s=n.filterDepth,a=n.filterHeight,u=n.filterWidth,l=w_(n.filterShape,"float32"),c=l.values,h=l.strides,p=h[0],d=h[1],f=h[2],m=h[3],g=this.readSync(e.dataId),y=e.strides,v=y[0],b=y[1],w=y[2],x=y[3],_=this.readSync(t.dataId),C=t.strides,S=C[0],E=C[1],k=C[2],N=C[3],I=n.padInfo.front,T=n.padInfo.left,A=n.padInfo.top,R=0;R<s;++R)for(var O=Math.max(0,Math.ceil((I-R)/r)),D=Math.min(n.outDepth,(n.inDepth+I-R)/r),P=R*p,F=0;F<a;++F)for(var M=Math.max(0,Math.ceil((A-F)/i)),L=Math.min(n.outHeight,(n.inHeight+A-F)/i),z=F*d+P,B=0;B<u;++B)for(var U=Math.max(0,Math.ceil((T-B)/o)),V=Math.min(n.outWidth,(n.inWidth+T-B)/o),j=B*f+z,W=0;W<n.inChannels;++W)for(var H=W*m+j,q=0;q<n.outChannels;++q){for(var $=0,G=0;G<n.batchSize;++G)for(var K=G*S,X=G*v,Q=O;Q<D;++Q)for(var Z=(R+Q*r-I)*E+K,Y=Q*b+X,J=M;J<L;++J)for(var tt=(F+J*i-A)*k+Z,et=J*w+Y,nt=U;nt<V;++nt)$+=_[(B+nt*o-T)*N+tt+W]*g[nt*x+et+q];c[H+q]=$}return l.toTensor()},t.prototype.depthwiseConv2D=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,s=n.dilationWidth,a=n.padInfo.left,u=n.padInfo.top,l=n.outChannels/n.inChannels,c=w_(n.outShape,t.dtype),h=this.readSync(t.dataId),p=this.readSync(e.dataId),d=c.values,f=0;f<n.batchSize;++f)for(var m=f*t.strides[0],g=f*c.strides[0],y=0;y<n.outHeight;++y)for(var v=g+y*c.strides[1],b=y*n.strideHeight-a,w=0;w<r;++w){var x=b+w*o;if(!(x<0||x>=n.inHeight))for(var _=w*e.strides[0],C=m+x*t.strides[1],S=0;S<n.outWidth;++S)for(var E=v+S*c.strides[2],k=S*n.strideWidth-u,N=0;N<i;++N){var I=k+N*s;if(!(I<0||I>=n.inWidth))for(var T=C+I*n.inChannels,A=E,R=_+N*e.strides[1],O=0;O<n.inChannels;++O){for(var D=h[T+O],P=0;P<l;++P)d[A+P]+=D*p[R+P];A+=l,R+=l}}}return c.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerInput");for(var r=w_(n.inShape,"float32"),i=r.values,o=r.strides,s=o[0],a=o[1],u=o[2],l=this.readSync(t.dataId),c=t.strides,h=c[0],p=c[1],d=c[2],f=this.readSync(e.dataId),m=e.strides,g=m[0],y=m[1],v=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,_=n.inChannels,C=n.inHeight,S=n.inWidth,E=n.outHeight,k=n.outWidth,N=n.strideHeight,I=n.strideWidth,T=w-1-n.padInfo.top,A=x-1-n.padInfo.left,R=n.outChannels/_,O=0;O<b;++O)for(var D=0;D<_;++D)for(var P=0;P<C;++P)for(var F=P-T,M=Math.max(0,Math.ceil(F/N)),L=Math.min(E,(w+F)/N),z=0;z<S;++z){for(var B=z-A,U=Math.max(0,Math.ceil(B/I)),V=Math.min(k,(x+B)/I),j=0,W=M;W<L;++W)for(var H=W*N-F,q=U;q<V;++q)for(var $=h*O+p*W+d*q,G=g*(w-1-H)+y*(x-1-(q*I-B))+v*D,K=0;K<R;++K)j+=l[$+(D*R+K)]*f[G+K];i[s*O+a*P+u*z+D]=j}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=w_(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,h=this.bufferSync(t),p=this.bufferSync(e),d=0;d<o;++d)for(var f=Math.max(0,Math.ceil((l-d)/r)),m=Math.min(n.outHeight,(n.inHeight+l-d)/r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((u-g)/i)),v=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/c),x=b%c,_=0,C=0;C<n.batchSize;++C)for(var S=f;S<m;++S)for(var E=d+S*r-l,k=y;k<v;++k)_+=h.get(C,E,g+k*i-u,w)*p.get(C,S,k,b);a.set(_,d,g,w,x)}return a.toTensor()},t.prototype.tile=function(t,e){return this.assertNotComplex(t,"tile"),jC(this.bufferSync(t),e)},t.prototype.pad=function(t,e,n){this.assertNotComplex(t,"pad");var r=e.map(function(e,n){return e[0]+t.shape[n]+e[1]}),i=e.map(function(t){return t[0]}),o=this.bufferSync(t),s=w_(r,t.dtype);0!==n&&s.values.fill(n);for(var a=0;a<t.size;a++){var u=o.indexToLoc(a),l=u.map(function(t,e){return t+i[e]});s.set.apply(s,[o.get.apply(o,u)].concat(l))}return s.toTensor()},t.prototype.transpose=function(t,e){this.assertNotComplex(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=w_(n,t.dtype),s=this.bufferSync(t);for(r=0;r<t.size;++r){for(var a=s.indexToLoc(r),u=new Array(a.length),l=0;l<u.length;l++)u[l]=a[e[l]];var c=o.locToIndex(u);o.values[c]=i[r]}return o.toTensor()},t.prototype.gather=function(t,e,n){this.assertNotComplex([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=w_(r,t.dtype),s=this.bufferSync(t),a=0;a<o.size;++a){var u=o.indexToLoc(a),l=u.slice();l[n]=i[u[n]];var c=s.locToIndex(l);o.values[a]=s.values[c]}return o.toTensor()},t.prototype.batchToSpaceND=function(t,e,n){this.assertNotComplex([t],"batchToSpaceND");var r=e.reduce(function(t,e){return t*e}),i=G_(t.shape,e,r),o=K_(i.length,e.length),s=X_(t.shape,e,r),a=Q_(n,e.length),u=Z_(s,n,e.length);return t.reshape(i).transpose(o).reshape(s).slice(a,u)},t.prototype.spaceToBatchND=function(t,e,n){this.assertNotComplex([t],"spaceToBatchND");var r=e.reduce(function(t,e){return t*e}),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var s=t.pad(i),a=G_(s.shape,e,r,!1),u=K_(a.length,e.length,!1),l=X_(s.shape,e,r,!1);return s.reshape(a).transpose(u).reshape(l)},t.prototype.pool=function(t,e,n){this.assertNotComplex(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,a=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=e.padInfo.top,c=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(t.dataId),d=w_(e.outShape,t.dtype),f=d.values,m=e.outShape[1]*e.outShape[2]*e.outShape[3],g=e.outShape[2]*e.outShape[3],y=e.outShape[3],v=0;v<e.batchSize;++v)for(var b=v*m,w=v*t.strides[0],x=0;x<e.inChannels;++x)for(var _=0;_<e.outHeight;++_)for(var C=_*r-l,S=Math.max(0,C),E=Math.min(e.inHeight,a+C),k=b+_*g,N=0;N<e.outWidth;++N){for(var I=N*i-c,T=Math.max(0,I),A=Math.min(e.inWidth,u+I),R=h,O=0,D=0,P=S;P<E;P+=o){for(var F=w+P*t.strides[1],M=T;M<A;M+=s){var L=p[F+M*t.strides[2]+x];"max"===n&&L>R?R=L:"avg"===n&&(O+=L,D++)}if(isNaN(R))break}f[k+N*y+x]="avg"===n?O/D:R}return d.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var n=w_(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,a=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=e.padInfo.top,c=e.padInfo.left,h=this.bufferSync(t),p=0;p<e.batchSize;++p)for(var d=0;d<e.inChannels;++d)for(var f=0;f<e.outHeight;++f){for(var m=f*r-l,g=m;g<0;)g+=o;for(var y=Math.min(e.inHeight,a+m),v=0;v<e.outWidth;++v){for(var b=v*i-c,w=b;w<0;)w+=s;for(var x=Math.min(e.inWidth,u+b),_=Number.NEGATIVE_INFINITY,C=-1,S=g;S<y;S+=o)for(var E=S-m,k=w;k<x;k+=s){var N=k-b,I=h.get(p,S,k,d);I>_&&(_=I,C=E*u+N)}n.set(C,p,f,v,d)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=c-1-r.padInfo.left,p=l-1-r.padInfo.top,d=w_(e.shape,"float32"),f=this.bufferSync(i),m=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var y=0;y<r.inChannels;++y)for(var v=0;v<r.inHeight;++v)for(var b=0;b<r.inWidth;++b){for(var w=v-p,x=b-h,_=0,C=0;C<l;C+=a){var S=(w+C)/o;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var E=0;E<c;E+=u){var k=(x+E)/s;if(!(k<0||k>=r.outWidth||Math.floor(k)!==k)){var N=l*c-1-f.get(g,S,k,y)===C*c+E?1:0;0!==N&&(_+=m.get(g,S,k,y)*N)}}}d.set(_,g,v,b,y)}return d.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,s=n.filterWidth,a=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,p=l-1-n.padInfo.top,d=w_(e.shape,"float32"),f=1/(o*s),m=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var y=0;y<n.inChannels;++y)for(var v=0;v<n.inHeight;++v)for(var b=0;b<n.inWidth;++b){for(var w=v-p,x=b-h,_=0,C=0;C<l;C+=a){var S=(w+C)/r;if(!(S<0||S>=n.outHeight||Math.floor(S)!==S))for(var E=0;E<c;E+=u){var k=(x+E)/i;k<0||k>=n.outWidth||Math.floor(k)!==k||(_+=m.get(g,S,k,y))}}d.set(_*f,g,v,b,y)}return d.toTensor()},t.prototype.cast=function(t,e){return RC(t,e,this)},t.prototype.reshape=function(t,e){return OC(t,e)},t.prototype.avgPool=function(t,e){return this.assertNotComplex(t,"avgPool"),this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){this.assertNotComplex(t,"resizeBilinear");for(var i=t.shape,o=i[0],s=i[1],a=i[2],u=i[3],l=this.readSync(t.dataId),c=new Float32Array($v([o,e,n,u])),h=[r&&e>1?s-1:s,r&&n>1?a-1:a],p=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=0,f=h[0]/p[0],m=h[1]/p[1],g=0;g<o;g++)for(var y=0;y<e;y++)for(var v=f*y,b=Math.floor(v),w=v-b,x=Math.min(s-1,Math.ceil(v)),_=g*t.strides[0]+b*t.strides[1],C=g*t.strides[0]+x*t.strides[1],S=0;S<n;S++)for(var E=m*S,k=Math.floor(E),N=E-k,I=Math.min(a-1,Math.ceil(E)),T=_+k*t.strides[2],A=C+k*t.strides[2],R=_+ +I*t.strides[2],O=C+I*t.strides[2],D=0;D<u;D++){var P=l[T+D],F=l[A+D],M=P+(l[R+D]-P)*N;c[d++]=M+(F+(l[O+D]-F)*N-M)*w}return Vx(c,[o,e,n,u])},t.prototype.resizeBilinearBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],s=r[2],a=r[3],u=t.shape,l=u[1],c=u[2],h=new Float32Array(i*o*s*a),p=[n&&l>1?o-1:o,n&&c>1?s-1:s],d=[n&&l>1?l-1:l,n&&c>1?c-1:c],f=p[0]/d[0],m=p[1]/d[1],g=this.readSync(t.dataId),y=0,v=0;v<i;v++)for(var b=v*e.strides[0],w=0;w<l;w++)for(var x=w*f,_=Math.floor(x),C=Math.min(Math.ceil(x),o-1),S=b+_*e.strides[1],E=b+C*e.strides[1],k=x-_,N=1-k,I=0;I<c;I++)for(var T=I*m,A=Math.floor(T),R=Math.min(Math.ceil(T),s-1),O=T-A,D=1-O,P=S+A*e.strides[2],F=S+R*e.strides[2],M=E+A*e.strides[2],L=E+R*e.strides[2],z=N*D,B=N*O,U=k*D,V=k*O,j=0;j<a;j++){var W=g[y++];h[P+j]+=W*z,h[F+j]+=W*B,h[M+j]+=W*U,h[L+j]+=W*V}return Gx(h,[i,s,o,a],e.dtype)},t.prototype.resizeNearestNeighbor=function(t,e,n,r){this.assertNotComplex(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],s=i[1],a=i[2],u=i[3],l=this.readSync(t.dataId),c=new Float32Array(o*e*n*u),h=[r&&e>1?s-1:s,r&&n>1?a-1:a],p=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=h[0]/p[0],f=h[1]/p[1],m=0,g=0;g<o;g++)for(var y=g*t.strides[0],v=0;v<e;v++)for(var b=d*v,w=y+Math.min(s-1,r?Math.round(b):Math.floor(b))*t.strides[1],x=0;x<n;x++)for(var _=f*x,C=w+Math.min(a-1,r?Math.round(_):Math.floor(_))*t.strides[2],S=0;S<u;S++)c[m++]=l[C+S];return Vx(c,[o,e,n,u],t.dtype)},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],s=r[2],a=r[3],u=t.shape,l=u[1],c=u[2],h=new Float32Array(i*o*s*a),p=this.readSync(t.dataId),d=[n&&l>1?o-1:o,n&&c>1?s-1:s],f=[n&&l>1?l-1:l,n&&c>1?c-1:c],m=d[0]/f[0],g=d[1]/f[1],y=1/m,v=1/g,b=2*Math.ceil(y)+2,w=2*Math.ceil(v)+2,x=0;x<i;x++)for(var _=x*e.strides[0],C=0;C<o;C++)for(var S=_+C*e.strides[1],E=Math.floor(C*y),k=Math.floor(E-b/2),N=0;N<s;N++)for(var I=S+N*e.strides[2],T=Math.floor(N*v),A=Math.floor(T-w/2),R=0;R<a;R++){for(var O=0,D=0;D<b;D++){var P=D+k;if(!(P<0||P>=l)){var F=_+P*t.strides[1],M=P*m;if(C===Math.min(o-1,n?Math.round(M):Math.floor(M)))for(var L=0;L<w;L++){var z=L+A;if(!(z<0||z>=c)){var B=F+z*t.strides[2],U=z*g;N===Math.min(s-1,n?Math.round(U):Math.floor(U))&&(O+=p[B+R])}}}}h[I+R]=O}return Gx(h,e.shape,e.dtype)},t.prototype.batchNormalization=function(t,e,n,r,i,o){this.assertNotComplex([t,e,n,i,o],"batchNorm");for(var s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=this.readSync(n.dataId),l=i?this.readSync(i.dataId):new Float32Array([1]),c=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(s.length),p=c.length,d=l.length,f=u.length,m=a.length,g=0,y=0,v=0,b=0,w=0;w<s.length;++w)h[w]=c[g++]+(s[w]-a[y++])*l[v++]/Math.sqrt(u[b++]+r),g>=p&&(g=0),y>=m&&(y=0),v>=d&&(v=0),b>=f&&(b=0);return Gx(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){this.assertNotComplex(t,"localResponseNormalization4D");var o=t.shape[3],s=o-1,a=this.readSync(t.dataId),u=t.size,l=new Float32Array(u);function c(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,s),u=0;r<=i;r++){var l=a[r];u+=l*l}return u}for(var h=0;h<u;h++){var p=c(h),d=a[h]*Math.pow(n+r*p,-i);l[h]=d}return Gx(l,t.shape)},t.prototype.LRNGrad=function(t,e,n,r,i,o,s){this.assertNotComplex(t,"LRNGrad");for(var a=t.shape[3],u=this.readSync(t.dataId),l=this.readSync(e.dataId),c=this.readSync(n.dataId),h=new Float32Array(t.size),p=t.size,d=0;d<p;d++){for(var f=d%a,m=d-f+Math.max(0,f-r),g=d-f+Math.min(a,f+r+1),y=0,v=m;v<g;v++)y+=Math.pow(l[v],2);for(y=o*y+i,v=m;v<g;v++){var b=-2*o*s*l[v]*c[d]/y;d===v&&(b+=Math.pow(y,-s)),h[v]+=b*=u[d]}}return Gx(h,t.shape)},t.prototype.multinomial=function(t,e,n,r){this.assertNotComplex(t,"multinomial");for(var i=e?t:fC(t),o=i.shape[0],s=i.shape[1],a=Zx([o,n],"int32"),u=this.readSync(a.dataId),l=this.readSync(i.dataId),c=0;c<o;++c){var h=c*s,p=new Float32Array(s-1);p[0]=l[h];for(var d=1;d<p.length;++d)p[d]=p[d-1]+l[h+d];for(var f=y_(r.toString()),m=c*n,g=0;g<n;++g){var y=f();u[m+g]=p.length;for(var v=0;v<p.length;v++)if(y<p[v]){u[m+g]=v;break}}}return a},t.prototype.oneHot=function(t,e,n,r){this.assertNotComplex(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),s=0;s<t.size;++s)o[s]>=0&&o[s]<e&&(i[s*e+o[s]]=n);return qx(i,[t.size,e],"int32")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return this.assertNotComplex(t,"nonMaxSuppression"),BC(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},t.prototype.fft=function(t){return this.fftBatch(t,!1)},t.prototype.ifft=function(t){return this.fftBatch(t,!0)},t.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=w_(t.shape,"float32"),o=w_(t.shape,"float32"),s=Bx(t).as2D(n,r),a=Ux(t).as2D(n,r),u=0;u<n;u++)for(var l=s.slice([u,0],[1,r]),c=a.slice([u,0],[1,r]),h=zx(l,c),p=this.readSync(this.fftImpl(h,e).dataId),d=0;d<r;d++){var f=MC(p,d);i.values[u*r+d]=f.real,o.values[u*r+d]=f.imag}return zx(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=zx(Bx(i).div(Wx(r)),Ux(i).div(Wx(r)))),i}var o=this.readSync(t.dataId),s=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return zx(s.real,s.imag).as2D(t.shape[0],t.shape[1])},t.prototype.isExponentOf2=function(t){return 0==(t&t-1)},t.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),s=zx(o.real,o.imag).as1D(),a=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=zx(a.real,a.imag).as1D();s=this.fftRadix2(s,i,n),u=this.fftRadix2(u,i,n);var l=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),c=zx(l.real,l.imag).mul(u),h=s.add(c),p=s.sub(c),d=Bx(h).concat(Bx(p)),f=Ux(h).concat(Ux(p));return zx(d,f).as1D()},t.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,s=0,a=0;a<e;a++){var u=zC(i*a,e,n),l=MC(t,a);o+=l.real*u.real-l.imag*u.imag,s+=l.real*u.imag+l.imag*u.real}n&&(o/=e,s/=e),LC(r,o,s,i)}return r},t.prototype.depthToSpace=function(t,e,n){jv("NHWC"===n,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n}),jv(e>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+e});for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],s=t.shape[3],a=i*e,u=o*e,l=s/(e*e),c=this.readSync(t.dataId),h=new Float32Array(r*a*u*l),p=0,d=0;d<r;++d)for(var f=0;f<a;++f)for(var m=Math.floor(f/e),g=f%e,y=0;y<u;++y)for(var v=Math.floor(y/e),b=(g*e+y%e)*l,w=0;w<l;++w)h[p++]=c[w+b+s*(v+o*(m+i*d))];return Gx(h,[r,a,u,l])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=wC(t.shape,e.shape),o=w_(i,n),s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=vC(t.shape,i),l=vC(e.shape,i),c=o.values;if(u.length+l.length===0)for(var h=0;h<c.length;++h)c[h]=r(s[h%s.length],a[h%a.length]);else{var p=this.bufferSync(t),d=this.bufferSync(e),f=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach(function(t){return h[t]=0});var f=p.locToIndex(h),m=i.slice(-e.rank);l.forEach(function(t){return m[t]=0});var g=d.locToIndex(m);c[n]=r(s[f],a[g])};for(h=0;h<c.length;++h)f(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=wC(t.shape,e.shape),i=w_(r,"float32"),o=w_(r,"float32"),s=this.readSync(t.dataId),a=this.readSync(e.dataId),u=vC(t.shape,r),l=vC(e.shape,r),c=i.values,h=o.values;if(u.length+l.length===0)for(var p=0;p<c.length;p++){var d=p%s.length,f=p%a.length,m=n(s[2*d],s[2*d+1],a[2*f],a[2*f+1]);c[p]=m.real,h[p]=m.imag}else{var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=this.bufferSync(this.data.get(e.dataId).complexTensors.real),v=function(r){var o=i.indexToLoc(r),p=o.slice(-t.rank);u.forEach(function(t){return p[t]=0});var d=g.locToIndex(p),f=o.slice(-e.rank);l.forEach(function(t){return f[t]=0});var m=y.locToIndex(f),v=n(s[2*d],s[2*d+1],a[2*m],a[2*m+1]);c[r]=v.real,h[r]=v.imag};for(p=0;p<c.length;p++)v(p)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(t,e,n){return VC(t,e,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(t,e,n,r,i,o){for(var s=t.shape,a=s[0],u=s[1],l=s[2],c=s[3],h=e.shape[0],p=r[0],d=r[1],f=w_([h,p,d,c],t.dtype),m=this.readSync(e.dataId),g=this.readSync(n.dataId),y=this.readSync(t.dataId),v=t.strides,b=f.strides,w=0;w<h;w++){var x=4*w,_=m[x],C=m[x+1],S=m[x+2],E=m[x+3],k=g[w];if(!(k>=a))for(var N=p>1?(S-_)*(u-1)/(p-1):0,I=d>1?(E-C)*(l-1)/(d-1):0,T=0;T<p;T++){var A=p>1?_*(u-1)+T*N:.5*(_+S)*(u-1);if(A<0||A>u-1)for(var R=0;R<d;R++)for(var O=0;O<c;O++){var D=O+R*b[2]+T*b[1]+w*b[0];f.values[D]=o}else if("bilinear"===i){var P=Math.floor(A),F=Math.ceil(A),M=A-P;for(R=0;R<d;R++)if((q=d>1?C*(l-1)+R*I:.5*(C+E)*(l-1))<0||q>l-1)for(O=0;O<c;O++)f.values[D=O+R*b[2]+T*b[1]+w*b[0]]=o;else{var L=Math.floor(q),z=Math.ceil(q),B=q-L;for(O=0;O<c;O++){var U=y[D=O+L*v[2]+P*v[1]+k*v[0]],V=y[D=O+z*v[2]+P*v[1]+k*v[0]],j=y[D=O+L*v[2]+F*v[1]+k*v[0]],W=U+(V-U)*B,H=j+(y[D=O+z*v[2]+F*v[1]+k*v[0]]-j)*B;f.values[D=O+R*b[2]+T*b[1]+w*b[0]]=W+(H-W)*M}}}else for(R=0;R<d;++R){var q;if((q=d>1?C*(l-1)+R*I:.5*(C+E)*(l-1))<0||q>l-1)for(O=0;O<c;O++)f.values[D=O+R*b[2]+T*b[1]+w*b[0]]=o;else{var $=Math.round(q),G=Math.round(A);for(O=0;O<c;O++)f.values[O+R*b[2]+T*b[1]+w*b[0]]=y[O+$*v[2]+G*v[1]+k*v[0]]}}}}return f.toTensor()},t.prototype.sparseToDense=function(t,e,n,r){var i=eC(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=Y_(t,e),o=i[0],s=i[1],a=i[2],u=i[3];if(0===s)return Vx([],o,t.dtype);for(var l=new Pb([s,a],t.dtype),c=this.readSync(e.dataId),h=this.readSync(t.dataId),p=0;p<s;p++){for(var d=[],f=0,m=0;m<r;m++){var g=c[p*r+m];f+=g*u[m],d.push(g)}if(f<0||f>=t.size/a)throw new Error("Invalid indices: "+d+" does not index into "+t.shape);for(var y=0;y<a;y++)l.values[p*a+y]=h[f*a+y]}return l.toTensor().reshape(o)},t.prototype.scatterND=function(t,e,n){var r=eC(0,t,n),i=r.sliceRank,o=r.numUpdates,s=r.sliceSize,a=r.strides,u=r.outputSize,l=Wx(0);return this.scatter(t,e,n,u,s,o,i,a,l,!0)},t.prototype.fill=function(t,e,n){var r=rb(n=n||fb(e),$v(t));return r.fill(e),zb.make(t,{values:r},n)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){var e=rb(t.dtype,$v(t.shape));return zb.make(t.shape,{values:e},t.dtype)},t.prototype.linspace=function(t,e,n){return DC(t,e,n)},t.prototype.scatter=function(t,e,n,r,i,o,s,a,u,l){var c=[r/i,i],h=this.readSync(t.dataId),p=this.readSync(e.dataId);if(0===r)return Vx([],n,e.dtype);var d=new Pb(c,e.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var f=0;f<o;f++){for(var m=[],g=0,y=0;y<s;y++){var v=h[f*s+y];m.push(v),g+=v*a[y]}if(g<0||g>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)l?d.values[g*i+b]+=p[f*i+b]:d.values[g*i+b]=0===e.rank?p[0]:p[f*i+b]}return d.toTensor().reshape(n)},t}();rw.registerBackend("cpu",function(){return new TT},1);var AT=function(){function t(){this.textEncoder=new TextEncoder}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();Fv.get("IS_BROWSER")&&Fv.setPlatform("browser",new AT);var RT,OT=function(){function t(){this.util=n(3),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=Fv.global.fetch?Fv.global.fetch(t,e):(null==RT&&(RT=n(2)),RT(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();Fv.get("IS_NODE")&&Fv.setPlatform("node",new OT);var DT={float32:4,int32:4,uint16:2,uint8:1,bool:1},PT=4;function FT(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,s=e.shape,a=$v(s),u=void 0;if("quantization"in e){var l=e.quantization;if("uint8"!==l.dtype&&"uint16"!==l.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+l.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var c=DT[l.dtype],h=t.slice(r,r+a*c),p="uint8"===l.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(p,function(t){return t*l.scale+l.min});else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(p,function(t){return Math.round(t*l.scale+l.min)})}r+=a*c}else if("string"===o){var d=$v(e.shape);u=[];for(var f=0;f<d;f++){var m=new Uint32Array(t.slice(r,r+PT))[0];r+=PT;var g=new Uint8Array(t.slice(r,r+m));u.push(g),r+=m}}else{var y=DT[o];if(h=t.slice(r,r+a*y),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=a*y}n[i]=Vx(u,s,o)},o=0,s=e;o<s.length;o++)i(s[o]);return n}function MT(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach(function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)});var r=new Uint8Array(e),i=0;return n.forEach(function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength}),r.buffer}var LT="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function zT(t){return LT?Buffer.byteLength(t):new Blob([t]).size}function BT(t){var e=0;t.forEach(function(t){e+=t.byteLength});var n=new Uint8Array(e),r=0;return t.forEach(function(t){n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function UT(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function VT(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:zT(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:zT(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var jT=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(t){var n=t(e,r);null!==n&&i.push(n)}),i},t}(),WT="://",HT=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){jv(null!=e,function(){return"scheme must not be undefined or null."}),e.endsWith(WT)&&(e=e.slice(0,e.indexOf(WT))),jv(e.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();jv(null==r.managers[e],function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function qT(t){if(-1===t.indexOf(WT))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+HT.getSchemes().join(","));return{scheme:t.split(WT)[0],path:t.split(WT)[1]}}function $T(t,e,n){return void 0===n&&(n=!1),Rv(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,h;return Ov(this,function(p){switch(p.label){case 0:return jv(t!==e,function(){return"Old path and new path are the same: '"+t+"'"}),jv((r=jT.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),jv(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),i=r[0],jv((o=jT.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),jv(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),s=o[0],a=qT(t).scheme,u=qT(t).path,l=a===qT(t).scheme,[4,i.load()];case 1:return c=p.sent(),n&&l?[4,HT.getManager(a).removeModel(u)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,s.save(c)];case 4:return h=p.sent(),!n||l?[3,6]:[4,HT.getManager(a).removeModel(u)];case 5:p.sent(),p.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var GT="models_store",KT="model_info_store";function XT(){if(!Fv.getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function QT(t){var e=t.result;e.createObjectStore(GT,{keyPath:"modelPath"}),e.createObjectStore(KT,{keyPath:"modelPath"})}var ZT=function(){function t(t){if(this.indexedDB=XT(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},t.prototype.load=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(t,e){var n=this;return new Promise(function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return QT(i)},i.onsuccess=function(){var o=i.result;if(null==e){var s=o.transaction(GT,"readonly"),a=s.objectStore(GT).get(n.modelPath);a.onsuccess=function(){if(null==a.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(a.result.modelArtifacts)},a.onerror=function(t){return o.close(),r(a.error)},s.oncomplete=function(){return o.close()}}else{var u,l=VT(e),c=o.transaction(KT,"readwrite"),h=c.objectStore(KT),p=h.put({modelPath:n.modelPath,modelArtifactsInfo:l});p.onsuccess=function(){var i=(u=o.transaction(GT,"readwrite")).objectStore(GT).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:l});i.onsuccess=function(){return t({modelArtifactsInfo:l})},i.onerror=function(t){var e=(h=c.objectStore(KT)).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},p.onerror=function(t){return o.close(),r(p.error)},c.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}})},t.URL_SCHEME="indexeddb://",t}(),YT=function(t){return Fv.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ZT.URL_SCHEME)?(e=t.slice(ZT.URL_SCHEME.length),new ZT(e)):null;var e};jT.registerSaveRouter(YT),jT.registerLoadRouter(YT);var JT=function(){function t(){this.indexedDB=XT()}return t.prototype.listModels=function(){return Rv(this,void 0,void 0,function(){var t=this;return Ov(this,function(e){return[2,new Promise(function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return QT(r)},r.onsuccess=function(){var t=r.result,i=t.transaction(KT,"readonly"),o=i.objectStore(KT).getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}})]})})},t.prototype.removeModel=function(t){return Rv(this,void 0,void 0,function(){var e=this;return Ov(this,function(n){var r;return t=(r=t).startsWith(ZT.URL_SCHEME)?r.slice(ZT.URL_SCHEME.length):r,[2,new Promise(function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return QT(i)},i.onsuccess=function(){var e,o=i.result,s=o.transaction(KT,"readwrite"),a=s.objectStore(KT),u=a.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=a.delete(t),s=function(){var i=(e=o.transaction(GT,"readwrite")).objectStore(GT).delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=s,i.onerror=function(t){return s(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},s.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}})]})})},t}();if(Fv.getBool("IS_BROWSER"))try{HT.registerManager(ZT.URL_SCHEME,new JT)}catch(qb){}var tA="/",eA="tensorflowjs_models",nA="info",rA="model_topology",iA="weight_specs",oA="weight_data",sA="model_metadata";function aA(t){return{info:[eA,t,nA].join(tA),topology:[eA,t,rA].join(tA),weightSpecs:[eA,t,iA].join(tA),weightData:[eA,t,oA].join(tA),modelMetadata:[eA,t,sA].join(tA)}}function uA(t){var e=t.split(tA);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(tA)}var lA=function(){function t(t){if(!Fv.getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=aA(this.modelPath)}return t.prototype.save=function(t){return Rv(this,void 0,void 0,function(){var e,n,r;return Ov(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=VT(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=t.weightData,LT?Buffer.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]})})},t.prototype.load=function(){return Rv(this,void 0,void 0,function(){var t,e,n,r,i,o,s;return Ov(this,function(a){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(LT){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(s),[2,e]})})},t.URL_SCHEME="localstorage://",t}(),cA=function(t){return Fv.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(lA.URL_SCHEME)?(e=t.slice(lA.URL_SCHEME.length),new lA(e)):null;var e};jT.registerSaveRouter(cA),jT.registerLoadRouter(cA);var hA=function(){function t(){jv(Fv.getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),jv(void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return Rv(this,void 0,void 0,function(){var t,e,n,r,i,o;return Ov(this,function(s){for(t={},e=eA+tA,n=tA+nA,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=uA(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},t.prototype.removeModel=function(t){return Rv(this,void 0,void 0,function(){var e,n;return Ov(this,function(r){var i;if(t=(i=t).startsWith(lA.URL_SCHEME)?i.slice(lA.URL_SCHEME.length):i,e=aA(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]})})},t}();if(Fv.getBool("IS_BROWSER"))try{HT.registerManager(lA.URL_SCHEME,new hA)}catch(qb){}var pA="model",dA=".json",fA=".weights.bin";function mA(t){return new Promise(function(t){return setTimeout(t)}).then(t)}var gA=function(){function t(e){if(!Fv.getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e=pA),this.modelTopologyFileName=e+dA,this.weightDataFileName=e+fA}return t.prototype.save=function(t){return Rv(this,void 0,void 0,function(){var e,n,r,i;return Ov(this,function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,mA(function(){return r.dispatchEvent(new MouseEvent("click"))})];case 2:return o.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,mA(function(){return i.dispatchEvent(new MouseEvent("click"))})]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:VT(t)}]}})})},t.URL_SCHEME="downloads://",t}(),yA=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return Rv(this,void 0,void 0,function(){var t,e,n=this;return Ov(this,function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(r,i){var o=new FileReader;o.onload=function(o){var s=JSON.parse(o.target.result),a=s.modelTopology;if(null!=a){0===e.length&&r({modelTopology:a});var u=s.weightsManifest;if(null!=u){var l;try{l=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var c=[],h=[],p=[];u.forEach(function(t){t.paths.forEach(function(t){h.push(t),p.push(null)}),c.push.apply(c,t.weights)}),u.forEach(function(t){t.paths.forEach(function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);p[i]=n,-1===p.indexOf(null)&&r({modelTopology:a,weightSpecs:c,weightData:BT(p)})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(l[t])})})}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)})]})})},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map(function(t){return UT(t.name)}),i={},o=0,s=t;o<s.length;o++)s[o].paths.forEach(function(t){var o=UT(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]});if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function vA(t,e,n,r){!function(t){jv(null!=t&&Array.isArray(t)&&t.length>0,function(){return"promises must be a none empty array"})}(t),function(t,e){jv(t>=0&&t<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t}),jv(e>=0&&e<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e}),jv(e>=t,function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e})}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map(function(o){return o.then(function(o){var s=n+ ++i/t.length*(r-n);return e(s),o}),o}))}function bA(t,e){return Rv(this,void 0,void 0,function(){var n,r,i,o,s,a,u,l,c;return Ov(this,function(h){switch(h.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?Sb:e.fetchFunc,r=t.map(function(t){return n(t,e.requestInit)}),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return s=h.sent(),[3,4];case 2:return[4,vA(r,e.onProgress,i,o)];case 3:s=h.sent(),h.label=4;case 4:return a=s.map(function(t){return t.arrayBuffer()}),u=.5,l=1,null!=e.onProgress?[3,6]:[4,Promise.all(a)];case 5:return c=h.sent(),[3,8];case 6:return[4,vA(a,e.onProgress,u,l)];case 7:c=h.sent(),h.label=8;case 8:return[2,c]}})})}function wA(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),Rv(e,void 0,void 0,function(){var e,o,s,a,u,l,c,h,p,d;return Ov(this,function(f){switch(f.label){case 0:if(e=n.map(function(){return!1}),o={},s=null!=i?i.map(function(){return!1}):[],a=[],n.forEach(function(t,n){var r=0;t.weights.forEach(function(t){var u=DT["quantization"in t?t.quantization.dtype:t.dtype]*$v(t.shape),l=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:u})};null!=i?i.forEach(function(e,n){e===t.name&&(l(),s[n]=!0)}):l(),a.push(t.name),r+=u})}),!s.every(function(t){return t}))throw u=i.filter(function(t,e){return!s[e]}),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+a.join(", ")+".");return l=e.reduce(function(t,e,n){return e&&t.push(n),t},[]),c=[],l.forEach(function(t){n[t].paths.forEach(function(t){var e=r+(r.endsWith("/")?"":"/")+t;c.push(e)})}),[4,t(c)];case 1:return h=f.sent(),p={},d=0,l.forEach(function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=h[d+i].byteLength;for(var s=new ArrayBuffer(r),a=new Uint8Array(s),u=0,l=0;l<e;l++){var c=new Uint8Array(h[d+l]);a.set(c,u),u+=c.byteLength}o[t].forEach(function(t){var e=FT(s.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)p[n]=e[n]}),d+=e}),[2,p]}})})}}jT.registerSaveRouter(function(t){return Fv.getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(gA.URL_SCHEME)?(void 0===(e=t.slice(gA.URL_SCHEME.length))&&(e="model"),new gA(e)):null;var e});var xA=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(jv("function"==typeof e.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=Sb,jv(null!=t&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&jv(2===t.length,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return Rv(this,void 0,void 0,function(){var e,n;return Ov(this,function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:VT(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}})})},t.prototype.load=function(){return Rv(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a;return Ov(this,function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:a=u.sent(),o=a[0],s=a[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:o,weightData:s}]}})})},t.prototype.loadWeights=function(t){return Rv(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,l,c;return Ov(this,function(h){switch(h.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,s=[],a=0,u=t;a<u.length;a++)s.push.apply(s,u[a].weights);return l=[],t.forEach(function(t){t.paths.forEach(function(t){l.push(o+t+i)})}),[4,bA(l,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return c=h.sent(),[2,[s,BT(c)]]}})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function _A(t){return null!=t.match(xA.URL_SCHEME_REGEX)}var CA=function(t,e){return(Array.isArray(t)?t.every(function(t){return _A(t)}):_A(t))?SA(t,{onProgress:e}):null};function SA(t,e){return new xA(t,e)}jT.registerSaveRouter(CA),jT.registerLoadRouter(CA);var EA=function(){function t(t,e,n,r){this.modelTopology=t,this.weightSpecs=e,this.weightData=n,this.trainingConfig=r}return t.prototype.load=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){return t={},null!=this.modelTopology&&(t=Av({modelTopology:this.modelTopology},t)),null!=this.weightSpecs&&this.weightSpecs.length>0&&(t=Av({weightSpecs:this.weightSpecs},t)),null!=this.weightData&&this.weightData.byteLength>0&&(t=Av({weightData:this.weightData},t)),null!=this.trainingConfig&&(t=Av({trainingConfig:this.trainingConfig},t)),[2,t]})})},t}(),kA=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(e){return[2,this.saveHandler(t)]})})},t}(),NA=Object.freeze({browserFiles:function(t){return new yA(t)},browserHTTPRequest:function(t,e){return SA(t,e)},concatenateArrayBuffers:BT,decodeWeights:FT,encodeWeights:function(t,e){return Rv(this,void 0,void 0,function(){var n,r,i,o,s,a=this;return Ov(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t),o=function(o){var s=i[o],u=Array.isArray(t)?t[o].tensor:t[s];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+s+"': "+u.dtype);var l={name:s,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var c=new Promise(function(t){return Rv(a,void 0,void 0,function(){var e,n,r,i,o,s,a;return Ov(this,function(l){switch(l.label){case 0:return[4,u.bytes()];case 1:for(e=l.sent(),n=e.reduce(function(t,e){return t+e.length},0)+PT*e.length,r=new Uint8Array(n),i=0,o=0;o<e.length;o++)s=e[o],a=new Uint8Array(new Uint32Array([s.length]).buffer),r.set(a,i),r.set(s,i+=PT),i+=s.length;return t(r),[2]}})})});r.push(c)}else r.push(u.data());null!=e&&(l.group=e),n.push(l)},s=0;s<i.length;++s)o(s);return[4,Promise.all(r)];case 1:return[2,{data:MT(u.sent()),specs:n}]}})})},fromMemory:function(t,e,n,r){return new EA(t,e,n,r)},getLoadHandlers:function(t,e){return jT.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:VT,getSaveHandlers:function(t){return jT.getSaveHandlers(t)},http:SA,isHTTPScheme:_A,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),Rv(this,void 0,void 0,function(){return Ov(this,function(i){return[2,wA(function(t){return bA(t,{requestInit:r})})(t,e,n)]})})},registerLoadRouter:function(t){return jT.registerLoadRouter(t)},registerSaveRouter:function(t){return jT.registerSaveRouter(t)},weightsLoaderFactory:wA,withSaveHandler:function(t){return new kA(t)},copyModel:function(t,e){return Rv(this,void 0,void 0,function(){return Ov(this,function(n){return[2,$T(t,e,!1)]})})},listModels:function(){return Rv(this,void 0,void 0,function(){var t,e,n,r,i,o,s;return Ov(this,function(a){switch(a.label){case 0:t=HT.getSchemes(),e={},n=0,r=t,a.label=1;case 1:return n<r.length?[4,HT.getManager(i=r[n]).listModels()]:[3,4];case 2:for(s in o=a.sent())e[i+WT+s]=o[s];a.label=3;case 3:return n++,[3,1];case 4:return[2,e]}})})},moveModel:function(t,e){return Rv(this,void 0,void 0,function(){return Ov(this,function(n){return[2,$T(t,e,!0)]})})},removeModel:function(t){return Rv(this,void 0,void 0,function(){var e;return Ov(this,function(n){return e=qT(t),[2,HT.getManager(e.scheme).removeModel(e.path)]})})}}),IA=Lx({confusionMatrix_:function(t,e,n){var r=Ex(t,"labels","confusionMatrix"),i=Ex(e,"predictions","confusionMatrix");jv(null==n||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),jv(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),jv(1===i.rank,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),jv(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),jv(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var o=A_(r.asType("int32"),n),s=A_(i.asType("int32"),n);return o.transpose().matMul(s).asType("int32")}}),TA=Object.freeze({confusionMatrix:IA}),AA=Lx({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");return rw.fromPixels(t,e)}}),RA=Object.freeze({toPixels:function(t,e){return Rv(this,void 0,void 0,function(){var n,r,i,o,s,a,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_;return Ov(this,function(C){switch(C.label){case 0:if(n=Ex(t,"img","toPixels"),t instanceof zb||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(s=2===n.rank?1:n.shape[2])>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return a=C.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=C.sent(),h=c[0][0],p=c[1][0],u.dispose(),l.dispose(),"float32"===n.dtype){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(d="float32"===n.dtype?255:1,f=new Uint8ClampedArray(o*i*4),m=0;m<i*o;++m)g=void 0,y=void 0,v=void 0,b=void 0,1===s?(g=a[m]*d,y=a[m]*d,v=a[m]*d,b=255):3===s?(g=a[3*m]*d,y=a[3*m+1]*d,v=a[3*m+2]*d,b=255):4===s&&(g=a[4*m]*d,y=a[4*m+1]*d,v=a[4*m+2]*d,b=a[4*m+3]*d),f[0+(w=4*m)]=Math.round(g),f[w+1]=Math.round(y),f[w+2]=Math.round(v),f[w+3]=Math.round(b);return null!=e&&(e.width=o,e.height=i,x=e.getContext("2d"),_=new ImageData(f,o,i),x.putImageData(_,0,0)),n!==t&&n.dispose(),[2,f]}})})},fromPixels:AA}),OA=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),DA=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function PA(t){jv(null!=t.className,function(){return"Class being registered does not have the static className property defined."}),jv("string"==typeof t.className,function(){return"className is required to be a string, but got type "+typeof t.className}),jv(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),DA.register(t)}var FA=Object.freeze({Serializable:OA,SerializationMap:DA,registerClass:PA}),MA=.001,LA=.1;function zA(){return 32===rw.backend.floatPrecision()?MA:LA}function BA(t,e,n){var r=!0;if((ub(t)||ub(e))&&(r=!1),ub(t)&&ub(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var s=Cx(t),a=Cx(e);if(!Gv(s,a))throw new Error("Arrays have different shapes. Actual: ["+s+"]. Expected: ["+a+"]")}var u=ub(t)?t:qv(t),l=ub(e)?e:qv(e);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+".\nActual:   "+u+".\nExpected: "+l+".");for(var c=0;c<l.length;++c){var h=u[c],p=l[c];if(!n(h,p))throw new Error("Arrays differ: actual["+c+"] = "+h+", expected["+c+"] = "+p+".\nActual:   "+u+".\nExpected: "+l+".")}}function UA(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}var VA=Object.freeze({TEST_EPSILON_FLOAT16:LA,expectArraysClose:function(t,e,n){return null==n&&(n=zA()),BA(t,e,function(t,e){return UA(t,e,n)})},testEpsilon:zA,expectPromiseToFail:function(t,e){t().then(function(){return e.fail()},function(){return e()})},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return hb(t)||hb(t[0])||hb(e)||hb(e[0])?BA(t,n,function(t,e){return t==e}):BA(t,e,function(t,e){return UA(t,e,0)})},expectNumbersClose:function(t,e,n){if(null==n&&(n=zA()),!UA(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),jA="1.2.6",WA=Object.freeze({gpgpu_util:mE,webgl_util:ex,MathBackendWebGL:ak,setWebGLContext:aw,GPGPUContext:gE}),HA=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tv(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var s=n.map(function(t){return{name:t.name,tensor:o[t.name]}});this.applyGradients(s)}else this.applyGradients(o);return cx(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return hC(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&cx(this.iterations_)},e.prototype.saveIterations=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:Wx(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(t){return Rv(this,void 0,void 0,function(){var e;return Ov(this,function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}})})},e}(OA);Object.defineProperty(HA,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var qA=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=rw.backend.epsilon()),i}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t)).forEach(function(n,r){var i=rw.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:lx(function(){return n_(i).variable(!1)})}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:lx(function(){return n_(i).variable(!1)})});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedGrads[r].variable,a=e.accumulatedUpdates[r].variable;lx(function(){var t=s.mul(e.rho).add(o.square().mul(1-e.rho)),n=a.add(e.epsilon).sqrt().div(s.add(e.epsilon).sqrt()).mul(o),r=a.mul(e.rho).add(n.square().mul(1-e.rho));s.assign(t),a.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)})}}),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(cx(this.accumulatedGrads.map(function(t){return t.variable})),cx(this.accumulatedUpdates.map(function(t){return t.variable})))},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){var e;return Ov(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),this.accumulatedUpdates=t.slice(e,2*e).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="AdadeltaOptimizer",e}(HA);PA(qA);var $A=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t)).forEach(function(n,r){var i=rw.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:lx(function(){return Yx(i.shape,e.initialAccumulatorValue).variable(!1)})});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedGrads[r].variable;lx(function(){var t=s.add(o.square());s.assign(t);var n=o.div(t.add(rw.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)})}}),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&cx(this.accumulatedGrads.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(HA);PA($A);var GA=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],lx(function(){o.accBeta1=Wx(n).variable(),o.accBeta2=Wx(r).variable()}),null==i&&(o.epsilon=rw.backend.epsilon()),o}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t);lx(function(){var r=wI(1,e.accBeta1),i=wI(1,e.accBeta2);n.forEach(function(n,o){var s=rw.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:lx(function(){return n_(s).variable(!1)})}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:lx(function(){return n_(s).variable(!1)})});var a=Array.isArray(t)?t[o].tensor:t[n];if(null!=a){var u=e.accumulatedFirstMoment[o].variable,l=e.accumulatedSecondMoment[o].variable,c=u.mul(e.beta1).add(a.mul(1-e.beta1)),h=l.mul(e.beta2).add(a.square().mul(1-e.beta2)),p=c.div(r),d=h.div(i);u.assign(c),l.assign(h);var f=p.div(d.sqrt().add(e.epsilon)).mul(-e.learningRate).add(s);s.assign(f)}}),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&cx(this.accumulatedFirstMoment.map(function(t){return t.variable})),null!=this.accumulatedSecondMoment&&cx(this.accumulatedSecondMoment.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){var e,n=this;return Ov(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),lx(function(){n.accBeta1.assign(gI(n.beta1,n.iterations_+1)),n.accBeta2.assign(gI(n.beta2,n.iterations_+1))}),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),this.accumulatedSecondMoment=t.slice(e,2*e).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(HA);PA(GA);var KA=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var s=t.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=r,s.epsilon=i,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],lx(function(){s.iteration=Wx(0).variable(),s.accBeta1=Wx(n).variable()}),null==i&&(s.epsilon=rw.backend.epsilon()),s}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t);lx(function(){var r=wI(1,e.accBeta1),i=oI(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach(function(n,o){var s=rw.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:n_(s).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:n_(s).variable(!1)});var a=Array.isArray(t)?t[o].tensor:t[n];if(null!=a){var u=e.accumulatedFirstMoment[o].variable,l=e.accumulatedWeightedInfNorm[o].variable,c=u.mul(e.beta1).add(a.mul(1-e.beta1)),h=l.mul(e.beta2),p=a.abs(),d=h.maximum(p);u.assign(c),l.assign(d);var f=i.div(r).mul(c.div(d.add(e.epsilon))).add(s);s.assign(f)}}),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&cx(this.accumulatedFirstMoment.map(function(t){return t.variable})),null!=this.accumulatedWeightedInfNorm&&cx(this.accumulatedWeightedInfNorm.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(HA);PA(KA);var XA=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t)).forEach(function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=rw.registeredVariables[n];lx(function(){var t=e.c.mul(i).add(o);o.assign(t)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=hx(Wx(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(HA);PA(XA);var QA=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=Wx(i.momentum),i}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t)).forEach(function(n,r){var i=rw.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:lx(function(){return n_(i).variable(!1)})});var o=e.accumulations[r].variable,s=Array.isArray(t)?t[r].tensor:t[n];null!=s&&lx(function(){var t,n=e.m.mul(o).add(s);t=e.useNesterov?e.c.mul(s.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&cx(this.accumulations.map(function(t){return t.variable}))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){return Ov(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){return Ov(this,function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="MomentumOptimizer",e}(XA);PA(QA);var ZA=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var s=t.call(this)||this;return s.learningRate=e,s.decay=n,s.momentum=r,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,null==i&&(s.epsilon=rw.backend.epsilon()),s}return Tv(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map(function(t){return t.name}):Object.keys(t)).forEach(function(n,r){var i=rw.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:lx(function(){return n_(i).variable(!1)})}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:lx(function(){return n_(i).variable(!1)})}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:lx(function(){return n_(i).variable(!1)})});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedMeanSquares[r].variable,a=e.accumulatedMoments[r].variable;lx(function(){var t=s.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),l=a.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));s.assign(t),n.assign(u),a.assign(l);var c=i.sub(l);i.assign(c)}else{var h=s.mul(e.decay).add(o.square().mul(1-e.decay));l=a.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),s.assign(h),a.assign(l),c=i.sub(l),i.assign(c)}})}}),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&cx(this.accumulatedMeanSquares.map(function(t){return t.variable})),null!=this.accumulatedMeanGrads&&this.centered&&cx(this.accumulatedMeanGrads.map(function(t){return t.variable})),null!=this.accumulatedMoments&&cx(this.accumulatedMoments.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Rv(this,void 0,void 0,function(){var t;return Ov(this,function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},e.prototype.setWeights=function(t){return Rv(this,void 0,void 0,function(){var e;return Ov(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),this.accumulatedMoments=t.slice(e,2*e).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(HA);PA(ZA);var YA=function(){function t(){}return t.sgd=function(t){return new XA(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new QA(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new ZA(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new GA(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new qA(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new KA(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new $A(t,e)},t}(),JA={sgd:YA.sgd,momentum:YA.momentum,adadelta:YA.adadelta,adagrad:YA.adagrad,rmsprop:YA.rmsprop,adamax:YA.adamax,adam:YA.adam},tR="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(t){return t()};function eR(){return new Promise(function(t){return tR(function(){return t()})})}Mb=IT;var nR=function(){return(nR=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function rR(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})}function iR(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var oR,sR,aR,uR={};function lR(t){return uR[t]}function cR(t,e,n,r){var i=e.inputParams[t];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd;if("tensor"===i.type)return hR(e.inputNames[i.inputIndexStart],n,r);if("tensors"===i.type)return e.inputNames.slice(o,s).map(function(t){return hR(t,n,r)});var a=Array.prototype.slice.call(hR(e.inputNames.slice(o)[0],n,r).dataSync());return"number"===i.type?a[0]:a}var u=e.attrParams[t];return u&&u.value}function hR(t,e,n){var r=fR(t),i=r[0],o=r[1],s=n.currentContextIds.find(function(t){return!!e[dR(i,t)]});return void 0!==s?e[dR(i,s)][o]:void 0}function pR(t,e){var n=fR(t),r=n[1];return[dR(n[0],e&&e.currentContextId),r]}function dR(t,e){return e?t+"-"+e:t}function fR(t){var e=t.lastIndexOf(":");return-1===e?[t,0]:[t.substring(0,e),Number(t.substring(e+1))]}function mR(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}(aR=oR||(oR={}))[aR.DT_INVALID=0]="DT_INVALID",aR[aR.DT_FLOAT=1]="DT_FLOAT",aR[aR.DT_DOUBLE=2]="DT_DOUBLE",aR[aR.DT_INT32=3]="DT_INT32",aR[aR.DT_UINT8=4]="DT_UINT8",aR[aR.DT_INT16=5]="DT_INT16",aR[aR.DT_INT8=6]="DT_INT8",aR[aR.DT_STRING=7]="DT_STRING",aR[aR.DT_COMPLEX64=8]="DT_COMPLEX64",aR[aR.DT_INT64=9]="DT_INT64",aR[aR.DT_BOOL=10]="DT_BOOL",aR[aR.DT_QINT8=11]="DT_QINT8",aR[aR.DT_QUINT8=12]="DT_QUINT8",aR[aR.DT_QINT32=13]="DT_QINT32",aR[aR.DT_BFLOAT16=14]="DT_BFLOAT16",aR[aR.DT_FLOAT_REF=101]="DT_FLOAT_REF",aR[aR.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",aR[aR.DT_INT32_REF=103]="DT_INT32_REF",aR[aR.DT_UINT8_REF=104]="DT_UINT8_REF",aR[aR.DT_INT16_REF=105]="DT_INT16_REF",aR[aR.DT_INT8_REF=106]="DT_INT8_REF",aR[aR.DT_STRING_REF=107]="DT_STRING_REF",aR[aR.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",aR[aR.DT_INT64_REF=109]="DT_INT64_REF",aR[aR.DT_BOOL_REF=110]="DT_BOOL_REF",aR[aR.DT_QINT8_REF=111]="DT_QINT8_REF",aR[aR.DT_QUINT8_REF=112]="DT_QUINT8_REF",aR[aR.DT_QINT32_REF=113]="DT_QINT32_REF",aR[aR.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(sR||(sR={}));var gR=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),yR=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),vR=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),bR=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),wR=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]}]}),xR=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),_R=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),CR=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),SR=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),ER=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),kR=Object.freeze({json:[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),NR=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),IR=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),TR=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),AR=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),RR=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),OR=function(){function t(){var t=[].concat.apply([],[gR,yR,vR,bR,wR,xR,_R,ER,SR,CR,kR,NR,IR,TR,AR,RR].map(function(t){return t.json}));this.opMappers=t.reduce(function(t,e){return t[e.tfOpName]=e,t},{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(t){var e=this,n=[],r=[],i=t.node.reduce(function(t,i){return t[i.name]=e.mapNode(i),"Placeholder"===i.op&&n.push(t[i.name]),"Const"===i.op&&r.push(t[i.name]),t},{}),o=[],s=[],a=Object.keys(i);return a.forEach(function(t){var e=i[t];e.inputNames.forEach(function(t){var n=pR(t)[0];e.inputs.push(i[n]),i[n].children.push(e)}),0===e.inputs.length&&o.push(e)}),a.forEach(function(t){var e=i[t];0===e.children.length&&s.push(e)}),{nodes:i,inputs:o,outputs:s,weights:r,placeholders:n}},t.prototype.mapNode=function(t){var e=lR(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(function(t){return t.startsWith("^")?t.substr(1):t}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce(function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t},{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce(function(e,n){var r=n.type,i=void 0;switch(n.type){case"string":void 0===(i=PR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=PR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(i=WR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=WR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(i=MR(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(i=MR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(i=jR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=jR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(i=FR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=FR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(i=qR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=qR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(i=VR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=VR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(i=HR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=HR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(i=zR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=zR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(i=BR(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=BR(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+t.op)}return e[n.name]={value:i,type:r},e},{})),n},t}();function DR(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var e=Fv.global;if(void 0!==e.atob)return e.atob(t);if("undefined"!=typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function PR(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return null!=i?DR(i.s,r):n}function FR(t,e,n){var r=t[e];return r?r.b:n}function MR(t,e,n){var r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function LR(t){switch("string"==typeof t&&(t=oR[t]),t){case oR.DT_FLOAT:return"float32";case oR.DT_INT32:return"int32";case oR.DT_BOOL:return"bool";case oR.DT_DOUBLE:return"float32";case oR.DT_STRING:return"string";default:return null}}function zR(t,e,n){var r=t[e];return r&&r.type?LR(r.type):n}function BR(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map(function(t){return LR(t)}):n}function UR(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)}):[]}function VR(t,e,n){var r=t[e];return r&&r.shape?UR(r.shape):n}function jR(t,e,n){var r=t[e];return r?(r.list.f&&r.list.f.length?r.list.f:r.list.i).map(function(t){return"number"==typeof t?t:parseInt(t,10)}):n}function WR(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return i&&i.list&&i.list.s?i.list.s.map(function(t){return DR(t,r)}):n}function HR(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(function(t){return UR(t)}):n}function qR(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var $R=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(t){return r.getInput(t)}),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(t,e){return t[e]=r.getAttr(e),t},{}))}return t.prototype.getInput=function(t){return hR(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return hR(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return MR(this.node.rawAttrs,t,e);if(null!=n.s)return PR(this.node.rawAttrs,t,e);if(null!=n.b)return FR(this.node.rawAttrs,t,e);if(null!=n.shape)return VR(this.node.rawAttrs,t,e);if(null!=n.type)return zR(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return jR(this.node.rawAttrs,t,e);if(null!=n.list.s)return WR(this.node.rawAttrs,t,e);if(null!=n.list.shape)return HR(this.node.rawAttrs,t,e);if(null!=n.list.b)return qR(this.node.rawAttrs,t,e);if(null!=n.list.type)return BR(this.node.rawAttrs,t,e)}return e},t}(),GR=function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[eI(cR("a",t,e,n),cR("b",t,e,n))];case"AddN":return[nI(cR("tensors",t,e,n))];case"FloorMod":case"Mod":return[pI(cR("a",t,e,n),cR("b",t,e,n))];case"Mul":return[fI(cR("a",t,e,n),cR("b",t,e,n))];case"RealDiv":case"Div":return[oI(cR("a",t,e,n),cR("b",t,e,n))];case"FloorDiv":return[aI(cR("a",t,e,n),cR("b",t,e,n))];case"Sub":return[wI(cR("a",t,e,n),cR("b",t,e,n))];case"Minimum":return[cI(cR("a",t,e,n),cR("b",t,e,n))];case"Maximum":return[uI(cR("a",t,e,n),cR("b",t,e,n))];case"Pow":return[gI(cR("a",t,e,n),cR("b",t,e,n))];case"SquaredDifference":return[vI(cR("a",t,e,n),cR("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},KR=function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[uk(cR("x",t,e,n))];case"Acos":return[lk(cR("x",t,e,n))];case"Acosh":return[ck(cR("x",t,e,n))];case"Asin":return[hk(cR("x",t,e,n))];case"Asinh":return[pk(cR("x",t,e,n))];case"Atan":return[dk(cR("x",t,e,n))];case"Atan2":return[iI(cR("x",t,e,n),cR("y",t,e,n))];case"Atanh":return[fk(cR("x",t,e,n))];case"Ceil":return[mk(cR("x",t,e,n))];case"Complex":return[zx(cR("real",t,e,n),cR("imag",t,e,n))];case"Cos":return[yk(cR("x",t,e,n))];case"Cosh":return[vk(cR("x",t,e,n))];case"Elu":return[II(cR("x",t,e,n))];case"Erf":return[bk(cR("x",t,e,n))];case"Exp":return[wk(cR("x",t,e,n))];case"Expm1":return[xk(cR("x",t,e,n))];case"Floor":return[_k(cR("x",t,e,n))];case"Log":return[Ck(cR("x",t,e,n))];case"Log1p":return[Sk(cR("x",t,e,n))];case"Neg":return[kk(cR("x",t,e,n))];case"Reciprocal":return[Nk(cR("x",t,e,n))];case"Relu":return[RI(cR("x",t,e,n))];case"Round":return[Ik(cR("x",t,e,n))];case"Selu":return[OI(cR("x",t,e,n))];case"Sigmoid":return[Ak(cR("x",t,e,n))];case"Sin":return[Fk(cR("x",t,e,n))];case"Sign":return[Rk(cR("x",t,e,n))];case"Sinh":return[Mk(cR("x",t,e,n))];case"Softplus":return[Lk(cR("x",t,e,n))];case"Sqrt":return[zk(cR("x",t,e,n))];case"Square":return[Bk(cR("x",t,e,n))];case"Tanh":return[jk(cR("x",t,e,n))];case"Tan":return[Vk(cR("x",t,e,n))];case"Relu6":case"ClipByValue":return[gk(cR("x",t,e,n),cR("clipValueMin",t,e,n),cR("clipValueMax",t,e,n))];case"Rsqrt":return[Tk(hR(t.inputNames[0],e,n))];case"Prod":return[jN(cR("x",t,e,n),cR("axes",t,e,n))];case"LeakyRelu":return[TI(cR("x",t,e,n),cR("alpha",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},XR=function(){function t(e,n,r,i,o,s,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=o,this.dynamicSize=s,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map(function(t){return e.read(t)})},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+",\n          because the value dtype is "+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach(function(t,r){return n.write(t,e[r])})},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return Vx([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),j_(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(0===this.size())return Vx([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),r_(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,q_(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var r=0,i=t.map(function(t){return r+=t});if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=0===r?0:e.size/r,s=[];lx(function(){e=e.reshape([1,r,o]);for(var a=0;a<t.length;++a)s[a]=kN(e,[0,0===a?0:i[a-1],0],[1,t[a],o]).reshape(n.elementShape);return s});for(var a=[],u=0;u<t.length;u++)a[u]=u;this.writeMany(a,s)},t.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){void 0===n&&(n=""),Nb.assert(this.shapesEqualAllowUndefinedSize(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})},t.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0},t.nextId=0,t}(),QR=function(t,e,n){switch(t.op){case"Conv1D":var r=cR("stride",t,e,n),i=cR("pad",t,e,n),o=cR("dataFormat",t,e,n).toUpperCase(),s=cR("dilation",t,e,n);return[sN(cR("x",t,e,n),cR("filter",t,e,n),r,i,o,s)];case"Conv2D":r=cR("strides",t,e,n),i=cR("pad",t,e,n),o=cR("dataFormat",t,e,n).toUpperCase();var a=cR("dilations",t,e,n);return[aN(cR("x",t,e,n),cR("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])];case"Conv2DBackpropInput":case"Conv2dTranspose":var u=cR("outputShape",t,e,n);return r=cR("strides",t,e,n),i=cR("pad",t,e,n),[pN(cR("x",t,e,n),cR("filter",t,e,n),u,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=cR("strides",t,e,n),i=cR("pad",t,e,n),a=cR("dilations",t,e,n),o=cR("dataFormat",t,e,n).toUpperCase(),[cN(cR("input",t,e,n),cR("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])];case"AvgPool":r=cR("strides",t,e,n),i=cR("pad",t,e,n);var l=cR("kernelSize",t,e,n);return[SN(cR("x",t,e,n),[l[1],l[2]],[r[1],r[2]],i)];case"MaxPool":return r=cR("strides",t,e,n),i=cR("pad",t,e,n),l=cR("kernelSize",t,e,n),[CN(cR("x",t,e,n),[l[1],l[2]],[r[1],r[2]],i)];default:throw TypeError("Node type "+t.op+" is not implemented")}},ZR=function(t,e,n){switch(t.op){case"Fill":var r=cR("shape",t,e,n),i=cR("dtype",t,e,n);return[Yx(r,cR("value",t,e,n),i)];case"LinSpace":var o=cR("start",t,e,n);return[Jx(o,cR("stop",t,e,n),cR("num",t,e,n))];case"OneHot":var s=cR("indices",t,e,n),a=cR("depth",t,e,n),u=cR("onValue",t,e,n),l=cR("offValue",t,e,n);return[A_(s,a,u,l)];case"Ones":return[Qx(cR("shape",t,e,n),cR("dtype",t,e,n))];case"OnesLike":return[e_(cR("x",t,e,n))];case"RandomUniform":return[z_(cR("shape",t,e,n),cR("minval",t,e,n),cR("maxval",t,e,n),cR("dtype",t,e,n))];case"Range":return[t_(o=cR("start",t,e,n),cR("stop",t,e,n),cR("step",t,e,n),cR("dtype",t,e,n))];case"TruncatedNormal":r=cR("shape",t,e,n);var c=cR("mean",t,e,n),h=cR("stdDev",t,e,n),p=cR("seed",t,e,n);return[H_(r,c,h,cR("dtype",t,e,n),p)];case"Zeros":return[Zx(cR("shape",t,e,n),cR("dtype",t,e,n))];case"ZerosLike":return[n_(cR("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},YR=function(t,e,n){switch(t.op){case"TopKV2":var r=cR("x",t,e,n),i=cR("k",t,e,n),o=cR("sorted",t,e,n),s=HI(r,i,o);return[s.values,s.indices];default:throw TypeError("Node type "+t.op+" is not implemented")}},JR=function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=cR("default",t,e,n);return[hR(t.name,e,n)||r];case"Placeholder":return[hR(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[cR("x",t,e,n).clone()];case"IdentityN":return cR("x",t,e,n).map(function(t){return t.clone()});case"Snapshot":return[cR("x",t,e,n).clone()];case"Shape":return[Hx(cR("x",t,e,n).shape,"int32")];case"ShapeN":return cR("x",t,e,n).map(function(t){return Hx(t.shape)});case"Size":return[Wx(cR("x",t,e,n).size,"int32")];case"Rank":return[Wx(cR("x",t,e,n).rank,"int32")];case"NoOp":return[];case"Print":var i=cR("x",t,e,n),o=cR("data",t,e,n),s=cR("message",t,e,n),a=cR("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,a));return[i];default:throw TypeError("Node type "+t.op+" is not implemented")}},tO=function(t,e,n){switch(t.op){case"ResizeBilinear":var r=cR("images",t,e,n),i=cR("size",t,e,n),o=cR("alignCorners",t,e,n);return[ET.resizeBilinear(r,[i[0],i[1]],o)];case"ResizeNearestNeighbor":return r=cR("images",t,e,n),i=cR("size",t,e,n),o=cR("alignCorners",t,e,n),[ET.resizeNearestNeighbor(r,[i[0],i[1]],o)];case"CropAndResize":var s=cR("image",t,e,n),a=cR("boxes",t,e,n),u=cR("boxInd",t,e,n),l=cR("cropSize",t,e,n),c=cR("method",t,e,n),h=cR("extrapolationValue",t,e,n);return[ET.cropAndResize(s,a,u,l,c,h)];default:throw TypeError("Node type "+t.op+" is not implemented")}},eO=function(t,e,n){switch(t.op){case"Equal":return[WN(cR("a",t,e,n),cR("b",t,e,n))];case"NotEqual":return[JN(cR("a",t,e,n),cR("b",t,e,n))];case"Greater":return[qN(cR("a",t,e,n),cR("b",t,e,n))];case"GreaterEqual":return[$N(cR("a",t,e,n),cR("b",t,e,n))];case"Less":return[XN(cR("a",t,e,n),cR("b",t,e,n))];case"LessEqual":return[QN(cR("a",t,e,n),cR("b",t,e,n))];case"LogicalAnd":return[_I(cR("a",t,e,n),cR("b",t,e,n))];case"LogicalNot":return[CI(cR("a",t,e,n))];case"LogicalOr":return[SI(cR("a",t,e,n),cR("b",t,e,n))];case"Select":return[kI(cR("condition",t,e,n),cR("a",t,e,n),cR("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},nO=function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[dN(cR("a",t,e,n),cR("b",t,e,n),cR("transposeA",t,e,n),cR("transposeB",t,e,n))];case"Transpose":return[DI(cR("x",t,e,n),cR("perm",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},rO=function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Jk(cR("x",t,e,n),cR("mean",t,e,n),cR("variance",t,e,n),cR("offset",t,e,n),cR("scale",t,e,n),cR("epsilon",t,e,n))];case"LRN":return[PI(cR("x",t,e,n),cR("radius",t,e,n),cR("bias",t,e,n),cR("alpha",t,e,n),cR("beta",t,e,n))];case"Softmax":return[fC(cR("x",t,e,n))];case"LogSoftmax":return[mC(cR("x",t,e,n))];case"SparseToDense":return[ZI(cR("sparseIndices",t,e,n),cR("outputShape",t,e,n),cR("sparseValues",t,e,n),cR("defaultValue",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},iO=function(t,e,n){switch(t.op){case"Max":var r=cR("axis",t,e,n),i=cR("keepDims",t,e,n);return[LN(cR("x",t,e,n),r,i)];case"Mean":return r=cR("axis",t,e,n),i=cR("keepDims",t,e,n),[zN(cR("x",t,e,n),r,i)];case"Min":return r=cR("axis",t,e,n),i=cR("keepDims",t,e,n),[BN(cR("x",t,e,n),r,i)];case"Sum":return r=cR("axis",t,e,n),i=cR("keepDims",t,e,n),[VN(cR("x",t,e,n),r,i)];case"All":return r=cR("axis",t,e,n),i=cR("keepDims",t,e,n),[ON(cR("x",t,e,n),r,i)];case"Any":return r=cR("axis",t,e,n),i=cR("keepDims",t,e,n),[DN(cR("x",t,e,n),r,i)];case"ArgMax":return r=cR("axis",t,e,n),[PN(cR("x",t,e,n),r)];case"ArgMin":return r=cR("axis",t,e,n),[FN(cR("x",t,e,n),r)];case"Prod":return r=cR("axis",t,e,n),i=cR("keepDims",t,e,n),[jN(cR("x",t,e,n),r,i)];default:throw TypeError("Node type "+t.op+" is not implemented")}},oO=function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=cR("axis",t,e,n),i=cR("tensors",t,e,n);return[r_(i,r)];case"GatherV2":case"Gather":r=cR("axis",t,e,n);var o=cR("x",t,e,n),s=cR("indices",t,e,n);return[zI(o,s.asType("int32"),r)];case"ReverseV2":case"Reverse":return r=cR("axis",t,e,n),o=cR("x",t,e,n),[gN(o,r)];case"Slice":var a=cR("begin",t,e,n),u=cR("size",t,e,n);return[kN(cR("x",t,e,n),a,u)];case"StridedSlice":a=cR("begin",t,e,n);var l=cR("end",t,e,n),c=cR("strides",t,e,n),h=cR("beginMask",t,e,n),p=cR("endMask",t,e,n),d=cR("ellipsisMask",t,e,n),f=cR("newAxisMask",t,e,n),m=cR("shrinkAxisMask",t,e,n),g=cR("x",t,e,n);if(1===a.length&&g.shape.length>1)for(var y=1;y<g.shape.length;y++)a.push(0),l.push(g.shape[y]),c.push(c[0]);return[WI(g,a,l,c,h,p,d,f,m)];case"Pack":return lx(function(){var r=cR("axis",t,e,n),i=cR("tensors",t,e,n),o=i[0].shape,s=i[0].squeeze().shape,a=i.map(function(t){var e=Nb.arraysEqual(t.shape,o);if(!e&&!Nb.arraysEqual(t.squeeze().shape,s))throw new Error("the input tensors shape does not match");return e?t:t.reshape(o)});return[j_(a,r)]});case"Unpack":return lx(function(){var r=cR("axis",t,e,n),i=cR("tensor",t,e,n);return q_(i,r)});case"Tile":var v=cR("reps",t,e,n);return[W_(cR("x",t,e,n),v)];case"Split":case"SplitV":r=cR("axis",t,e,n);var b=cR("numOrSizeSplits",t,e,n);return u_(cR("x",t,e,n),b,r);case"ScatterNd":s=cR("indices",t,e,n);var w=cR("values",t,e,n),x=cR("shape",t,e,n);return[qI(s,w,x)];case"GatherNd":var _=cR("x",t,e,n);return s=cR("indices",t,e,n),[YI(_,s)];case"SparseToDense":s=cR("sparseIndices",t,e,n),x=cR("outputShape",t,e,n);var C=cR("sparseValues",t,e,n),S=cR("defaultValue",t,e,n);return[ZI(s,C,x,C.dtype===S.dtype?S:S.asType(C.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}},sO=function(t,e,n){switch(t.op){case"FFT":return[$I(cR("x",t,e,n))];case"IFFT":return[GI(cR("x",t,e,n))];case"RFFT":return[KI(cR("x",t,e,n))];case"IRFFT":return[XI(cR("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},aO=function(t,e,n){switch(t.op){case"Cast":return[C_(cR("x",t,e,n),cR("dtype",t,e,n))];case"ExpandDims":var r=cR("axis",t,e,n);return[N_(cR("x",t,e,n),r)];case"Squeeze":return r=cR("axis",t,e,n),[V_(cR("x",t,e,n),r)];case"Reshape":return[B_(cR("x",t,e,n),cR("shape",t,e,n))];case"PadV2":case"Pad":return[R_(cR("x",t,e,n),mR(cR("padding",t,e,n),2),cR("constantValue",t,e,n))];case"SpaceToBatchND":var i=cR("blockShape",t,e,n),o=mR(cR("paddings",t,e,n),2);return[U_(cR("x",t,e,n),i,o)];case"BatchToSpaceND":i=cR("blockShape",t,e,n);var s=mR(cR("crops",t,e,n),2);return[__(cR("x",t,e,n),i,s)];case"DepthToSpace":var a=cR("blockSize",t,e,n),u=cR("dataFormat",t,e,n).toUpperCase();return[k_(cR("x",t,e,n),a,u)];default:throw TypeError("Node type "+t.op+" is not implemented")}};function uO(t,e,n){var r=function(t,e,n){switch(t.category){case"arithmetic":return GR(t,e,n);case"basic_math":return KR(t,e,n);case"control":return function(t,e,n){return rR(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_,C,S,E,k,N,I,T,A,R,O,D,P,F,M;return iR(this,function(L){switch(L.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[cR("pred",t,e,n).clone()]];case 2:return r=cR("pred",t,e,n),i=cR("data",t,e,n),[4,r.data()];case 3:return[2,L.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(o=t.inputNames.find(function(t){return void 0!==hR(t,e,n)}))?[hR(o,e,n).clone()]:void 0];case 5:return s=cR("frameName",t,e,n),a=cR("tensor",t,e,n),n.enterFrame(s),[2,[a.clone()]];case 6:return u=cR("tensor",t,e,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=cR("tensor",t,e,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=cR("size",t,e,n),h=cR("dtype",t,e,n),p=cR("elementShape",t,e,n),d=cR("dynamicSize",t,e,n),f=cR("clearAfterRead",t,e,n),m=cR("identicalElementShapes",t,e,n),g=cR("name",t,e,n),y=new XR(g,h,c,p,m,d,f),n.addTensorArray(y),[2,[Wx(y.id),Wx(1)]];case 9:return v=cR("tensorArrayId",t,e,n),b=cR("index",t,e,n),w=cR("tensor",t,e,n),n.getTensorArray(v).write(b,w),[2,[Wx(1)]];case 10:return x=cR("tensorArrayId",t,e,n),_=cR("index",t,e,n),[2,[n.getTensorArray(x).read(_)]];case 11:return C=cR("tensorArrayId",t,e,n),S=cR("indices",t,e,n),E=cR("dtype",t,e,n),[2,[n.getTensorArray(C).gather(S,E)]];case 12:return k=cR("tensorArrayId",t,e,n),N=cR("indices",t,e,n),I=cR("tensor",t,e,n),n.getTensorArray(k).scatter(N,I),[2,[Wx(1)]];case 13:return T=cR("tensorArrayId",t,e,n),A=n.getTensorArray(T),R=cR("dtype",t,e,n),[2,[A.concat(R)]];case 14:return O=cR("tensorArrayId",t,e,n),D=cR("tensor",t,e,n),P=cR("lengths",t,e,n),n.getTensorArray(O).split(P,D),[2,[Wx(1)]];case 15:return F=cR("tensorArrayId",t,e,n),[2,[Wx(n.getTensorArray(F).size(),"int32")]];case 16:return M=cR("tensorArrayId",t,e,n),n.getTensorArray(M).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}})})}(t,e,n);case"convolution":return QR(t,e,n);case"creation":return ZR(t,e,n);case"dynamic":return function(t,e,n){return rR(this,void 0,void 0,function(){var r,i,o,s,a;return iR(this,function(u){switch(u.label){case 0:switch(t.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,7];case 1:return r=cR("boxes",t,e,n),i=cR("scores",t,e,n),o=cR("maxOutputSize",t,e,n),s=cR("iouThreshold",t,e,n),a=cR("scoreThreshold",t,e,n),[4,ET.nonMaxSuppressionAsync(r,i,o,s,a)];case 2:return[2,[u.sent()]];case 3:return[4,NI(cR("condition",t,e,n))];case 4:return[2,[u.sent()]];case 5:return[4,$_(cR("x",t,e,n),cR("y",t,e,n))];case 6:return[2,u.sent()];case 7:throw TypeError("Node type "+t.op+" is not implemented")}})})}(t,e,n);case"evaluation":return YR(t,e,n);case"image":return tO(t,e,n);case"graph":return JR(t,e,n);case"logical":return eO(t,e,n);case"matrices":return nO(t,e,n);case"normalization":return rO(t,e,n);case"reduction":return iO(t,e,n);case"slice_join":return oO(t,e,n);case"spectral":return sO(t,e,n);case"transformation":return aO(t,e,n);case"custom":var r=lR(t.op);if(r&&r.customExecutor)return r.customExecutor(new $R(t,e,n));throw TypeError("Custom op "+t.op+" is not registered.");default:throw TypeError("Unknown op '"+t.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return r instanceof Promise?r.then(function(t){return[].concat(t)}):[].concat(r)}var lO=function(){function t(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map(function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId}).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t}();function cO(t,e,n){for(var r=new Set,i=[],o=null,s=null,a=new Set,u=e.slice();u.length>0;){var l=u.pop();(dO(l)||fO(l))&&null==o&&(s=(o=l).children.map(function(t){return t.name}).filter(function(t){return r.has(t)})),r.add(l.name),null==n[l.name]&&null==t[l.name]&&(0!==l.inputs.length?l.inputs.forEach(function(t){a.has(t.name)||(a.add(t.name),u.push(t))}):i.push(l.name))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:s}}var hO=["Switch","Merge","Enter","Exit","NextIteration"],pO=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function dO(t){return hO.indexOf(t.op)>=0}function fO(t){return pO.indexOf(t.op)>=0}var mO=function(){function t(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=t.placeholders,this._outputs=t.outputs}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map(function(e){return t[e].map(function(t){return t.id})});this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.placeholders.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(t){return t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.outputs.map(function(t){return t.name})},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map(function(t){return t.name}).sort(),r=e.map(function(t){return t.name}).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},t.prototype.compile=function(t,e){var n=cO(t,e,this.weightMap),r=n.missingInputs,i=n.dynamicNode;if(null!=i)throw new Error("This execution contains the node '"+i.name+"', which has the dynamic op '"+i.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+n.syncInputs+"]");if(r.length>0){var o=e.map(function(t){return t.name}),s=Object.keys(t);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+s+"]. Missing the following inputs: ["+r+"]")}return function(t,e,n){var r=n.usedNodes,i=[];Object.keys(n.inputs).map(function(e){return t.nodes[e]}).forEach(function(t){r.has(t.name)&&i.push(t)}),t.weights.forEach(function(t){r.has(t.name)&&i.push(t)});for(var o=new Set,s=[];i.length>0;){var a=i.pop();o.add(a.name),e[a.name]||s.push(a),a.children.forEach(function(t){!o.has(t.name)&&r.has(t.name)&&t.inputs.every(function(t){return o.has(t.name)})&&i.push(t)})}return s}(this.graph,this.weightMap,n)},t.prototype.fusePrelu=function(){!function(t,e){var n=function(n){var r=t.nodes[n];if(null==r||"Add"!==r.op&&"AddV2"!==r.op||2!==r.inputNames.length)return"continue";var i=r.inputs.find(function(t){return"Relu"===t.op});if(null==i||1!==i.inputNames.length)return"continue";var o=r.inputs.find(function(t){return"Mul"===t.op});if(null==o||2!==o.inputNames.length)return"continue";var s=o.inputs.find(function(t){return"Const"===t.op}),a=o.inputs.find(function(t){return"Relu"===t.op});if(null==s||null==a||1!==a.inputNames.length)return"continue";var u=a.inputs[0];if(null==u||"Neg"!==u.op||1!==u.inputNames.length)return"continue";if(i.inputNames[0]!==u.inputNames[0])return"continue";var l=i.inputs[0],c=r.children,h=s.name+"_neg",p={name:h,inputNames:[],inputs:[],attrParams:{},category:"graph",children:[],op:"Const",inputParams:{},rawAttrs:{}};e[h]=[kk(e[s.name][0])],t.weights.push(p);var d={name:r.name+"_Prelu",inputNames:[l.name,p.name],inputs:[l,p],attrParams:{},category:"custom",children:c,op:"Prelu",inputParams:{x:{inputIndexStart:0,type:"tensor"},alpha:{inputIndexStart:1,type:"tensor"}}};p.children.push(d);var f=s.children.indexOf(o);f>-1&&s.children.splice(f,1);var m=l.children.indexOf(i);m>-1&&l.children.splice(m,1);var g=l.children.indexOf(u);if(g>-1&&l.children.splice(g,1),l.children.push(d),c.forEach(function(t){var e=t.inputNames.indexOf(r.name);e>-1&&(t.inputNames[e]=d.name,t.inputs[e]=d)}),0===c.length){var y=t.outputs.indexOf(r);y>-1&&t.outputs.splice(y,1),t.outputs.push(d)}delete t.nodes[r.name],delete t.nodes[o.name],delete t.nodes[i.name],delete t.nodes[a.name],delete t.nodes[u.name],t.nodes[d.name]=d,t.nodes[p.name]=p};for(var r in t.nodes)n(r)}(this.graph,this.weightMap)},t.prototype.execute=function(t,e){var n=this,r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e);var i=r.map(function(t){return n.graph.nodes[t]}),o=e.map(function(t){return n.graph.nodes[fR(t)[0]]}),s=this.getCompilationKey(i,o),a=this.compiledMap.get(s);null==a&&(a=this.compile(t,o),this.compiledMap.set(s,a));var u={};return lx(function(){var r=new lO(n._weightMap,u),i=nR({},n.weightMap);Object.keys(t).forEach(function(e){i[e]=[t[e]]});for(var o=n.getFrozenTensorIds(i),s={},l=0;l<a.length;l++){var c=a[l];if(!i[c.name]){var h=uO(c,i,r);if(h instanceof Promise)throw new Error("The execution of the op '"+c.op+"' returned a promise. Please use model.executeAsync() instead.");i[c.name]=h,n.checkTensorForDisposal(c.name,c,i,r,o,e,s)}}return e.map(function(t){return hR(t,i,r)})})},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map(function(e){return t[e]}).map(function(t){return t.map(function(t){return t.id})}));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,i,o,s){"control"!==e.category&&-1===o.indexOf(t)&&(n[t].forEach(function(t){null!=t&&(s[t.id]=(s[t.id]||0)+e.children.length)}),e.inputs.forEach(function(t){if("control"!==t.category){var e=function(t,e,n){return e[dR(t,r.currentContextId)]}(t.name,n);null!=e&&e.forEach(function(t){if(t&&!i.has(t.id)){var e=s[t.id];1===e?(t.dispose(),delete s[t.id]):null!=e&&s[t.id]--}})}}))},t.prototype.executeAsync=function(t,e){return rR(this,void 0,void 0,function(){var n,r,i,o,s,a=this;return iR(this,function(u){switch(u.label){case 0:return this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e),n=new lO(this._weightMap,{}),[4,this.executeWithControlFlow(t,n,e)];case 1:return r=u.sent(),i=e.map(function(t){return hR(t,r,n)}),o=new Set(i.map(function(t){return t.id})),s=new Set(Object.keys(t).map(function(e){return t[e].id})),Object.keys(r).forEach(function(t){r[t].forEach(function(t){!t||t.isDisposed||o.has(t.id)||s.has(t.id)||-1!==a.weightIds.indexOf(t.id)||t.dispose()})}),[2,i]}})})},t.prototype.executeWithControlFlow=function(t,e,n){return rR(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,h,p,d,f,m,g,y,v,b=this;return iR(this,function(w){switch(w.label){case 0:r=Object.keys(t),i=r.map(function(t){return b.graph.nodes[t]}),o=n.map(function(t){return b.graph.nodes[fR(t)[0]]}),s=cO(t,o,this.weightMap),a=s.usedNodes,u=s.missingInputs,l=s.dynamicNode,c=s.syncInputs,h=i.concat(this.graph.weights).map(function(t){return{node:t,contexts:e.currentContext}}),p=nR({},this.weightMap),Object.keys(t).forEach(function(e){p[e]=[t[e]]}),d={},f=this.getFrozenTensorIds(p),m={},w.label=1;case 1:return h.length>0?(g=this.processStack(i,h,e,p,m,f,n,d,a),[4,Promise.all(g)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(null==l&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=o.filter(function(t){return!dO(t)&&!hR(t.name,p,e)}).map(function(t){return t.name})).length>0)throw v="",null!=l&&(v="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+c+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+u+"]. "+v);return[2,p]}})})},t.prototype.processStack=function(t,e,n,r,i,o,s,a,u){for(var l=this,c=[],h=function(){var h=e.pop();n.currentContext=h.contexts;var d="";if("Enter"===h.node.op&&cR("isConstant",h.node,r,n)&&(d=pR(h.node.name,n)[0]),-1===t.indexOf(h.node)){var f=uO(h.node,r,n);d||(d=pR(h.node.name,n)[0]);var m=n.currentContext;f instanceof Promise?c.push(f.then(function(t){return r[d]=t,n.currentContext=m,l.checkTensorForDisposal(d,h.node,r,n,o,s,a),l.processChildNodes(h.node,e,n,r,i,u),t})):(r[d]=f,p.checkTensorForDisposal(d,h.node,r,n,o,s,a),p.processChildNodes(h.node,e,n,r,i,u))}else p.processChildNodes(h.node,e,n,r,i,u)},p=this;e.length>0;)h();return c},t.prototype.processChildNodes=function(t,e,n,r,i,o){t.children.forEach(function(t){var s=pR(t.name,n)[0];!i[s]&&o.has(t.name)&&("Merge"===t.op?t.inputNames.some(function(t){return!!hR(t,r,n)})&&(i[s]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every(function(t){return!!hR(t,r,n)})&&(i[s]=!0,e.push({contexts:n.currentContext,node:t})))})},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(e){return t.weightMap[e].forEach(function(t){return t.dispose()})})},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach(function(n){var r=t[n],i=e.graph.nodes[n];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every(function(t,e){return-1===o[e]||o[e]===t});Nb.assert(s,function(){return"The shape of dict['"+i.name+"'] provided in model.execute(dict) must be ["+o+"], but was ["+r.shape+"]"})}i.attrParams.dtype&&i.attrParams.dtype.value&&Nb.assert(r.dtype===i.attrParams.dtype.value,function(){return"The dtype of dict['"+i.name+"'] provided in model.execute(dict) must be "+i.attrParams.dtype.value+", but was "+r.dtype})})},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter(function(t){return!e.graph.nodes[t]});if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},t.prototype.checkOutputs=function(t){var e=this;t.forEach(function(t){var n=fR(t)[0];if(!e.graph.nodes[n])throw new Error("The output '"+t+"' is not found in the graph")})},t}(),gO="?tfjs-format=file",yO="model.json",vO=function(){function t(t,e){void 0===e&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.fusePrelu=function(){this.executor.fusePrelu(),null==lR("Prelu")&&function(t,e){uR[t]={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:function(t){return AI(t.inputs[0],t.inputs[1])}}}("Prelu")},t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=NA.browserHTTPRequest(t,this.loadOptions);else{var e=NA.getLoadHandlers(t,this.loadOptions.onProgress);if(0===e.length)e.push(NA.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},t.prototype.load=function(){return rR(this,void 0,void 0,function(){var t,e,n;return iR(this,function(r){switch(r.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return t=r.sent(),this.version=(e=t.modelTopology).versions.producer+"."+e.versions.minConsumer,n=NA.decodeWeights(t.weightData,t.weightSpecs),this.executor=new mO(OR.Instance.transformGraph(e)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),[2,!0]}})})},t.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},t.prototype.normalizeInputs=function(t){if(!(t instanceof zb||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(e,n,r){return e[n]=t[r],e},{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return rR(this,void 0,void 0,function(){var n;return iR(this,function(r){switch(r.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}})})},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(e,n){return e[n]=[t[n]],e},{})},t.prototype.dispose=function(){this.executor.dispose()},t}();function bO(t,e){return void 0===e&&(e={}),rR(this,void 0,void 0,function(){var n;return iR(this,function(r){switch(r.label){case 0:if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t=""+t+yO+gO),[4,(n=new vO(t,e)).load()];case 1:return r.sent(),[2,n]}})})}function wO(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})}function xO(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var _O={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},CO={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},SO={"1.00":{.25:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1","0.50":"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",.75:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1","1.00":"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1"},"2.00":{"0.50":"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",.75:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2","1.00":"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2"}};function EO(t){return void 0===t&&(t={version:1,alpha:1}),wO(this,void 0,void 0,function(){var e,n,i;return xO(this,function(o){switch(o.label){case 0:if(null==r)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(e=t.version.toFixed(2),n=t.alpha?t.alpha.toFixed(2):"",null==t.modelUrl){if(!(e in SO))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(SO));if(!(n in SO[e]))throw new Error("MobileNet constructed with invalid alpha "+t.alpha+". Valid multipliers for this version are: "+Object.keys(SO[e])+".")}return[4,(i=new kO(e,n,t.modelUrl)).load()];case 1:return o.sent(),[2,i]}})})}var kO=function(){function t(t,e,n){this.version=t,this.alpha=e,this.modelUrl=n,this.normalizationOffset=Wx(127.5)}return t.prototype.load=function(){return wO(this,void 0,void 0,function(){var t,e,n,r=this;return xO(this,function(i){switch(i.label){case 0:return this.modelUrl?(t=this,[4,bO(this.modelUrl)]):[3,2];case 1:return t.model=i.sent(),[3,4];case 2:return e=this,[4,bO(SO[this.version][this.alpha],{fromTFHub:!0})];case 3:e.model=i.sent(),i.label=4;case 4:return[4,(n=lx(function(){return r.model.predict(Zx([1,224,224,3]))})).data()];case 5:return i.sent(),n.dispose(),[2]}})})},t.prototype.infer=function(t,e){var n=this;return void 0===e&&(e=!1),lx(function(){t instanceof zb||(t=RA.fromPixels(t));var r=t.toFloat().sub(n.normalizationOffset).div(n.normalizationOffset),i=r;224===t.shape[0]&&224===t.shape[1]||(i=ET.resizeBilinear(r,[224,224],!0));var o=i.reshape([-1,224,224,3]);return e?n.model.execute(o,CO[n.version]).squeeze([1,2]):n.model.predict(o).slice([0,1],[-1,1e3])})},t.prototype.classify=function(t,e){return void 0===e&&(e=3),wO(this,void 0,void 0,function(){var n,r;return xO(this,function(i){switch(i.label){case 0:return[4,NO(n=this.infer(t),e)];case 1:return r=i.sent(),n.dispose(),[2,r]}})})},t}();function NO(t,e){return wO(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return xO(this,function(l){switch(l.label){case 0:return[4,(n=t.softmax()).data()];case 1:for(r=l.sent(),n.dispose(),i=[],u=0;u<r.length;u++)i.push({value:r[u],index:u});for(i.sort(function(t,e){return e.value-t.value}),o=new Float32Array(e),s=new Int32Array(e),u=0;u<e;u++)o[u]=i[u].value,s[u]=i[u].index;for(a=[],u=0;u<s.length;u++)a.push({className:_O[s[u]],probability:o[u]});return[2,a]}})})}class IO{constructor(t){this.errorService=t,this.predictions=[],this.subscriptions$=[]}ngOnInit(){this.subscriptions$.push(G(EO()).subscribe({next:t=>this.model=t,error:()=>this.errorService.displayError()}))}onFileSelected(t){const e=t.target.files[0];if(e){const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{this.imageSource=t.result,setTimeout(()=>{this.subscriptions$.push(G(this.model.classify(this.userImageRef.nativeElement)).subscribe({next:t=>this.predictions=t,error:()=>this.errorService.displayError()}))})}}}cleanup(){this.imageSource=void 0,this.predictions=[]}ngOnDestroy(){this.subscriptions$.forEach(t=>{t&&t.unsubscribe()})}}function TO(){throw Error("Host already has a portal attached")}class AO{attach(t){return null==t&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),t.hasAttached()&&TO(),this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null==t?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class RO extends AO{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class OO extends AO{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class DO{constructor(){this._isDisposed=!1}hasAttached(){return!!this._attachedPortal}attach(t){return t||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&TO(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),t instanceof RO?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof OO?(this._attachedPortal=t,this.attachTemplatePortal(t)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class PO extends DO{constructor(t,e,n,r){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r}attachComponentPortal(t){const e=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(e,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>n.destroy())):(n=e.create(t.injector||this._defaultInjector),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),n}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.detectChanges(),n.rootNodes.forEach(t=>this.outletElement.appendChild(t)),this.setDisposeFn(()=>{let t=e.indexOf(n);-1!==t&&e.remove(t)}),n}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let FO=(()=>(class extends DO{constructor(t,e){super(),this._componentFactoryResolver=t,this._viewContainerRef=e,this._isInitialized=!1,this.attached=new Di}get portal(){return this._attachedPortal}set portal(t){(!this.hasAttached()||t||this._isInitialized)&&(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const e=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),r=e.createComponent(n,e.length,t.injector||e.injector);return super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);const e=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=e,this.attached.emit(e),e}}))(),MO=(()=>(class{}))();class LO{constructor(t,e){this._parentInjector=t,this._customTokens=e}get(t,e){const n=this._customTokens.get(t);return void 0!==n?n:this._parentInjector.get(t,e)}}function zO(t,e,n,r){return i(n)&&(r=n,n=void 0),r?zO(t,e,n).pipe(W(t=>l(t)?r(...t):r(t))):new _(r=>{!function t(e,n,r,i,o){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(n,r,o),s=()=>t.removeEventListener(n,r,o)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(n,r),s=()=>t.off(n,r)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(n,r),s=()=>t.removeListener(n,r)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let s=0,a=e.length;s<a;s++)t(e[s],n,r,i,o)}i.add(s)}(t,e,function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},r,n)})}class BO{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new UO(t,this.durationSelector))}}class UO extends j{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let n;try{const{durationSelector:r}=this;n=r(t)}catch(e){return this.destination.error(e)}const r=V(this,n);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))}notifyNext(t,e,n,r){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function VO(t){return!l(t)&&t-parseFloat(t)+1>=0}function jO(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function WO(t,e=ad){return n=()=>(function(t=0,e,n){let r=-1;return VO(e)?r=Number(e)<1?1:Number(e):A(e)&&(n=e),A(n)||(n=ad),new _(e=>{const i=VO(t)?t:+t-n.now();return n.schedule(jO,i,{index:0,period:r,subscriber:e})})})(t,e),function(t){return t.lift(new BO(n))};var n}const HO=20;let qO=(()=>{class t{constructor(t,e){this._ngZone=t,this._platform=e,this._scrolled=new I,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=HO){return this._platform.isBrowser?new _(e=>{this._globalSubscription||this._addGlobalListener();const n=t>0?this._scrolled.pipe(WO(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ga()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(ru(t=>!t||n.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((n,r)=>{this._scrollableContainsElement(r,t)&&e.push(r)}),e}_scrollableContainsElement(t,e){let n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>zO(window.document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(ao),Ut(td))},token:t,providedIn:"root"}),t})(),$O=(()=>(class{}))();const GO=20;let KO=(()=>{class t{constructor(t,e){this._platform=t,e.runOutsideAngular(()=>{this._change=t.isBrowser?J(zO(window,"resize"),zO(window,"orientationchange")):Ga(),this._invalidateCache=this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){this._invalidateCache.unsubscribe()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+e,height:n,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=document.documentElement,e=t.getBoundingClientRect();return{top:-e.top||document.body.scrollTop||window.scrollY||t.scrollTop||0,left:-e.left||document.body.scrollLeft||window.scrollX||t.scrollLeft||0}}change(t=GO){return t>0?this._change.pipe(WO(t)):this._change}_updateViewportSize(){this._viewportSize=this._platform.isBrowser?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0}}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(td),Ut(ao))},token:t,providedIn:"root"}),t})();class XO{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Qp(-this._previousScrollPosition.left),t.style.top=Qp(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",i=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=i}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}function QO(){return Error("Scroll strategy has already been attached.")}class ZO{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){if(this._overlayRef)throw QO();this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class YO{enable(){}disable(){}attach(){}}function JO(t,e){return e.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function tD(t,e){return e.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class eD{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){if(this._overlayRef)throw QO();this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:n}=this._viewportRuler.getViewportSize();JO(t,[{width:e,height:n,bottom:n,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let nD=(()=>{class t{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this.noop=()=>new YO,this.close=t=>new ZO(this._scrollDispatcher,this._ngZone,this._viewportRuler,t),this.block=()=>new XO(this._viewportRuler,this._document),this.reposition=t=>new eD(this._scrollDispatcher,this._viewportRuler,this._ngZone,t),this._document=r}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(qO),Ut(KO),Ut(ao),Ut(Ua))},token:t,providedIn:"root"}),t})();class rD{constructor(t){if(this.scrollStrategy=new YO,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class iD{constructor(t,e,n,r,i){this.offsetX=n,this.offsetY=r,this.panelClass=i,this.originX=t.originX,this.originY=t.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}let oD=(()=>(class{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}))();function sD(t,e){if("top"!==e&&"bottom"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "top", "bottom" or "center".')}function aD(t,e){if("start"!==e&&"end"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". `+'Expected "start", "end" or "center".')}let uD=(()=>{class t{constructor(t){this._attachedOverlays=[],this._keydownListener=t=>{const e=this._attachedOverlays;for(let n=e.length-1;n>-1;n--)if(e[n]._keydownEventSubscriptions>0){e[n]._keydownEvents.next(t);break}},this._document=t}ngOnDestroy(){this._detach()}add(t){this.remove(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(t)}remove(t){const e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this._detach()}_detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(Ua))},token:t,providedIn:"root"}),t})(),lD=(()=>{class t{constructor(t){this._document=t}ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._document.getElementsByClassName("cdk-overlay-container");for(let n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);const e=this._document.createElement("div");e.classList.add("cdk-overlay-container"),this._document.body.appendChild(e),this._containerElement=e}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(Ua))},token:t,providedIn:"root"}),t})();class cD{constructor(t,e,n,r,i,o,s,a){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=i,this._keyboardDispatcher=o,this._document=s,this._location=a,this._backdropElement=null,this._backdropClick=new I,this._attachments=new I,this._detachments=new I,this._locationChanges=d.EMPTY,this._backdropClickHandler=t=>this._backdropClick.next(t),this._keydownEventsObservable=new _(t=>{const e=this._keydownEvents.subscribe(t);return this._keydownEventSubscriptions++,()=>{e.unsubscribe(),this._keydownEventSubscriptions--}}),this._keydownEvents=new I,this._keydownEventSubscriptions=0,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(_u(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick.asObservable()}attachments(){return this._attachments.asObservable()}detachments(){return this._detachments.asObservable()}keydownEvents(){return this._keydownEventsObservable}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign({},this._config,t),this._updateElementSize()}setDirection(t){this._config=Object.assign({},this._config,{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){const t=this._pane.style;t.width=Qp(this._config.width),t.height=Qp(this._config.height),t.minWidth=Qp(this._config.minWidth),t.minHeight=Qp(this._config.minHeight),t.maxWidth=Qp(this._config.maxWidth),t.maxHeight=Qp(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"auto":"none"}_attachBackdrop(){this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add("cdk-overlay-backdrop-showing")})}):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t,e=this._backdropElement;if(!e)return;let n=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",n),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",n)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(n,500))}_toggleClasses(t,e,n){const r=t.classList;Xp(e).forEach(t=>{n?r.add(t):r.remove(t)})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.asObservable().pipe(hv(J(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}}const hD="cdk-overlay-connected-position-bounding-box";class pD{constructor(t,e,n,r,i){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=i,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new I,this._resizeSubscription=d.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){if(this._overlayRef&&t!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),t.hostElement.classList.add(hD),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=[];let i;for(let o of this._preferredPositions){let s=this._getOriginPoint(t,o),a=this._getOverlayPoint(s,e,o),u=this._getOverlayFit(a,e,n,o);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(o,s);this._canFitWithFlexibleDimensions(u,a,n)?r.push({position:o,origin:s,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(s,o)}):(!i||i.overlayFit.visibleArea<u.visibleArea)&&(i={overlayFit:u,overlayPoint:a,originPoint:s,position:o,overlayRect:e})}if(r.length){let t=null,e=-1;for(const n of r){const r=n.boundingBoxRect.width*n.boundingBoxRect.height*(n.position.weight||1);r>e&&(e=r,t=n)}return this._isPushed=!1,void this._applyPosition(t.position,t.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(i.position,i.originPoint);this._applyPosition(i.position,i.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&dD(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(hD),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e){let n,r;if("center"==e.originX)n=t.left+t.width/2;else{const r=this._isRtl()?t.right:t.left,i=this._isRtl()?t.left:t.right;n="start"==e.originX?r:i}return{x:n,y:r="center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom}}_getOverlayPoint(t,e,n){let r,i;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,{x:t.x+r,y:t.y+(i="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height)}}_getOverlayFit(t,e,n,r){let{x:i,y:o}=t,s=this._getOffset(r,"x"),a=this._getOffset(r,"y");s&&(i+=s),a&&(o+=a);let u=0-o,l=o+e.height-n.height,c=this._subtractOverflows(e.width,0-i,i+e.width-n.width),h=this._subtractOverflows(e.height,u,l),p=c*h;return{visibleArea:p,isCompletelyWithinViewport:e.width*e.height===p,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:c==e.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,i=n.right-e.x,o=this._overlayRef.getConfig().minHeight,s=this._overlayRef.getConfig().minWidth,a=t.fitsInViewportHorizontally||null!=s&&s<=i;return(t.fitsInViewportVertically||null!=o&&o<=r)&&a}}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=this._viewportRect,i=Math.max(t.x+e.width-r.right,0),o=Math.max(t.y+e.height-r.bottom,0),s=Math.max(r.top-n.top-t.y,0),a=Math.max(r.left-n.left-t.x,0);let u=0,l=0;return this._previousPushAmount={x:u=e.width<=r.width?a||-i:t.x<this._viewportMargin?r.left-n.left-t.x:0,y:l=e.height<=r.height?s||-o:t.y<this._viewportMargin?r.top-n.top-t.y:0},{x:t.x+u,y:t.y+l}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const e=this._getScrollVisibility(),n=new oD(t,e);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let i=0;i<e.length;i++)e[i].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let i,o,s,a,u,l;if("top"===e.overlayY)i=n.height-(o=t.y)+this._viewportMargin;else if("bottom"===e.overlayY)i=n.height-(s=n.height-t.y+2*this._viewportMargin)+this._viewportMargin;else{const e=Math.min(n.bottom-t.y+n.top,t.y),r=this._lastBoundingBoxSize.height;o=t.y-e,(i=2*e)>r&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-r/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)l=n.width-t.x+this._viewportMargin,a=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)u=t.x,a=n.right-t.x;else{const e=Math.min(n.right-t.x+n.left,t.x),r=this._lastBoundingBoxSize.width;u=t.x-e,(a=2*e)>r&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.x-r/2)}return{top:o,left:u,bottom:s,right:l,width:a,height:i}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right="",r.width=r.height="100%";else{const t=this._overlayRef.getConfig().maxHeight,i=this._overlayRef.getConfig().maxWidth;r.height=Qp(n.height),r.top=Qp(n.top),r.bottom=Qp(n.bottom),r.width=Qp(n.width),r.left=Qp(n.left),r.right=Qp(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",t&&(r.maxHeight=Qp(t)),i&&(r.maxWidth=Qp(i))}this._lastBoundingBoxSize=n,dD(this._boundingBox.style,r)}_resetBoundingBoxStyles(){dD(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){dD(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={};if(this._hasExactPosition()){const r=this._viewportRuler.getViewportScrollPosition();dD(n,this._getExactOverlayY(e,t,r)),dD(n,this._getExactOverlayX(e,t,r))}else n.position="static";let r="",i=this._getOffset(e,"x"),o=this._getOffset(e,"y");i&&(r+=`translateX(${i}px) `),o&&(r+=`translateY(${o}px)`),n.transform=r.trim(),this._hasFlexibleDimensions&&this._overlayRef.getConfig().maxHeight&&(n.maxHeight=""),this._hasFlexibleDimensions&&this._overlayRef.getConfig().maxWidth&&(n.maxWidth=""),dD(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:null,bottom:null},i=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));let o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return i.y-=o,"bottom"===t.overlayY?r.bottom=`${this._document.documentElement.clientHeight-(i.y+this._overlayRect.height)}px`:r.top=Qp(i.y),r}_getExactOverlayX(t,e,n){let r,i={left:null,right:null},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),"right"==(r=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left")?i.right=`${this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)}px`:i.left=Qp(o.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:tD(t,n),isOriginOutsideView:JO(t,n),isOverlayClipped:tD(e,n),isOverlayOutsideView:JO(e,n)}}_subtractOverflows(t,...e){return e.reduce((t,e)=>t-Math.max(e,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach(t=>{aD("originX",t.originX),sD("originY",t.originY),aD("overlayX",t.overlayX),sD("overlayY",t.overlayY)})}_addPanelClasses(t){this._pane&&Xp(t).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;return t instanceof ln?t.nativeElement.getBoundingClientRect():t instanceof HTMLElement?t.getBoundingClientRect():{top:t.y,bottom:t.y,left:t.x,right:t.x,height:0,width:0}}}function dD(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}class fD{constructor(t,e,n,r,i,o,s){this._preferredPositions=[],this._positionStrategy=new pD(n,r,i,o,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,e)}get _isRtl(){return"rtl"===this._overlayRef.getDirection()}get onPositionChange(){return this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(t){this._positionStrategy.withScrollableContainers(t)}withFallbackPosition(t,e,n,r){const i=new iD(t,e,n,r);return this._preferredPositions.push(i),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}withOffsetX(t){return this._positionStrategy.withDefaultOffsetX(t),this}withOffsetY(t){return this._positionStrategy.withDefaultOffsetY(t),this}withLockedPosition(t){return this._positionStrategy.withLockedPosition(t),this}withPositions(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(t){return this._positionStrategy.setOrigin(t),this}}const mD="cdk-global-overlay-wrapper";class gD{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(mD),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig();t.position=this._cssPosition,t.marginLeft="100%"===n.width?"0":this._leftOffset,t.marginTop="100%"===n.height?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,"100%"===n.width?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems="100%"===n.height?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(mD),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let yD=(()=>{class t{constructor(t,e,n,r){this._viewportRuler=t,this._document=e,this._platform=n,this._overlayContainer=r}global(){return new gD}connectedTo(t,e,n){return new fD(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new pD(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(KO),Ut(Ua),Ut(td),Ut(lD))},token:t,providedIn:"root"}),t})(),vD=0,bD=(()=>(class{constructor(t,e,n,r,i,o,s,a,u,l){this.scrollStrategies=t,this._overlayContainer=e,this._componentFactoryResolver=n,this._positionBuilder=r,this._keyboardDispatcher=i,this._injector=o,this._ngZone=s,this._document=a,this._directionality=u,this._location=l}create(t){const e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),i=new rD(t);return i.direction=i.direction||this._directionality.value,new cD(r,e,n,i,this._ngZone,this._keyboardDispatcher,this._document,this._location)}position(){return this._positionBuilder}_createPaneElement(t){const e=this._document.createElement("div");return e.id=`cdk-overlay-${vD++}`,e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(No)),new PO(t,this._componentFactoryResolver,this._appRef,this._injector)}}))();const wD=new It("cdk-connected-overlay-scroll-strategy");function xD(t){return()=>t.scrollStrategies.reposition()}let _D=(()=>(class{}))();class CD{constructor(t){this.total=t}call(t,e){return e.subscribe(new SD(t,this.total))}}class SD extends g{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){++this.count>this.total&&this.destination.next(t)}}const ED=new Set;let kD,ND=(()=>{class t{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):ID}matchMedia(t){return this._platform.WEBKIT&&function(t){if(!ED.has(t))try{kD||((kD=document.createElement("style")).setAttribute("type","text/css"),document.head.appendChild(kD)),kD.sheet&&(kD.sheet.insertRule(`@media ${t} {.fx-query-test{ }}`,0),ED.add(t))}catch(aR){console.error(aR)}}(t),this._matchMedia(t)}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(td))},token:t,providedIn:"root"}),t})();function ID(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let TD=(()=>{class t{constructor(t,e){this._mediaMatcher=t,this._zone=e,this._queries=new Map,this._destroySubject=new I}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return AD(Xp(t)).some(t=>this._registerQuery(t).mql.matches)}observe(t){let e=Ya(AD(Xp(t)).map(t=>this._registerQuery(t).observable));return(e=Ru(e.pipe(_u(1)),e.pipe(t=>t.lift(new CD(1)),function(t,e=ad){return t=>t.lift(new ud(0,e))}()))).pipe(W(t=>{const e={matches:!1,breakpoints:{}};return t.forEach(t=>{e.matches=e.matches||t.matches,e.breakpoints[t.query]=t.matches}),e}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const e=this._mediaMatcher.matchMedia(t),n={observable:new _(t=>{const n=e=>this._zone.run(()=>t.next(e));return e.addListener(n),()=>{e.removeListener(n)}}).pipe(Ou(e),W(e=>({query:t,matches:e.matches})),hv(this._destroySubject)),mql:e};return this._queries.set(t,n),n}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(ND),Ut(ao))},token:t,providedIn:"root"}),t})();function AD(t){return t.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const RD={XSmall:"(max-width: 599.99px)",Small:"(min-width: 600px) and (max-width: 959.99px)",Medium:"(min-width: 960px) and (max-width: 1279.99px)",Large:"(min-width: 1280px) and (max-width: 1919.99px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.99px) and (orientation: portrait), (max-width: 959.99px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.99px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.99px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.99px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.99px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.99px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.99px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};class OD{constructor(t,e){this._overlayRef=e,this._afterDismissed=new I,this._afterOpened=new I,this._onAction=new I,this._dismissedByAction=!1,this.containerInstance=t,this.onAction().subscribe(()=>this.dismiss()),t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),t)}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed.asObservable()}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction.asObservable()}}const DD=new It("MatSnackBarData");class PD{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let FD=(()=>(class{constructor(t,e){this.snackBarRef=t,this.data=e}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}))(),MD=(()=>(class extends DO{constructor(t,e,n,r){super(),this._ngZone=t,this._elementRef=e,this._changeDetectorRef=n,this.snackBarConfig=r,this._destroyed=!1,this._onExit=new I,this._onEnter=new I,this._animationState="void",this._role="assertive"!==r.politeness||r.announcementMessage?"off"===r.politeness?null:"status":"alert"}attachComponentPortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(t)}onAnimationEnd(t){const{fromState:e,toState:n}=t;if(("void"===n&&"void"!==e||"hidden"===n)&&this._completeExit(),"visible"===n){const t=this._onEnter;this._ngZone.run(()=>{t.next(),t.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}exit(){return this._animationState="hidden",this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.asObservable().pipe(_u(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const t=this._elementRef.nativeElement,e=this.snackBarConfig.panelClass;e&&(Array.isArray(e)?e.forEach(e=>t.classList.add(e)):t.classList.add(e)),"center"===this.snackBarConfig.horizontalPosition&&t.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&t.classList.add("mat-snack-bar-top")}_assertNotAttached(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}))(),LD=(()=>(class{}))();const zD=new It("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new PD}});let BD=(()=>{class t{constructor(t,e,n,r,i,o){this._overlay=t,this._live=e,this._injector=n,this._breakpointObserver=r,this._parentSnackBar=i,this._defaultConfig=o,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const t=this._parentSnackBar;return t?t._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(t){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=t:this._snackBarRefAtThisLevel=t}openFromComponent(t,e){return this._attach(t,e)}openFromTemplate(t,e){return this._attach(t,e)}open(t,e="",n){const r=Object.assign({},this._defaultConfig,n);return r.data={message:t,action:e},r.announcementMessage||(r.announcementMessage=t),this.openFromComponent(FD,r)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(t,e){const n=new LO(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[PD,e]])),r=new RO(MD,e.viewContainerRef,n),i=t.attach(r);return i.instance.snackBarConfig=e,i.instance}_attach(t,e){const n=Object.assign({},new PD,this._defaultConfig,e),r=this._createOverlay(n),i=this._attachSnackBarContainer(r,n),o=new OD(i,r);if(t instanceof Fn){const e=new OO(t,null,{$implicit:n.data,snackBarRef:o});o.instance=i.attachTemplatePortal(e)}else{const e=this._createInjector(n,o),r=new RO(t,void 0,e),s=i.attachComponentPortal(r);o.instance=s.instance}return this._breakpointObserver.observe(RD.Handset).pipe(hv(r.detachments().pipe(_u(1)))).subscribe(t=>{t.matches?r.overlayElement.classList.add("mat-snack-bar-handset"):r.overlayElement.classList.remove("mat-snack-bar-handset")}),this._animateSnackBar(o,n),this._openedSnackBarRef=o,this._openedSnackBarRef}_animateSnackBar(t,e){t.afterDismissed().subscribe(()=>{this._openedSnackBarRef==t&&(this._openedSnackBarRef=null),e.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{t.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):t.containerInstance.enter(),e.duration&&e.duration>0&&t.afterOpened().subscribe(()=>t._dismissAfter(e.duration)),e.announcementMessage&&this._live.announce(e.announcementMessage,e.politeness)}_createOverlay(t){const e=new rD;e.direction=t.direction;let n=this._overlay.position().global();const r="rtl"===t.direction,i="left"===t.horizontalPosition||"start"===t.horizontalPosition&&!r||"end"===t.horizontalPosition&&r,o=!i&&"center"!==t.horizontalPosition;return i?n.left("0"):o?n.right("0"):n.centerHorizontally(),"top"===t.verticalPosition?n.top("0"):n.bottom("0"),e.positionStrategy=n,this._overlay.create(e)}_createInjector(t,e){return new LO(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[OD,e],[DD,t.data]]))}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(bD),Ut(dd),Ut(Tt),Ut(TD),Ut(t,12),Ut(zD))},token:t,providedIn:LD}),t})(),UD=(()=>{class t{constructor(t){this.snackBar=t}displayError(t="Something went wrong, please try again.",e=3e3){this.snackBar.open(t,"Error",{duration:e})}}return t.ngInjectableDef=gt({factory:function(){return new t(Ut(BD))},token:t,providedIn:"root"}),t})();var VD=nr({encapsulation:0,styles:[[".image-classifier__file-input[_ngcontent-%COMP%]{display:none}.image-classifier-container[_ngcontent-%COMP%]{margin:0 auto}.image-classifier__card-wrap[_ngcontent-%COMP%]{margin:20px;display:-webkit-box;display:flex;-webkit-box-flex:1;flex-grow:1;-webkit-box-pack:center;justify-content:center}.image-classifier__card-wrap[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{max-width:500px}.image-classifier__no-data-text[_ngcontent-%COMP%]{opacity:.26;font-style:italic}"]],data:{}});function jD(t){return hs(0,[(t()(),Go(0,0,null,null,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),pi(1,16384,null,0,ry,[],null,null),(t()(),us(-1,null,["Prediction Result"]))],null,null)}function WD(t){return hs(0,[(t()(),Go(0,0,[[1,0],["userImage",1]],null,1,"img",[["alt","Classifier Image"],["class","mat-card-image"],["mat-card-image",""]],[[8,"src",4]],null,null,null,null)),pi(1,16384,null,0,oy,[],null,null)],null,function(t,e){t(e,0,0,e.component.imageSource)})}function HD(t){return hs(0,[(t()(),Go(0,0,null,null,1,"span",[["class","image-classifier__no-data-text"]],null,null,null,null,null)),(t()(),us(-1,null,[" No Image "]))],null,null)}function qD(t){return hs(0,[(t()(),Go(0,0,null,null,6,"mat-list-item",[["class","mat-list-item"],["role","listitem"]],[[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],null,null,kv,Ev)),pi(1,1228800,null,3,wv,[ln,An,[2,vv],[2,bv]],null,null),Yo(603979776,2,{_lines:1}),Yo(603979776,3,{_avatar:0}),Yo(603979776,4,{_icon:0}),(t()(),us(5,2,[" "," | confidence: "," "])),os(6,1)],null,function(t,e){t(e,0,0,Jr(e,1)._avatar||Jr(e,1)._icon,Jr(e,1)._avatar||Jr(e,1)._icon);var n=e.context.$implicit.className,r=Jn(e,5,1,t(e,6,0,Jr(e.parent,0),100*e.context.$implicit.probability));t(e,5,0,n,r)})}function $D(t){return hs(0,[di(0,Nv,[]),Yo(671088640,1,{userImageRef:0}),(t()(),Go(2,0,null,null,1,"app-header",[],null,null,null,ey,ty)),pi(3,114688,null,0,Jg,[gp],null,null),(t()(),Go(4,0,null,null,24,"div",[["class","image-classifier-container"]],null,null,null,null,null)),(t()(),Go(5,0,null,null,22,"div",[["class","image-classifier__card-wrap"]],null,null,null,null,null)),(t()(),Go(6,0,null,null,21,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,ly,uy)),pi(7,49152,null,0,sy,[[2,Xg]],null,null),(t()(),$o(16777216,null,0,1,null,jD)),pi(9,16384,null,0,Ma,[Ln,Fn],{ngIf:[0,"ngIf"]},null),(t()(),$o(16777216,null,0,1,null,WD)),pi(11,16384,null,0,Ma,[Ln,Fn],{ngIf:[0,"ngIf"]},null),(t()(),Go(12,0,null,0,7,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),pi(13,16384,null,0,ny,[],null,null),(t()(),$o(16777216,null,null,1,null,HD)),pi(15,16384,null,0,Ma,[Ln,Fn],{ngIf:[0,"ngIf"]},null),(t()(),Go(16,0,null,null,3,"mat-list",[["class","mat-list mat-list-base"],["role","list"]],null,null,null,Sv,Cv)),pi(17,704512,null,0,bv,[ln],null,null),(t()(),$o(16777216,null,0,1,null,qD)),pi(19,278528,null,0,Pa,[Ln,Fn,In],{ngForOf:[0,"ngForOf"]},null),(t()(),Go(20,0,null,0,7,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),pi(21,16384,null,0,iy,[],null,null),(t()(),Go(22,0,null,null,2,"button",[["color","primary"],["mat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Jr(t,28).click()&&r),r},Yg,Zg)),pi(23,180224,null,0,Xd,[ln,gd,[2,Xg]],{color:[0,"color"]},null),(t()(),us(-1,0,[" Upload Image "])),(t()(),Go(25,0,null,null,2,"button",[["color","warn"],["mat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.cleanup()&&r),r},Yg,Zg)),pi(26,180224,null,0,Xd,[ln,gd,[2,Xg]],{disabled:[0,"disabled"],color:[1,"color"]},null),(t()(),us(-1,0,[" Clear "])),(t()(),Go(28,0,[["imageInput",1]],null,0,"input",[["class","image-classifier__file-input"],["type","file"]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.onFileSelected(n)&&r),r},null,null))],function(t,e){var n=e.component;t(e,3,0),t(e,9,0,n.imageSource),t(e,11,0,n.imageSource),t(e,15,0,!n.imageSource),t(e,19,0,n.predictions),t(e,23,0,"primary"),t(e,26,0,!n.imageSource,"warn")},function(t,e){t(e,6,0,"NoopAnimations"===Jr(e,7)._animationMode),t(e,20,0,"end"===Jr(e,21).align),t(e,22,0,Jr(e,23).disabled||null,"NoopAnimations"===Jr(e,23)._animationMode),t(e,25,0,Jr(e,26).disabled||null,"NoopAnimations"===Jr(e,26)._animationMode)})}function GD(t){return hs(0,[(t()(),Go(0,0,null,null,1,"app-image-classifier",[],null,null,null,$D,VD)),pi(1,245760,null,0,IO,[UD],null,null)],function(t,e){t(e,1,0)},null)}var KD=jr("app-image-classifier",IO,GD,{},{},[]),XD=function(t,e){return(XD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function QD(t,e){function n(){this.constructor=t}XD(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ZD,YD=function(){return(YD=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function JD(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})}function tP(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function eP(){return null==ZD&&(ZD=wx().epsilon()),ZD}var nP=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return QD(e,t),e}(Error),rP=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return QD(e,t),e}(Error),iP=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return QD(e,t),e}(Error),oP=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return QD(e,t),e}(Error),sP=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return QD(e,t),e}(Error);function aP(t,e){if(Array.isArray(t)){for(var n=[],r=0;r<e;r++)n=n.concat(t);return n}return(n=new Array(e)).fill(t),n}function uP(t,e){if(!t)throw new sP(e)}function lP(t,e){for(var n=0,r=0,i=t;r<i.length;r++)i[r]===e&&n++;return n}function cP(t){return 1===t.length?t[0]:t}function hP(t){return Array.isArray(t)?t:[t]}function pP(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function dP(t){return t.length<=1?t:-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,function(t,e){return e.toUpperCase()})}!function(t){QD(function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r},t)}(Error);var fP={};function mP(t){if(null==t)return null;var e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function gP(t,e,n,r,i){var o,s,a;if(void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r="object"),void 0===i&&(i=!1),"string"==typeof t){var u=void 0;if(t in n)u=n[t];else if(t in fP)u=fP[t];else if(null==(u=e[t]))throw new iP("Unknown "+r+": "+t+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return u}var l=t;if(null==l.className||null==l.config)throw new iP(r+": Improper config format: "+JSON.stringify(l)+".\n'className' and 'config' must set.");var c=l.className,h=void 0,p=void 0;if(c in n?(h=(o=n[c])[0],p=o[1]):c in fP?(h=(s=fP.className)[0],p=s[1]):c in e&&(h=(a=e[c])[0],p=a[1]),null==h)throw new iP("Unknown "+r+": "+c+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(null!=p){for(var d={},f=0,m=Object.keys(fP);f<m.length;f++)d[x=m[f]]=fP[x];for(var g=0,y=Object.keys(n);g<y.length;g++)d[x=y[g]]=n[x];l.config.customObjects=d;for(var v=YD({},fP),b=0,w=Object.keys(n);b<w.length;b++){var x=w[b];fP[x]=n[x]}!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach(function(e){return t(e)});else for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],o=e[i];null!=o&&"object"==typeof o&&(Array.isArray(o)||"ndarray"!==o.type||"number"!=typeof o.value?t(o):e[i]=o.value)}}(l.config);var _=p(h,l.config,n,i);return fP=YD({},v),_}v=YD({},fP);for(var C=0,S=Object.keys(n);C<S.length;C++)fP[x=S[C]]=n[x];return _=new h(l.config),fP=YD({},v),_}function yP(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function vP(t){if(null==t)return t;for(var e=[],n=0,r=t;n<r.length;n++){var i=r[n];-1===e.indexOf(i)&&e.push(i)}return e}function bP(t){if(null==t)throw new iP("Invalid value in obj: "+JSON.stringify(t));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function wP(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new iP(n+" is not a valid "+e+".  Valid values are "+t+" or null/undefined.")}function xP(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=1/0),uP(n>=0),uP(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(function(t){return typeof t===e})}function _P(t,e){Array.isArray(t)?(Nb.assert(t.length>0,function(){return e+" is unexpectedly an empty array."}),t.forEach(function(t,n){return _P(t,"element "+(n+1)+" of "+e)})):Nb.assert(Number.isInteger(t)&&t>0,function(){return"Expected "+e+" to be a positive integer, but got "+function t(e){return null===e?"null":Array.isArray(e)?"["+e.map(function(e){return t(e)}).join(",")+"]":"string"==typeof e?'"'+e+'"':""+e}(t)+"."})}function CP(t,e){return lx(function(){return zk(VN(mI(t,t),e,!0))})}var SP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.getConfig=function(){return{}},e}(FA.Serializable),EP=function(t){function e(e){var n=t.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return QD(e,t),e.prototype.apply=function(t){var e=this;return lx(function(){var n=CP(t,e.axis),r=gk(n,0,e.maxValue);return fI(t,oI(r,eI(eP(),n)))})},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e.className="MaxNorm",e}(SP);FA.registerClass(EP);var kP=function(t){function e(e){var n=t.call(this)||this;return n.defaultAxis=0,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return QD(e,t),e.prototype.apply=function(t){var e=this;return lx(function(){return oI(t,eI(eP(),CP(t,e.axis)))})},e.prototype.getConfig=function(){return{axis:this.axis}},e.className="UnitNorm",e}(SP);FA.registerClass(kP);var NP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return RI(t)},e.className="NonNeg",e}(SP);FA.registerClass(NP);var IP=function(t){function e(e){var n=t.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=e.minValue?e.minValue:n.defaultMinValue,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.rate=null!=e.rate?e.rate:n.defaultRate,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return QD(e,t),e.prototype.apply=function(t){var e=this;return lx(function(){var n=CP(t,e.axis),r=eI(fI(e.rate,gk(n,e.minValue,e.maxValue)),fI(1-e.rate,n));return fI(t,oI(r,eI(eP(),n)))})},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e.className="MinMaxNorm",e}(SP);FA.registerClass(IP);var TP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function AP(t){return mP(t)}function RP(t,e){return void 0===e&&(e={}),gP(t,FA.SerializationMap.getMap().classNameMap,e,"constraint")}function OP(t){return null==t?null:"string"==typeof t?RP({className:t in TP?TP[t]:t,config:{}}):t instanceof SP?t:RP(t)}Object.freeze({maxNorm:function(t){return new EP(t)},unitNorm:function(t){return new kP(t)},nonNeg:function(){return new NP},minMaxNorm:function(t){return new IP(t)}});var DP=["channelsFirst","channelsLast"],PP=["valid","same","causal"],FP=["max","avg"],MP=["sum","mul","concat","ave"],LP=new Map;function zP(t){wP(DP,"DataFormat",t)}function BP(t){wP(PP,"PaddingMode",t)}var UP=[],VP="/";function jP(t,e){UP.push(t);try{var n=e();return UP.pop(),n}catch(t){throw UP.pop(),t}}function WP(t){if(!$P(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===UP.length?"":UP.join(VP)+VP)+t}function HP(t){if(!$P(t))throw new Error("Not a valid tensor name: '"+t+"'");LP.has(t)||LP.set(t,0);var e=LP.get(t);if(LP.set(t,LP.get(t)+1),e>0){var n=t+"_"+e;return LP.set(n,1),n}return t}var qP=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function $P(t){return!!t.match(qP)}function GP(t){return t===parseInt(t.toString(),10)}function KP(t,e,n){null==e&&(e=0),null==n&&(n=t.length);for(var r=1,i=e;i<n;++i)r*=t[i];return r}function XP(t){return Hx(t=Array.isArray(t)?new Float32Array(t):t)}function QP(t){return BN(XP(t)).dataSync()[0]}function ZP(t){return LN(XP(t)).dataSync()[0]}function YP(t,e){if(e<t)throw new iP("end ("+e+") < begin ("+t+") is forbidden.");for(var n=[],r=t;r<e;++r)n.push(r);return n}function JP(t,e){return t.asType(e)}function tF(t,e){void 0===e&&(e=-1);var n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function eF(t,e,n){return lx(function(){switch(t.rank){case 1:return NN(t,e,n);case 2:return IN(t,[e,0],[n,t.shape[1]]);case 3:return TN(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return AN(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);default:throw new iP("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function nF(t,e,n){return lx(function(){switch(t.rank){case 1:return NN(t,e,n);case 2:return IN(t,[0,e],[t.shape[0],n]);case 3:return TN(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return AN(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new iP("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function rF(t,e,n,r){return lx(function(){switch(t.rank){case 1:return NN(t,e,n);case 2:switch(r){case 1:return eF(t,e,n);case 2:return nF(t,e,n);default:throw new iP("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return eF(t,e,n);case 2:return TN(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return nF(t,e,n);default:throw new iP("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return eF(t,e,n);case 2:return AN(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return AN(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return nF(t,e,n);default:throw new iP("The axis is not within the rank of the tensor "+r)}default:throw new iP("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function iF(t,e){var n;return void 0===e&&(e=-1),e<0&&(e=0!==(n=t[0].rank)?n:0),e===t[0].rank&&(e=-1),r_(t,e)}function oF(t,e){switch(t.rank){case 1:return i_([t,e]);case 2:return o_([t,e],0);case 3:return s_([t,e],0);case 4:return a_([t,e],0);default:throw new iP("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function sF(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new iP("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+t.rank+")");return W_(t,e)}function aF(t,e,n,r,i){return void 0===e&&(e=0),void 0===n&&(n=1),L_(t,e,n,r,i)}function uF(t,e,n,r){if(t.rank<2||e.rank<2)throw new oP("dot requires both inputs to be rank >= 2 but got x shape = "+t.shape+" and y shape = "+e.shape);if(e.rank>=3&&(a=t.shape.slice(-1)[0])!==(c=e.shape.slice(-2)[0]))throw new oP("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+t.shape+" and  y shape = "+e.shape);if(2===t.rank&&2===e.rank){var i=!1,o=!1;return NT.matMul(t,e,i,o,r?hF(t.rank,r,"channelsLast"):null,n)}var s=t.shape.slice(),a=s.pop();t=t.reshape([-1,a]);var u=e.shape.slice(),l=u.pop(),c=u.pop(),h=u.concat([l]),p=Array.from({length:e.rank},function(t,n){return 0===n?e.rank-2:n<=e.rank-2?n-1:n});e=e.transpose(p).reshape([c,-1]);var d=s.concat(h);return NT.matMul(t,e,i=!1,o=!1,r?hF(t.rank,r,"channelsLast"):null,n).reshape(d)}function lF(t,e,n){return lx(function(){return e=Array.isArray(e)?Hx(e,"int32"):e.toInt(),zI(t,e,n)})}function cF(t){return mI(t,t)}function hF(t,e,n){var r=e.shape;if(1!==e.rank&&e.rank!==t)throw new iP("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(t<3)return e;throw new iP("Unsupported input rank by biasAdd: "+e.rank)}function pF(t,e,n){return lx(function(){return null==n&&(n="channelsLast"),zP(n),t.add(hF(t.rank,e,n))})}function dF(t,e,n,r){return lx(function(){return JI(t,e,n,r)})}function fF(t,e,n){return void 0===n&&(n=!1),n?t():e()}var mF=["fanIn","fanOut","fanAvg"],gF=["normal","uniform","truncatedNormal"],yF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e}(FA.Serializable),vF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t,e){return Zx(t,e)},e.className="Zeros",e}(yF);FA.registerClass(vF);var bF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t,e){return Qx(t,e)},e.className="Ones",e}(yF);FA.registerClass(bF);var wF=function(t){function e(e){var n=t.call(this)||this;if("object"!=typeof e)throw new iP("Expected argument of type ConstantConfig but got "+e);if(void 0===e.value)throw new iP("config must have value set but got "+e);return n.value=e.value,n}return QD(e,t),e.prototype.apply=function(t,e){var n=this;return lx(function(){return fI(Wx(n.value),Qx(t,e))})},e.prototype.getConfig=function(){return{value:this.value}},e.className="Constant",e}(yF);FA.registerClass(wF);var xF=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=e.minval||n.DEFAULT_MINVAL,n.maxval=e.maxval||n.DEFAULT_MAXVAL,n.seed=e.seed,n}return QD(e,t),e.prototype.apply=function(t,e){return z_(t,this.minval,this.maxval,e)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e.className="RandomUniform",e}(yF);FA.registerClass(xF);var _F=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return QD(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new oP("randomNormal does not support dType "+e+".");return aF(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="RandomNormal",e}(yF);FA.registerClass(_F);var CF=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return QD(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new oP("truncatedNormal does not support dType "+e+".");return H_(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="TruncatedNormal",e}(yF);FA.registerClass(CF);var SF=function(t){function e(e){var n=t.call(this)||this;return n.gain=null!=e.gain?e.gain:1,n}return QD(e,t),e.prototype.apply=function(t,e){var n=this;return lx(function(){if(2!==t.length||t[0]!==t[1])throw new iP("Identity matrix initializer can only be used for 2D square matrices.");return fI(n.gain,I_(t[0]))})},e.prototype.getConfig=function(){return{gain:this.gain}},e.className="Identity",e}(yF);FA.registerClass(SF);var EF=function(t){function e(e){var n=t.call(this)||this;if(e.scale<0)throw new iP("scale must be a positive float. Got: "+e.scale);return n.scale=null==e.scale?1:e.scale,n.mode=null==e.mode?"fanIn":e.mode,wP(mF,"FanMode",n.mode),n.distribution=null==e.distribution?"normal":e.distribution,wP(gF,"Distribution",n.distribution),n.seed=e.seed,n}return QD(e,t),e.prototype.apply=function(t,e){var n=function(t,e){var n,r;if(void 0===e&&(e="channelsLast"),zP(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length))if("channelsFirst"===e){var i=KP(t,2);n=t[1]*i,r=t[0]*i}else"channelsLast"===e&&(i=KP(t,0,t.length-2),n=t[t.length-2]*i,r=t[t.length-1]*i);else{var o=KP(t);n=Math.sqrt(o),r=Math.sqrt(o)}return[n,r]}(t),r=n[0],i=n[1],o=this.scale;if(o/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,i):Math.max(1,(r+i)/2),"normal"===this.distribution){var s=Math.sqrt(o);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new oP(this.getClassName()+" does not support dType "+e+".");return H_(t,0,s,e,this.seed)}var a=Math.sqrt(3*o);return z_(t,-a,a,e)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e.className="VarianceScaling",e}(yF);FA.registerClass(EF);var kF=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})||this}return QD(e,t),e.prototype.getClassName=function(){return EF.className},e.className="GlorotUniform",e}(EF);FA.registerClass(kF);var NF=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})||this}return QD(e,t),e.prototype.getClassName=function(){return EF.className},e.className="GlorotNormal",e}(EF);FA.registerClass(NF);var IF=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return QD(e,t),e.prototype.getClassName=function(){return EF.className},e.className="HeNormal",e}(EF);FA.registerClass(IF);var TF=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return QD(e,t),e.prototype.getClassName=function(){return EF.className},e.className="HeUniform",e}(EF);FA.registerClass(TF);var AF=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return QD(e,t),e.prototype.getClassName=function(){return EF.className},e.className="LeCunNormal",e}(EF);FA.registerClass(AF);var RF=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return QD(e,t),e.prototype.getClassName=function(){return EF.className},e.className="LeCunNormal",e}(EF);FA.registerClass(RF);var OF=function(t){function e(e){var n=t.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==e.gain?n.DEFAULT_GAIN:e.gain,n.seed=e.seed,null!=n.seed)throw new oP("Random seed is not implemented for Orthogonal Initializer yet.");return n}return QD(e,t),e.prototype.apply=function(t,e){var n=this;return lx(function(){if(2!==t.length)throw new oP("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var e=aF(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),r=bT.gramSchmidt(e);return t[0]>t[1]&&(r=r.transpose()),fI(n.gain,r)})},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e.className="Orthogonal",e}(yF);FA.registerClass(OF);var DF={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function PF(t,e){return void 0===e&&(e={}),gP(t,FA.SerializationMap.getMap().classNameMap,e,"initializer")}function FF(t){return mP(t)}function MF(t){if("string"==typeof t){var e=t in DF?DF[t]:t;if("GlorotNormal"===e)return new NF;if("GlorotUniform"===e)return new kF;if("HeNormal"===e)return new IF;if("HeUniform"===e)return new TF;if("LeCunNormal"===e)return new AF;if("LeCunUniform"===e)return new RF;var n={};return n.className=e,n.config={},PF(n)}return t instanceof yF?t:PF(t)}Object.freeze({zeros:function(){return new vF},ones:function(){return new bF},constant:function(t){return new wF(t)},randomUniform:function(t){return new xF(t)},randomNormal:function(t){return new _F(t)},truncatedNormal:function(t){return new CF(t)},identity:function(t){return new SF(t)},varianceScaling:function(t){return new EF(t)},glorotUniform:function(t){return new kF(t)},glorotNormal:function(t){return new NF(t)},heNormal:function(t){return new IF(t)},heUniform:function(t){return new TF(t)},leCunNormal:function(t){return new AF(t)},leCunUniform:function(t){return new RF(t)},orthogonal:function(t){return new OF(t)}});var LF=0;function zF(){return LF++}var BF={};function UF(t){return void 0===t&&(t=""),t in BF||(BF[t]=0),BF[t]+=1,t+BF[t].toString()}function VF(t){return Array.isArray(t)&&Array.isArray(t[0])}function jF(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function WF(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new iP("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function HF(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new iP("Expected exactly 1 Shape; got "+t.length)}return t}function qF(t){for(var e=0,n=0,r=t;n<r.length;n++){var i=r[n];e+=0===i.shape.length?1:i.shape.reduce(function(t,e){return t*e})}return e}var $F="Variable",GF=function(){function t(t,e,n,r,i){void 0===e&&(e="float32"),void 0===n&&(n=$F),void 0===r&&(r=!0),void 0===i&&(i=null),this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=zF(),this.originalName=WP(n=null==n?$F:n),this.name=HP(this.originalName),this.trainable_=r,this.constraint=i,this.val=$b(t,this.trainable_,this.name,this.dtype)}return t.prototype.read=function(){return this.assertNotDisposed(),this.val},t.prototype.write=function(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},t.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},t.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),t}();function KF(t){return t.map(function(t){return t.read()})}function XF(t){t.forEach(function(t){t[0].write(t[1])})}var QF,ZF=function(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},YF=function(t,e,n,r,i,o,s){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=s,this.id=zF(),null!=o&&(this.originalName=WP(o),this.name=HP(this.originalName)),this.rank=e.length},JF=0,tM=function(){function t(t,e){this.callArgs=e,this.id=JF++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var n=0,r=t.inboundLayers;n<r.length;n++){var i=r[n];null!=i&&i.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return t.prototype.getConfig=function(){for(var t=[],e=0,n=this.inboundLayers;e<n.length;e++){var r=n[e];t.push(null!=r?r.name:null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},t}(),eM=0,nM=function(t){function e(e){var n=t.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=eM++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=e.name;if(!r){var i=n.getClassName();r=pP(i)+"_"+UF(i)}if(n.name=r,n.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){var o=void 0;if(null!=e.batchInputShape)o=e.batchInputShape;else if(null!=e.inputShape){var s=null;null!=e.batchSize&&(s=e.batchSize),o=[s].concat(e.inputShape)}n.batchInputShape=o;var a=e.dtype;null==a&&(a=e.inputDType),null==a&&(a="float32"),n.dtype=a}return n.initialWeights=null!=e.weights?e.weights:null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return QD(e,t),e.nodeKey=function(t,e){return t.name+"_ib-"+e.toString()},e.prototype.getNodeAtIndex=function(t,e){if(0===this.inboundNodes.length)throw new rP("The layer has never been called and thus has no defined "+e+".");if(this.inboundNodes.length<=t)throw new iP("Asked to get "+e+" at node "+t+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return cP(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return cP(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new nP("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new nP("Layer "+this.name+" is not connected, no input to return.");return cP(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new nP("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new nP("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return cP(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map(function(t){return t()})},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach(function(e){return e.trainable=t}),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(t){return t.trainable}):[]},set:function(t){this._trainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(t){return!t.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){if(t=hP(t),null!=this.inputSpec&&0!==this.inputSpec.length){var e=hP(this.inputSpec);if(t.length!==e.length)throw new iP("Layer "+this.name+" expects "+e.length+" inputs, but it received "+t.length+" input tensors. Input received: "+t);for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(null!=i){var o=r.rank;if(null!=i.ndim&&o!==i.ndim)throw new iP("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+i.ndim+", found ndim="+o);if(null!=i.maxNDim&&o>i.maxNDim)throw new iP("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+i.maxNDim+", found ndim="+o);if(null!=i.minNDim&&o<i.minNDim)throw new iP("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+i.minNDim+", found ndim="+o+".");if(null!=i.dtype&&r.dtype!==i.dtype)throw new iP("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+i.dtype+", found dtype="+r.dtype+".");if(i.axes){var s=r.shape;for(var a in i.axes){var u=Number(a),l=i.axes[a];if(null!=l&&-1===[l,null].indexOf(u>=0?s[u]:s[s.length+u]))throw new iP("Input "+n+" is incompatible with layer "+this.name+": expected axis "+u+" of input shape to have value "+l+" but got shape "+s+".")}}if(null!=i.shape)for(var c=0;c<i.shape.length;++c){var h=i.shape[c],p=r.shape[c];if(null!=h&&null!=p&&h!==p)throw new iP("Input "+n+" is incompatible with layer "+this.name+": expected shape="+i.shape+", found shape="+r.shape+".")}}}}},e.prototype.call=function(t,e){return t},e.prototype.invokeCallHook=function(t,e){null!=this._callHook&&this._callHook(t,e)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,e){var n=this;e=e||{},this.assertNotDisposed();for(var r=hP(t),i=!0,o=0,s=r;o<s.length;o++)if(!(s[o]instanceof YF)){i=!1;break}for(var a=!0,u=0,l=r;u<l.length;u++)if(l[u]instanceof YF){a=!1;break}if(i===a)throw new iP("Arguments to apply() must be all SymbolicTensors or all Tensors");return jP(this.name,function(){if(!n.built){n.assertInputCompatibility(t);for(var i=[],o=0,s=hP(t);o<s.length;o++)i.push(s[o].shape);n.build(cP(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&a&&(n._refCount=1)}if(n.assertInputCompatibility(t),a){for(var u=[],l=0,c=hP(f=n.call(t,e));l<c.length;l++){var h=c[l];-1!==r.indexOf(h)&&(h=h.clone()),u.push(h)}if(f=cP(u),null!=n.activityRegularizer)throw new oP("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}var p=function(t){for(var e=[],n=0,r=t=hP(t);n<r.length;n++)e.push(r[n].shape);return cP(e)}(t),d=n.computeOutputShape(p),f=void 0,m="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(t)?p[0]:p),f=null!=d&&d.length>0&&Array.isArray(d[0])?d.map(function(r,i){return new YF(m,r,n,hP(t),e,n.name,i)}):new YF(m,d,n,hP(t),e,n.name),n.addInboundNode(t,f,null,null,p,d,e),n._refCount++,null!=n.activityRegularizer)throw new oP("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f})},e.prototype.warnOnIncompatibleInputShape=function(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var e=!1;this.batchInputShape.forEach(function(n,r){null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)}),e&&console.warn("The shape of the input tensor ("+JSON.stringify(t)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new nP("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var t=[],e=0,n=this.inboundNodes;e<n.length;e++){var r=JSON.stringify(n[e].outputShapes);-1===t.indexOf(r)&&t.push(r)}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new nP("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new rP("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return qF(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return void 0===t&&(t=!1),KF(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var e=this;lx(function(){var n=e.weights;if(n.length!==t.length)throw new iP('You called setWeights(weights) on layer "'+e.name+'" with a weight list of length '+t.length+", but the layer was expecting "+n.length+" weights. Provided weights: "+t+"...");if(0!==n.length){for(var r=[],i=KF(n),o=0;o<i.length;++o){var s=i[o],a=n[o],u=t[o];if(!Nb.arraysEqual(s.shape,u.shape))throw new iP("Layer weight shape "+s.shape+" not compatible with provided weight shape "+u.shape);r.push([a,u])}XF(r)}})},e.prototype.addWeight=function(t,e,n,r,i,o,s){if(-1!==this._addedWeightNames.indexOf(t))throw new iP("Duplicate weight name "+t+" for layer "+this.name);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=MF("zeros"));var a=r.apply(e,n),u=new GF(a,n,t,o,s);return a.dispose(),null!=i&&this.addLoss(function(){return i.apply(u.read())}),null==o&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var e;null==t||Array.isArray(t)&&0===t.length||(t=hP(t),null!=this._losses&&(e=this.losses).push.apply(e,t))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,e){var n=this;if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");e.forEach(function(t){if(null!=t)throw new TypeError("Layer "+n.name+" does not support masking, but was passed an inputMask.")})}return null}return e},e.prototype.addInboundNode=function(t,e,n,r,i,o,s){void 0===s&&(s=null);var a=hP(t);e=hP(e),n=hP(n),r=hP(r),i=jF(i),o=jF(o);for(var u=[],l=[],c=[],h=0,p=a;h<p.length;h++){var d=p[h];u.push(d.sourceLayer),l.push(d.nodeIndex),c.push(d.tensorIndex)}new tM({outboundLayer:this,inboundLayers:u,nodeIndices:l,tensorIndices:c,inputTensors:a,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:o},s);for(var f=0;f<e.length;f++)e[f].sourceLayer=this,e[f].nodeIndex=this.inboundNodes.length-1,e[f].tensorIndex=f},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach(function(t){return t.dispose()}),this.weights.length},e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e}(FA.Serializable),rM=function(t){function e(e){var n=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:UF("input").toString()})||this;if(null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new iP("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new iP("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new iP("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";n.batchInputShape=r,n.dtype=i,n.inputSpec=[{shape:r}];var o=new YF(n.dtype,n.batchInputShape,n,[],{},n.name);return o.nodeIndex=0,o.tensorIndex=0,new tM({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return QD(e,t),e.prototype.apply=function(t,e){throw new iP("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e.className="InputLayer",e}(nM);function iM(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new iP("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));var n=t.dtype;return null==n&&(n="float32"),new rM({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function oM(t){return JD(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u;return tP(this,function(l){switch(l.label){case 0:if(null==t)return[2];for(i in e=[],n=[],r=[],t)"number"!=typeof(o=t[i])&&(e.push((s=o).data()),n.push(i),r.push(s));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(a=l.sent(),u=0;u<a.length;++u)t[n[u]]=a[u][0];cx(r),l.label=2;case 2:return[2]}})})}function sM(t){if(null!=t)for(var e in t){var n=t[e];"number"!=typeof n&&n.dispose()}}FA.registerClass(rM),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(QF||(QF={}));var aM=125,uM=function(){function t(){this.validationData=null}return t.prototype.setParams=function(t){this.params=t},t.prototype.onEpochBegin=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(t){return[2]})})},t.prototype.onEpochEnd=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(t){return[2]})})},t.prototype.onBatchBegin=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(t){return[2]})})},t.prototype.onBatchEnd=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(t){return[2]})})},t.prototype.onTrainBegin=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(t){return[2]})})},t.prototype.onTrainEnd=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(t){return[2]})})},t.prototype.setModel=function(t){},t}(),lM=function(){function t(t,e){void 0===e&&(e=10),null==t&&(t=[]),this.callbacks=t,this.queueLength=e}return t.prototype.append=function(t){this.callbacks.push(t)},t.prototype.setParams=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setParams(t)},t.prototype.setModel=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setModel(t)},t.prototype.onEpochBegin=function(t,e){return JD(this,void 0,void 0,function(){var n,r;return tP(this,function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.onEpochEnd=function(t,e){return JD(this,void 0,void 0,function(){var n,r;return tP(this,function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.onBatchBegin=function(t,e){return JD(this,void 0,void 0,function(){var n,r;return tP(this,function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.onBatchEnd=function(t,e){return JD(this,void 0,void 0,function(){var n,r;return tP(this,function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onBatchEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.onTrainBegin=function(t){return JD(this,void 0,void 0,function(){var e,n;return tP(this,function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainBegin(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.onTrainEnd=function(t){return JD(this,void 0,void 0,function(){var e,n;return tP(this,function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainEnd(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t}(),cM=function(t){function e(){return t.call(this)||this}return QD(e,t),e.prototype.onEpochBegin=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(t){return this.seen=0,this.totals={},[2]})})},e.prototype.onBatchEnd=function(t,e){return JD(this,void 0,void 0,function(){var t,n,r,i,o=this;return tP(this,function(s){for(i in null==e&&(e={}),this.seen+=t=null==e.size?0:e.size,n=function(n){var i=e[n];if("number"==typeof i)r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+i*t;else{var s=void 0;n in r.totals?s=r.totals[n]:r.totals[n]=0,r.totals[n]=lx(function(){return eI(o.totals[n],fI(i,t))}),null!=s&&s.dispose()}},r=this,e)n(i);return[2]})})},e.prototype.onEpochEnd=function(t,e){return JD(this,void 0,void 0,function(){var t,n,r,i,o=this;return tP(this,function(s){if(null!=e)for(t=function(t){if(null==n.totals[t])return"continue";"number"==typeof n.totals[t]?e[t]=n.totals[t]/n.seen:lx(function(){e[t]=fI(oI(1,o.seen),o.totals[t]),o.totals[t].dispose(),hx(e[t])})},n=this,r=0,i=this.params.metrics;r<i.length;r++)t(i[r]);return[2]})})},e}(uM),hM=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.onTrainBegin=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(t){return this.epoch=[],this.history={},[2]})})},e.prototype.onEpochEnd=function(t,e){return JD(this,void 0,void 0,function(){var n;return tP(this,function(r){for(n in null==e&&(e={}),this.epoch.push(t),e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n]);return[2]})})},e.prototype.syncData=function(){return JD(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a;return tP(this,function(u){switch(u.label){case 0:for(r in t=[],e=[],n=[],this.history)for(i=this.history[r],o=0;o<i.length;++o)"number"!=typeof i[o]&&(t.push(i[o].data()),e.push(r),n.push(o));return[4,Promise.all(t)];case 1:for(s=u.sent(),a=0;a<s.length;++a)this.history[e[a]][n[a]].dispose(),this.history[e[a]][n[a]]=s[a][0];return[2]}})})},e}(uM),pM=function(t){function e(e,n){var r=t.call(this)||this;if(r.currentEpoch=0,r.yieldEvery=n||"auto","auto"===r.yieldEvery&&(r.yieldEvery=aM),"never"===r.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return Nb.isNumber(r.yieldEvery)&&(r.maybeWait=function(t,e){var n,r=Nb.now();return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=Nb.now();return s-r<e?n:(r=s,n=t.apply(void 0,i))}}(r.maybeWait.bind(r),r.yieldEvery)),r.trainBegin=e.onTrainBegin,r.trainEnd=e.onTrainEnd,r.epochBegin=e.onEpochBegin,r.epochEnd=e.onEpochEnd,r.batchBegin=e.onBatchBegin,r.batchEnd=e.onBatchEnd,r.yield=e.onYield,r}return QD(e,t),e.prototype.maybeWait=function(t,e,n){return JD(this,void 0,void 0,function(){var r;return tP(this,function(i){switch(i.label){case 0:return r=[],null==this.yield?[3,2]:[4,oM(n)];case 1:i.sent(),r.push(this.yield(t,e,n)),i.label=2;case 2:return r.push(eR()),[4,Promise.all(r)];case 3:return i.sent(),[2]}})})},e.prototype.onEpochBegin=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){switch(n.label){case 0:return this.currentEpoch=t,null==this.epochBegin?[3,3]:[4,oM(e)];case 1:return n.sent(),[4,this.epochBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.onEpochEnd=function(t,e){return JD(this,void 0,void 0,function(){var n;return tP(this,function(r){switch(r.label){case 0:return n=[],null==this.epochEnd?[3,2]:[4,oM(e)];case 1:r.sent(),n.push(this.epochEnd(t,e)),r.label=2;case 2:return"epoch"===this.yieldEvery&&n.push(eR()),[4,Promise.all(n)];case 3:return r.sent(),[2]}})})},e.prototype.onBatchBegin=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,oM(e)];case 1:return n.sent(),[4,this.batchBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.onBatchEnd=function(t,e){return JD(this,void 0,void 0,function(){var n;return tP(this,function(r){switch(r.label){case 0:return n=[],null==this.batchEnd?[3,2]:[4,oM(e)];case 1:r.sent(),n.push(this.batchEnd(t,e)),r.label=2;case 2:return"batch"===this.yieldEvery?n.push(eR()):Nb.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),[4,Promise.all(n)];case 3:return r.sent(),[2]}})})},e.prototype.onTrainBegin=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(e){switch(e.label){case 0:return null==this.trainBegin?[3,3]:[4,oM(t)];case 1:return e.sent(),[4,this.trainBegin(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},e.prototype.onTrainEnd=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(e){switch(e.label){case 0:return null==this.trainEnd?[3,3]:[4,oM(t)];case 1:return e.sent(),[4,this.trainEnd(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},e}(uM);function dM(t,e){return null==t&&(t={}),t instanceof uM?[t]:Array.isArray(t)&&t[0]instanceof uM?t:hP(t).map(function(t){return new pM(t,e)})}var fM=function(){function t(){}return t.registerCallbackConstructor=function(e,n){Nb.assert(e>=0&&Number.isInteger(e),function(){return"Verbosity level is expected to be an integer >= 0, but got "+e}),t.checkForDuplicate(n),null==t.constructors[e]&&(t.constructors[e]=[]),t.constructors[e].push(n)},t.checkForDuplicate=function(e){for(var n in t.constructors)t.constructors[+n].forEach(function(t){if(t===e)throw new iP("Duplicate callback constructor.")})},t.clear=function(){t.constructors={}},t.createCallbacks=function(e){var n=[];for(var r in t.constructors){var i=+r;e>=i&&n.push.apply(n,t.constructors[i])}return n.map(function(t){return new t})},t.constructors={},t}();function mM(t,e,n,r,i,o,s,a,u){var l=new hM,c=[new cM].concat(fM.createCallbacks(e));null!=t&&c.push.apply(c,t),c.push(l);var h=new lM(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:o,batchSize:s,verbose:e,doValidation:a,metrics:u}),{callbackList:h,history:l}}function gM(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=!1),gP(t,FA.SerializationMap.getMap().classNameMap,e,"layer",n)}function yM(t,e){return lx(function(){"float32"!==t.dtype&&(t=t.asType("float32"));var n=VN(cF(t),e,!0),r=Yx(n.shape,eP()),i=zk(uI(n,r));return oI(t,i)})}function vM(t,e){return lx(function(){return zN(cF(wI(e,t)),-1)})}function bM(t,e){return lx(function(){return zN(uk(wI(e,t)),-1)})}function wM(t,e){return lx(function(){var n=wI(t,e),r=gk(uk(t),eP(),Number.MAX_VALUE),i=uk(oI(n,r));return fI(100,zN(i,-1))})}function xM(t,e,n){return void 0===n&&(n=!1),lx(function(){if(n)e=fC(e);else{var r=VN(e,e.shape.length-1,!0);e=oI(e,r)}return e=gk(e,eP(),1-eP()),kk(VN(fI(t.toFloat(),Ck(e)),e.shape.length-1))})}function _M(t,e){return lx(function(){var n=_k(function(t){var e=[KP(t.shape)];return t.reshape(e)}(t)).toInt(),r=(e=gk(e,eP(),1-eP())).shape;return xM(A_(n,r[r.length-1]).reshape(r),e,!1)})}function CM(t,e){return lx(function(){var n;return n=gk(e,eP(),1-eP()),n=Ck(oI(n,wI(1,n))),zN(function(t,e){if(!Nb.arraysEqual(t.shape,e.shape))throw new iP("logits and labels must have the same shape, but got shapes "+JSON.stringify(t.shape)+" and "+JSON.stringify(e.shape));return lx(function(){var n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())})}(t,n),-1)})}function SM(t,e){return lx(function(){var n=yM(t,-1),r=yM(e,-1),i=fI(n,r);return kk(VN(i,-1))})}var EM={meanSquaredError:vM,meanAbsoluteError:bM,meanAbsolutePercentageError:wM,meanSquaredLogarithmicError:function(t,e){return lx(function(){var n=gk(e,eP(),Number.MAX_VALUE),r=Ck(eI(1,n)),i=gk(t,eP(),Number.MAX_VALUE),o=Ck(eI(1,i));return zN(cF(wI(r,o)),-1)})},squaredHinge:function(t,e){return lx(function(){var n=uI(0,wI(1,fI(t,e)));return zN(cF(n),-1)})},hinge:function(t,e){return lx(function(){var n=uI(0,wI(1,fI(t,e)));return zN(n,-1)})},categoricalHinge:function(t,e){return lx(function(){var n=VN(fI(t,e),-1),r=LN(fI(wI(1,t),e),-1);return uI(0,eI(1,wI(r,n)))})},logcosh:function(t,e){return lx(function(){var n=Math.log(2),r=wI(e,t),i=wI(eI(r,Lk(fI(-2,r))),n);return zN(i,-1)})},categoricalCrossentropy:xM,sparseCategoricalCrossentropy:_M,binaryCrossentropy:CM,kullbackLeiblerDivergence:function(t,e){return lx(function(){var n=gk(t,eP(),1),r=gk(e,eP(),1);return VN(fI(t,Ck(oI(n,r))),-1)})},poisson:function(t,e){return lx(function(){var n=Ck(eI(eP(),e));return zN(wI(e,fI(t,n)),-1)})},cosineProximity:SM};function kM(t){if("string"==typeof t){if(t in EM)return EM[t];var e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss "+t+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new iP(e)}return t}function NM(t,e){return lx(function(){var n=fI(.5,e_(e)),r=JP(qN(e,n),t.dtype);return zN(WN(t,r),-1)})}function IM(t,e){return lx(function(){return JP(WN(PN(t,-1),PN(e,-1)),"float32")})}function TM(t,e){return lx(function(){return _I(t.equal(1),e.equal(1)).sum().cast("float32")})}function AM(t,e){return lx(function(){var n=TM(t,e),r=function(t,e){return lx(function(){return _I(t.equal(0),e.equal(1)).sum().cast("float32")})}(t,e),i=n.add(r);return kI(qN(i,0),n.div(i),0).cast("float32")})}function RM(t,e){return CM(t,e)}function OM(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),WN(t,e).asType("float32")}var DM=xM,PM=_M,FM={binaryAccuracy:NM,categoricalAccuracy:IM,precision:AM,categoricalCrossentropy:DM,sparseCategoricalCrossentropy:PM,mse:vM,MSE:vM,mae:bM,MAE:bM,mape:wM,MAPE:wM,cosine:SM};function MM(t){if(uP(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;for(var e=void 0,n=0,r=Object.keys(EM);n<r.length;n++){var i=r[n];if(EM[i]===t){e=i;break}}if(void 0!==e)return e;for(var o=0,s=Object.keys(FM);o<s.length;o++)if(FM[i=s[o]]===t){e=i;break}return void 0!==e?e:t.name}function LM(t,e,n){void 0===n&&(n=console.log);for(var r="",i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[i]).slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function zM(t,e,n){var r;try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}LM([t.name+" ("+t.getClassName()+")",r,t.countParams().toString()],e,n)}function BM(t,e,n,r){var i;try{i=JSON.stringify(t.outputShape)}catch(t){i="multiple"}for(var o=[],s=0,a=t.inboundNodes;s<a.length;s++){var u=a[s];if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var l=0;l<u.inboundLayers.length;++l)o.push(u.inboundLayers[l].name+"["+u.nodeIndices[l]+"]["+u.tensorIndices[l]+"]")}var c=t.name,h=t.getClassName(),p=0===o.length?"":o[0];for(LM([c+" ("+h+")",i,t.countParams().toString(),p],e,r),l=1;l<o.length;++l)LM(["","","",o[l]],e,r)}function UM(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function VM(t,e){if(null===t)return null;if("string"==typeof t)return dP(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var n=[],r=t.length,i=0;i<r;++i){var o=t[i];UM(e,i,o)?n.push(o):n.push(VM(o,e))}return n}for(var s={},a=0,u=Object.keys(t);a<u.length;a++){var l=u[a],c=t[l];if("name"===l&&"string"==typeof c)s[l]=c;else{var h=dP(l);s[h]=VM(c,h)}}return s}var jM=function(){function t(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof t)for(var n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(null==e)return;for(var r=0,i=e;r<i.length;r++){var o=i[r];this.add(o.key,o.value)}}}return t.prototype.add=function(t,e,n){if(null!=this.id2Value[t.id])throw new iP("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return C_(e,t.dtype)}catch(n){throw new iP("The dtype of the feed ("+e.dtype+") can not be cast to the dtype of the key '"+t.name+"' ("+t.dtype+").")}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this},t.prototype.addFeed=function(t){this.add(t.key,t.value)},t.prototype.hasKey=function(t){return null!=this.id2Value[t.id]},t.prototype.names=function(){return Object.keys(this.name2Id)},t.prototype.getValue=function(t){if(t instanceof YF){if(null==this.id2Value[t.id])throw new iP("Nonexistent key: "+t.name);return this.id2Value[t.id]}var e=this.name2Id[t];if(null==e)throw new iP("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]},t.prototype.getMask=function(t){if(t instanceof YF){if(null==this.id2Value[t.id])throw new iP("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var e=this.name2Id[t];if(null==e)throw new iP("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]},t.prototype.disposeMasks=function(){null!=this.id2Mask&&cx(this.id2Mask)},t}(),WM={},HM={};function qM(t,e,n,r){for(var i=null!=n&&n.training,o=Array.isArray(t),s=o?t:[t],a=s.map(function(t){return t.name}),u=[],l=e.names(),c=0,h=a;c<h.length;c++){var p=h[c];-1!==l.indexOf(p)?u.push(e.getValue(p)):u.push(null)}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var d,f,m=a.join(",")+"|"+e.names().join(",");if(null==WM[m]){var g=function(t,e){Nb.assert(null!=t&&t.length>0,function(){return"Expected at least one fetch, got none"});var n=[],r={};if(1===t.length){var i=GM(t[0],e);n=i.sorted,r=i.recipientMap}else for(var o=new Set,s=0,a=t;s<a.length;s++){for(var u=GM(a[s],e),l=u.recipientMap,c=0,h=u.sorted;c<h.length;c++){var p=h[c];o.has(p.name)||(n.push(p),o.add(p.name))}var d=function(t){null==r[t]&&(r[t]=new Set),l[t].forEach(function(e){return r[t].add(e)})};for(var f in l)d(f)}return{sorted:n,recipientCounts:$M(r)}}(s,e);f=g.recipientCounts,WM[m]=d=g.sorted,HM[m]=f}d=WM[m],f={},i||Object.assign(f,HM[m]);for(var y=new jM(e),v=0;v<d.length;++v){if(null!=r){var b=ax().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var w=d[v],x=w.sourceLayer;if(!(x instanceof rM)){for(var _=[],C=[],S=[],E=!1,k=0,N=w.inputs;k<N.length;k++){var I=N[k],T=y.getValue(I),A=y.getMask(I);_.push(T),C.push(A),null!=A&&(E=!0),i||(f[I.name]--,0!==f[I.name]||e.hasKey(I)||-1!==a.indexOf(I.name)||T.isDisposed||!0===I.sourceLayer.stateful||S.push(T))}E&&((n=n||{}).mask=C[0]);var R=hP(x.apply(_,n)),O=null;x.supportsMasking&&(O=x.computeMask(_,C));for(var D=KM(w),P=Array.isArray(D)?D:[D],F=0;F<P.length;++F){y.hasKey(P[F])||y.add(P[F],R[F],Array.isArray(O)?O[0]:O);var M=a.indexOf(P[F].name);-1!==M&&(u[M]=R[F])}i||cx(S)}}return y.disposeMasks(),o?u:u[0]}function $M(t){var e={};for(var n in t)e[n]=t[n].size;return e}function GM(t,e){for(var n=new Set,r=[],i={},o=0,s=e.names();o<s.length;o++)n.add(s[o]);var a=[],u=[];for(a.push(t);a.length>0;){var l=a[a.length-1];if(n.has(l.name))a.pop();else{var c=u[u.length-1]===a.length-1;if(0===l.inputs.length||c)a.pop(),r.push(l),n.add(l.name),c&&u.pop();else{u.push(a.length-1);for(var h=0,p=l.inputs;h<p.length;h++){var d=p[h];null==i[d.name]&&(i[d.name]=new Set),i[d.name].add(l.name),n.has(d.name)||a.push(d)}}}}return{sorted:r,recipientMap:i}}function KM(t){var e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{for(var n=null,r=0;r<t.sourceLayer.inboundNodes.length;++r)for(var i=0,o=t.sourceLayer.inboundNodes[r].outputTensors;i<o.length;i++)if(o[i].id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}var XM=function(t){function e(n){var r=t.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var i=r.getClassName().toLowerCase();r.name=UF(i)}if(r.supportsMasking=!1,r.trainable_=!0,r.inputs=Array.isArray(n.inputs)?n.inputs.slice():[n.inputs],r.outputs=Array.isArray(n.outputs)?n.outputs.slice():[n.outputs],vP(r.inputs).length!==r.inputs.length)throw new iP("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(t){return t.name}));vP(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(t){return t.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[];for(var o=0,s=r.outputs;o<s.length;o++){var a=(k=s[o]).sourceLayer,u=k.nodeIndex,l=k.tensorIndex;r.outputLayers.push(a),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,h=r.inputs;c<h.length;c++)a=(k=h[c]).sourceLayer,l=k.tensorIndex,uP(0===(u=k.nodeIndex),"input layer has >1 nodes"),uP(0===l,"input layer has >1 tensors"),r.inputLayers.push(a),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var p=0;p<r.inputLayers.length;p++){if(!((a=r.inputLayers[p])instanceof rM))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+p+" (0-based) originates from layer type "+a.getClassName()+".");r.inputNames.push(a.name),r.feedInputShapes.push(a.batchInputShape),r.feedInputNames.push(a.name)}for(var d=0,f=r.outputLayers;d<f.length;d++)r.outputNames.push((a=f[d]).name);r.internalInputShapes=r.inputs.map(function(t){return t.shape}),r.internalOutputShapes=r.outputs.map(function(t){return t.shape});for(var m={},g={},y={},v={},b={},w=[],x=function(t,n,i,o,s,a){null!=o&&null!=s&&null!=a||(o=t.sourceLayer,s=t.nodeIndex,a=t.tensorIndex);var u=o.inboundNodes[s];if(-1!==i.indexOf(u))throw new rP("The tensor "+t.name+' at layer "'+o.name+'" is part of a cycle.');if(-1===n.indexOf(u)){r.containerNodes.add(e.nodeKey(o,s)),o.id in b||(b[o.id]=Object.keys(b).length),-1===i.indexOf(u)&&i.push(u);for(var l=u.inboundLayers.length,c=0;c<l;c++)x(u.inputTensors[c],n,i,u.inboundLayers[c],u.nodeIndices[c],u.tensorIndices[c]);for(n.push(u);i.indexOf(u)>=0;)i.splice(i.indexOf(u),1);w.push(u)}},_=[],C=[],S=0,E=r.outputs;S<E.length;S++){var k=E[S];x(k,_,C)}for(var N=0,I=w.slice().reverse();N<I.length;N++){g[(G=I[N]).id]=G,G.id in m||(m[G.id]=0);var T=m[G.id];for(T=Math.max(T,null==y[G.outboundLayer.id]?0:y[G.outboundLayer.id]),y[G.outboundLayer.id]=T,v[G.outboundLayer.id]=G.outboundLayer,m[G.id]=T,p=0;p<G.inboundLayers.length;p++){var A=G.inboundLayers[p].inboundNodes[u=G.nodeIndices[p]];m[A.id]=Math.max(T+1,null==m[A.id]?0:m[A.id]),g[A.id]=A}}var R={};for(var O in m)(T=m[O])in R||(R[T]=[]),R[T].push(g[O]);var D={};for(var P in y)(T=y[P])in D||(D[T]=[]),D[T].push(v[P]);var F=Object.keys(D).map(function(t){return parseInt(t,10)}).sort(yP);r.layers=[];for(var M=0,L=F;M<L.length;M++){var z=D[T=L[M]];z.sort(function(t,e){var n=b[t.id],r=b[e.id];return n<r?-1:n>r?1:0});for(var B=0,U=z;B<U.length;B++)r.layers.push(a=U[B])}r.layersByDepth=D,F=Object.keys(R).map(function(t){return parseInt(t,10)}).sort(yP);for(var V=r.inputs.slice(),j=[],W=0,H=F;W<H.length;W++)for(var q=0,$=R[T=H[W]];q<$.length;q++){var G;if(null!=(a=(G=$[q]).outboundLayer)){for(var K=0,X=G.inputTensors;K<X.length;K++)if(-1===V.indexOf(k=X[K]))throw new rP("Graph disconnected: cannot obtain value for tensor "+k+' at layer "'+a.name+'". The following previous layers were accessed without issue: '+j);for(var Q=0,Z=G.outputTensors;Q<Z.length;Q++)V.push(k=Z[Q]);j.push(a.name)}}r.nodesByDepth=R;for(var Y=r.layers.map(function(t){return t.name}),J=function(t){var e=Y.filter(function(e){return e===t}).length;if(1!==e)throw new rP('The name "'+t+'" is used '+e+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(Y))},tt=0,et=Y;tt<et.length;tt++)J(et[tt]);return r.outboundNodes=[],r.inboundNodes=[],new tM({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(t){return null}),outputMasks:r.outputs.map(function(t){return null}),inputShapes:r.inputs.map(function(t){return t.shape}),outputShapes:r.outputs.map(function(t){return t.shape})}),r.built=!0,r._refCount=1,r}return QD(e,t),e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount)for(var e=0,n=this.layers;e<n.length;e++)t.numDisposedVariables+=n[e].dispose().numDisposedVariables;return t.refCountAfterDispose=this._refCount,t},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach(function(e){e._trainableWeights.forEach(function(e){return e.trainable=t})}),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new iP("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var t=[],e=0,n=this.layers;e<n.length;e++)t=t.concat(n[e].trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var i=[],o=0,s=this.layers;o<s.length;o++)i.push.apply(i,(r=s[o]).trainableWeights);return i.concat(t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.loadWeights=function(t,e){void 0===e&&(e=!0);for(var n={},r=0,i=0,o=this.layers;i<o.length;i++)for(var s=0,a=o[i].weights;s<a.length;s++){var u=a[s];if(null!=n[u.originalName])throw new iP("Duplicate weight name: "+u.originalName);n[u.originalName]=u,r++}var l=[];for(var c in t){if(null!=n[c])l.push([n[c],t[c]]);else if(e)throw new iP("Provided weight data has no target variable: "+c);delete n[c]}if(e){var h=[];for(var p in n)h.push(p);if(h.length>0)throw new iP(h.length+" of "+r+" weights are not set: "+h)}XF(l)},e.prototype.updatedConfig=function(){var t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 1.2.6",e.backend="TensorFlow.js",e},e.prototype.toJSON=function(t,e){void 0===e&&(e=!0);var n=function t(e,n){if(null==e)return null;if("string"==typeof e)return pP(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var r=[],i=e.length,o=0;o<i;++o){var s=e[o];UM(n,o,s)?r.push(s):r.push(t(s,n))}return r}for(var a={},u=0,l=Object.keys(e);u<l.length;u++){var c=l[u],h=e[c];a[pP(c)]="name"!==c&&"className"!==c||"string"!=typeof h?t(h,c):h}return a}(this.updatedConfig());return e?JSON.stringify(n):n},e.prototype.call=function(t,e){var n=this;return lx(function(){t=hP(t);for(var r=new jM,i=0;i<n.inputs.length;++i)r.add(n.inputs[i],t[i]);return qM(n.outputs,r,e)})},e.prototype.computeMask=function(t,e){var n=this;return lx(function(){var r;return t=hP(t),r=null==e?aP(null,t.length):hP(e),n.runInternalGraph(t,r)[1]})},e.prototype.computeOutputShape=function(t){var e=jF(t);if(e.length!==this.inputLayers.length)throw new iP("Invalid inputShape argument "+t+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},r=0;r<e.length;r++){var i=this.inputLayers[r];n[b=i.name+"_0_0"]=e[r]}var o=Object.keys(this.nodesByDepth).map(function(t){return parseInt(t,10)}).sort(yP);if(o.length>1)for(var s=0,a=o;s<a.length;s++)for(var u=0,l=this.nodesByDepth[a[s]];u<l.length;u++){var c=l[u];if(i=c.outboundLayer,-1===this.inputLayers.map(function(t){return t.id}).indexOf(i.id)){for(var h=[],p=0;p<c.inboundLayers.length;p++){var d=c.tensorIndices[p],f=n[b=c.inboundLayers[p].name+"_"+c.nodeIndices[p]+"_"+d];h.push(f)}var m=jF(i.computeOutputShape(cP(h))),g=i.inboundNodes.indexOf(c);for(p=0;p<m.length;p++)n[b=i.name+"_"+g+"_"+p]=m[p]}}var y=[],v=[];for(r=0;r<this.outputLayers.length;r++){var b=(i=this.outputLayers[r]).name+"_"+(g=this.outputLayersNodeIndices[r])+"_"+(d=this.outputLayersTensorIndices[r]);v.push(b)}for(r=0;r<v.length;r++){var w=v[r];uP(w in n),y.push(n[w])}return cP(y)},e.prototype.runInternalGraph=function(t,e){null==e&&(e=aP(null,t.length));for(var n={},r=0;r<this.inputs.length;++r){var i=this.inputs[r],o=t[r],s=e[r];n[i.id]=[o,s]}for(var a=0,u=Object.keys(this.nodesByDepth).map(function(t){return parseInt(t,10)}).sort(yP);a<u.length;a++)for(var l=0,c=this.nodesByDepth[u[a]];l<c.length;l++){for(var h=c[l],p=h.outboundLayer,d=h.inputTensors,f=h.outputTensors,m=new Array,g=0,y=d;g<y.length;g++)(i=y[g]).id in n&&m.push(n[i.id]);if(m.length===d.length){var v={},b=void 0,w=void 0,x=void 0,_=void 0;if(null!=h.callArgs&&(v=h.callArgs),1===m.length){var C=m[0],S=C[0],E=C[1];null==v.mask&&(v.mask=E),x=hP(p.call(S,v)),_=hP(p.computeMask(S,E)),b=[S],w=[E]}else b=m.map(function(t){return t[0]}),w=m.map(function(t){return t[1]}),null==v.mask&&(v.mask=w),x=hP(p.call(b,v)),_=hP(p.computeMask(b,w));if(p.activityRegularizer)throw new oP("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(r=0;r<f.length;++r)n[(i=f[r]).id]=[o=x[r],s=_[r]]}}for(var k=[],N=[],I=[],T=0,A=this.outputs;T<A.length;T++){uP((i=A[T]).id in n,"Could not compute output "+i.name+" : "+i.id);var R=n[i.id],O=R[0];s=R[1],I.push(O.shape),k.push(O),N.push(s)}return[k,N,I]},e.prototype.buildNodeConversionMap=function(t){for(var n,r={},i=0,o=this.layers;i<o.length;i++){var s=o[i];n=s instanceof e?1:0;for(var a=0;a<s.inboundNodes.length;a++){var u=e.nodeKey(s,a);this.containerNodes.has(u)&&(r[u]=n,n+=1)}}return r},e.prototype.getLayer=function(t,e){if(null!=e){if(this.layers.length<=e)throw new iP("Was asked to retrieve layer at index "+e+", but model only has "+this.layers.length+" layer(s).");return this.layers[e]}if(null==t)throw new iP("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var i=r[n];if(i.name===t)return i}throw new iP("No such layer: "+t)},e.prototype.calculateLosses=function(){var t=this;return lx(function(){for(var n=[],r=0,i=t.layers;r<i.length;r++)for(var o=i[r],s=0;s<o.inboundNodes.length;++s){var a=e.nodeKey(o,s);t.containerNodes.has(a)&&n.push.apply(n,o.calculateLosses())}return n})},e.prototype.getConfig=function(){for(var t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],i=0,o=this.layers;i<o.length;i++){for(var s=(w=o[i]).getClassName(),a=w.getConfig(),u=[],l=0;l<w.inboundNodes.length;l++){var c=w.inboundNodes[l],h=e.nodeKey(w,l),p={};if(this.containerNodes.has(h)){if(c.callArgs)try{JSON.stringify(c.callArgs),p=c.callArgs}catch(t){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+c.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),p={}}if(c.inboundLayers.length>0){for(var d=[],f=0;f<c.inboundLayers.length;f++){var m=c.inboundLayers[f],g=c.nodeIndices[f],y=c.tensorIndices[f];null==(_=n[e.nodeKey(m,g)])&&(_=0),d.push([m.name,_,y,p])}u.push(d)}}}var v={};v.name=w.name,v.className=s,v.config=a,v.inboundNodes=u,r.push(v)}t.layers=r;var b=[];for(f=0;f<this.inputLayers.length;f++){var w=this.inputLayers[f];h=e.nodeKey(w,g=this.inputLayersNodeIndices[f]),this.containerNodes.has(h)&&(null!==(_=n[h])&&void 0!==_||(_=0),b.push([w.name,_,y=this.inputLayersTensorIndices[f]]))}t.inputLayers=b;var x=[];for(f=0;f<this.outputLayers.length;f++){var _;h=e.nodeKey(w=this.outputLayers[f],g=this.outputLayersNodeIndices[f]),this.containerNodes.has(h)&&(null!==(_=n[h])&&void 0!==_||(_=0),x.push([w.name,_,y=this.outputLayersTensorIndices[f]]))}return t.outputLayers=x,t},e.fromConfig=function(t,e,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var i={},o={};function s(t,e){t.name in o?o[t.name].push(e):o[t.name]=[e]}function a(t,e){for(var n,r=[],o=0,a=e;o<a.length;o++){var u=a[o],l=u[0],c=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(l in i))return void s(t,e);var p=i[l];if(p.inboundNodes.length<=c)return void s(t,e);r.push(p.inboundNodes[c].outputTensors[h])}r.length>0&&t.apply(cP(r),n)}function u(t){var n=t.name,o=gM(t,null!=e.customObjects?e.customObjects:{});o.setFastWeightInitDuringBuild(r),i[n]=o,t.inboundNodes.forEach(function(t){if(!(t instanceof Array))throw new iP("Corrupted configuration, expected array for nodeData: "+t);s(o,t)})}for(var l=e.name,c=e.layers,h=0,p=c;h<p.length;h++)u(m=p[h]);for(;!bP(o);)for(var d=0,f=c;d<f.length;d++){var m=f[d];if((T=i[m.name]).name in o){var g=o[T.name];delete o[T.name];for(var y=0,v=g;y<v.length;y++)a(T,v[y])}}for(var b=[],w=[],x=0,_=e.inputLayers;x<_.length;x++){var C=(m=_[x])[0],S=m[1],E=m[2];uP(C in i);var k=(T=i[C]).inboundNodes[S].outputTensors;b.push(k[E])}for(var N=0,I=e.outputLayers;N<I.length;N++){var T;C=(m=I[N])[0],S=m[1],E=m[2],uP(C in i),k=(T=i[C]).inboundNodes[S].outputTensors,w.push(k[E])}return new t({inputs:b,outputs:w,name:l})},Object.defineProperty(e.prototype,"stateful",{get:function(){if(this._stateful)throw new iP("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var t=0,e=this.layers;t<e.length;t++)if(e[t].stateful)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){var t=this;lx(function(){t.layers.forEach(function(t){t.stateful&&t.resetStates()})})},e}(nM);function QM(t,e){return function(t,e,n){var r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(function(t){return null});if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided "+n+" is an array of "+t.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){var i=[];return e.forEach(function(e){i.push(e in t?t[e]:null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+e+" keys. Provided "+n+" not understood: "+JSON.stringify(t))}(t,e,"classWeight")}function ZM(t,e,n,r){return JD(this,void 0,void 0,function(){var i,o,s,a,u;return tP(this,function(l){switch(l.label){case 0:if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");return null==n?[3,2]:(i=lx(function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+t.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+t.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),a=(s=Array).from,[4,i.data()]);case 1:return o=a.apply(s,[l.sent()]),cx(i),u=[],o.forEach(function(t){if(null==n[t])throw new Error("classWeight must contain all classes in the training data. The class "+t+" exists in the data but not in classWeight");u.push(n[t])}),[2,Hx(u,"float32")];case 2:return[2,null]}})})}function YM(t,e){return fI(t,e)}var JM=32;function tL(t,e){var n,r;r=e.ys,Nb.assert(null!=(n=e.xs)&&null!=r,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e});var i=eL("input",t.inputNames,n),o=eL("output",t.outputNames,r),s=i[0].shape[0];Nb.assert(i.length===t.inputs.length,function(){return"LayersModel has "+t.inputs.length+" inputs, but the dataset provides "+i.length+" inputs.  (Expected input keys: "+JSON.stringify(t.inputNames)+")"}),Nb.assert(o.length===t.outputs.length,function(){return"LayersModel has "+t.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(t.outputNames)+")"});var a=function(e){Nb.assert(i[e].shape[0]===s,function(){return"Batch size mismatch: input "+t.inputNames[e]+" has "+i[e].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."})};for(var u in i)a(u);var l=function(e){Nb.assert(o[e].shape[0]===s,function(){return"Batch size mismatch: output "+t.outputNames[e]+" has "+o[e].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."})};for(var c in o)l(c);return{xs:i,ys:o}}function eL(t,e,n){if(n instanceof zb)return[n];if(Array.isArray(n))return Nb.assert(n.length===e.length,function(){return"Received an array of "+n.length+" Tensors, but expected "+e.length+" to match the "+t+" keys "+e+"."}),n;for(var r=[],i=0,o=e;i<o.length;i++){var s=o[i];if(null==n[s])throw new iP("The feature data generated by the dataset lacks the required "+t+" key '"+s+"'.");r.push(n[s])}return r}function nL(t,e,n){return JD(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_,C,S,E,k,N,I,T,A,R,O,D,P;return tP(this,function(F){switch(F.label){case 0:if(r=null!=n.batchesPerEpoch,Nb.assert(null!=t.optimizer,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),Nb.assert(null!=n,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),Nb.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs}),Nb.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch}),Nb.assert(null==n.validationSplit,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,F.label=1;case 1:return F.trys.push([1,,26,27]),o=void 0,s=void 0,(i=null!=n.validationData)&&(rL(n.validationData)?Nb.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches}):(a=function(t){if(3===t.length)throw new oP("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData),o=a.xs,s=a.ys)),u=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),c=i?l.slice().concat(l.map(function(t){return"val_"+t})):l.slice(),h=dM(n.callbacks,n.yieldEvery),p=mM(h,null==n.verbose?1:n.verbose,n.epochs,null,null,function(t,e){var n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,i,c),f=p.history,(d=p.callbackList).setModel(t),t.history=f,[4,d.onTrainBegin()];case 2:return F.sent(),t.stopTraining_=!1,m=null==n.initialEpoch?0:n.initialEpoch,[4,e.iterator()];case 3:g=F.sent(),F.label=4;case 4:return m<n.epochs?(y={},[4,d.onEpochBegin(m)]):[3,23];case 5:return F.sent(),v=0,b=0,r?[3,7]:[4,e.iterator()];case 6:g=F.sent(),F.label=7;case 7:return!r||v<n.batchesPerEpoch?[4,g.next()]:[3,21];case 8:return w=F.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+v+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):null==w.value?[3,15]:(x=tL(t,w.value),_=x.xs,C=x.ys,(S={}).batch=b,S.size=_[0].shape[0],[4,d.onBatchBegin(b,S)]);case 9:if(F.sent(),E=[],null==n.classWeight)return[3,13];k=QM(n.classWeight,t.outputNames),P=0,F.label=10;case 10:return P<k.length?(I=(N=E).push,[4,ZM(C[P],null,k[P])]):[3,13];case 11:I.apply(N,[F.sent()]),F.label=12;case 12:return++P,[3,10];case 13:for(T=_.concat(C).concat(E),A=u(T),cx(T),P=0;P<l.length;++P)S[l[P]]=R=A[P],hx(R);return[4,d.onBatchEnd(b,S)];case 14:F.sent(),sM(S),b++,v++,F.label=15;case 15:return(r?v>=n.batchesPerEpoch:w.done)?i?(O=void 0,rL(n.validationData)?(D=hP,[4,t.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return O=D.apply(void 0,[F.sent()]),[3,18];case 17:O=hP(t.evaluate(o,s,{batchSize:null==n.validationBatchSize?JM:n.validationBatchSize,verbose:0})),F.label=18;case 18:for(P=0;P<t.metricsNames.length;++P)y["val_"+t.metricsNames[P]]=O[P];F.label=19;case 19:return[3,21];case 20:return t.stopTraining_?[3,21]:[3,7];case 21:return[4,d.onEpochEnd(m,y)];case 22:return F.sent(),m++,t.stopTraining_?[3,23]:[3,4];case 23:return[4,d.onTrainEnd()];case 24:return F.sent(),[4,t.history.syncData()];case 25:return F.sent(),[2,t.history];case 26:return t.isTraining=!1,[7];case 27:return[2]}})})}function rL(t){return"function"==typeof t.iterator}function iL(t,e,n){return JD(this,void 0,void 0,function(){var r,i,o,s,a,u,l,c,h,p;return tP(this,function(d){switch(d.label){case 0:if(r=null!=(n=n||{}).batches,i=t.testFunction,o=[],n.verbose>0)throw new oP("Verbose mode is not implemented yet.");return Nb.assert(!r||n.batches>0&&Number.isInteger(n.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)}),"function"==typeof e.next?(a=e,[3,3]):[3,1];case 1:return[4,e.iterator()];case 2:a=d.sent(),d.label=3;case 3:s=a,u=0,l=0,c=function(){var e;return tP(this,function(a){switch(a.label){case 0:return[4,s.next()];case 1:return e=a.sent(),o=lx(function(){if(e.value){var n=tL(t,e.value),r=n.xs.concat(n.ys),s=lx(function(){return i(r)});if(cx(r),0===l)for(var a=0;a<s.length;++a)o.push(Wx(0));var c=r[0].shape[0],h=function(t){var e=s[t],n=o[t];o[t]=lx(function(){return eI(o[t],fI(c,e))}),l>0&&cx(n)};for(a=0;a<s.length;++a)h(a);cx(s),u+=c,++l}return o}),e.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},d.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return"break"===d.sent()?[3,6]:[3,4];case 6:for(h=0;h<o.length;++h)p=o[h],o[h]=oI(o[h],u),cx(p);return[2,cP(o)]}})})}function oL(t){Nb.assert(t>0&&Number.isInteger(t),function(){return"batchSize is required to be a positive integer, but got "+t})}function sL(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(function(t){return eF(t,e,n-e)}):eF(t,e,n-e)}function aL(t,e){return lx(function(){return null==t?null:Array.isArray(t)?t.map(function(t){return aL(t,e)}):lF(t,"int32"===e.dtype?e:e.toInt())})}function uL(t,e){for(var n=[],r=0,i=null;r<t;)(i=r+e)>=t&&(i=t),n.push([r,i]),r=i;return n}function lL(t,e,n,r,i,o,s,a,u,l,c,h,p,d,f){return JD(this,void 0,void 0,function(){var m,g,y,v,b,w,x,_;return tP(this,function(C){switch(C.label){case 0:if(null==i&&(i=32),null==o&&(o=1),null==c&&(c=!0),null==p&&(p=0),m=!1,null!=u&&null!=l&&(m=!0),null!=f&&(m=!0,null==d))throw new iP("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(g=t.checkNumSamples(n,i,d,"steps_per_epoch"))&&(y=YP(0,g)),null==s&&(s=1),v=mM(a,s,o,p,g,d,i,m,h),w=v.history,(b=v.callbackList).setModel(t),t.history=w,[4,b.onTrainBegin()];case 1:C.sent(),t.stopTraining_=!1,x=function(o){var s,a,h,p,f;return tP(this,function(v){switch(v.label){case 0:return[4,b.onEpochBegin(o)];case 1:if(v.sent(),s={},null==d)return[3,2];throw new oP("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===c)throw new oP("batch shuffling is not implemneted yet");c&&Nb.shuffle(y),a=Hx(y),h=uL(g,i),p=function(o){var c;return tP(this,function(p){switch(p.label){case 0:return[4,b.onBatchBegin(o,c={})];case 1:return p.sent(),lx(function(){var p=h[o][0],d=h[o][1],f=eF(a,p,d-p);c.batch=o,c.size=d-p;for(var g=aL(n,f),y=e(g),v=0;v<r.length;++v){var b=r[v],w=y[v];c[b]=w,hx(w)}if(o===h.length-1&&m){var x=t.testLoop(u,l,i);for(v=0;v<r.length;++v)b=r[v],hx(w=x[v]),s["val_"+b]=w}}),[4,b.onBatchEnd(o,c)];case 2:return p.sent(),sM(c),t.stopTraining_?[2,"break"]:[2]}})},f=0,v.label=3;case 3:return f<h.length?[5,p(f)]:[3,6];case 4:if("break"===v.sent())return[3,6];v.label=5;case 5:return++f,[3,3];case 6:a.dispose(),v.label=7;case 7:return[4,b.onEpochEnd(o,s)];case 8:return v.sent(),t.stopTraining_?[2,"break"]:[2]}})},_=p,C.label=2;case 2:return _<o?[5,x(_)]:[3,5];case 3:if("break"===C.sent())return[3,5];C.label=4;case 4:return++_,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return C.sent(),[4,t.history.syncData()];case 7:return C.sent(),[2,t.history]}})})}function cL(t,e,n,r){return void 0===r&&(r={}),JD(this,void 0,void 0,function(){var i,o,s,a,u,l,c,h,p,d,f,m,g,y,v,b,w,x,_,C;return tP(this,function(S){switch(S.label){case 0:if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,S.label=1;case 1:return S.trys.push([1,,7,8]),oL(h=null==r.batchSize?32:r.batchSize),[4,t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,h)];case 2:if(p=S.sent(),i=p[0],o=p[1],c=p[2],d=!1,f=void 0,!(null!=r.validationData&&r.validationData.length>0))return[3,4];if(d=!0,2!==r.validationData.length)throw 3===r.validationData.length?new oP("validationData including sample weights is not supported yet."):new iP("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return[4,t.standardizeUserData(s=r.validationData[0],a=r.validationData[1],null,null,!0,h)];case 3:return m=S.sent(),f=(u=m[0]).concat(l=m[1]),[3,5];case 4:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(d=!0,g=Math.floor(i[0].shape[0]*(1-r.validationSplit)),u=sL(i,g,y=i[0].shape[0]),i=sL(i,0,g),l=sL(o,g,y),o=sL(o,0,g),f=u.concat(l)):null!=r.validationSteps&&(d=!0),S.label=5;case 5:return v=i.concat(o).concat(c),t.checkTrainableWeightsConsistency(),b=t.makeTrainFunction(),w=t.getDedupedMetricsNames(),x=void 0,_=void 0,d?(t.makeTestFunction(),x=t.testFunction,_=w.slice().concat(w.map(function(t){return"val_"+t}))):(x=null,f=[],_=w.slice()),C=dM(r.callbacks,r.yieldEvery),[4,lL(t,b,v,w,h,r.epochs,r.verbose,C,x,f,r.shuffle,_,r.initialEpoch,null,null)];case 6:return[2,S.sent()];case 7:return t.isTraining=!1,pL(i,e),pL(o,n),pL(u,s),pL(l,a),null!=c&&cx(c),[7];case 8:return[2]}})})}function hL(t){var e=[];t instanceof zb&&(t=[t]);for(var n=0;n<t.length;++n){var r=t[n];if(1===r.rank)e.push(tF(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function pL(t,e){if(null!=t){var n=[];if(e instanceof zb)n.push(e.id);else if(Array.isArray(e))e.forEach(function(t){return n.push(t.id)});else if(null!=e)for(var r in e)n.push(e[r].id);var i=[];if(t instanceof zb)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach(function(t){-1===n.indexOf(t.id)&&i.push(t)});else if(null!=t)for(var o in t){var s=t[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach(function(t){t.isDisposed||t.dispose()})}}function dL(t){return Array.isArray(t)}function fL(t){return!function(t){return t instanceof zb}(t)&&!dL(t)}function mL(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=""),null==e||0===e.length){if(null!=t){var o=!1;if(dL(t)&&t.length>0)o=!0;else if(fL(t)){for(var s in t)if(t.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new iP("Error when checking model "+i+" expected no data, but got "+t)}return[]}if(null==t)return e.map(function(t){return null});var a;if(fL(t)){t=t,a=[];for(var u=0,l=e;u<l.length;u++){var c=l[u];if(null==t[c])throw new iP('No data provided for "'+c+'". Need data for each key in: '+e);a.push(t[c])}}else if(dL(t)){if((t=t).length!==e.length)throw new iP("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+t);a=t}else{if(t=t,e.length>1)throw new iP("The model "+i+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+t.shape);a=[t]}if(a=hL(a),null!=n)for(var h=0;h<e.length;++h)if(null!=n[h]){var p=a[h];if(p.shape.length!==n[h].length)throw new iP("Error when checking "+i+": expected "+e[h]+" to have "+n[h].length+" dimension(s). but got array with shape "+p.shape);for(var d=0;d<n[h].length;++d)if(0!==d||r){var f=n[h][d];if(null!=f&&f>=0&&p.shape[d]!==f)throw new iP("Error when checking "+i+": expected "+e[h]+" to have shape ["+n[h]+"], but got array with shape ["+p.shape+"].")}}return a}function gL(t,e,n,r,i){var o;if(void 0===r&&(r=!0),void 0===i&&(i=""),Array.isArray(t)){if(t.length!==e.length)throw new iP("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+t.length+" Tensors(s).");o=t}else{if(e.length>1)throw new iP("The model expects "+e.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(t.shape)+".");o=[t]}if(null!=n)for(var s=0;s<e.length;++s)if(null!=n[s]){var a=o[s];if(a.shape.length!==n[s].length)throw new iP("Error when checking "+i+": expected "+e[s]+" to have "+n[s].length+" dimension(s), but got array with shape "+JSON.stringify(a.shape));for(var u=0;u<n[s].length;++u)if(0!==u||r){var l=n[s][u];if(null!=l&&l!==a.shape[u])throw new iP("Error when checking "+i+": expected "+e[s]+" to have shape "+JSON.stringify(n[s])+" but got array with shape "+JSON.stringify(a.shape)+".")}}}var yL=function(t){function e(e){var n=t.call(this,e)||this;return n.isTraining=!1,n}return QD(e,t),e.prototype.summary=function(t,e,n){if(void 0===n&&(n=console.log),!this.built)throw new iP("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r){void 0===r&&(r=console.log);var i,o=function(t){var e=!0,n=[],r=[];for(var i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(var o=0,s=n;o<s.length;o++){var a=s[o];if(a.length>1||1===a.length&&a[0].inboundLayers.length>1){e=!1;break}r.push.apply(r,a)}if(e)for(var u=0,l=t.layers;u<l.length;u++){for(var c=!1,h=0,p=l[u].inboundNodes;h<p.length;h++)if(-1!==r.indexOf(p[h])){if(c){e=!1;break}c=!0}if(!e)break}return e}(t),s=["Layer (type)","Output shape","Param #"];if(o?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(function(t){return Math.floor(e*t)})),!o)for(var a in s.push("Receives inputs"),i=[],t.nodesByDepth)i.push.apply(i,t.nodesByDepth[a]);r("_".repeat(e)),LM(s,n,r),r("=".repeat(e));for(var u=t.layers,l=0;l<u.length;++l)o?zM(u[l],n,r):BM(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();var c=function(t){return qF(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights)}(t),h=qF(t.nonTrainableWeights);r("Total params: "+(c+h)),r("Trainable params: "+c),r("Non-trainable params: "+h),r("_".repeat(e))}(this,t,e,n)},e.prototype.compile=function(t){var e=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){var e={Adagrad:function(){return JA.adagrad(.01)},Adadelta:function(){return JA.adadelta(1,.95,eP())},Adam:function(){return JA.adam(.001,.9,.999,eP())},Adamax:function(){return JA.adamax(.002,.9,.999,eP(),0)},RMSProp:function(){return JA.rmsprop(.001,.9,0,eP())},SGD:function(){return JA.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new iP("Unknown Optimizer "+t)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof HA))throw new iP("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new iP("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");n=t.loss.map(function(t){return kM(t)})}else{var r=kM(t.loss);this.outputs.forEach(function(t){n.push(r)})}else{for(var i in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(i))throw new iP('Unknown entry in loss dictionary: "'+i+'". Only expected the following keys: '+this.outputNames);for(var o=0,s=this.outputNames;o<s.length;o++){var a=s[o];null==t.loss[a]&&console.warn('Output "'+a+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+a+" during training"),n.push(kM(t.loss[a]))}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var u=0;u<this.outputs.length;++u){var l=this.internalOutputShapes[u];this.feedOutputNames.push(this.outputNames[u]),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[u])}var c=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],jP("loss",function(){for(var t=0;t<e.outputs.length;++t)-1===c.indexOf(t)&&e.outputs.length>1&&(e.metricsTensors.push([e.lossFunctions[t],t]),e.metricsNames.push(e.outputNames[t]+"_loss"))});var h=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(function(t){return[]});var n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map(function(t){return n});for(var r=[],i=0,o=e;i<o.length;i++){var s=o[i],a=n.hasOwnProperty(s)?n[s]:[];Array.isArray(a)||(a=[a]),r.push(a)}return r}(t.metrics,this.outputNames);jP("metric",function(){for(var t=function(t){if(-1!==c.indexOf(t))return"continue";!function(n){for(var r,i,o,s=function(n){if("string"==typeof n&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(n)){var s=e.internalOutputShapes[t];1===s[s.length-1]||e.lossFunctions[t]===CM?-1!==["accuracy","acc"].indexOf(n)?i=NM:-1!==["crossentropy","ce"].indexOf(n)&&(i=RM):e.lossFunctions[t]===_M?-1!==["accuracy","acc"].indexOf(n)?i=OM:-1!==["crossentropy","ce"].indexOf(n)&&(i=PM):-1!==["accuracy","acc"].indexOf(n)?i=IM:-1!==["crossentropy","ce"].indexOf(n)&&(i=DM);var a=void 0;-1!==["accuracy","acc"].indexOf(n)?a="acc":-1!==["crossentropy","ce"].indexOf(n)&&(a="ce"),o=i,r=""+a}else{var u=function(t){if("string"==typeof n&&n in FM)return FM[n];if("string"!=typeof n&&null!=n)return n;throw new iP("Unknown metric "+n)}();o=u,r=""+MM(n)}var l;jP(r,function(){l=o}),function(t,n,r){e.outputNames.length>1&&(n=e.outputNames[t]+"_"+n),e.metricsNames.push(n),e.metricsTensors.push([r,t])}(t,r,l)},a=0,u=h[t];a<u.length;a++)s(u[a])}()},n=0;n<e.outputs.length;++n)t(n)}),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,e,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize;oL(r);var i=this.standardizeUserDataXY(t,e,!0,r);try{var o=i[0].concat(i[1]);return this.makeTestFunction(),cP(this.testLoop(this.testFunction,o,r,n.verbose,n.steps))}finally{pL(i[0],t),pL(i[1],e)}},e.prototype.evaluateDataset=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){return this.makeTestFunction(),[2,iL(this,t,e)]})})},e.prototype.checkNumSamples=function(t,e,n,r){var i;if(void 0===r&&(r="steps"),null!=n){if(i=null,null!=e)throw new iP("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+e)}else{if(null==t)throw new iP("Either the input data should have a defined shape, or "+r+" shoud be specified.");i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i},e.prototype.execute=function(t,e){if(Array.isArray(e)&&0===e.length)throw new iP("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(e),r=this.retrieveSymbolicTensors(n?e:[e]),i=new jM;if(t instanceof zb&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new iP("The number of inputs provided ("+t.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],t[o])}else for(var s=0,a=this.inputs;s<a.length;s++){var u=a[s],l=t[u.name];if(null==l)throw new iP("No value is provided for the model's input "+u.name);i.add(u,l)}var c=qM(r,i);return n?c:c[0]},e.prototype.retrieveSymbolicTensors=function(t){for(var e=aP(null,t.length),n=t.length,r=0,i=this.layers;r<i.length;r++){for(var o=i[r],s=Array.isArray(o.output)?o.output:[o.output],a=s.map(function(t){return t.name}),u=0;u<t.length;++u){var l=a.indexOf(t[u]);if(-1!==l&&(e[u]=s[l],n--),0===n)break}if(0===n)break}if(n>0){var c=[];throw e.forEach(function(e,n){null==e&&c.push(t[n])}),new iP("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(c))}return e},e.prototype.predictLoop=function(t,e,n){var r=this;return void 0===e&&(e=32),void 0===n&&(n=!1),lx(function(){var i=r.checkNumSamples(t);if(n)throw new oP("Verbose predictLoop() is not implemented yet.");for(var o=uL(i,e),s=r.outputs.map(function(t){return[]}),a=function(e){lx(function(){var n=sL(t,o[e][0],o[e][1]),i=[];if(Array.isArray(n))for(var s=0;s<n.length;++s)i.push({key:r.inputs[s],value:n[s]});else i.push({key:r.inputs[0],value:n});var a=new jM(i);return qM(r.outputs,a)}).forEach(function(t,e){return s[e].push(t)})},u=0;u<o.length;++u)a(u);return cP(s.map(function(t){return r_(t,0)}))})},e.prototype.predict=function(t,e){void 0===e&&(e={});var n=hL(t);gL(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==e.batchSize?32:e.batchSize;return oL(r),this.predictLoop(n,r)}finally{pL(n,t)}},e.prototype.predictOnBatch=function(t){return gL(t,this.inputNames,this.feedInputShapes,!0),this.predictLoop(t,t.shape[0])},e.prototype.standardizeUserDataXY=function(t,e,n,r){if(void 0===n&&(n=!0),null==this.optimizer_)throw new rP("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var i=[],o=0;o<this.feedOutputShapes.length;++o){var s=this.feedOutputShapes[o];i.push(this.feedLossFns[o]===_M?s.slice(0,s.length-1).concat([1]):s)}if(function(t,e,n){var r=vP(t.map(function(t){return t.shape[0]}));r.sort();var i=vP(e.map(function(t){return t.shape[0]}));if(i.sort(),r.length>1)throw new iP("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(t){return t.shape})));if(i.length>1)throw new iP("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(t){return t.shape})));if(r.length>0&&i.length>0&&!Nb.arraysEqual(r,i))throw new iP("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}(t=mL(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=mL(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){for(var r=[vM,CM,xM],i=0;i<t.length;++i){var o=t[i],s=e[i],a=n[i];if(null!=s){if(s===xM&&1===o.shape[o.shape.length-1])throw new iP("You are passing a target array of shape "+o.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(s))for(var u=o.shape.slice(1),l=a.slice(1),c=0;c<u.length;++c){var h=l[c];if(null!=h&&u[c]!==h)throw new iP("A target Tensor with shape "+o.shape+" was passed for an output of shape "+a+", while using a loss function that expects targets to have the same shape as the output.")}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new iP("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+t[0].shape[0]+" sample(s).");return[t,e]},e.prototype.standardizeUserData=function(t,e,n,r,i,o){return void 0===i&&(i=!0),JD(this,void 0,void 0,function(){var s,a,u,l,c,h,p,d;return tP(this,function(f){switch(f.label){case 0:if(s=this.standardizeUserDataXY(t,e,i,o),a=s[0],u=s[1],null!=n)throw new Error("sample weight is not supported yet.");if(l=null,null==r)return[3,4];c=QM(r,this.outputNames),l=[],h=0,f.label=1;case 1:return h<c.length?(d=(p=l).push,[4,ZM(u[h],null,c[h])]):[3,4];case 2:d.apply(p,[f.sent()]),f.label=3;case 3:return++h,[3,1];case 4:return[2,[a,u,l]]}})})},e.prototype.testLoop=function(t,e,n,r,i){var o=this;return void 0===r&&(r=0),lx(function(){var s=o.checkNumSamples(e,n,i,"steps"),a=[];if(r>0)throw new oP("Verbose mode is not implemented yet.");if(null!=i)throw new oP("steps mode in testLoop() is not implemented yet");for(var u=uL(s,n),l=Hx(YP(0,s)),c=0;c<u.length;++c){var h=u[c][0],p=u[c][1],d=eF(l,h,p-h),f=aL(e,d),m=t(f);if(0===c)for(var g=0;g<m.length;++g)a.push(Wx(0));for(g=0;g<m.length;++g)a[g]=eI(a[g],fI(p-h,m[g]))}for(g=0;g<a.length;++g)a[g]=oI(a[g],s);return a})},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,e=[],n=0;n<t.length;++n){var r=t[n],i=r;lP(t,r)>1&&(i+="_"+lP(t.slice(0,n),r)),e.push(i)}return e},e.prototype.makeTrainFunction=function(){var t=this;return function(e){var n=[],r=e.slice(0,t.inputs.length),i=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),o=e.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),s=[],a=t.collectedTrainableWeights.map(function(t){return t.read()});return[t.optimizer_.minimize(function(){for(var e=[],a=0;a<t.inputs.length;++a)e.push({key:t.inputs[a],value:r[a]});var u,l=new jM(e),c=qM(t.outputs,l,{training:!0});for(a=0;a<t.lossFunctions.length;++a){var h=(0,t.lossFunctions[a])(i[a],c[a]);null!=o[a]&&(h=YM(h,o[a]));var p=zN(h);n.push(p),u=0===a?h:eI(u,h)}for(a=0;a<t.metricsTensors.length;++a){var d=void 0;if(t.outputs.length>1&&a<t.outputs.length)d=n[a];else{var f=t.metricsTensors[a][1];d=zN((0,t.metricsTensors[a][0])(i[f],c[f]))}hx(d),s.push(d)}return u=zN(u),t.calculateLosses().forEach(function(t){u=eI(u,t)}),u},!0,a)].concat(s)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(e){return lx(function(){for(var n,r=[],i=e.slice(0,t.inputs.length),o=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),s=[],a=0;a<t.inputs.length;++a)s.push({key:t.inputs[a],value:i[a]});var u=new jM(s),l=qM(t.outputs,u);for(a=0;a<t.lossFunctions.length;++a){var c=zN((0,t.lossFunctions[a])(o[a],l[a]));n=0===a?c:eI(n,c),r.push(n)}for(a=0;a<t.metricsTensors.length;++a){var h=t.metricsTensors[a][1],p=zN((0,t.metricsTensors[a][0])(o[h],l[h]));r.push(p)}return r})}},e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),JD(this,void 0,void 0,function(){return tP(this,function(r){return[2,cL(this,t,e,n)]})})},e.prototype.fitDataset=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){return[2,nL(this,t,e)]})})},e.prototype.trainOnBatch=function(t,e){return JD(this,void 0,void 0,function(){var n,r,i,o,s,a,u,l,c;return tP(this,function(h){switch(h.label){case 0:return[4,this.standardizeUserData(t,e)];case 1:n=h.sent(),r=n[0],i=n[1],o=this.makeTrainFunction(),s=o(r.concat(i)),a=[],u=0,l=s,h.label=2;case 2:return u<l.length?[4,l[u].data()]:[3,5];case 3:c=h.sent(),a.push(c[0]),h.label=4;case 4:return u++,[3,2];case 5:return cx(s),[2,cP(a)]}})})},e.prototype.getNamedWeights=function(t){for(var e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n),o=0;o<r.length;++o)n&&!r[o].trainable||e.push({name:r[o].originalName,tensor:i[o]});return e},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=t.prototype.dispose.call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var n=ax().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-ax().numTensors}return e},e.prototype.getLossIdentifiers=function(){var t;if("string"==typeof this.loss)t=pP(this.loss);else if(Array.isArray(this.loss)){for(var e=0,n=this.loss;e<n.length;e++)if("string"!=typeof n[e])throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(function(t){return pP(t)})}else{var r=Object.keys(this.loss);t={};for(var i=this.loss,o=0,s=r;o<s.length;o++){var a=s[o];if("string"!=typeof i[a])throw new Error("Serialization of non-string loss is not supported.");t[a]=pP(i[a])}}return t},e.prototype.getMetricIdentifiers=function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[pP(MM(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(t){return pP(MM(t))});var t={};for(var e in this.metrics)t[e]=pP(MM(this.metrics[e]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var e,n,r=gM(VM(t.optimizer_config));if("string"==typeof t.loss)e=dP(t.loss);else if(Array.isArray(t.loss))e=t.loss.map(function(t){return dP(t)});else if(null!=t.loss)for(var i in e={},t.loss)e[i]=dP(t.loss[i]);if(Array.isArray(t.metrics))n=t.metrics.map(function(t){return dP(t)});else if(null!=t.metrics)for(var i in n={},t.metrics)n[i]=dP(t.metrics[i]);this.compile({loss:e,metrics:n,optimizer:r})},e.prototype.save=function(t,e){return JD(this,void 0,void 0,function(){var n,r,i,o,s,a,u,l,c,h;return tP(this,function(p){switch(p.label){case 0:if("string"==typeof t){if(0===(r=NA.getSaveHandlers(t)).length)throw new iP("Cannot find any save handlers for URL '"+t+"'");if(r.length>1)throw new iP("Found more than one ("+r.length+") save handlers for URL '"+t+"'");t=r[0]}if(null==t.save)throw new iP("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,NA.encodeWeights(this.getNamedWeights(e))];case 1:return i=p.sent(),o=this.toJSON(null,!1),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v1.2.6",convertedBy:null},null!=e&&e.includeOptimizer&&null!=this.optimizer?(s.trainingConfig=this.getTrainingConfig(),a="optimizer",h=(c=NA).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,h.apply(c,[p.sent(),a])];case 3:u=p.sent(),l=u.data,(n=i.specs).push.apply(n,u.specs),i.data=NA.concatenateArrayBuffers([i.data,l]),p.label=4;case 4:return s.weightData=i.data,s.weightSpecs=i.specs,[2,t.save(s)]}})})},e.className="Model",e}(XM);FA.registerClass(yL);var vL=function(t){function e(e){var n=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},n.trainable=!0,n.built=!1,n.name=null!=e.name?e.name:UF("sequential_"),null!=e.layers)for(var r=0,i=e.layers;r<i.length;r++)n.add(i[r]);return n}return QD(e,t),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some(function(t){return t<0}))throw new iP("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")},e.prototype.add=function(t){var n,r=t instanceof e||t instanceof yL;if(r){if(1!==(n=t).outputs.length)throw new iP("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new iP("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new iP("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var i=iM({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new iP("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new iP("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,n,r){if((null==n||null!=r&&r>0)&&(n=e.sourceLayer,r=e.nodeIndex),0===n.inboundNodes.length)return[e];var i=n.inboundNodes[r];if(0===i.inboundLayers.length)return i.inputTensors;for(var o=[],s=0;s<i.inboundLayers.length;s++)for(var a=0,u=t(i.inputTensors[s],i.inboundLayers[s],i.nodeIndices[s]);a<u.length;a++){var l=u[a];-1===o.indexOf(l)&&o.push(l)}return o}(this.outputs[0])}this.inboundNodes=[],new tM({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:aP(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(t){return t.shape}),outputShapes:this.outputs[0].shape})}else{var o=t.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,e){return null==this.model&&this.build(),this.model.call(t,e)},e.prototype.build=function(t){if(HF(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new yL({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),t.prototype.countParams.call(this)},e.prototype.summary=function(e,n,r){void 0===r&&(r=console.log),this.built||this.build(),t.prototype.summary.call(this,e,n,r)},e.prototype.setWeights=function(t){null==this.model&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,e,n){if(void 0===n&&(n={}),!this.built)throw new rP("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)},e.prototype.evaluateDataset=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){if(!this.built)throw new rP("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,e)]})})},e.prototype.predict=function(t,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(t,e)},e.prototype.predictOnBatch=function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return null==this.model?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!0,configurable:!0}),e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),JD(this,void 0,void 0,function(){return tP(this,function(r){if(!this.built)throw new rP("The model needs to be compiled before being used.");return[2,this.model.fit(t,e,n)]})})},e.prototype.fitDataset=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){if(!this.built)throw new rP("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,e)]})})},e.prototype.trainOnBatch=function(t,e){return JD(this,void 0,void 0,function(){return tP(this,function(n){return[2,this.model.trainOnBatch(t,e)]})})},e.fromConfig=function(t,n,r,i){var o;void 0===r&&(r={}),void 0===i&&(i=!1);var s={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new iP("Legacy serialization format not supported yet.");o=n}else Nb.assert(null!=n.layers,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),o=n.layers,delete n.layers,s=n;var a=new t(s);if(!(a instanceof e))throw new oP("Sequential.fromConfig called on non-Sequential input: "+a);for(var u=0,l=o;u<l.length;u++){var c=gM(l[u],void 0,i);i&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(null==this.model)throw new iP("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(null==this.model)throw new iP("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e],i={};i.className=r.getClassName(),i.config=r.getConfig(),t.push(i)}return t},e.className="Sequential",e}(yL);FA.registerClass(vL);var bL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.getConfig=function(){return{}},e}(FA.Serializable),wL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=1),function(t,e){if(void 0===e&&(e=1),1!==e)throw new oP("Support for alpha values other than 1 ("+e+") is not implemented yet.");return II(t)}(t,e)},e.className="elu",e}(bL);FA.registerClass(wL);var xL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return OI(t)},e.className="selu",e}(bL);FA.registerClass(xL);var _L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return RI(t)},e.className="relu",e}(bL);FA.registerClass(_L);var CL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return lx(function(){return cI(6,RI(t))})},e.className="relu6",e}(bL);FA.registerClass(CL);var SL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return t},e.className="linear",e}(bL);FA.registerClass(SL);var EL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return Ak(t)},e.className="sigmoid",e}(bL);FA.registerClass(EL);var kL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return function(t){return lx(function(){var e=eI(.5,fI(.2,t));return gk(e,0,1)})}(t)},e.className="hardSigmoid",e}(bL);FA.registerClass(kL);var NL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return Lk(t)},e.className="softplus",e}(bL);FA.registerClass(NL);var IL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return function(t){return lx(function(){return oI(t,uk(t).add(1))})}(t)},e.className="softsign",e}(bL);FA.registerClass(IL);var TL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t){return jk(t)},e.className="tanh",e}(bL);FA.registerClass(TL);var AL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),fC(t,e)},e.className="softmax",e}(bL);FA.registerClass(AL);var RL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),mC(t,e)},e.className="logSoftmax",e}(bL);function OL(t){return t.getClassName()}function DL(t,e){return void 0===e&&(e={}),gP(t,FA.SerializationMap.getMap().classNameMap,e,"activation")}function PL(t){var e;return null==t?DL(e={className:"linear",config:{}}):"string"==typeof t?((e={}).className=t,e.config={},DL(e)):t instanceof bL?t:DL(t)}FA.registerClass(RL);var FL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e}(FA.Serializable),ML=function(t){function e(e){var n=t.call(this)||this;return n.l1=null==e||null==e.l1?.01:e.l1,n.l2=null==e||null==e.l2?.01:e.l2,n.hasL1=0!==n.l1,n.hasL2=0!==n.l2,n}return QD(e,t),e.prototype.apply=function(t){var e=this;return lx(function(){var n=Zx([1]);return e.hasL1&&(n=eI(n,VN(fI(e.l1,uk(t))))),e.hasL2&&(n=eI(n,VN(fI(e.l2,cF(t))))),n.asScalar()})},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,e){return new t({l1:e.l1,l2:e.l2})},e.className="L1L2",e}(FL);FA.registerClass(ML);var LL={l1l2:"L1L2"};function zL(t){return mP(t)}function BL(t,e){return void 0===e&&(e={}),gP(t,FA.SerializationMap.getMap().classNameMap,e,"regularizer")}function UL(t){return null==t?null:"string"==typeof t?BL({className:t in LL?LL[t]:t,config:{}}):t instanceof FL?t:BL(t)}var VL=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,null!=e&&(n.maxValue=e.maxValue),n}return QD(e,t),e.prototype.call=function(t,e){t=WF(t);var n=RI(t);return null!=this.maxValue&&(n=gk(n,0,this.maxValue)),n},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={maxValue:this.maxValue},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ReLU",e}(nM);FA.registerClass(VL);var jL=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_ALPHA=.3,null==e&&(e={}),n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return QD(e,t),e.prototype.call=function(t,e){var n=WF(t);return TI(n,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LeakyReLU",e}(nM);FA.registerClass(jL);var WL=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),n.supportsMasking=!0,n.alphaInitializer=MF(e.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=UL(e.alphaRegularizer),n.alphaConstraint=OP(e.alphaConstraint),null==e.sharedAxes)n.sharedAxes=null;else if(Array.isArray(e.sharedAxes))n.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new iP("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);n.sharedAxes=[e.sharedAxes]}return n}return QD(e,t),e.prototype.build=function(t){var e=(t=HF(t)).slice(1);if(null!=this.sharedAxes)for(var n=0,r=this.sharedAxes;n<r.length;n++)e[(o=r[n])-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var i={};if(null!=this.sharedAxes)for(var o=1;o<t.length;++o)i[o]=t[o];this.inputSpec=[new ZF({ndim:t.length,axes:i})],this.built=!0},e.prototype.call=function(t,e){return t=WF(t),AI(t,this.alpha.read())},e.prototype.getConfig=function(){var e={alphaInitializer:FF(this.alphaInitializer),alphaRegularizer:zL(this.alphaRegularizer),alphaConstraint:AP(this.alphaConstraint),sharedAxes:this.sharedAxes},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="PReLU",e}(nM);FA.registerClass(WL);var HL=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==n.DEFAULT_ALPHA)throw new oP("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return QD(e,t),e.prototype.call=function(t,e){var n=WF(t);return II(n)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ELU",e}(nM);FA.registerClass(HL);var qL=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_THETA=1,null==e&&(e={}),n.theta=null==e.theta?n.DEFAULT_THETA:e.theta,n}return QD(e,t),e.prototype.call=function(t,e){var n=WF(t);return n.mul(JP(n.greater(this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={theta:this.theta},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ThresholdedReLU",e}(nM);FA.registerClass(qL);var $L=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_AXIS=1,null==e&&(e={}),n.softmax=(new AL).apply,n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n}return QD(e,t),e.prototype.call=function(t,e){var n=WF(t);return this.softmax(n,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Softmax",e}(nM);function GL(t,e,n){if("number"==typeof t)return aP(t,e);if(t.length!==e)throw new iP("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+t.length+" elements.");for(var r=0;r<e;++r){var i=t[r];if(!GP(i))throw new iP("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+JSON.stringify(t)+" including a non-integer number "+i)}return t}function KL(t,e,n,r,i){return void 0===i&&(i=1),null==t?t:Math.floor((("same"===n?t:t-(e+(e-1)*(i-1))+1)+r-1)/r)}function XL(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+ZP([n-e,0]);else{if("same"!==r)throw new iP("Unsupport padding mode: "+r+".");t*=e}return t}function QL(t,e){return lx(function(){return zP(e),"channelsFirst"===e?DI(t,[0,2,3,1]):t})}FA.registerClass($L);var ZL=function(t){function e(n,r){var i=t.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(r),i.rank=n,_P(i.rank,"rank"),1!==i.rank&&2!==i.rank&&3!==i.rank)throw new oP("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=GL(r.kernelSize,n,"kernelSize"),i.strides=GL(null==r.strides?1:r.strides,n,"strides"),i.padding=null==r.padding?"valid":r.padding,BP(i.padding),i.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,zP(i.dataFormat),i.activation=PL(r.activation),i.useBias=null==r.useBias||r.useBias,i.biasInitializer=MF(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=OP(r.biasConstraint),i.biasRegularizer=UL(r.biasRegularizer),i.activityRegularizer=UL(r.activityRegularizer),i.dilationRate=GL(null==r.dilationRate?1:r.dilationRate,n,"dilationRate"),1===i.rank&&Array.isArray(i.dilationRate)&&1!==i.dilationRate.length)throw new iP("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(2===i.rank){if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate];else if(2!==i.dilationRate.length)throw new iP("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(3===i.rank)if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(3!==i.dilationRate.length)throw new iP("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate));return i}return QD(e,t),e.verifyArgs=function(t){if(uP("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!xP(t.kernelSize,"number",1,3))throw new iP("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(t.kernelSize)+".")},e.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:OL(this.activation),useBias:this.useBias,biasInitializer:FF(this.biasInitializer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),biasConstraint:AP(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(nM),YL=function(t){function e(n,r){var i=t.call(this,n,r)||this;return i.kernel=null,e.verifyArgs(r),i.filters=r.filters,_P(i.filters,"filters"),i.kernelInitializer=MF(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=OP(r.kernelConstraint),i.kernelRegularizer=UL(r.kernelRegularizer),i}return QD(e,t),e.prototype.build=function(t){var e;t=HF(t);var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new iP("The channel dimension of the input should be defined. Found "+t[n]);var r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(e={},e[n]=r,e)}],this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){var e;t=WF(t);var r=null==n.bias?null:n.bias.read();if(1===n.rank)e=function(t,e,n,r,i,o,s){return void 0===r&&(r=1),void 0===i&&(i="valid"),void 0===s&&(s=1),lx(function(){if(null==o&&(o="channelsLast"),zP(o),3!==t.shape.length)throw new iP("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new iP("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new iP("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===o&&(t=DI(t,[0,2,1])),"causal"===i)throw new oP("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var a=sN(t,e,r,"same"===i?"same":"valid","NWC",s);return null!=n&&(a=pF(a,n)),a})}(t,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)e=function(t,e,n,r,i,o,s){return void 0===r&&(r=[1,1]),void 0===i&&(i="valid"),lx(function(){if(null==o&&(o="channelsLast"),zP(o),3!==t.rank&&4!==t.rank)throw new iP("conv2dWithBias expects input to be of rank 3 or 4, but received "+t.rank+".");if(3!==e.rank&&4!==e.rank)throw new iP("conv2dWithBias expects kernel to be of rank 3 or 4, but received "+t.rank+".");var a=QL(t,o);if("causal"===i)throw new oP("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return a=aN(a,e,r,"same"===i?"same":"valid","NHWC",s),null!=n&&(a=pF(a,n)),"channelsFirst"===o&&(a=DI(a,[0,3,1,2])),a})}(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new oP("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r,i,o,s){return void 0===r&&(r=[1,1,1]),void 0===i&&(i="valid"),lx(function(){if(null==o&&(o="channelsLast"),zP(o),4!==t.rank&&5!==t.rank)throw new iP("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new iP("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");var a=function(t,e){return lx(function(){return zP(e),"channelsFirst"===e?DI(t,[0,2,3,4,1]):t})}(t,o);if("causal"===i)throw new oP("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=uN(a,e,r,"same"===i?"same":"valid","NDHWC",s),null!=n&&(a=pF(a,n)),"channelsFirst"===o&&(a=DI(a,[0,4,1,2,3])),a})}(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}return null!=n.activation&&(e=n.activation.apply(e)),e})},e.prototype.computeOutputShape=function(t){t=HF(t);for(var e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<n.length;++r){var i=KL(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(i)}var o=[t[0]];return"channelsLast"===this.dataFormat?(o=o.concat(e)).push(this.filters):(o.push(this.filters),o=o.concat(e)),o},e.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:FF(this.kernelInitializer),kernelRegularizer:zL(this.kernelRegularizer),kernelConstraint:AP(this.kernelConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.verifyArgs=function(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new iP("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))},e}(ZL),JL=function(t){function e(n){var r=t.call(this,2,n)||this;return e.verifyArgs(n),r}return QD(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!xP(t.kernelSize,"number",1,2))throw new iP("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv2D",e}(YL);FA.registerClass(JL);var tz=function(t){function e(n){var r=t.call(this,3,n)||this;return e.verifyArgs(n),r}return QD(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new iP("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv3D",e}(YL);FA.registerClass(tz);var ez=function(t){function e(e){var n=t.call(this,e)||this;if(n.inputSpec=[new ZF({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new iP("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return QD(e,t),e.prototype.build=function(t){var e;if(4!==(t=HF(t)).length)throw new iP("Input should have rank 4; Received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new iP("The channel dimension of the inputs should be defined. Found `None`.");var r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ZF({ndim:4,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){var e=WF(t);if(4!==e.shape.length)throw new iP("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);var r,i,o=e.shape;"channelsFirst"===n.dataFormat?(r=2,i=3):(r=1,i=2);var s=o[i],a=n.kernelSize[1],u=n.strides[1],l=[o[0],XL(o[r],n.strides[0],n.kernelSize[0],n.padding),XL(s,u,a,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=DI(e,[0,2,3,1]));var c=pN(e,n.kernel.read(),l,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(c=DI(c,[0,3,1,2])),null!=n.bias&&(c=pF(c,n.bias.read(),n.dataFormat)),null!=n.activation&&(c=n.activation.apply(c)),c})},e.prototype.computeOutputShape=function(t){var e,n,r,i=(t=HF(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3):(e=3,n=1,r=2);var o=this.kernelSize[0],s=this.kernelSize[1],a=this.strides[0],u=this.strides[1];return i[e]=this.filters,i[n]=XL(i[n],a,o,this.padding),i[r]=XL(i[r],u,s,this.padding),i},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e.className="Conv2DTranspose",e}(JL);FA.registerClass(ez);var nz=function(t){function e(e){return t.call(this,2,e)||this}return QD(e,t),e.className="SeparableConv2D",e}(function(t){function e(e,n){var r=t.call(this,e,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new iP("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new iP("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new iP("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=MF(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=UL(n.depthwiseRegularizer),r.depthwiseConstraint=OP(n.depthwiseConstraint),r.pointwiseInitializer=MF(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=UL(n.pointwiseRegularizer),r.pointwiseConstraint=OP(n.pointwiseConstraint),r}return QD(e,t),e.prototype.build=function(t){var e;if((t=HF(t)).length<this.rank+2)throw new iP("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n]||t[n]<0)throw new iP("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[n]));for(var r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),o=[],s=0;s<this.rank;++s)o.push(1);o.push(r*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new ZF({ndim:this.rank+2,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){var e;if(t=WF(t),1===n.rank)throw new oP("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=DI(t,[0,2,3,1])),e=hN(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=pF(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=DI(e,[0,3,1,2])),e})},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=FF(this.depthwiseInitializer),e.pointwiseInitializer=FF(this.pointwiseInitializer),e.depthwiseRegularizer=zL(this.depthwiseRegularizer),e.pointwiseRegularizer=zL(this.pointwiseRegularizer),e.depthwiseConstraint=AP(this.depthwiseConstraint),e.pointwiseConstraint=AP(this.pointwiseConstraint),e},e.className="SeparableConv",e}(YL));FA.registerClass(nz);var rz=function(t){function e(n){var r=t.call(this,1,n)||this;return e.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return QD(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!xP(t.kernelSize,"number",1,1))throw new iP("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv1D",e}(YL);FA.registerClass(rz);var iz=function(t){function e(e){var n=t.call(this,e)||this;return n.cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,n.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,n.inputSpec=[{ndim:4}],n}return QD(e,t),e.prototype.computeOutputShape=function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,e){var n=this;return lx(function(){return t=WF(t),"channelsLast"===n.dataFormat?rF(rF(t,n.cropping[0][0],t.shape[1]-n.cropping[0][0]-n.cropping[0][1],2),n.cropping[1][0],t.shape[2]-n.cropping[1][1]-n.cropping[1][0],3):rF(rF(t,n.cropping[0][0],t.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),n.cropping[1][0],t.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)})},e.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Cropping2D",e}(nM);FA.registerClass(iz);var oz=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=null==e.size?n.DEFAULT_SIZE:e.size,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,n}return QD(e,t),e.prototype.computeOutputShape=function(t){if("channelsFirst"===this.dataFormat){var e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}return[t[0],e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2],t[3]]},e.prototype.call=function(t,e){var n=this;return lx(function(){var e=WF(t),r=e.shape;if("channelsFirst"===n.dataFormat){e=DI(e,[0,2,3,1]);var i=n.size[0]*r[2],o=n.size[1]*r[3],s=e.resizeNearestNeighbor([i,o]);return DI(s,[0,3,1,2])}return e.resizeNearestNeighbor([i=n.size[0]*r[1],o=n.size[1]*r[2]])})},e.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="UpSampling2D",e}(nM);FA.registerClass(oz);var sz=function(t){function e(e){var n=t.call(this,2,e)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,n.depthwiseInitializer=MF(e.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=OP(e.depthwiseConstraint),n.depthwiseRegularizer=UL(e.depthwiseRegularizer),n}return QD(e,t),e.prototype.build=function(t){if((t=HF(t)).length<4)throw new iP("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");var e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new iP("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[e]+").");var n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){var e=function(t,e,n,r,i,o){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),lx(function(){null==i&&(i="channelsLast"),zP(i);var o=QL(t,i);if(4!==t.rank)throw new iP("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new iP("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return o=cN(o,e,n,"same"===r?"same":"valid","NHWC",null),"channelsFirst"===i&&(o=DI(o,[0,3,1,2])),o})}(t=WF(t),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat);return n.useBias&&(e=pF(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),e})},e.prototype.computeOutputShape=function(t){t=HF(t);var e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=KL("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),i=KL(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,r,i]:[t[0],r,i,n]},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=FF(this.depthwiseInitializer),e.depthwiseRegularizer=zL(this.depthwiseRegularizer),e.depthwiseConstraint=AP(this.depthwiseRegularizer),e},e.className="DepthwiseConv2D",e}(ZL);FA.registerClass(sz);var az=function(t){function e(e){var n=t.call(this,e)||this;if(n.rate=Math.max(Math.min(e.rate,1),0),n.noiseShape=e.noiseShape,n.seed=e.seed,null!=n.seed)throw new oP("Non-default seed is not implemented in Dropout layer yet: "+n.seed);return n.supportsMasking=!0,n}return QD(e,t),e.prototype.getNoiseShape=function(t){if(null==this.noiseShape)return this.noiseShape;for(var e=t.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t);if(null!=n.noiseShape&&!Nb.arraysEqual(r.shape,n.noiseShape))throw new oP("Non-default noise shape is not implemented in Dropout layer yet: "+JSON.stringify(n.noiseShape));if(0<n.rate&&n.rate<1){var i=null!=e.training&&e.training,o=n.getNoiseShape(r);return fF(function(){return dF(r,n.rate,o,n.seed)},function(){return r},i)}return t})},e.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.dispose=function(){return t.prototype.dispose.call(this)},e.className="Dropout",e}(nM);FA.registerClass(az);var uz=function(t){function e(e){var n=t.call(this,e)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=[r,e.inputDim]}return n.units=e.units,_P(n.units,"units"),n.activation=PL(e.activation),null!=e.useBias&&(n.useBias=e.useBias),n.kernelInitializer=MF(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=MF(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=OP(e.kernelConstraint),n.biasConstraint=OP(e.biasConstraint),n.kernelRegularizer=UL(e.kernelRegularizer),n.biasRegularizer=UL(e.biasRegularizer),n.activityRegularizer=UL(e.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return QD(e,t),e.prototype.build=function(t){var e,n=(t=HF(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(e={},e[-1]=n,e)}],this.built=!0},e.prototype.computeOutputShape=function(t){var e=(t=HF(t)).slice();return e[e.length-1]=this.units,e},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r,i=WF(t),o=function(t){return"relu"===t?"relu":"linear"===t?"linear":null}(n.activation.getClassName());return null!=o?r=uF(i,n.kernel.read(),o,n.bias?n.bias.read():null):(r=uF(i,n.kernel.read()),null!=n.bias&&(r=pF(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r})},e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),biasInitializer:FF(this.biasInitializer),kernelRegularizer:zL(this.kernelRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),biasConstraint:AP(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dense",e}(nM);FA.registerClass(uz);var lz=function(t){function e(e){var n=t.call(this,e||{})||this;return n.inputSpec=[{minNDim:3}],n}return QD(e,t),e.prototype.computeOutputShape=function(t){for(var e=0,n=(t=HF(t)).slice(1);e<n.length;e++)if(null==n[e])throw new iP('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],KP(t,1)]},e.prototype.call=function(t,e){var n=this;return lx(function(){return n.invokeCallHook(t,e),function(t){if(t.rank<=1)throw new iP("batchFlatten requires a minimum rank of 2. Got rank: "+t.rank+".");var e=[t.shape[0],KP(t.shape,1)];return t.reshape(e)}(WF(t))})},e.className="Flatten",e}(nM);FA.registerClass(lz);var cz=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.activation=PL(e.activation),n}return QD(e,t),e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t);return n.activation.apply(r)})},e.prototype.getConfig=function(){var e={activation:OL(this.activation)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Activation",e}(nM);FA.registerClass(cz);var hz=function(t){function e(e){var n=t.call(this,e)||this;return n.n=e.n,n.inputSpec=[{ndim:2}],n}return QD(e,t),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,e){var n=this;return lx(function(){return function(t,e){return lx(function(){if(2!==t.shape.length)throw new iP("repeat() expects a rank-2 tensor, but received a rank-"+t.shape.length+" tensor.");return sF(tF(t,1),[1,e,1])})}(t=WF(t),n.n)})},e.prototype.getConfig=function(){var e={n:this.n},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="RepeatVector",e}(nM);FA.registerClass(hz);var pz=function(t){function e(e){var n=t.call(this,e)||this;n.targetShape=e.targetShape;for(var r=0;r<n.targetShape.length;++r)n.isUnknown(n.targetShape[r])&&(n.targetShape[r]=null);return n}return QD(e,t),e.prototype.isUnknown=function(t){return t<0||null==t},e.prototype.fixUnknownDimension=function(t,e){for(var n="Total size of new array must be unchanged.",r=e.slice(),i=1,o=null,s=0;s<r.length;++s){var a=r[s];if(this.isUnknown(a)){if(null!==o)throw new iP("Can only specifiy one unknown dimension.");o=s}else i*=a}var u=KP(t);if(null!==o){if(0===i||u%i!=0)throw new iP(n);r[o]=u/i}else if(u!==i)throw new iP(n);return r},e.prototype.computeOutputShape=function(t){for(var e=!1,n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t),i=r.shape,o=i.slice(0,1).concat(n.fixUnknownDimension(i.slice(1),n.targetShape));return r.reshape(o)})},e.prototype.getConfig=function(){var e={targetShape:this.targetShape},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Reshape",e}(nM);FA.registerClass(pz);var dz=function(t){function e(e){var n=t.call(this,e)||this;if(null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var r=YP(1,e.dims.length+1);if(!Nb.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=e.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new ZF({ndim:n.dims.length+1})],n}return QD(e,t),e.prototype.computeOutputShape=function(t){var e=(t=HF(t)).slice();return this.dims.forEach(function(n,r){e[r+1]=t[n]}),e},e.prototype.call=function(t,e){return DI(WF(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var e={dims:this.dims},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Permute",e}(nM);FA.registerClass(dz);var fz=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,n.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,n}return QD(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,e),n},e.prototype.computeMask=function(t,e){var n=WF(t);return DN(JN(n,this.maskValue),-1)},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t),i=DN(JN(r,n.maskValue),-1,!0);return r.mul(i.asType(r.dtype))})},e.className="Masking",e}(nM);FA.registerClass(fz);var mz=function(t){function e(e){var n=t.call(this,e)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=null==e.inputLength?[r,null]:[r].concat(hP(e.inputLength))}return n.inputDim=e.inputDim,_P(n.inputDim,"inputDim"),n.outputDim=e.outputDim,_P(n.outputDim,"outputDim"),n.embeddingsInitializer=MF(e.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=UL(e.embeddingsRegularizer),n.activityRegularizer=UL(e.activityRegularizer),n.embeddingsConstraint=OP(e.embeddingsConstraint),n.maskZero=e.maskZero,n.supportsMasking=e.maskZero,n.inputLength=e.inputLength,n}return QD(e,t),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,e){var n=this;return lx(function(){return n.maskZero?(t=WF(t),JN(t,n_(t))):null})},e.prototype.computeOutputShape=function(t){if(t=HF(t),null==this.inputLength)return t.concat([this.outputDim]);var e=hP(this.inputLength);if(e.length!==t.length-1)throw new iP('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(var n=0,r=0;r<e.length;++r){var i=e[r],o=t[r+1];if(null!=i&&null!=o&&i!==o)throw new iP('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);null==i&&(e[n]=o),n++}return[t[0]].concat(e,[this.outputDim])},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t);return"int32"!==r.dtype&&(r=JP(r,"int32")),lF(n.embeddings.read(),r.as1D()).reshape(HF(n.computeOutputShape(r.shape)))})},e.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:FF(this.embeddingsInitializer),embeddingsRegularizer:zL(this.embeddingsRegularizer),activityRegularizer:zL(this.activityRegularizer),embeddingsConstraint:AP(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Embedding",e}(nM);FA.registerClass(mz);var gz=function(t){function e(e){var n=t.call(this,e||{})||this;return n.supportsMasking=!0,n}return QD(e,t),e.prototype.mergeFunction=function(t){throw new oP},e.prototype.computeElementwiseOpOutputShape=function(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(var n=t.slice(0,t.length-e.length),r=0;r<e.length;++r){var i=t[t.length-e.length+r],o=e[r];if(null==i||null==o||i<0||o<0)n.push(null);else if(1===i)n.push(o);else if(1===o)n.push(i);else{if(i!==o)throw new iP("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n},e.prototype.build=function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[HF(t)]),(t=t).length<2)throw new iP("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(var e=[],n=0,r=t;n<r.length;n++)null!=(s=r[n])&&null!==s[0]&&e.push(s[0]);if((e=vP(e)).length>1)throw new iP("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(var i=null==t[0]?null:t[0].slice(1),o=1;o<t.length;++o){var s=null==t[o]?null:t[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var a=t.map(function(t){return t.length});this.reshapeRequired=-1!==t.indexOf(null)||1!==vP(a).length},e.prototype.call=function(t,e){var n=this;return lx(function(){if(t=t,n.reshapeRequired){var e=[],r=t.map(function(t){return t.rank});if(-1===r.indexOf(null)){for(var i=ZP(r),o=0,s=t;o<s.length;o++){for(var a=(p=s[o]).rank,u=0;u<i-a;++u)p=tF(p,1);e.push(p)}return n.mergeFunction(e)}for(var l=!1,c=0,h=t;c<h.length;c++){var p;if(null==(a=(p=h[c]).rank)){var d=p.shape,f=d[0],m=d.slice(1).concat([f]),g=p.reshape([f].concat(KP(d.slice(1))));g=(g=DI(g,[1,0])).reshape(m),e.push(g),l=!0}else if(a>1){var y=YP(1,a).concat([0]);e.push(DI(p,y)),l=!0}else e.push(p)}var v=n.mergeFunction(e),b=v.rank;if(l)if(null==b){var w=v.shape;m=[f=w[w.length-1]].concat(w.slice(0,w.length-1)),v=DI(v.reshape([-1,f]),[1,0]).reshape(m)}else b>1&&(y=[b-1].concat(YP(0,b-1)),v=DI(v,y));return v}return n.mergeFunction(t)})},e.prototype.computeOutputShape=function(t){var e;e=null==(t=t)[0]?null:t[0].slice(1);for(var n=1;n<t.length;++n){var r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}for(var i=[],o=0,s=t;o<s.length;o++)null!=(r=s[o])&&null!==r[0]&&i.push(r[0]);return 1===(i=vP(i)).length?i.concat(e):[null].concat(e)},e.prototype.computeMask=function(t,e){return lx(function(){if(null==e)return null;if(!Array.isArray(e))throw new iP("`mask` should be an Array");if(!Array.isArray(t))throw new iP("`inputs` should be an Array");if(e.length!==t.length)throw new iP("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+t.length+" vs "+e.length+")");if(e.every(function(t){return null==t}))return null;for(var n=(e=e.map(function(t){return null==t?t:N_(t,0)}))[0],r=1;r<e.length-1;++r)n=_I(n,e[r]);return n})},e}(nM),yz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.mergeFunction=function(t){return lx(function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=eI(e,t[n]);return e})},e.className="Add",e}(gz);FA.registerClass(yz);var vz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.mergeFunction=function(t){return lx(function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=fI(e,t[n]);return e})},e.className="Multiply",e}(gz);FA.registerClass(vz);var bz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.mergeFunction=function(t){return lx(function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=eI(e,t[n]);return fI(1/t.length,e)})},e.className="Average",e}(gz);FA.registerClass(bz);var wz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.mergeFunction=function(t){return lx(function(){for(var e=t[0],n=1;n<t.length;++n)e=uI(e,t[n]);return e})},e.className="Maximum",e}(gz);FA.registerClass(wz);var xz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.mergeFunction=function(t){return lx(function(){for(var e=t[0],n=1;n<t.length;++n)e=cI(e,t[n]);return e})},e.className="Minimum",e}(gz);FA.registerClass(xz);var _z=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_AXIS=-1,null==e&&(e={}),n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return QD(e,t),e.prototype.build=function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new iP("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var e=!0,n=0,r=t=t;n<r.length;n++)if(null!=(c=r[n])){e=!1;break}if(!e){for(var i=[],o=0;o<t.length;++o){var s=t[o].slice();s.splice(this.axis,1);for(var a=!1,u=0,l=i;u<l.length;u++){var c=l[u];if(Nb.arraysEqual(c,s)){a=!0;break}}a||i.push(s)}if(i.length>1)throw new iP("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var e=this;return lx(function(){return iF(t,e.axis)})},e.prototype.computeOutputShape=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new iP("A `Concatenate` layer should be called on a list of inputs.");for(var e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,i=0,o=e.slice(1);i<o.length;i++){var s=o[i];if(null==n[r]||null==s[r]){n[r]=null;break}n[r]+=s[r]}return n},e.prototype.computeMask=function(t,e){var n=this;if(null==e)return null;if(!Array.isArray(e))throw new iP("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new iP("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new iP("Mismatch in the length of mask ("+e.length+") and the legnth of inputs ("+t.length+")");return lx(function(){var r=!0;if(e.forEach(function(t){null==t||(r=!1)}),r)return null;for(var i=[],o=0;o<t.length;++o)i.push(null==e[o]?e_(t[o]).asType("bool"):e[o].rank<t[o].rank?N_(e[o],-1):e[o]);var s=r_(i,n.axis);return ON(s,-1,!1)})},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Concatenate",e}(gz);function Cz(t,e){for(;t<0;)t+=e;return t}FA.registerClass(_z);var Sz=function(t){function e(e){var n=t.call(this,e)||this;return n.axes=e.axes,n.normalize=null!=e.normalize&&e.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return QD(e,t),e.prototype.build=function(t){Nb.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var e=t[0],n=t[1];if(e.length>3||n.length>3)throw new oP("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new iP("Dimension incompatibility: "+e[r[0]]+" !== "+n[r[1]])},e.prototype.mergeFunction=function(t){if(2!==t.length)throw new iP("A `Dot` layer must be called on exactly 2 inputs, but received "+t.length+" input(s).");var e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map(function(e,n){return Cz(e,t[n].shape.length)}):[Cz(this.axes,n.shape.length),Cz(this.axes,r.shape.length)],this.normalize&&(n=yM(n,e[0]),r=yM(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new oP("batchDot is not implemented for tensors of 4D or higher rank yet");if(Nb.assert(t.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+t.shape.length}),Nb.assert(t.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+e.shape.length}),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new oP("batchDot is not implemented for complex64-type Tensors yet.");var r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);var o=n;return lx(function(){var n,s;if(r>i){n=r-i;for(var a=[],u=0;u<n;++u)a.push(1);e=e.reshape(e.shape.concat(a))}else if(i>r){for(n=i-r,a=[],u=0;u<n;++u)a.push(1);t=t.reshape(t.shape.concat(a))}else n=0;if(s=2===t.shape.length&&2===e.shape.length?o[0]===o[1]?t.mulStrict(e).sum(o[0]):t.transpose([1,0]).mulStrict(e).sum(o[1]):t.matMul(e,o[0]!==t.shape.length-1,o[1]===e.shape.length-1),n>0){var l,c=[];for(u=l=r>i?r+i-3:r-1;u<l+n;++u)c.push(u);s=s.squeeze(c)}return 1===s.shape.length&&(s=s.expandDims(1)),s})}(n,r,e)},e.prototype.interpretAxes=function(t,e){return Array.isArray(this.axes)?this.axes:[Cz(this.axes,t.length),Cz(this.axes,e.length)]},e.prototype.computeOutputShape=function(t){Nb.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new oP("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var i=e.concat(n);return 1===i.length&&i.push(1),i},e.prototype.computeMask=function(t,e){return null},e.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dot",e}(gz);FA.registerClass(Sz);var Ez=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.stddev=e.stddev,n}return QD(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t);return fF(function(){return aF(r.shape,0,n.stddev).add(r)},function(){return r},e.training||!1)})},e.className="GaussianNoise",e}(nM);FA.registerClass(Ez);var kz=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n}return QD(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e);var r=WF(t);return n.rate>0&&n.rate<1?fF(function(){var t=Math.sqrt(n.rate/(1-n.rate));return r.mul(aF(r.shape,1,t))},function(){return r},e.training||!1):r})},e.className="GaussianDropout",e}(nM);FA.registerClass(kz);var Nz=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n.noiseShape=e.noiseShape,n}return QD(e,t),e.prototype._getNoiseShape=function(t){return this.noiseShape||WF(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return lx(function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(t);return fF(function(){var e=WF(t),i=-1.7580993408473766,o=$N(z_(r),n.rate);o=JP(o,"float32");var s=Math.pow((1-n.rate)*(1+n.rate*Math.pow(i,2)),-.5),a=-s*i*n.rate;return e.mul(o).add(o.add(-1).mul(i)).mul(s).add(a)},function(){return WF(t)},e.training||!1)}return t})},e.className="AlphaDropout",e}(nM);function Iz(t,e,n,r,i,o){var s;if(void 0===o&&(o=.001),2===t.rank)s=tN(t,e,n,r,i,o);else if(3===t.rank)s=eN(t,e,n,r,i,o);else{if(4!==t.rank)throw new oP("batchNormalization is not implemented for array of rank "+t.rank+" yet");s=nN(t,e,n,r,i,o)}return s}FA.registerClass(Nz);var Tz=function(t){function e(e){var n=this;return null==e&&(e={}),(n=t.call(this,e)||this).supportsMasking=!0,n.axis=null==e.axis?-1:e.axis,n.momentum=null==e.momentum?.99:e.momentum,n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=MF(e.betaInitializer||"zeros"),n.gammaInitializer=MF(e.gammaInitializer||"ones"),n.movingMeanInitializer=MF(e.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=MF(e.movingVarianceInitializer||"ones"),n.betaConstraint=OP(e.betaConstraint),n.gammaConstraint=OP(e.gammaConstraint),n.betaRegularizer=UL(e.betaRegularizer),n.gammaRegularizer=UL(e.gammaRegularizer),n}return QD(e,t),e.prototype.build=function(t){var e;t=HF(t);var n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(null==r)throw new iP("Axis "+n+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new ZF({ndim:t.length,axes:(e={},e[n]=r,e)})];var i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){var r=null!=e.training&&e.training,i=WF(t),o=i.shape,s=o.length,a=YP(0,s),u=n.axis>=0?n.axis:n.axis+s;a.splice(u,1);var l=aP(1,s);l[u]=o[u];var c=a.slice();c.sort();var h=!Nb.arraysEqual(c,YP(0,s).slice(0,s-1));if(!r)return function(){if(h){var t=n.movingMean.read().reshape(l),e=n.movingVariance.read().reshape(l),r=n.center?n.beta.read().reshape(l):null,o=n.scale?n.gamma.read().reshape(l):null;return Iz(i,t,e,r,o,n.epsilon)}return Iz(i,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var p=function(t,e,n,r,i){return void 0===i&&(i=.001),Nb.arraysEqual(r.slice().sort(),YP(0,t.rank-1))?function(t,e,n,r,i){return void 0===i&&(i=.001),lx(function(){var o=UN(t,r),s=o.mean,a=o.variance;return[Iz(t,s,a,n,e,i),s,a]})}(t,e,n,r,i):function(t,e,n,r,i){return void 0===i&&(i=.001),lx(function(){for(var o=UN(t,r),s=o.mean,a=o.variance,u=[],l=0,c=YP(0,t.rank);l<c.length;l++){var h=c[l];-1!==r.indexOf(h)?u.push(1):u.push(t.shape[h])}var p=s.reshape(u),d=a.reshape(u),f=null==e?null:e.reshape(u),m=null==n?null:n.reshape(u);return[Iz(t,p,d,m,f,i),s,a]})}(t,e,n,r,i)}(i,n.gamma.read(),n.beta.read(),a,n.epsilon),d=p[0],f=p[2],m=function(t,e,n){lx(function(){var r=1-n,i=t.read(),o=i.sub(e).mul(r);t.write(i.sub(o))})};return m(n.movingMean,p[1],n.momentum),m(n.movingVariance,f,n.momentum),d})},e.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:FF(this.betaInitializer),gammaInitializer:FF(this.gammaInitializer),movingMeanInitializer:FF(this.movingMeanInitializer),movingVarianceInitializer:FF(this.movingVarianceInitializer),betaRegularizer:zL(this.betaRegularizer),gammaRegularizer:zL(this.gammaRegularizer),betaConstraint:AP(this.betaConstraint),gammaConstraint:AP(this.gammaConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="BatchNormalization",e}(nM);FA.registerClass(Tz);var Az=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)n.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new iP("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");var r=void 0,i=void 0;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new iP("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(r=e.padding[0],2!==e.padding[1].length)throw new iP("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");i=e.padding[1]}n.padding=[r,i]}return n.inputSpec=[new ZF({ndim:4})],n}return QD(e,t),e.prototype.computeOutputShape=function(t){return t=HF(t),"channelsFirst"===this.dataFormat?[t[0],t[1],null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null]:[t[0],null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,t[3]]},e.prototype.call=function(t,e){var n=this;return lx(function(){return function(t,e,n){return lx(function(){if(4!==t.rank)throw new iP("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new iP("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new iP("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");return R_(t,"channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]])})}(WF(t),n.padding,n.dataFormat)})},e.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ZeroPadding2D",e}(nM);function Rz(t,e,n,r,i,o){return lx(function(){var s;zP(i),wP(FP,"PoolMode",o),BP(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==o&&(o="max"),t=QL(t,i);var a="same"===r?"same":"valid";return s="max"===o?CN(t,e,n,a):SN(t,e,n,a),"channelsFirst"===i&&(s=DI(s,[0,3,1,2])),s})}FA.registerClass(Az);var Oz=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=2),n=t.call(this,e)||this,"number"==typeof e.poolSize)n.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new iP("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));n.poolSize=e.poolSize}if(_P(n.poolSize,"poolSize"),null==e.strides)n.strides=n.poolSize;else if("number"==typeof e.strides)n.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new iP("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));n.strides=e.strides}return _P(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,BP(n.padding),n.inputSpec=[new ZF({ndim:3})],n}return QD(e,t),e.prototype.computeOutputShape=function(t){var e=KL((t=HF(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]},e.prototype.call=function(t,e){var n=this;return lx(function(){n.invokeCallHook(t,e),t=tF(WF(t),2);var r=n.poolingFunction(WF(t),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return V_(r,[2])})},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(nM),Dz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return zP(i),BP(r),Rz(t,e,n,r,i,"max")},e.className="MaxPooling1D",e}(Oz);FA.registerClass(Dz);var Pz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return zP(i),BP(r),Rz(t,e,n,r,i,"avg")},e.className="AveragePooling1D",e}(Oz);FA.registerClass(Pz);var Fz=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new iP("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides];return _P(n.poolSize,"poolSize"),_P(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,zP(n.dataFormat),BP(n.padding),n.inputSpec=[new ZF({ndim:4})],n}return QD(e,t),e.prototype.computeOutputShape=function(t){t=HF(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=KL(e,this.poolSize[0],this.padding,this.strides[0]),n=KL(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return lx(function(){return n.invokeCallHook(t,e),n.poolingFunction(WF(t),n.poolSize,n.strides,n.padding,n.dataFormat)})},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(nM),Mz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return zP(i),BP(r),Rz(t,e,n,r,i,"max")},e.className="MaxPooling2D",e}(Fz);FA.registerClass(Mz);var Lz=function(t){function e(e){return t.call(this,e)||this}return QD(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return zP(i),BP(r),Rz(t,e,n,r,i,"avg")},e.className="AveragePooling2D",e}(Fz);FA.registerClass(Lz);var zz=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[new ZF({ndim:3})],n}return QD(e,t),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,e){throw new oP},e}(nM),Bz=function(t){function e(e){return t.call(this,e||{})||this}return QD(e,t),e.prototype.call=function(t,e){return lx(function(){var e=WF(t);return zN(e,1)})},e.className="GlobalAveragePooling1D",e}(zz);FA.registerClass(Bz);var Uz=function(t){function e(e){return t.call(this,e||{})||this}return QD(e,t),e.prototype.call=function(t,e){return lx(function(){var e=WF(t);return LN(e,1)})},e.className="GlobalMaxPooling1D",e}(zz);FA.registerClass(Uz);var Vz=function(t){function e(e){var n=t.call(this,e)||this;return n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,zP(n.dataFormat),n.inputSpec=[new ZF({ndim:4})],n}return QD(e,t),e.prototype.computeOutputShape=function(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,e){throw new oP},e.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(nM),jz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.call=function(t,e){var n=this;return lx(function(){var e=WF(t);return zN(e,"channelsLast"===n.dataFormat?[1,2]:[2,3])})},e.className="GlobalAveragePooling2D",e}(Vz);FA.registerClass(jz);var Wz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.call=function(t,e){var n=this;return lx(function(){var e=WF(t);return LN(e,"channelsLast"===n.dataFormat?[1,2]:[2,3])})},e.className="GlobalMaxPooling2D",e}(Vz);function Hz(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new iP("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function qz(t,e,n,r,i,o,s,a){return void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),lx(function(){var u=e.shape.length;if(u<3)throw new iP("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(YP(2,u));if(e=DI(e,l),null!=o)throw new oP("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=N_(i,-1)),i=DI(i,l)),r&&(e=gN(e,0),null!=i&&(i=gN(i,0)));var c,h,p=[],d=n,f=e.shape[0],m=q_(e);null!=i&&(h=q_(i));for(var g,y=function(e){var n=m[e],r=lx(function(){return t(n,d)});if(null==i)c=r[0],d=r[1];else{var o=lx(function(){var t=h[e],n=e_(t).sub(t);return{output:r[0].mul(t).addStrict(d[0].mul(n)),newStates:d.map(function(e,i){return r[1][i].mul(t).addStrict(e.mul(n))})}});c=o.output,d=o.newStates}a&&p.push(c)},v=0;v<f;++v)y(v);return a&&(g=j_(p,1)),[c,g,d]})}FA.registerClass(Wz);var $z=function(t){function e(e){var n,r=t.call(this,e)||this;if(null==e.cell)throw new iP("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(e.cell)?new tB({cells:e.cell}):e.cell).stateSize)throw new iP("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new ZF({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return QD(e,t),e.prototype.getStates=function(){return null==this.states_?YP(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(t){return null}):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){VF(t)&&(t=t[0]),t=t;var e=this.cell.stateSize;Array.isArray(e)||(e=[e]);var n,r=e[0];if(n=this.returnSequences?[t[0],t[1],r]:[t[0],r],this.returnState){for(var i=[],o=0,s=e;o<s.length;o++)i.push([t[0],s[o]]);return[n].concat(i)}return n},e.prototype.computeMask=function(t,e){var n=this;return lx(function(){Array.isArray(e)&&(e=e[0]);var t=n.returnSequences?e:null;if(n.returnState){var r=n.states.map(function(t){return null});return[t].concat(r)}return t})},Object.defineProperty(e.prototype,"states",{get:function(){if(null==this.states_){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[],n=0;n<t;++n)e.push(null);return e}return this.states_},set:function(t){this.states_=t},enumerable:!0,configurable:!0}),e.prototype.build=function(t){if(null!=this.numConstants)throw new oP("Constants support is not implemented in RNN yet.");VF(t)&&(t=t[0]),t=t,this.inputSpec[0]=new ZF({shape:[this.stateful?t[0]:null,null,t[t.length-1]]});var e,n=[t[0]].concat(t.slice(2));if(this.cell.build(n),e=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Nb.arraysEqual(this.stateSpec.map(function(t){return t.shape[t.shape.length-1]}),e))throw new iP("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=e.map(function(t){return new ZF({shape:[null,t]})});this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,e){var n=this;void 0===e&&(e=!1),lx(function(){if(!n.stateful)throw new nP("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new iP("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states_)n.states_=Array.isArray(n.cell.stateSize)?n.cell.stateSize.map(function(t){return Zx([r,t])}):[Zx([r,n.cell.stateSize])];else if(null==t)cx(n.states_),null!=n.keptStates&&(cx(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map(function(t){return Zx([r,t])}):n.states_[0]=Zx([r,n.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==n.states_.length)throw new iP("Layer "+n.name+" expects "+n.states_.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);!0===e?n.keptStates.push(n.states_.slice()):cx(n.states_);for(var i=0;i<n.states_.length;++i){var o=t[i],s=Array.isArray(n.cell.stateSize)?n.cell.stateSize[i]:n.cell.stateSize,a=[r,s];if(!Nb.arraysEqual(o.shape,a))throw new iP("State "+i+" is incompatible with layer "+n.name+": expected shape="+a+", received shape="+o.shape);n.states_[i]=o}}n.states_=n.states_.map(function(t){return hx(t.clone())})})},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,i=null==n?null:n.constants;null==n&&(n={});var o=Hz(e,r,i,this.numConstants);e=o.inputs,i=o.constants;var s=[],a=[];if(null!=(r=o.initialState)){n.initialState=r,s=s.concat(r),this.stateSpec=[];for(var u=0,l=r;u<l.length;u++)this.stateSpec.push(new ZF({shape:l[u].shape}));a=a.concat(this.stateSpec)}if(null!=i&&(n.constants=i,s=s.concat(i),this.numConstants=i.length),s[0]instanceof YF){var c=[e].concat(s),h=this.inputSpec.concat(a),p=this.inputSpec;this.inputSpec=h;var d=t.prototype.apply.call(this,c,n);return this.inputSpec=p,d}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return lx(function(){var r=null==e?null:e.mask,i=null==e?null:e.training,o=null==e?null:e.initialState;t=WF(t),null==o&&(o=n.stateful?n.states_:n.getInitialState(t));var s=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(o.length!==s)throw new iP("RNN Layer has "+s+" state(s) but was passed "+o.length+" initial state(s).");n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var a={training:i},u=qz(function(t,e){var r=n.cell.call([t].concat(e),a);return[r[0],r.slice(1)]},t,o,n.goBackwards,r,null,n.unroll,n.returnSequences),l=u[0],c=u[1],h=u[2];n.stateful&&n.resetStates(h,i);var p=n.returnSequences?c:l;return n.returnState?[p].concat(h):p})},e.prototype.getInitialState=function(t){var e=this;return lx(function(){var n=Zx(t.shape);return n=tF(n=VN(n,[1,2])),Array.isArray(e.cell.stateSize)?e.cell.stateSize.map(function(t){return t>1?sF(n,[1,t]):n}):e.cell.stateSize>1?[sF(n,[1,e.cell.stateSize])]:[n]})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var n=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:n};var r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=gM(e.cell,n);return new t(Object.assign(e,{cell:r}))},e.className="RNN",e}(nM);FA.registerClass($z);var Gz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e}(nM),Kz=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,_P(n.units,"units"),n.activation=PL(null==e.activation?n.DEFAULT_ACTIVATION:e.activation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=MF(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=MF(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=MF(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=UL(e.kernelRegularizer),n.recurrentRegularizer=UL(e.recurrentRegularizer),n.biasRegularizer=UL(e.biasRegularizer),n.kernelConstraint=OP(e.kernelConstraint),n.recurrentConstraint=OP(e.recurrentConstraint),n.biasConstraint=OP(e.biasConstraint),n.dropout=QP([1,ZP([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=QP([1,ZP([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return QD(e,t),e.prototype.build=function(t){t=HF(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){if(2!==(t=t).length)throw new iP("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");var r=t[1];t=t[0];var i,o=null!=e.training&&e.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=eB(function(){return e_(t)},n.dropout,o)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=eB(function(){return e_(r)},n.recurrentDropout,o));var s=n.dropoutMask,a=n.recurrentDropoutMask;i=uF(null!=s?fI(t,s):t,n.kernel.read()),null!=n.bias&&(i=pF(i,n.bias.read())),null!=a&&(r=fI(r,a));var u=eI(i,uF(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]})},e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),recurrentInitializer:FF(this.recurrentInitializer),biasInitializer:FF(this.biasInitializer),kernelRegularizer:zL(this.kernelRegularizer),recurrentRegularizer:zL(this.recurrentRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),recurrentConstraint:AP(this.recurrentConstraint),biasConstraint:AP(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="SimpleRNNCell",e}(Gz);FA.registerClass(Kz);var Xz=function(t){function e(e){return e.cell=new Kz(e),t.call(this,e)||this}return QD(e,t),e.prototype.call=function(e,n){var r=this;return lx(function(){return null!=r.cell.dropoutMask&&(cx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(cx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),recurrentInitializer:FF(this.recurrentInitializer),biasInitializer:FF(this.biasInitializer),kernelRegularizer:zL(this.kernelRegularizer),recurrentRegularizer:zL(this.recurrentRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),recurrentConstraint:AP(this.recurrentConstraint),biasConstraint:AP(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return new t(e)},e.className="SimpleRNN",e}($z);FA.registerClass(Xz);var Qz=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,_P(n.units,"units"),n.activation=PL(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=PL(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=MF(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=MF(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=MF(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=UL(e.kernelRegularizer),n.recurrentRegularizer=UL(e.recurrentRegularizer),n.biasRegularizer=UL(e.biasRegularizer),n.kernelConstraint=OP(e.kernelConstraint),n.recurrentConstraint=OP(e.recurrentConstraint),n.biasConstraint=OP(e.biasConstraint),n.dropout=QP([1,ZP([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=QP([1,ZP([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return QD(e,t),e.prototype.build=function(t){var e=(t=HF(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){if(2!==(t=t).length)throw new iP("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");var r=null!=e.training&&e.training,i=t[1];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=eB(function(){return e_(t)},n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=eB(function(){return e_(i)},n.recurrentDropout,r,3));var o,s,a,u=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=fI(t,n.dropoutMask[0]));var l=uF(t,n.kernel.read());n.useBias&&(l=pF(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(i=fI(i,u[0]));var c=n.recurrentKernel.read(),h=u_(c,[2*n.units,n.units],c.rank-1),p=h[1],d=uF(i,h[0]),f=u_(l,3,l.rank-1),m=f[0],g=f[1],y=f[2],v=u_(d,2,d.rank-1),b=v[1];o=n.recurrentActivation.apply(eI(m,v[0])),s=n.recurrentActivation.apply(eI(g,b));var w=uF(fI(s,i),p);a=n.activation.apply(eI(y,w));var x=eI(fI(o,i),fI(eI(1,kk(o)),a));return[x,x]})},e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),recurrentActivation:OL(this.recurrentActivation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),recurrentInitializer:FF(this.recurrentInitializer),biasInitializer:FF(this.biasInitializer),kernelRegularizer:zL(this.kernelRegularizer),recurrentRegularizer:zL(this.recurrentRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),recurrentConstraint:AP(this.recurrentConstraint),biasConstraint:AP(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="GRUCell",e}(Gz);FA.registerClass(Qz);var Zz=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Qz(e),t.call(this,e)||this}return QD(e,t),e.prototype.call=function(e,n){var r=this;return lx(function(){return null!=r.cell.dropoutMask&&(cx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(cx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),recurrentActivation:OL(this.recurrentActivation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),recurrentInitializer:FF(this.recurrentInitializer),biasInitializer:FF(this.biasInitializer),kernelRegularizer:zL(this.kernelRegularizer),recurrentRegularizer:zL(this.recurrentRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),recurrentConstraint:AP(this.recurrentConstraint),biasConstraint:AP(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="GRU",e}($z);FA.registerClass(Zz);var Yz=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,_P(n.units,"units"),n.activation=PL(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=PL(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=MF(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=MF(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=MF(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=e.unitForgetBias,n.kernelRegularizer=UL(e.kernelRegularizer),n.recurrentRegularizer=UL(e.recurrentRegularizer),n.biasRegularizer=UL(e.biasRegularizer),n.kernelConstraint=OP(e.kernelConstraint),n.recurrentConstraint=OP(e.recurrentConstraint),n.biasConstraint=OP(e.biasConstraint),n.dropout=QP([1,ZP([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=QP([1,ZP([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return QD(e,t),e.prototype.build=function(t){var e,n,r=(t=HF(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var i=this.biasInitializer,o=this.units;n=new((e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return QD(e,t),e.prototype.apply=function(t,e){var n=i.apply([o]),r=(new bF).apply([o]),s=i.apply([2*o]);return oF(oF(n,r),s)},e}(yF)).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,e){var n=this;return lx(function(){var r=null!=e.training&&e.training;if(3!==(t=t).length)throw new iP("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");var i=t[1],o=t[2];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=eB(function(){return e_(t)},n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=eB(function(){return e_(i)},n.recurrentDropout,r,4));var s,a,u,l,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=fI(t,n.dropoutMask[0]));var h=uF(t,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(i=fI(i,c[0])),h=eI(h,uF(i,n.recurrentKernel.read())),n.useBias&&(h=pF(h,n.bias.read()));var p=u_(h,4,h.rank-1),d=p[1],f=p[2],m=p[3];s=n.recurrentActivation.apply(p[0]),a=n.recurrentActivation.apply(d),u=eI(fI(a,o),fI(s,n.activation.apply(f))),l=n.recurrentActivation.apply(m);var g=fI(l,n.activation.apply(u));return[g,g,u]})},e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),recurrentActivation:OL(this.recurrentActivation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),recurrentInitializer:FF(this.recurrentInitializer),biasInitializer:FF(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:zL(this.kernelRegularizer),recurrentRegularizer:zL(this.recurrentRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),recurrentConstraint:AP(this.recurrentConstraint),biasConstraint:AP(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LSTMCell",e}(Gz);FA.registerClass(Yz);var Jz=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Yz(e),t.call(this,e)||this}return QD(e,t),e.prototype.call=function(e,n){var r=this;return lx(function(){return null!=r.cell.dropoutMask&&(cx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(cx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:OL(this.activation),recurrentActivation:OL(this.recurrentActivation),useBias:this.useBias,kernelInitializer:FF(this.kernelInitializer),recurrentInitializer:FF(this.recurrentInitializer),biasInitializer:FF(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:zL(this.kernelRegularizer),recurrentRegularizer:zL(this.recurrentRegularizer),biasRegularizer:zL(this.biasRegularizer),activityRegularizer:zL(this.activityRegularizer),kernelConstraint:AP(this.kernelConstraint),recurrentConstraint:AP(this.recurrentConstraint),biasConstraint:AP(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="LSTM",e}($z);FA.registerClass(Jz);var tB=function(t){function e(e){var n=t.call(this,e)||this;return n.cells=e.cells,n}return QD(e,t),Object.defineProperty(e.prototype,"stateSize",{get:function(){for(var t=[],e=0,n=this.cells.slice().reverse();e<n.length;e++){var r=n[e];Array.isArray(r.stateSize)?t.push.apply(t,r.stateSize):t.push(r.stateSize)}return t},enumerable:!0,configurable:!0}),e.prototype.call=function(t,e){var n=this;return lx(function(){for(var r=(t=t).slice(1),i=[],o=0,s=n.cells.slice().reverse();o<s.length;o++){var a=s[o];Array.isArray(a.stateSize)?i.push(r.splice(0,a.stateSize.length)):i.push(r.splice(0,1))}i.reverse();for(var u,l=[],c=0;c<n.cells.length;++c)a=n.cells[c],r=i[c],u=0===c?[t[0]].concat(r):[u[0]].concat(r),u=a.call(u,e),l.push(u.slice(1));r=[];for(var h=0,p=l.slice().reverse();h<p.length;h++)r.push.apply(r,p[h]);return[u[0]].concat(r)})},e.prototype.build=function(t){var e;VF(t)&&(t=t[0]),t=t;for(var n=0,r=this.cells;n<r.length;n++){var i=r[n];i.build(t),e=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,t=[t[0],e]}this.built=!0},e.prototype.getConfig=function(){for(var e=[],n=0,r=this.cells;n<r.length;n++){var i=r[n];e.push({className:i.getClassName(),config:i.getConfig()})}var o={cells:e},s=t.prototype.getConfig.call(this);return Object.assign(o,s),o},e.fromConfig=function(t,e,n){void 0===n&&(n={});for(var r=[],i=0,o=e.cells;i<o.length;i++)r.push(gM(o[i],n));return new t({cells:r})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var t=[],e=0,n=this.cells;e<n.length;e++)t.push.apply(t,n[e].trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.cells;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var i=[],o=0,s=this.cells;o<s.length;o++)i.push.apply(i,(r=s[o]).trainableWeights);return i.concat(t)}return t},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){for(var t=[],e=0,n=this.cells;e<n.length;e++)t.push.apply(t,n[e].weights);return KF(t)},e.prototype.setWeights=function(t){for(var e=[],n=0,r=this.cells;n<r.length;n++)for(var i=r[n],o=t.splice(i.weights.length),s=0;s<i.weights.length;++s)e.push([i.weights[s],o[s]]);XF(e)},e.className="StackedRNNCells",e}(Gz);function eB(t,e,n,r){function i(){return dF(t(),e)}if(void 0===n&&(n=null),void 0===r&&(r=1),r>1){for(var o=[],s=0;s<r;s++)o.push(fF(i,t,n));return o.map(function(t){return hx(t.clone())})}return hx(fF(i,t,n).clone())}FA.registerClass(tB);var nB=function(t){function e(e){var n=t.call(this,e)||this;return n.layer=e.layer,n}return QD(e,t),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=gM(e.layer,n);delete e.layer;var i={layer:r};return Object.assign(i,e),new t(i)},e}(nM),rB=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n}return QD(e,t),e.prototype.build=function(e){if((e=HF(e)).length<3)throw new iP("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),t.prototype.build.call(this,e)},e.prototype.computeOutputShape=function(t){var e=[(t=HF(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))},e.prototype.call=function(t,e){var n=this;return lx(function(){return qz(function(t,r){return[WF(n.layer.call(t,e)),[]]},t=WF(t),[],!1,null,null,!1,!0)[1]})},e.className="TimeDistributed",e}(nB);FA.registerClass(rB);var iB="concat",oB=function(t){function e(e){var n=t.call(this,e)||this,r=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=r,n.forwardLayer=gM(i),r.goBackwards=!0!==r.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=r,n.backwardLayer=gM(o),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=void 0===e.mergeMode?iB:e.mergeMode,wP(MP,"BidirectionalMergeMode",n.mergeMode),e.weights)throw new oP("weights support is not implemented for Bidirectional layer yet.");return n._stateful=e.layer.stateful,n.returnSequences=e.layer.returnSequences,n.returnState=e.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=e.layer.inputSpec,n.numConstants=null,n}return QD(e,t),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))},e.prototype.computeOutputShape=function(t){var e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):cP(n)},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,i=null==n?null:n.constants;null==n&&(n={});var o=Hz(e,r,i,this.numConstants);if(e=o.inputs,r=o.initialState,i=o.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==i)return t.prototype.apply.call(this,e,n);var s=[],a=[];if(null!=r){var u=r.length;if(u%2>0)throw new iP("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,s.push.apply(s,r);var l=r.map(function(t){return new ZF({shape:t.shape})});this.forwardLayer.stateSpec=l.slice(0,u/2),this.backwardLayer.stateSpec=l.slice(u/2),a.push.apply(a,l)}if(null!=i)throw new oP("Support for constants in Bidirectional layers is not implemented yet.");for(var c=s[0]instanceof YF,h=0,p=s;h<p.length;h++)if(p[h]instanceof YF!==c)throw new iP("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){var d=[e].concat(s),f=this.inputSpec.concat(a),m=this.inputSpec;this.inputSpec=f;var g=t.prototype.apply.call(this,d,n);return this.inputSpec=m,g}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return lx(function(){if(null!=e.mask)throw new oP("The support for masking is not implemented for Bidirectional layers yet.");var r,i,o,s,a=e.initialState;if(null==a)r=n.forwardLayer.call(t,e),i=n.backwardLayer.call(t,e);else{var u=a.slice(0,a.length/2),l=a.slice(a.length/2);r=n.forwardLayer.call(t,Object.assign(e,{initialState:u})),i=n.backwardLayer.call(t,Object.assign(e,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),n.returnSequences&&(i=gN(i,1)),"concat"===n.mergeMode?s=iF([r,i]):"sum"===n.mergeMode?s=eI(r,i):"ave"===n.mergeMode?s=fI(.5,eI(r,i)):"mul"===n.mergeMode?s=fI(r,i):null==n.mergeMode&&(s=[r,i]),n.returnState?null==n.mergeMode?s.concat(o):[s].concat(o):s})},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var e=this;jP(this.forwardLayer.name,function(){e.forwardLayer.build(t)}),jP(this.backwardLayer.name,function(){e.backwardLayer.build(t)}),this.built=!0},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.fromConfig=function(t,e){var n=gM(e.layer);if(delete e.layer,null!=e.numConstants)throw new oP("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=e;return r.layer=n,new t(r)},e.className="Bidirectional",e}(nB);function sB(t){return new Pz(t)}function aB(t){return new Lz(t)}function uB(t){return new Uz(t)}function lB(t){return new Wz(t)}function cB(t){return new Dz(t)}function hB(t){return new Mz(t)}function pB(t,e){return t<e}function dB(t,e){return t>e}FA.registerClass(oB),Object.freeze({inputLayer:function(t){return new rM(t)},elu:function(t){return new HL(t)},reLU:function(t){return new VL(t)},leakyReLU:function(t){return new jL(t)},prelu:function(t){return new WL(t)},softmax:function(t){return new $L(t)},thresholdedReLU:function(t){return new qL(t)},conv1d:function(t){return new rz(t)},conv2d:function(t){return new JL(t)},conv2dTranspose:function(t){return new ez(t)},conv3d:function(t){return new tz(t)},separableConv2d:function(t){return new nz(t)},cropping2D:function(t){return new iz(t)},upSampling2d:function(t){return new oz(t)},depthwiseConv2d:function(t){return new sz(t)},activation:function(t){return new cz(t)},dense:function(t){return new uz(t)},dropout:function(t){return new az(t)},flatten:function(t){return new lz(t)},repeatVector:function(t){return new hz(t)},reshape:function(t){return new pz(t)},permute:function(t){return new dz(t)},embedding:function(t){return new mz(t)},add:function(t){return new yz(t)},average:function(t){return new bz(t)},concatenate:function(t){return new _z(t)},maximum:function(t){return new wz(t)},minimum:function(t){return new xz(t)},multiply:function(t){return new vz(t)},dot:function(t){return new Sz(t)},batchNormalization:function(t){return new Tz(t)},zeroPadding2d:function(t){return new Az(t)},averagePooling1d:sB,avgPool1d:function(t){return sB(t)},avgPooling1d:function(t){return sB(t)},averagePooling2d:aB,avgPool2d:function(t){return aB(t)},avgPooling2d:function(t){return aB(t)},globalAveragePooling1d:function(t){return new Bz(t)},globalAveragePooling2d:function(t){return new jz(t)},globalMaxPooling1d:uB,globalMaxPooling2d:lB,maxPooling1d:cB,maxPooling2d:hB,gru:function(t){return new Zz(t)},gruCell:function(t){return new Qz(t)},lstm:function(t){return new Jz(t)},lstmCell:function(t){return new Yz(t)},simpleRNN:function(t){return new Xz(t)},simpleRNNCell:function(t){return new Kz(t)},rnn:function(t){return new $z(t)},stackedRNNCells:function(t){return new tB(t)},bidirectional:function(t){return new oB(t)},timeDistributed:function(t){return new rB(t)},globalMaxPool1d:uB,globalMaxPool2d:lB,maxPool1d:cB,maxPool2d:hB,Layer:nM,RNN:$z,RNNCell:Gz,input:function(t){return iM(t)},gaussianNoise:function(t){return new Ez(t)},gaussianDropout:function(t){return new kz(t)},alphaDropout:function(t){return new Nz(t)},masking:function(t){return new fz(t)}}),Object.freeze({binaryAccuracy:function(t,e){return NM(t,e)},binaryCrossentropy:function(t,e){return RM(t,e)},sparseCategoricalAccuracy:function(t,e){return OM(t,e)},categoricalAccuracy:function(t,e){return IM(t,e)},categoricalCrossentropy:function(t,e){return DM(t,e)},precision:function(t,e){return AM(t,e)},recall:function(t,e){return function(t,e){return lx(function(){var n=TM(t,e),r=function(t,e){return lx(function(){return _I(t.equal(1),e.equal(0)).sum().cast("float32")})}(t,e),i=n.add(r);return kI(qN(i,0),n.div(i),0).cast("float32")})}(t,e)},cosineProximity:function(t,e){return SM(t,e)},meanAbsoluteError:function(t,e){return bM(t,e)},meanAbsolutePercentageError:function(t,e){return wM(t,e)},MAPE:function(t,e){return wM(t,e)},mape:function(t,e){return wM(t,e)},meanSquaredError:function(t,e){return vM(t,e)},MSE:function(t,e){return vM(t,e)},mse:function(t,e){return vM(t,e)}}),Object.freeze({modelFromJSON:function(t,e){return JD(this,void 0,void 0,function(){var n,r,i,o,s,a,u,l;return tP(this,function(c){switch(c.label){case 0:return"modelTopology"in t||(t={modelTopology:t}),null!=(n=(t=t).modelTopology).model_config&&(n=n.model_config),r=VM(n),i=gM(r,e),null==t.weightsManifest?[3,2]:[4,NA.loadWeights(t.weightsManifest,t.pathPrefix,i.weights.map(function(t){return t.originalName}))];case 1:for(o=c.sent(),s={},a=0,u=i.weights;a<u.length;a++)s[(l=u[a]).originalName]=o[l.originalName];i.loadWeights(s),cx(o),c.label=2;case 2:return[2,i]}})})}}),Object.freeze({l1l2:function(t){return new ML(t)},l1:function(t){return function(t){return new ML({l1:null!=t?t.l1:null,l2:0})}(t)},l2:function(t){return function(t){return new ML({l2:null!=t?t.l2:null,l1:0})}(t)}}),function(t){function e(e){var n=t.call(this)||this;if(null==e&&(e={}),e.restoreBestWeights)throw new oP("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=e.monitor||"val_loss",n.minDelta=Math.abs(e.minDelta||0),n.patience=e.patience||0,n.verbose=e.verbose||0,n.mode=e.mode||"auto",n.baseline=e.baseline,-1===["auto","min","max"].indexOf(n.mode)&&(console.warn("EarlyStopping mode '"+n.mode+"' is invalid. Falling back to mode 'auto'."),n.mode="auto"),n.monitorFunc="min"===n.mode?pB:"max"===n.mode?dB:-1!==n.monitor.indexOf("acc")?dB:pB,n.monitorFunc===pB&&(n.minDelta*=-1),n}QD(e,t),e.prototype.onTrainBegin=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(t){return this.wait=0,this.stoppedEpoch=0,this.best=null!=this.baseline?this.baseline:this.monitorFunc===pB?1/0:-1/0,[2]})})},e.prototype.onEpochEnd=function(t,e){return JD(this,void 0,void 0,function(){var n;return tP(this,function(r){switch(r.label){case 0:return[4,oM(e)];case 1:return r.sent(),null==(n=this.getMonitorValue(e))?[2]:(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)),[2])}})})},e.prototype.onTrainEnd=function(t){return JD(this,void 0,void 0,function(){return tP(this,function(t){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},e.prototype.getMonitorValue=function(t){null==t&&(t={});var e=t[this.monitor];return null==e&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(t)),e}}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=null,e}return QD(e,t),e.prototype.setModel=function(t){if(!(t instanceof yL))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e}(uM));var fB=function(t,e){return(fB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function mB(t,e){function n(){this.constructor=t}fB(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function gB(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})}function yB(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function vB(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var bB=vB(function(t){!function(t,e,n){function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var n=new function(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}(t),i=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)}),wB=vB(function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var n=new function(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)}),xB=vB(function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)}),_B=vB(function(t){!function(t,e,n){function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.x&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)}),CB=vB(function(t){!function(t,e,n){function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=a[127&o]^=r+(s=s+1640531527|0))?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,a[i]=(r^=r>>>15)^(n^=n>>>12);t.w=s,t.X=a,t.i=i}(e,t)}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.X&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)}),SB=vB(function(t){!function(t,e,n){function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)}),EB=vB(function(t){!function(e,r){var i,o=this,s=256,a=6,u="random",l=r.pow(s,a),c=r.pow(2,52),h=2*c,p=s-1;function d(t,n,d){var y=[],v=m(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,g(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(o.crypto||o.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,g(e)]}}():t,3),y),b=new function(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=p&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=p&i+1],n=n*s+a[p&(a[i]=a[o=p&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(s)}(y),w=function(){for(var t=b.g(a),e=l,n=0;t<c;)t=(t+n)*s,e*=s,n=b.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return w.int32=function(){return 0|b.g(4)},w.quick=function(){return b.g(4)/4294967296},w.double=w,m(g(b.S),e),(n.pass||d||function(t,e,n,i){return i&&(i.S&&f(i,b),t.state=function(){return f(b,{})}),n?(r[u]=t,e):t})(w,v,"global"in n?n.global:this==r,n.state)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[p&i]=p&(n^=19*e[p&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(r["seed"+u]=d,m(r.random(),e),t.exports){t.exports=d;try{i=n(4)}catch(t){}}}([],Math)});EB.alea=bB,EB.xor128=wB,EB.xorwow=xB,EB.xorshift7=_B,EB.xor4096=CB,EB.tychei=SB;var kB=EB.alea;function NB(t,e,n,r){if(void 0===n&&(n=new Map),void 0===r&&(r=new Set),null==t)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(AB(t)){var o=Array.isArray(t)?[]:{};for(var s in r.add(t),t){var a=NB(t[s],e,n,r);o[s]=a}return r.delete(t),o}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,i.value),i.value}function IB(t){return null===t?null:AB(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function TB(t,e){return gB(this,void 0,void 0,function(){var n,r,i,o,s,a;return yB(this,function(u){switch(u.label){case 0:n=new Map,NB(t,e,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(s=n.get(o=i[r]))instanceof Promise?[4,s]:[3,3]:[3,4];case 2:a=u.sent(),n.set(o,a),u.label=3;case 3:return r++,[3,1];case 4:return[2,NB(t,e,n)]}})})}function AB(t){return null!=t&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof zb))}function RB(t){return function(t,e){return NB(t,OB)}(t)}function OB(t){return t instanceof zb?{value:t.clone(),recurse:!1}:AB(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var DB=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,n=t;e<n.length;e++)this.push(n[e])},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n},t}(),PB=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return mB(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),n=this.length(),r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},e.INITIAL_CAPACITY=32,e}(DB);function FB(t){return new UB(t)}function MB(t,e){return new ZB(t,e)}var LB,zB=function(){function t(){}return t.prototype.toArray=function(){return gB(this,void 0,void 0,function(){var t,e;return yB(this,function(n){switch(n.label){case 0:return t=[],[4,this.next()];case 1:e=n.sent(),n.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=n.sent(),[3,2];case 4:return[2,t]}})})},t.prototype.toArrayForTest=function(){return gB(this,void 0,void 0,function(){var t,e,n;return yB(this,function(r){switch(r.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(e.push(n.value),[4,t.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,e]}})})},t.prototype.resolveFully=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}})})},t.prototype.resolveWhile=function(t){return gB(this,void 0,void 0,function(){var e,n;return yB(this,function(r){switch(r.label){case 0:return[4,this.next()];case 1:e=r.sent(),n=t(e.value),r.label=2;case 2:return e.done||!n?[3,4]:[4,this.next()];case 3:return e=r.sent(),n=t(e.value),[3,2];case 4:return[2]}})})},t.prototype.handleErrors=function(t){return new GB(this,t)},t.prototype.filter=function(t){return new qB(this,t)},t.prototype.map=function(t){return new $B(this,t)},t.prototype.mapAsync=function(t){return new KB(this,t)},t.prototype.serialMapAsync=function(t){return new KB(this,t).serial()},t.prototype.flatmap=function(t){return new QB(this,t)},t.prototype.forEachAsync=function(t){return gB(this,void 0,void 0,function(){return yB(this,function(e){return[2,this.map(t).resolveFully()]})})},t.prototype.serialForEach=function(t){return gB(this,void 0,void 0,function(){return yB(this,function(e){return[2,this.serialMapAsync(t).resolveWhile(function(t){return!0===t})]})})},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new HB(this,t,e)},t.prototype.columnMajorBatch=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=IB),this.rowMajorBatch(t,e).map(function(t){return function(t,e){return void 0===e&&(e=IB),function t(e,n,r){void 0===r&&(r=new Set);var i=e[0];if(r.has(i))throw new Error("Circular references are not supported.");var o=n(e);if(o.recurse&&null!==o.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(o.recurse){if(AB(i)){var s=Array.isArray(i)?[]:{};r.add(i);var a=function(i){var o=t(e.map(function(t){return t[i]}),n,r);s[i]=o};for(var u in i)a(u);return r.delete(i),s}throw new Error("Can't recurse into non-iterable type: "+i)}return o.value}(t,e)}(t,n)})},t.prototype.concatenate=function(t,e){return new ZB(function(t){return new BB(t)}([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new WB(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new jB(this,t)},t.prototype.prefetch=function(t){return new YB(this,t)},t.prototype.shuffle=function(t,e){return new JB(this,t,e)},t.prototype.serial=function(){return new VB(this)},t}(),BB=function(t){function e(e){var n=t.call(this)||this;return n.items=e,n.trav=0,n}return mB(e,t),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:RB(t),done:!1}])})})},e}(zB),UB=function(t){function e(e){var n=t.call(this)||this;return n.nextFn=e,n}return mB(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]})})},e}(zB),VB=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){return[2,this.upstream.next()]})})},e}(zB),jB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=e.sent()).done?[2,t]:(cx(t.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},e}(zB),WB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},e}(zB),HB=function(t){function e(e,n,r){void 0===r&&(r=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=n,i.enableSmallLastBatch=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){var t,e;return yB(this,function(n){switch(n.label){case 0:t=[],n.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=n.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}})})},e}(zB),qB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.predicate=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){switch(e.label){case 0:return[4,this.upstream.next()];case 1:return(t=e.sent()).done||this.predicate(t.value)?[2,t]:(cx(t.value),[3,0]);case 2:return[2]}})})},e}(zB),$B=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t,e,n,r,i,o,s;return yB(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:if((t=a.sent()).done)return[2,{value:null,done:!0}];for(e=tw.getTensorsInContainer(t.value),n=this.transform(t.value),r=tw.getTensorsInContainer(n),i=0,o=e;i<o.length;i++)tw.isTensorInList(s=o[i],r)||s.dispose();return[2,{value:n,done:!1}]}})})},e}(zB),GB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.handler=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},e}(zB),KB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t,e,n,r,i,o,s;return yB(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(t=a.sent()).done?[2,{value:null,done:!0}]:(e=tw.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(n=a.sent(),r=tw.getTensorsInContainer(n),i=0,o=e;i<o.length;i++)tw.isTensorInList(s=o[i],r)||s.dispose();return[2,{value:n,done:!1}]}})})},e}(zB),XB=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new PB,e.lastRead=Promise.resolve({value:null,done:!1}),e}return mB(e,t),e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},e}(zB),QB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return gB(this,void 0,void 0,function(){var t,e,n,r,i,o,s;return yB(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:if((t=a.sent()).done)return[2,!1];for(e=tw.getTensorsInContainer(t.value),n=this.transform(t.value),r=tw.getTensorsInContainer(n),this.outputQueue.pushAll(n),i=0,o=e;i<o.length;i++)tw.isTensorInList(s=o[i],r)||s.dispose();return[2,!0]}})})},e}(XB),ZB=function(t){function e(e,n){var r=t.call(this)||this;return r.baseErrorHandler=n,r.lastRead=null,r.iterator=null,r.moreIterators=e,r}return mB(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},e.prototype.readFromChain=function(t){return gB(this,void 0,void 0,function(){var e,n;return yB(this,function(r){switch(r.label){case 0:return[4,t];case 1:return r.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=r.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),r.label=3;case 3:return[4,this.iterator.next()];case 4:return(n=r.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,n]}})})},e}(zB);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(LB||(LB={})),function(t){function e(e,n){void 0===n&&(n=LB.FAIL);var r=t.call(this)||this;return r.iterators=e,r.mismatchMode=n,r.count=0,r.currentPromise=null,r}mB(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return gB(this,void 0,void 0,function(){function e(t){return t instanceof zB?{value:t.next().then(function(t){return n++,t.done&&r++,t.value}),recurse:!1}:{value:null,recurse:!0}}var n,r,i;return yB(this,function(o){switch(o.label){case 0:return[4,t];case 1:return o.sent(),n=0,r=0,[4,TB(this.iterators,e)];case 2:if(i=o.sent(),n===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case LB.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case LB.SHORTEST:return[2,{value:null,done:!0}]}return this.count++,[2,{value:i,done:!1}]}})})},e.prototype.next=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:return this.currentPromise=this.nextState(this.currentPromise),[4,this.currentPromise];case 1:return[2,t.sent()]}})})}}(zB);var YB=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.bufferSize=n,r.buffer=new DB(n),r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(zB),JB=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.upstream=e,i.windowSize=n,i.upstreamExhausted=!1,i.random=kB(r||Nb.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return mB(e,t),e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t=this;return yB(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return gB(this,void 0,void 0,function(){var t,e;return yB(this,function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=n.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}})})},e}(YB),tU=function(){function t(){this.size=null}return t.prototype.batch=function(t,e){var n=this;void 0===e&&(e=!0);var r=this;return Nb.assert(t>0,function(){return"batchSize needs to be positive, but it is\n      "+t}),eU(function(){return gB(n,void 0,void 0,function(){return yB(this,function(n){switch(n.label){case 0:return[4,r.iterator()];case 1:return[2,n.sent().columnMajorBatch(t,e,nU)]}})})},this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){var e,r;return yB(this,function(i){switch(i.label){case 0:return[4,n.iterator()];case 1:return r=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,r.apply(e,[i.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().filter(function(e){return lx(function(){return t(e)})})]}})})},this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return gB(this,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}})})},t.prototype.forEach=function(t){return gB(this,void 0,void 0,function(){return yB(this,function(e){return ox("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},t.prototype.map=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().map(function(e){return lx(function(){return t(e)})})]}})})},this.size)},t.prototype.mapAsync=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().mapAsync(t)]}})})},this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return eU(function(){return gB(e,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().prefetch(t)]}})})},this.size)},t.prototype.repeat=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){var e=this;return yB(this,function(r){return[2,MB(FB(function(){return gB(e,void 0,void 0,function(){var t;return yB(this,function(e){switch(e.label){case 0:return t={},[4,n.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}})})}).take(t))]})})},null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().skip(t)]}})})},null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,e,n){var r=this;if(void 0===n&&(n=!0),null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var i=this,o=kB(e||Nb.now().toString());return eU(function(){return gB(r,void 0,void 0,function(){var e;return yB(this,function(r){switch(r.label){case 0:return e=o.int32(),n&&(e+=o.int32()),[4,i.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}})})},this.size)},t.prototype.take=function(t){var e=this,n=this;return eU(function(){return gB(e,void 0,void 0,function(){return yB(this,function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().take(t)]}})})},null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},t.prototype.toArrayForTest=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},t.MAX_BUFFER_SIZE=1e4,t}();function eU(t,e){return void 0===e&&(e=null),new(function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.size=e,t}return mB(r,n),r.prototype.iterator=function(){return gB(this,void 0,void 0,function(){return yB(this,function(e){return[2,t()]})})},r}(tU))}function nU(t){return null===t?null:function(t){return null==t||function(t){return null===t||"object"!=typeof t&&"function"!=typeof t}(t)||Array.isArray(t)||"object"==typeof t&&t instanceof zb||Nb.isTypedArray(t)}(t[0])?{value:rU(t),recurse:!1}:{value:null,recurse:!0}}function rU(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof zb?j_(t):Vx(t)}var iU=function(t){function e(e){var n=t.call(this)||this;return n.input=e,n}return mB(e,t),e.prototype.iterator=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:return[4,this.input.iterator()];case 1:return[2,t.sent().decodeUTF8().split("\n").map(function(t){return t.endsWith("\r")&&(t=t.slice(0,-1)),t})]}})})},e}(tU),oU=Symbol("out"),sU=Symbol("field"),aU=Symbol("quote"),uU=Symbol("quoteafterquote"),lU=Symbol("quoteinquote"),cU=(function(t){function e(e,n){var r=t.call(this)||this;return r.input=e,r.hasHeader=!0,r.fullColumnNames=null,r.columnNamesValidated=!1,r.columnConfigs=null,r.configuredColumnsOnly=!1,r.delimiter=",",r.delimWhitespace=!1,r.base=new iU(e),n||(n={}),r.hasHeader=!1!==n.hasHeader,r.fullColumnNames=n.columnNames,r.columnConfigs=n.columnConfigs,r.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(Nb.assert(null==n.delimiter,function(){return"Delimiter should not be provided when delimWhitespace is true."}),r.delimWhitespace=!0,r.delimiter=" "):r.delimiter=n.delimiter?n.delimiter:",",r}mB(e,t),e.prototype.columnNames=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},e.prototype.setColumnNames=function(){return gB(this,void 0,void 0,function(){var t,e,n,r,i,o,s=this;return yB(this,function(a){switch(a.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=a.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&Nb.assert(t.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+s.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=t),e=this.fullColumnNames.reduce(function(t,e){return t[e]=t[e]+1||1,t},{}),n=Object.keys(e).filter(function(t){return e[t]>1}),Nb.assert(0===n.length,function(){return"Duplicate column names found: "+n.toString()}),this.columnConfigs)for(r=0,i=Object.keys(this.columnConfigs);r<i.length;r++)if(-1===this.fullColumnNames.indexOf(o=i[r]))throw new Error('The key "'+o+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}})})},e.prototype.maybeReadHeaderLine=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){switch(e.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,e.sent().next()];case 2:if((t=e.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,this.parseRow(t.value,!1)];case 3:return[2,null]}})})},e.prototype.iterator=function(){return gB(this,void 0,void 0,function(){var t,e=this;return yB(this,function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[4,this.base.iterator()];case 3:return t=n.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map(function(t){return e.makeDataElement(t)})]}})})},e.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),n={},r={},i=0;i<this.fullColumnNames.length;i++){var o=this.fullColumnNames[i],s=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||s){var a=e[i],u=null;if(""===a)if(s&&void 0!==s.default)u=s.default;else{if(s&&(s.required||s.isLabel))throw new Error("Required column "+o+" is empty in this line: "+t);u=void 0}else{var l=Number(a);if(isNaN(l))u=s&&"bool"===s.dtype?this.getBoolean(a):a;else if(s&&s.dtype)switch(s.dtype){case"float32":u=l;break;case"int32":u=Math.floor(l);break;case"bool":u=this.getBoolean(a);break;default:u=l}else u=l}s&&s.isLabel?r[o]=u:n[o]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}},e.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},e.prototype.parseRow=function(t,e){void 0===e&&(e=!0);for(var n=[],r=0,i=t.length,o=oU,s=0;s<i;s++)switch(o){case oU:switch(t.charAt(s)){case'"':r=s+1,o=aU;break;case this.delimiter:if(r=s+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),o=oU;break;default:o=sU,r=s}break;case sU:switch(t.charAt(s)){case this.delimiter:n.push(t.substring(r,s)),o=oU,r=s+1}break;case aU:switch(t.charAt(s)){case'"':o=uU}break;case uU:switch(t.charAt(s)){case this.delimiter:n.push(t.substring(r,s-1)),o=oU,r=s+1;break;case'"':o=aU;break;default:o=lU}break;case lU:switch(t.charAt(s)){case'"':o=aU}}if(n.push(o===uU?t.substring(r,i-1):t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+n);return n}}(tU),function(t){function e(e){var n=t.call(this)||this;n.microphoneConfig=e,n.isClosed=!1,n.fftSize=e.fftSize||1024;var r=Math.log2(n.fftSize);if(n.fftSize<0||r<4||r>14||!Number.isInteger(r))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+n.fftSize);if(n.numFrames=e.numFramesPerSpectrogram||43,n.sampleRateHz=e.sampleRateHz,n.columnTruncateLength=e.columnTruncateLength||n.fftSize,n.audioTrackConstraints=e.audioTrackConstraints,n.smoothingTimeConstant=e.smoothingTimeConstant||0,n.includeSpectrogram=!1!==e.includeSpectrogram,n.includeWaveform=!0===e.includeWaveform,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}mB(e,t),e.prototype.summary=function(){return"microphone"},e.create=function(t){return void 0===t&&(t={}),gB(this,void 0,void 0,function(){var n;return yB(this,function(r){switch(r.label){case 0:if(Fv.get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new e(t)).start()];case 1:return r.sent(),[2,n]}})})},e.prototype.start=function(){return gB(this,void 0,void 0,function(){var t,e,n,r;return yB(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return t.stream=i.sent(),[3,3];case 2:throw e=i.sent(),new Error("Error thrown while initializing video stream: "+e.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(n=window.AudioContext||window.webkitAudioContext,this.audioContext=new n,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t,e,n,r,i;return yB(this,function(o){switch(o.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return n=o.sent(),this.includeSpectrogram&&(r=this.flattenQueue(n.freqDataQueue),t=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(i=this.flattenQueue(n.timeDataQueue),e=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:e},done:!1}]}})})},e.prototype.capture=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.getAudioData=function(){return gB(this,void 0,void 0,function(){var t,e,n,r=this;return yB(this,function(i){return t=[],e=[],n=0,[2,new Promise(function(i){var o=setInterval(function(){r.includeSpectrogram&&(r.analyser.getFloatFrequencyData(r.freqData),r.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(r.freqData.slice(0,r.columnTruncateLength))),r.includeWaveform&&(r.analyser.getFloatTimeDomainData(r.timeData),e.push(r.timeData.slice())),++n===r.numFrames&&(clearInterval(o),i({freqDataQueue:t,timeDataQueue:e}))},r.fftSize/r.sampleRateHz*1e3)})]})})},e.prototype.stop=function(){this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop()},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var e=t[0].length,n=new Float32Array(t.length*e);return t.forEach(function(t,r){return n.set(t,r*e)}),n},e.prototype.getTensorFromAudioDataArray=function(t,e){var n=new Float32Array(Nb.sizeFromShape(e));return n.set(t,n.length-t.length),Vx(n,e)}}(zB),function(t){function e(e,n){var r=t.call(this)||this;if(r.webcamVideoElement=e,r.webcamConfig=n,r.isClosed=!0,r.resize=!1,r.needToResize())if(r.resize=!0,r.cropSize=[r.webcamConfig.resizeHeight,r.webcamConfig.resizeWidth],r.cropBoxInd=Hx([0],"int32"),r.webcamConfig.centerCrop){var i=1*r.webcamConfig.resizeWidth/r.webcamVideoElement.width,o=1*r.webcamConfig.resizeHeight/r.webcamVideoElement.height,s=(1-i)/2,a=(1-o)/2;r.cropBox=qx([a,s,o+a,s+i],[1,4])}else r.cropBox=qx([0,0,1,1],[1,4]);return r}mB(e,t),e.prototype.summary=function(){return"webcam"},e.create=function(t,n){return void 0===n&&(n={}),gB(this,void 0,void 0,function(){var r;return yB(this,function(i){switch(i.label){case 0:if(Fv.get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}return[4,(r=new e(t,n)).start()];case 1:return i.sent(),[2,r]}})})},e.prototype.start=function(){return gB(this,void 0,void 0,function(){var t,e,n=this;return yB(this,function(r){switch(r.label){case 0:this.webcamConfig.facingMode&&Nb.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,function(){return"Invalid webcam facing mode: "+n.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=r.sent(),[3,4];case 3:throw(e=r.sent()).message="Error thrown while initializing video stream: "+e.message,e;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(t){n.webcamVideoElement.onloadedmetadata=function(){t()}})]}})})},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){if(this.isClosed)return[2,{value:null,done:!0}];try{t=RA.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(t))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(t){throw new Error("Error thrown cropping the video: "+t.message)}finally{t.dispose()}return[2]})})},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var e=this;return lx(function(){var n,r=t.toFloat().expandDims(0),i=(n=ET.cropAndResize(r,e.cropBox,e.cropBoxInd,e.cropSize,"bilinear")).shape;return n.reshape(i.slice(1))})},e.prototype.capture=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.stop=function(){this.stream.getTracks().forEach(function(t){return t.stop()});try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")}}(zB),function(){}),hU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return mB(e,t),e.prototype.split=function(t){return new pU(this,t)},e}(zB),pU=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.impl=new dU(e,n),r}return mB(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){return[2,this.impl.next()]})})},e}(hU),dU=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.separator=n,r.carryover="",r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return gB(this,void 0,void 0,function(){var t,e,n,r;return yB(this,function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:if((t=i.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],n=0,r=e.slice(0,-1);n<r.length;n++)this.outputQueue.push(r[n]);return this.carryover=e[e.length-1],[2,!0]}})})},e}(XB),fU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return mB(e,t),e.prototype.decodeUTF8=function(){return new mU(this)},e}(zB),mU=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.impl=new gU(e),n}return mB(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){return[2,this.impl.next()]})})},e}(hU),gU=function(t){function e(e){var r=t.call(this)||this;if(r.upstream=e,Fv.get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=n(5).StringDecoder;r.decoder=new i("utf8")}return r}return mB(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return gB(this,void 0,void 0,function(){var t,e,n;return yB(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done?[2,!1]:(e=t.value,n=Fv.get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(n),[2,!0])}})})},e}(XB),yU=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.file=e,r.options=n,Nb.assert(e instanceof Uint8Array||!!Fv.get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return mB(e,t),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return gB(this,void 0,void 0,function(){var t,e,n=this;return yB(this,function(r){switch(r.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise(function(t,e){var r=n.offset+n.chunkSize;if(n.file instanceof Uint8Array)t(new Uint8Array(n.file.slice(n.offset,r)));else{var i=new FileReader;i.onload=function(n){var r=i.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},i.onabort=function(t){return e(new Error("Aborted"))},i.onerror=function(t){return e(new Error(t.type))};var o=n.file.slice(n.offset,r);i.readAsArrayBuffer(o)}n.offset=r}),e={},[4,t]);case 1:return[2,(e.value=r.sent(),e.done=!1,e)]}})})},e}(fU);function vU(t,e){return void 0===e&&(e={}),gB(this,void 0,void 0,function(){var n,r,i,o,s;return yB(this,function(a){switch(a.label){case 0:return"string"==typeof t?n=t:(n=t.url,r=bU(t)),[4,Nb.fetch(n,r)];case 1:return(i=a.sent()).ok?(s=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return o=new(s.apply(Uint8Array,[void 0,a.sent()])),[2,new yU(o,e)];case 3:throw new Error(i.statusText)}})})}var bU=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function wU(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var xU=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.input=e,r.options=n,r}return mB(e,t),e.prototype.iterator=function(){return gB(this,void 0,void 0,function(){var t;return yB(this,function(e){return wU(this.input)&&Fv.get("IS_NODE")&&(t=n(6),this.input=t.readFileSync(this.input.substr(7))),[2,new yU(this.input,this.options)]})})},e}(cU);!function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.url=e,r.fileOptions=n,r}mB(e,t),e.prototype.iterator=function(){return gB(this,void 0,void 0,function(){return yB(this,function(t){return wU(this.url)?[2,new xU(this.url,this.fileOptions).iterator()]:[2,vU(this.url,this.fileOptions)]})})}}(cU);class _U{constructor(t){this.errorService=t,this.predictions=[],this.isInitializing=!0,this.subscriptions$=[]}ngAfterViewInit(){this.subscriptions$.push(G(EO()).pipe(Mu(t=>(this.model=t,G(navigator.mediaDevices.getUserMedia({video:!0}))))).subscribe({next:t=>{this.isInitializing=!1,this.userVideoRef.nativeElement.srcObject=t,setInterval(()=>{this.classifyVideoStream()},2e3)},error:()=>this.errorService.displayError()}))}classifyVideoStream(){this.subscriptions$.push(G(this.model.classify(this.userVideoRef.nativeElement)).pipe(Mu(t=>(this.predictions=t,eR())),bu(()=>(this.errorService.displayError(),eR()))).subscribe())}ngOnDestroy(){this.subscriptions$.forEach(t=>t.unsubscribe())}}var CU=nr({encapsulation:0,styles:[[".video-classifier__container[_ngcontent-%COMP%]{margin:0 auto;text-align:center}.video-classifier__content[_ngcontent-%COMP%]{display:inline-block}"]],data:{}});function SU(t){return hs(0,[(t()(),Go(0,0,null,null,6,"mat-list-item",[["class","mat-list-item"],["role","listitem"]],[[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],null,null,kv,Ev)),pi(1,1228800,null,3,wv,[ln,An,[2,vv],[2,bv]],null,null),Yo(603979776,2,{_lines:1}),Yo(603979776,3,{_avatar:0}),Yo(603979776,4,{_icon:0}),(t()(),us(5,2,[" "," | confidence: "," "])),os(6,1)],null,function(t,e){t(e,0,0,Jr(e,1)._avatar||Jr(e,1)._icon,Jr(e,1)._avatar||Jr(e,1)._icon);var n=e.context.$implicit.className,r=Jn(e,5,1,t(e,6,0,Jr(e.parent,0),e.context.$implicit.probability));t(e,5,0,n,r)})}function EU(t){return hs(0,[di(0,Nv,[]),Yo(671088640,1,{userVideoRef:0}),(t()(),Go(2,0,null,null,1,"app-header",[],null,null,null,ey,ty)),pi(3,114688,null,0,Jg,[gp],null,null),(t()(),Go(4,0,null,null,6,"div",[["class","video-classifier__container"]],null,null,null,null,null)),(t()(),Go(5,0,null,null,5,"div",[["class","video-classifier__content"]],null,null,null,null,null)),(t()(),Go(6,0,[[1,0],["userVideo",1]],null,0,"video",[["autoplay",""],["height","300px"],["muted",""],["width","300px"]],null,null,null,null,null)),(t()(),Go(7,0,null,null,3,"mat-list",[["class","mat-list mat-list-base"],["role","list"]],null,null,null,Sv,Cv)),pi(8,704512,null,0,bv,[ln],null,null),(t()(),$o(16777216,null,0,1,null,SU)),pi(10,278528,null,0,Pa,[Ln,Fn,In],{ngForOf:[0,"ngForOf"]},null)],function(t,e){var n=e.component;t(e,3,0),t(e,10,0,n.predictions)},null)}function kU(t){return hs(0,[(t()(),Go(0,0,null,null,1,"app-video-classifier",[],null,null,null,EU,CU)),pi(1,4374528,null,0,_U,[UD],null,null)],null,null)}var NU=jr("app-video-classifier",_U,kU,{},{},[]),IU=nr({encapsulation:2,styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}@media (-ms-high-contrast:active){.mat-snack-bar-container{border:solid 1px}}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}"],data:{animation:[{type:7,name:"state",definitions:[{type:0,name:"void, hidden",styles:{type:6,styles:{transform:"scale(0.8)",opacity:0},offset:null},options:void 0},{type:0,name:"visible",styles:{type:6,styles:{transform:"scale(1)",opacity:1},offset:null},options:void 0},{type:1,expr:"* => visible",animation:{type:4,styles:null,timings:"150ms cubic-bezier(0, 0, 0.2, 1)"},options:null},{type:1,expr:"* => void, * => hidden",animation:{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"75ms cubic-bezier(0.4, 0.0, 1, 1)"},options:null}],options:{}}]}});function TU(t){return hs(0,[(t()(),$o(0,null,null,0))],null,null)}function AU(t){return hs(0,[Yo(402653184,1,{_portalOutlet:0}),(t()(),$o(16777216,null,null,1,null,TU)),pi(2,212992,[[1,4]],0,FO,[nn,Ln],{portal:[0,"portal"]},null)],function(t,e){t(e,2,0,"")},null)}function RU(t){return hs(0,[(t()(),Go(0,0,null,null,1,"snack-bar-container",[["class","mat-snack-bar-container"]],[[1,"role",0],[40,"@state",0]],[["component","@state.done"]],function(t,e,n){var r=!0;return"component:@state.done"===e&&(r=!1!==Jr(t,1).onAnimationEnd(n)&&r),r},AU,IU)),pi(1,180224,null,0,MD,[ao,ln,An,PD],null,null)],null,function(t,e){t(e,0,0,Jr(e,1)._role,Jr(e,1)._animationState)})}var OU=jr("snack-bar-container",MD,RU,{},{},[]),DU=nr({encapsulation:2,styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;height:100%;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}"],data:{}});function PU(t){return hs(0,[(t()(),Go(0,0,null,null,3,"div",[["class","mat-simple-snackbar-action"]],null,null,null,null,null)),(t()(),Go(1,0,null,null,2,"button",[["mat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.action()&&r),r},Yg,Zg)),pi(2,180224,null,0,Xd,[ln,gd,[2,Xg]],null,null),(t()(),us(3,0,["",""]))],null,function(t,e){var n=e.component;t(e,1,0,Jr(e,2).disabled||null,"NoopAnimations"===Jr(e,2)._animationMode),t(e,3,0,n.data.action)})}function FU(t){return hs(2,[(t()(),Go(0,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),us(1,null,["",""])),(t()(),$o(16777216,null,null,1,null,PU)),pi(3,16384,null,0,Ma,[Ln,Fn],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,3,0,e.component.hasAction)},function(t,e){t(e,1,0,e.component.data.message)})}function MU(t){return hs(0,[(t()(),Go(0,0,null,null,1,"simple-snack-bar",[["class","mat-simple-snackbar"]],null,null,null,FU,DU)),pi(1,49152,null,0,FD,[OD,DD],null,null)],null,null)}var LU=jr("simple-snack-bar",FD,MU,{},{},[]),zU=nr({encapsulation:0,styles:[[""]],data:{}});function BU(t){return hs(0,[(t()(),Go(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),pi(1,212992,null,0,xp,[wp,Ln,nn,[8,null],An],null,null)],function(t,e){t(e,1,0)},null)}function UU(t){return hs(0,[(t()(),Go(0,0,null,null,1,"app-root",[],null,null,null,BU,zU)),pi(1,49152,null,0,ba,[Gy,Ul],null,null)],null,null)}var VU=jr("app-root",ba,UU,{},{},[]);class jU{}var WU=ga(va,[ba],function(t){return function(t){const e={},n=[];let r=!1;for(let i=0;i<t.length;i++){const o=t[i];o.token===Ht&&!0===o.value&&(r=!0),1073741824&o.flags&&n.push(o.token),o.index=i,e[Yn(o.token)]=o}return{factory:null,providersByKey:e,providers:t,modules:n,isRoot:r}}([Dr(512,nn,rn,[[8,[$p,cv,KD,NU,OU,LU,VU]],[3,nn],sn]),Dr(5120,qi,Wo,[[3,qi]]),Dr(4608,Aa,Ra,[qi,[2,Ta]]),Dr(5120,Ii,Ho,[ao]),Dr(5120,zi,Bi,[]),Dr(5120,In,Vo,[]),Dr(5120,Tn,jo,[]),Dr(4608,Ul,Vl,[Ua]),Dr(6144,Oe,null,[Ul]),Dr(4608,Dl,Fl,[]),Dr(5120,sl,function(t,e,n,r,i,o,s,a){return[new Rl(t,e,n),new Bl(r),new Ml(i,o,s,a)]},[Ua,ao,ji,Ua,Ua,Dl,Hi,[2,Pl]]),Dr(4608,al,al,[sl,ao]),Dr(135680,cl,cl,[Ua]),Dr(4608,yl,yl,[al,cl,zi]),Dr(5120,Nf,$g,[]),Dr(5120,Im,Gg,[]),Dr(4608,cg,qg,[Ua,Nf,Im]),Dr(5120,pn,Kg,[yl,cg,ao]),Dr(6144,ll,null,[cl]),Dr(4608,mo,mo,[ao]),Dr(5120,oh,zp,[gp]),Dr(4608,Ep,Ep,[]),Dr(6144,Cp,null,[Ep]),Dr(135680,kp,kp,[gp,To,Ji,$t,Cp]),Dr(4608,Sp,Sp,[]),Dr(5120,Np,Dp,[gp,ja,Ip]),Dr(5120,jp,Vp,[Bp]),Dr(5120,Wi,function(t){return[t]},[jp]),Dr(4608,Zd,Mg,[pn,Ua]),Dr(4608,My,Ly,[Ua,ji,Py]),Dr(4608,zy,zy,[My,Fy]),Dr(5120,Iy,function(t){return[t]},[zy]),Dr(4608,Oy,Oy,[]),Dr(6144,Ry,null,[Oy]),Dr(4608,Dy,Dy,[Ry]),Dr(6144,hy,null,[Dy]),Dr(4608,cy,By,[hy,$t]),Dr(4608,ky,ky,[cy]),Dr(4608,bD,bD,[nD,lD,nn,yD,uD,$t,ao,Ua,jd,[2,Sa]]),Dr(5120,wD,xD,[bD]),Dr(1073742336,Ba,Ba,[]),Dr(1024,ze,Xl,[]),Dr(1024,_o,function(){return[Rp()]},[]),Dr(512,Bp,Bp,[$t]),Dr(1024,Mi,function(t,e){return[(n=t,rl("probe",ol),rl("coreTokens",Object.assign({},il,(n||[]).reduce((t,e)=>(t[e.name]=e.token,t),{}))),()=>ol),Up(e)];var n},[[2,_o],Bp]),Dr(512,Li,Li,[[2,Mi]]),Dr(131584,No,No,[ao,Hi,$t,ze,nn,Li]),Dr(1073742336,qo,qo,[No]),Dr(1073742336,Ql,Ql,[[3,Ql]]),Dr(1024,Tp,Fp,[[3,gp]]),Dr(512,Lc,zc,[]),Dr(512,wp,wp,[]),Dr(256,Ip,{},[]),Dr(1024,_a,Pp,[wa,[2,Ca],Ip]),Dr(512,Sa,Sa,[_a,wa]),Dr(512,Ji,Ji,[]),Dr(512,To,Oo,[Ji,[2,Ao]]),Dr(1024,lp,function(){return[[{path:"",component:sv},{path:"classifier/image",component:IO},{path:"classifier/video",component:_U}]]},[]),Dr(1024,gp,Lp,[No,Lc,wp,Sa,$t,To,Ji,lp,Ip,[2,hp],[2,ap]]),Dr(1073742336,Op,Op,[[2,Tp],[2,gp]]),Dr(1073742336,jU,jU,[]),Dr(1073742336,Qg,Qg,[]),Dr(1073742336,Uy,Uy,[]),Dr(1073742336,Vy,Vy,[]),Dr(1073742336,Wd,Wd,[]),Dr(1073742336,wd,wd,[[2,vd],[2,Pl]]),Dr(1073742336,ed,ed,[]),Dr(1073742336,Pd,Pd,[]),Dr(1073742336,Qd,Qd,[]),Dr(1073742336,ay,ay,[]),Dr(1073742336,rv,rv,[]),Dr(1073742336,Ud,Ud,[]),Dr(1073742336,MO,MO,[]),Dr(1073742336,$O,$O,[]),Dr(1073742336,_D,_D,[]),Dr(1073742336,LD,LD,[]),Dr(1073742336,Ed,Ed,[]),Dr(1073742336,Fd,Fd,[]),Dr(1073742336,_v,_v,[]),Dr(1073742336,xv,xv,[]),Dr(1073742336,va,va,[]),Dr(256,Ht,!0,[]),Dr(256,Xg,"BrowserAnimations",[]),Dr(256,Py,"XSRF-TOKEN",[]),Dr(256,Fy,"X-XSRF-TOKEN",[])])});(function(){if(ue)throw new Error("Cannot enable prod mode after platform setup.");ae=!1})(),Kl().bootstrapModuleFactory(WU).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);